
==== Front
Sensors (Basel)
Sensors (Basel)
sensors
Sensors (Basel, Switzerland)
1424-8220
MDPI

10.3390/s24113644
sensors-24-03644
Technical Note
Cluster-Based Strategy for Maximizing the Sum-Rate of a Distributed Reconfigurable Intelligent Surface (RIS)-Assisted Coordinated Multi-Point Non-Orthogonal Multiple-Access (CoMP-NOMA) System
Yang Qingqing
Zhang Qiuhua
Peng Yi *
Ma Xiaomin Academic Editor
Faculty of Information Engineering and Automation, Kunming University of Science and Technology, Kunming 650500, China; 20090119@kust.edu.cn (Q.Y.); 18377335701@163.com (Q.Z.)
* Correspondence: 12309214@kust.edu.cn
04 6 2024
6 2024
24 11 364430 4 2024
23 5 2024
31 5 2024
© 2024 by the authors.
2024
https://creativecommons.org/licenses/by/4.0/ Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https://creativecommons.org/licenses/by/4.0/).
This article proposes a distributed intelligent Coordinated Multi-Point Non-Orthogonal Multiple-Access (CoMP-NOMA) collaborative transmission model with the assistance of reconfigurable intelligent surfaces (RISs) to address the issues of poor communication quality, low fairness, and high system power consumption for edge users in multi-cellular networks. By analyzing the interaction mechanisms and influencing factors among RIS signal enhancement, NOMA user scheduling, and multi-point collaborative transmission, the model establishes RIS-enhanced edge user grouping and coordinates NOMA user clusters based on this. In the multi-cell RIS-assisted JT-CoMP NOMA downlink transmission, joint optimization of the power allocation (PA), user clustering (UC), and RIS phase-shift matrix design (PS) poses a challenging Mixed-Integer Non-Linear Programming (MINLP) problem. The original problem is decomposed by optimizing the formulas into joint sub-problems of PA, UC, and PA and PS, and solved using an alternating optimization approach. Simulation results demonstrate that the proposed scheme effectively reduces the system’s power consumption while significantly improving the system’s throughput and rates.

RIS
CoMP-NOMA
alternating optimization
user cluster
phase-shift design
National Natural Science Foundation of China61761025 This work was supported by the National Natural Science Foundation of China (with number 61761025).
==== Body
pmc1. Introduction

With the widespread application of fifth-generation mobile communication, the surge in data traffic poses increasingly higher requirements for wireless communication, including higher data rates, ultra-high communication reliability, and low transmission latency. Consequently, 5G networks will face higher power consumption and deployment costs [1]. RISs, one of the innovations in next-generation communication technologies, utilize intelligent surfaces to modify the propagation characteristics of electromagnetic waves, optimizing signal transmission and reception to enhance spectrum efficiency with lower power consumption and hardware costs [2]. Introducing RISs into communication environments can achieve better signal quality and coverage enhancement, striking a balance between power efficiency and communication performance.

In traditional cellular networks, NOMA technology is often utilized as one of the technical means to reduce system power consumption due to its ability to achieve high spectrum efficiency and support massive connectivity [3,4]. NOMA allows multiple users to transmit data simultaneously at the same time and with the same frequency resources, thereby improving the spectrum efficiency through non-orthogonal signal transmission between users. This enables support for more users within limited spectrum resources, reducing the need for additional spectra and thus aiding in lowering system power consumption [5]. Recently, researchers have studied RIS-assisted multi-user NOMA systems, developing related network transmission strategies and conducting performance analyses. The main methods typically fall into three types: optimization methods based on beamformer strategies, optimization methods based on cluster strategies, and optimization methods based on coordinated cluster strategies.

Optimization Methods Based on Beamformer Strategies: Each user employs an independent beamformer for service provision in the specific framework based on beamformers. The research in this area primarily focuses on the design of passive and active beamformers and NOMA user power allocation. For a dual-user RIS-assisted Multiple-Input Single-Output (MISO) NOMA downlink, Zheng et al. [6] improved energy efficiency by alternately optimizing passive and active beamformers. They developed active beamforming matrices at the base station and passive beamforming matrices at the RIS using continuous convex approximation and semi-definite relaxation, respectively. Zeng et al. [7] developed a new algorithm using a sequential rank-one relaxation method in RIS-assisted NOMA systems to find a locally optimal rank-one solution. Peng et al. [8] studied the alternating optimization of beamforming in the downlink RIS-NOMA system, proposing a method that combines fractional programming with alternating optimization of main and passive beamforming using continuous convex approximation. Yang et al. [9] researched an uplink NOMA system assisted by active RISs and rate optimization. They combined active RISs with NOMA technology for the first time, introducing constraints on the amplitude and amplification power of active RISs to establish a problem of maximizing rates. Björnson et al. [10] proposed a new resource allocation algorithm, a low-complexity decoding order optimization algorithm, and a joint optimization algorithm to, respectively, address channel allocation, decoding order, power allocation, and reflection coefficient design issues.

Optimization Methods Based on Cluster Strategies: Faced with large-scale user communications, a clustering strategy can improve user fairness and reduce system complexity. The key idea is to divide users into different clusters, with each cluster using a common beamformer to serve the users within that cluster [11]. Researchers have combined RIS deployment designs to study both centralized RIS and distributed RIS-assisted NOMA systems based on user clusters. Zuo et al. [12], targeting mmWave communication systems, adopted a centralized cluster NOMA strategy based on RISs. Data verification showed that the RIS-based centralized cluster NOMA scheme outperformed benchmark schemes based on ZF and OMA. Ding et al. [13] deployed multiple distributed RISs to serve edge users of a cell using a clustering strategy. They paired an edge user with a central cell user to form a NOMA cluster. Simulation data indicated that the NOMA strategy enhanced by distributed RISs could increase the maximum number of successfully served users and the coverage range of the BS. Xiu et al. [14] jointly optimized the beamforming vector at the BS and the RIS element matrix in a multi-cluster RIS-assisted MISO-NOMA communication network to minimize transmission power. Mu et al. [15] addressed the optimization problem of user clustering, power, and resource allocation in the downlink of a NOMA system, maximizing the minimum successful probability of user service.

Optimization Methods Based on Coordinated Cluster Strategies: In multi-cell, multi-user communication systems, due to the use of the same frequency for networking, edge users of cells will experience severe inter-cell interference [16,17]. To solve the technical challenge of communication transmission, CoMP allows multiple base stations to simultaneously transmit to specific terminals by coordinating the transmission and reception of multiple base stations and terminals, thus forming multi-point joint transmission [18,19,20]. The use of multi-cell MIMO technology provides the conditions for using CoMP technology to solve the problem of inter-cell interference. By utilizing the characteristics of the spatial channel to transmit signals, the introduction of CoMP technology improves the performance of edge users. Studies have shown that integrating RISs into multi-cell CoMP systems can further increase the transmission rate of edge users. Mohamed Elhattab et al. [21,22] studied the integration of RISs with downlink NOMA in a JT-CoMP-assisted dual-cell network. The RIS was deployed at the edge of two adjacent cells. By jointly optimizing the power allocation coefficients at the base station, employing user-clustering strategies, and using the phase-shift matrix of the RIS, they achieved maximization of the network and rate. Sun et al. [23] derived the outage probability and throughput of an uplink CoMP NOMA network using stochastic geometry, wherein a BS with a single antenna in the cell only serves one CoMP user. Wang et al. [24] investigated the problem of maximizing the sum-rate in a downlink RIS-assisted CoMP network with Device-to-Device (D2D) communication, further addressing this issue using semi-definite relaxation and penalty methods. As shown in Table 1, a comparison has been made between the work presented in this paper and the existing work published in recent years.

Therefore, in scenarios where there is deep overlapping coverage among multiple cells, it is essential to analyze and deeply explore the core foundational issues of RIS-assisted multi-cell, multi-antenna, NOMA-coordinated multi-point transmission. By modeling the interaction mechanism among RIS, JT-CoMP, and NOMA technology, and conducting in-depth analyses and attempts to resolve issues such as user scheduling, clustering, and power allocation, a novel optimization method for distributed RIS-assisted JT-CoMP NOMA network transmission is established. This can provide excellent technical support for analyzing the performance enhancement mechanism of introducing RISs into multi-cell CoMP NOMA networks.

Based on the background provided above, the main contributions of this paper are as follows:

The technology mentioned in the literature [12,15,18,22,25,28] is mainly applied to systems with single-RIS-assisted communication. However, in actual communication scenarios, with a large number of users, the resource utilization rate of single-RIS-assisted communication is relatively low. To better meet user demands and enhance system availability and flexibility, this paper proposes a distributed RIS-assisted CoMP-NOMA downlink transmission system model. It investigates the problems of minimizing power consumption while ensuring the lowest QoS (Quality of Service) for users and maximizing the transmission rate in a distributed RIS-assisted CoMP-NOMA system. By jointly optimizing inter-group power allocation, intra-group power allocation, user grouping, and phase-shift optimization, the system aims to reduce power consumption and improve system performance and transmission rate.

To ensure fairness in user communication and improve system resource utilization, this paper proposes a clustering strategy based on distributed RIS-assisted CoMP user grouping. The AGD clustering algorithm is employed to match CoMP users with RISs for grouping, thereby achieving more efficient signal enhancement with distributed RISs.

During inter-group power optimization allocation, the coordination between NOMA user clusters and inter-group power allocation is established. A user-grouping scheme based on channel strength is proposed to ensure minimal inter-group channel correlation. Ultimately, closed-form expressions for inter-group power allocation and coordinated NOMA clustering are derived to obtain the optimal solution.

The rest of this article is organized as follows: Section 2 introduces the system model and transmission signals of the article. Section 3 discusses the deployment of RISs and user grouping based on the distributed RISs. Section 4 allocates power between groups and within groups and describes the complexity analysis. Section 5 presents the simulation results and analysis. Section 6 presents the conclusion and future prospects of the article.

2. System Model

Consider the distributed RIS-assisted multi-cell CoMP-NOMA transmission network depicted in Figure 1, where the system comprises three base stations (expandable to multiple base stations), K users, and three intelligent reflecting surfaces. In this framework, two main user categories are considered: NOMA users and CoMP users. NOMA users communicate with a single base station, while CoMP users receive signal transmissions from all three base stations under CoMP transmission scheduling. Distributed RISs are deployed around the clustered area of CoMP users, with each RIS being composed of L reflecting units. By adjusting the phase and amplitude of the signal, the RIS reflects electromagnetic wave signals in predetermined directions and magnitudes, thereby enhancing the signals for CoMP users.

In the system model shown in Figure 1, it is assumed that there is a transmitting antenna and a receiving antenna between the base station and cellular users; set the number of NOMA users for services BS1, BS2, and BS3 to M, N, and Q, respectively, and the user set is represented as m∈[1,2,⋯,M], n∈[1,2,⋯,N], q∈[1,2,⋯,Q]. The number of CoMP users jointly served by all three base stations is denoted as Z, and the set of CoMP users is denoted as z∈[1,2,⋯,Z]. In the joint user grouping described in this paper, a cluster is defined as a cellular user cluster composed of three NOMA users and one CoMP user, represented as Ci=NOMA1m,NOMA2n,NOMA3q,CoMPz.

To address the issue of uneven distribution in the allocation of NOMA users and CoMP users, a CoMP user can exist in one or more clusters, and each cluster must have at least one NOMA user.

2.1. Signal Model

To enhance channel gains, RISs are deployed above the area where CoMP users are concentrated. Assuming three base stations serving their respective NOMA users, the distances between each base station and the NOMA users they serve are d1m, d2n, and d3q. To the CoMP users, the direct distances are h1z, h2z, and h3z. The channels to the RISs are h1,R, h2,R, and h3,R. The reflected channel from the RIS to the CoMP users is hR,Co. The communication between the base station and the users is influenced by various factors such as reflection, diffraction, etc., making it prone to Rayleigh fading. Therefore, the channels from the base station to the CoMP users and NOMA users are represented using the Kronecker model:(1) hCoB→Co=ψB→RξCoB→CodCoB→CoηB→Co2,

(2) hNOB→NO=ψB→RξNOB→NOdNOB→NOηB→NO2,

where dCoB→Co, dNOB→NO represent the distances between the base station and CoMP users, and between the base station and NOMA users, respectively; ηB→Co, ηB→NO are the path loss exponents for the direct path between the base station and users; and ψB→R represents the covariance matrix received by the base station. Each element in ξCoB→Co and ξNOB→NO follows a complex Gaussian distribution with zero mean and unit variance.

The primary path from the base station to the RIS is the line-of-sight (LOS) path, exhibiting mainly Rician fading. Therefore, the channel from the base station to the RIS can be represented as follows:(3) GB→R=κB→RκB→R+112ξ¯B→RdB→RηB→R2+1κB→R+112ψB→RξB→RψRdB→RηB→R2,

where dB→R represents the distance between the base station and the RIS, κB→S represents the Rician-K factor between the base station and the RIS, and ηB→R represents the loss exponent for the distance between the base station and the RIS. ξ¯B→R is the LOS component between the base station and the RIS, where each element in ξB→R follows a complex Gaussian distribution with zero mean and unit variance. ψR represents the reflection correlation matrix at the RIS. Similarly, the channel model between the RIS and CoMP users follows a Rician fading model and can be expressed as follows:(4) gR→Co=κR→CoκR→Co+112ζ¯R→CodR→CoηR→Co2+1κR→Co+112ψR→CoζR→CodR→CoηR→Co2.

where dR→Co represents the distance between the RIS and the CoMP user, ηR→Co represents the loss exponent between the RIS and the CoMP user, ζ¯R→Co represents the LOS component, and ψR→Co represents the receive correlation matrix at the RIS.

2.2. Analysis of Rates

The transmission of signals from the three base stations to the NOMA users and CoMP users according to the NOMA principle can be represented as follows:(5) yNO,Cot=αc,NOiPtyNOt+αc,CoPtyCot,

where t∈[1,2,3]; Pt represents the transmission power of the t-th base station; αc,NOi represents the power allocation factor for the i-th NOMA user in the c-th group; αc,Co represents the power allocation factor for the c-th group of CoMP users, and satisfies 0≺αc,NOi≺αc,Co≺1; and yNOt and yCot, respectively, represent the desired signals received by NOMA users and CoMP users at the n-th base station.

Due to severe obstacles blocking the path and path attenuation caused by long-distance transmission, we neglect signals with two or more reflections as well as interference from neighboring cells on NOMA users. The signals received by NOMA users served by each base station are as follows:(6) y˜NO,m1=d1myNO,Co1+ωNO,m1,

(7) y˜NO,n2=d2nyNO,Co2+ωNO,n2,

(8) y˜NO,q3=d3qyNO,Co3+ωNO,q3,

where ωNO,m1, ωNO,n2, and ωNO,q3 represent the Gaussian white noise received by the NOMA users.

In the transmission of the CoMP-NOMA network framework, CoMP users receive signals from three base stations, and the signal expression is as follows:(9) y˜Co,z=h1z+h1,RΦshR,CoyNO,Co1+    h2z+h2,RΦshR,CoyNO,Co2+    h3z+h3,RΦshR,CoyNO,Co3+ωCo,z

where ωCo,z represents the Gaussian white noise received by the CoMP user, and Φs,s∈1,2,3 is the phase-shift matrix, defined below:(10) Φs=diagΦs1,Φs2,⋯,ΦsL,

where ΦsL=ejθl,0≤θl≤2π.

Low-power transmission is a crucial step in the close integration of green development and mobile communication. To achieve fairness in communication transmission, NOMA users in cells with better channel conditions typically consume less transmission power than CoMP users. In the user demodulation order of this paper, NOMA users have a priority SIC decoding order. When demodulating NOMA user signals, CoMP user signals are treated as noise. Therefore, the Signal-to-Interference-plus-Noise Ratio (SINR) for the NOMA users in the cluster (c,NOi,i∈1,2,3) can be expressed as follows:(11) γc,NOi=εcαc,NOiPhti2Ic+Ic’+σ2.

In the above equation, εc is the inter-group power allocation factor for the c-th group, where dti represents the distance from the t-th base station to the i-th NOMA user; σ2 is the Gaussian white noise power; and P is the total transmission power, which can be expressed as P=P1+P2+P3. Ic and Ic’ are the intra-group interference and inter-group interference, respectively, which can be expressed as Ic=∑i’=1,i’≠i3εcαciPdti’2+εc1−αciPHc,Co2, Ic’=∑c’=1,c’≠cCεc’PHc’,Co+Dc’,Co2, where εc’ is the inter-group power allocation factor for the C’-th group, HC,Co=htz+ht,RΘshR,Co, DC,Co=d1m+d2n+d3q.

After the successful decoding of all NOMA users, CoMP users will remove the signals of NOMA users and then decode their signals. The SINR for the C-th group of CoMP users (c,Co) is given in the following equation:(12) γc,Co=εcαc,CoPHc,Co2Ic’+σ2.

3. User Grouping Based on Distributed RISs

In the deployment of multiple RISs in this article, the deployment of RIS1 should consider the relative positional relationship between BS1, BS2, and CoMP users. Calculate the centroid of the CoMP user cluster οC=∑n|Cn|ZC,n|Cn|, where the distance between BS1 and οC is D1, the distance between BS2 and οC is D2, and the vertical distances from RIS1 to BS1-οC and BS2-οC are T1 and T2, respectively. Theorem 1 in reference [30] states the following:

When T1≺D12 or T2≺D22, the RIS should be deployed near UE to maximize the received signal power.

When T1≥D12 or T2≥D22, RIS1 should be deployed at the intersection of the perpendicular lines in BS1-Oc and BS2-Oc to maximize the received signal power.

Similarly, we can complete the deployment of RIS2 and RIS3.

From a fairness perspective, our goal is to cluster users with similar channel conditions using clustering strategies to obtain optimal RIS-enhanced signals and improve service fairness. In this paper, we employ the AGD clustering algorithm for edge user clustering. According to the system model, CoMP users are clustered into three clusters (g1, g2, g3), with each cluster assisted with an intelligent reflecting surface for communication.

First, we address the distribution of edge users within the plane. By computing the centroid of the network based on user coordinates, once the centroid coordinates are determined, we connect the centroid point with the coordinates of adjacent base stations, thereby delineating the angular range for each clustered user. Subsequently, scanning begins based on the centroid. When a user falls within the angular range formed by the centroid and points BS1 and BS2, they are assigned to the cluster g1, and the scanning process continues for the next user. Additionally, we do not consider dynamic errors caused by user mobility, and each user can only be assigned to one user group.

We propose a strategy to match clustered users with the most suitable RIS by utilizing the minimum average distance between the centroid of the search user cluster and the centroid of a single RIS, thereby achieving the purpose of assisted communication. According to the known coordinates of the gj,j∈1,2,3 user within the n-th cluster ZC,n=xC,n,yC,nT,∀n∈1,⋯|Cn|, the centroid of the user cluster is given as οC=∑n|Cn|ZC,n|Cn|, using binary variables Ac,l∈0,1. To indicate that the j-th cluster selects the l-th RIS for communication, we define an RIS selection matrix as follows:(13) A=A1,1⋯A1,L⋮⋱⋮AC,1⋯AC,L

The objective function for obtaining the minimum sum distance using a binomial norm is represented as follows:(14) minA∑c=1C∑l=1LAc,l||λc−μl||s.t.1 rank(A)=C  2Ac,l∈0,1,∀c∈1,⋯C,∀l∈1,⋯L   3∑l=1LAc,l=1,∀c∈1,⋯C,∀l∈1,⋯L

where 1 is a full rank constraint, 2 ensures that each RIS block is in a working state, and 3 ensures that each cluster is only served by one RIS.

4. Power Allocation Scheme

By incorporating green communication principles and implementing low-power technologies, we aim to promote sustainable development and reduce the amount of energy resources consumed by communication systems. While ensuring that each user’s minimum QoS requirements are met, the optimization problem can be formulated as presented below:(15) minεc,Φs,αc,NOi,αc,Co,UCP=∑c=1C∑i=1Iαc,NOi2+αc,Co2s.t C1:γc,NOi≥minγc,NOi   C2:γc,Co≥minγc,Co   C3:|Φl|=1,1≤l≤L

where εc, Φs, αc,NOi, αc,Co, and UC are the optimization variables, and C1 and C2 ensure the minimum QoS for NOMA users and CoMP users, representing the single-mode constraint for each phase shifter.

The objective function involves multiple optimization variables, making it difficult to solve directly. To address this challenge, this paper approaches the problem from two perspectives: inter-group power allocation and intra-group power allocation, aiming to minimize the total transmission power. The optimization of inter-group power allocation is achieved through the joint grouping of CoMP-NOMA users, while the optimization of intra-group power allocation is accomplished through the phase-shift design of the RISs.

4.1. Joint Inter-Group PA and Coordinated NOMA UC Optimization

This section is dedicated to finding an optimal joint CoMP-NOMA user-grouping strategy. Through inter-group power allocation, the objective is to maximize the sum-rate at the group level.

When employing NOMA transmission and SIC detection, a higher sum-rate can be achieved when there is significant channel diversity between groups. Considering this, when forming joint CoMP-NOMA user groups, the inter-group user channel correlation should be sufficiently low. As shown in Algorithm 1, we perform joint NOMA user clustering. Algorithm 1 Coordinated NOMA user cluster algorithm.	
Input the channel status of NOMA users and CoMP users served by each of the three base stations g1x=h11,h12⋯h1x,   g2y=h21,h22⋯h2y, g3z=h31,h32⋯h3z, g4r=HCo1,HCo2⋯HCor, Ci;
initializing Ci[0]=0;
 repeat 
  Dynamic programming iteration: Outer loop iterates through ge,e∈1,2,3,4, inner loop iterates through each element within the current group;
   if the current state can reach;
    Update the next status value Ci+1;
  repeat
   Calculate the sum of all combinations Ctotal;
   for from 0 to Ctotal2;
    Find the value closest to half of the total as the target value for the optimal solution Coptimal;
 repeat
   Traverse the elements in each group and determine whether to select the cur-rent element based on the values in the dynamic programming array;
   if selected the current element, then add it to the Coptimal, update C’total;
  until all users participate in completing the grouping, with at least one NOMA user and CoMP user in each group;
 Output grouping results Ci,i∈1,2,⋯,C.	

Due to the introduction of RISs, the channels of CoMP users are synthesized from direct channels and reflected channels. In theory, when optimizing inter-group power and joint CoMP-NOMA user grouping, the phase shifts introduced by the RISs should be considered. However, to reduce complexity, the phase-shift factor of the RISs is not considered during the user-grouping process. The inter-group channel correlation is defined as follows:(16) Hc,c’=HcHHc’HcHc’.

where Hc=h1c+h2c+h3c+Hc,Co represents the channel state of the c-th group. Considering the users in the c-th group as a whole, the SNR can be expressed as follows:(17) γc=Hc2εcP∑c’=1,c’≠cCHc’2εc’P+σ2.

The achievable rate of the C-th group is (18) Rc=log21+γc.

On a group basis, the reachable sum-rate of the system is (19) Rsum=∑c=1Clog21+Hc2εcP∑c’=1,c’≠cCHc’2εc’P+σ2.

The greater the channel gain differences between users, the more significant the throughput improvement of the NOMA system will be compared to the OMA system. The optimization problem for inter-group power allocation can be formulated as follows:(20) max Rsum=∑c=1CRcs.t C4:Rc≥Rmin,  C5:P≥0  C6:P≤Pmax

where C4 ensures that the users in the c-th group satisfy the minimum QoS. Directly solving the optimization problem in Equation (17) requires traversing all possible user-grouping scenarios, resulting in extremely high complexity. Next, a simplified approach to this optimization problem is presented.

From Equation (16), the following can be obtained:(21) εc=γc∑c’=1,c’≠cCHc’2εc’P+σ2Hc2P.

It can be observed that the higher the channel gain of the c-th group, the smaller its power allocation factor εc. Furthermore, Equation (22) can be derived:(22) εc=γc1−εcHr2Hc2+γcσ2Hc2P,

where Hr2=∑c’=1,c’≠cCHc’2. Through transformation, we obtain (23) εc=PγcHr2+γcσ2PHc2+γcHr2.

Using Equation (17), the correlation coefficient between the channel gain of the c-th group and the interference from other groups’ channel gains can be defined as follows:(24) Hc,r=HcHHrHcHr

From Equation (22) to Equation (23), it can be inferred that when the channel gain of a particular group is determined, the power allocation factor for that group can be obtained. After the joint CoMP-NOMA user grouping is completed, and the inter-group channel states are known, the power allocation between channels can be achieved.

4.2. Alternating Optimization of Intra-Group PA and PS Design

After the inter-group power allocation is completed, fixed power levels are obtained for each group of users pc=εcP. According to Equations (12) and (13), the achievable rates for NOMA users and CoMP users within the group can be determined as follows:(25) Rc,NO=∑i=1Ilog21+γc,NOi,

(26) Rc,Co=log21+γc,Co.

The achievable rates for the c-th group are (27) RcNO,Co=Rc,NO+Rc,Co.

The intra-group power allocation in this paper aims to maximize the achievable rates for users within the group. The optimization problem is formulated as presented below:(28) maxRcNO,Cos.t C7:0≺αc,NOi≺αc,Co≺1  C8:0≤pαc,NOi+αc,Co≤pc  C9:Rc,NOi≥Rc,NOimin  C10:Rc,Co≥Rc,Comin  C11:Φl=1,1≤l≤L,

where C7 ensures that CoMP users within the group can achieve better service quality; C8 guarantees that the sum of allocated power within the group does not exceed the fixed power for each group pc; and C9 and C10 ensure that users within the group receive at least the minimum QoS. In this optimization objective, the intra-group power allocation is highly coupled with the phase shift, making it challenging to directly obtain the optimal solution. In the following, this paper will adopt an alternating optimization approach to solve the coupling problem between the power and phase shift.

Initializing the phase shift Φs(0), in the case of a fixed phase shift, the channel of CoMP users is known as HC,Co=htz+ht,RΘshR,Co, and the objective function for power allocation optimization can be expressed using intra-group power allocation coefficients:(29) min∑i=1Iαc,NOi2+αc,Co2.s.t C7,C9,C10

This objective function is convex and can be solved using CVX. When the optimal power allocation coefficients α^c,NOi and α^c,Co are obtained in the t-th iteration, the equality holds in (30) α^c,NOi2=2Rc,NOimin−1Ic+Ic’+σ2hti2,

(31) α^c,Co2=2Rc,Comin−1σ2Hc,Co2.

When obtaining the fixed power allocation factors for intra-group users during the initialization of the phase shift, optimizing the phase shift to maximize the achievable rates for CoMP users can be formulated as the optimization objective function:(32) max Rc,Cosum=∑c=1Clog21+pα^c,CoHc,Co2σ2+Ic’,s.t C7,C9,C10,C11.

If we let wc=Hc,Co2=htz+ht,RΘshR,Co2, C10 can be rewritten as follows:(33) wc≥∂c2Rc,Comin−1α^c,Co

where ∂c=σ2+Ic’p. Introducing auxiliary variables provides the following:(34) Θsc=xcxcHxchtzhtzHxcH0

where xc=diaght,RHhR,Co, and htz+ht,RΘshR,Co2 can be rewritten as htz+ΦlHxc2. Then, γc,Co can be rewritten as (35) γc,Co=νxcμxc,

where νxc and μxc can be expressed as follows:(36) νxc=htz+ΦlHxc2α^c,Cop

(37) μxc=∑c’=1,c’≠cCεc’Phtz+ΦlHxc+Dc’,Co2+σ2

According to the quadratic transformation, the objective function in Equation (30) can be transformed into the following:(38) fxc,γ=∑c=1C2α^c,CoReγc∗htz+ΦlHxc−∑c=1Cγc2∑c’=1,c’≠cCεc’Phtz+ΦlHxc+Dc’,Co2+σ2

where γ=γ1,γ2,⋯,γC is a Lagrangian auxiliary variable, Re is the real part taken, and ∗ is the taking conjugation.

The optimization problem in Equation (32) can be rewritten as (39) maxxc,γ∑c=1Cfxc,γs.t. C12:wc≥∂c2Rc,Comin−1α^c,Co,   C13:Φl=1,1≤l≤L

If we let ∂fxc,γ∂γc=0, and ∂fxc,γ∂xc=0, the optimal solution for γ can be obtained as follows:(40) γ˜=α^c,Cohtz+ΦlHxc∑c’=1,c’≠cCεc’Phtz+ΦlHxc+Dc’,Co2+σ2.

The optimal solution for xc obtained using the Lagrange multiplier method is (41) x˜c=α^c,CoγcHj∑χEL+∑j=cCγj2HjHjH,

where EL is the L-order identity matrix, and χ is the auxiliary variable that satisfies the constraint conditions. In summary, the alternating optimization method for power allocation and phase shift within the group is shown in Algorithm 2: Algorithm 2 Alternating optimization of intra-group PA and PS.	
 Input p0, Φ10,Φ20,Φ30, αc,Co0, αc,NOi0, the maximum number of iterations is T and the system’s initial sum-rate is Rsum(t)=0. Set the current iteration number to t = 0;
 While (t≤T or Rsum(t+1)−Rsum(t)≻ς)
  repeat
   Fix Φ10, update αc,Co1 and αc,NOi1 through Equation (29);
   Fix αc,Co1, αc,NOi1, update Φs1 through Equation (39);
  until ( t=T or Rsum(t+1)−Rsum(t)≤ς) Φ^st=Φ^st+1, α^c,Cot=α^c,Cot+1, α^c,NOit=α^c,NOit+1;
 Output Φ^st, α^c,Cot, α^c,NOit.	

4.3. Complexity Analysis

The complexity analysis presented in this article mainly includes the following two aspects: user grouping based on distributed RISs, and grouping COMP users and matching them with the best-matching RISs for auxiliary communication, with a complexity of OZ2T. To quantify the computational complexity of the distributed RIS-assisted COMP-NOMA system based on cluster strategy and the AO algorithm designed for rate maximization proposed in Algorithm 2, it is necessary to evaluate the computational complexity of PA-UC optimization and PA-PS optimization. The computational complexity of the optimal reachable sum of all possible coordinated NOMA cluster configurations for PA-UC is OMNQZ. PA-PS optimization requires multiple replacements of the Lagrange multipliers, and its complexity is OL3. Therefore, the overall complexity of the AO algorithm is OJ1MNQZ+J2L3. In summary, the time complexity of the algorithm proposed in this article is OZ2T+J1MNQZ+J2L3.

5. Simulation Results

Through the analysis of simulation experiment data, this section validates the communication performance of the proposed energy-efficient RIS-assisted coordinated multi-point transmission NOMA system user-grouping design. In a three-dimensional plane, we assume that three small-cell base stations are located at BS1 (1000,2000), BS2 (2500,2000), and BS3 (1750,1000). Three RISs are located separately at RIS1 (1750,3000), RIS2 (1000,1000), and RIS3 (2500,1000). To meet the basic QoS for users, we set γmin=−10 dB. More parameters are given in Table 2.

To validate the enhancement of overall system performance using the RIS-based edge user-grouping strategy, experiments were conducted to compare the impacts of different clustering algorithms and user–RIS pairings on the system’s performance and rates. With a fixed number of reflecting elements (L = 25) and a system transmission power of P = 30 dB, as shown in Figure 2, the simulation results indicate the impact of user numbers on the data transmission rate of mobile communication networks. As the number of users increases, the system faces more communication demands, leading to an increase in the data transmission rates. The AGD clustering algorithm adopted in this paper demonstrates the best performance enhancement in terms of system and rate. The K-means clustering algorithm clusters users with similar Euclidean distances into the same group, and the distribution of users and RISs greatly affects the clustering effect. In situations where user distribution is uneven, this can lead to small channel differences within each cluster and an uneven distribution of users. When users randomly select an RIS for assistance communication, the system performance is severely degraded due to geographical location and channel fading effects. Therefore, grouping edge users and making reasonable matches with RISs can effectively enhance the system’s overall rate.

To verify the improvement in the system sum-rate achieved by optimizing the inter-group power allocation and employing a joint CoMP-NOMA user-grouping strategy, experiments were conducted with a fixed number of reflecting elements (L = 25) comparing the following scenarios: (1) equal inter-group power allocation, and (2) random inter-group power allocation. As depicted in Figure 3, as the power level increases, the signal coverage range expands, and users can receive signals in a wider area. Moderately increasing the power can improve the transmission quality, reduce signal loss and interference, and thus improve the communication efficiency and data transmission rate. Under different power gains, the algorithm proposed in this paper demonstrates superior enhancement in the system’s sum-rate within the CoMP-NOMA system compared to other approaches. When inter-group power is equally allocated, due to significant channel variations among inter-group users, ensuring the minimum service quality for some user groups may be challenging. Consequently, equal power allocation among user groups in the presence of channel disparities violates communication fairness, thus affecting the overall system throughput. OMA schemes, unaffected by bandwidth reuse gains, require more transmit power to achieve the same sum-rate.

To validate the enhancement in the system sum-rate for CoMP users achieved through the alternating optimization of intra-group power allocation and phase shift, experiments were conducted with a fixed number of reflecting elements (L = 25), comparing the following scenarios: (1) equal intra-group power allocation with random phase-shift control, and (2) random intra-group power allocation with random phase-shift control. As shown in Figure 4, with the increase in system power gain, the sum-rate of CoMP users exhibits an upward trend. Under the same transmit power gain, the algorithm employed in this paper demonstrates a more significant enhancement in the system sum-rate for CoMP users. By validating the RIS’s role in signal enhancement, applying the algorithm in a CoMP-NOMA system without the assistance of RISs results in a significant reduction in the sum-rate for CoMP users due to the lack of RIS-assisted communication. This confirms that controlling RIS phase shifts can improve the communication quality for edge users. In comparison experiments where intra-group power is equally allocated, disregarding the bias introduced by the phase-shift control, due to superior channel conditions for NOMA users within the group compared to CoMP users, equal power allocation within the group violates the fairness principle and fails to maximize the communication quality for CoMP users. Thus, the jointly optimized intra-group power allocation and phase shift proposed in this paper demonstrate both rationality and effectiveness in enhancing the communication quality for system edge users.

To verify the impact of the number of reflecting units on the system’s transmit power, with a fixed number of users K = 24, as shown in Figure 5, as the number of reflection units increases, the available phase adjustment schemes also increase. Moderately increasing the number of reflection units can improve the transmission quality, reduce multipath effects and signal attenuation, and thus improve the communication quality and data transmission rate. When the number of reflecting units increases, the transmit power of the RIS-assisted CoMP-NOMA network system, as adopted in this paper, decreases. While there is a decreasing trend in power consumption when phase shifts are randomly generated, the system fails to achieve better performance due to the lack of optimization in the phase shift. In the RIS-assisted CoMP-OMA system, the lower spectrum utilization results in the worst performance for this scheme. In the CoMP-NOMA system without RIS assistance, the absence of reflecting units leads to constant system power consumption. Increasing the number of reflecting units can effectively reduce the system’s power consumption.

To verify the influence of the number of users on the system sum-rate, with a fixed number of reflecting elements L = 25 and a system transmit power of P = 30 dB, four experimental schemes were compared. As shown in Figure 6, with the increase in the number of system users, both system sum-rates exhibit an upward trend. In the RIS-assisted CoMP-NOMA system design proposed in this paper, through grouping strategies and phase optimization, with a fixed transmit power, as the number of users increases, more CoMP-NOMA clusters are formed, leading to a significant improvement in the system sum-rate.

The comparison between the algorithm proposed in this article and the existing technology [18,22] shows that the number of fixed reflection units is L = 25. As the number of users increases, the sum-rate of the system acts as shown in Figure 7 when the transmission power is P = 25 and P = 30. With the assistance of multiple intelligent reflection surfaces for communication, the algorithm in this article combines two user clusters, which greatly improves the sum-rate of the system from two levels of service fairness and communication quality improvement, as well as the reasonable allocation of inter-group power and intra-group power. The technology mentioned in reference Mohamed, E 2022 [22] is mainly applied in systems with single-RIS-assisted communication. However, in actual communication scenarios, with a large number of users, the resource utilization rate of single-RIS-assisted communication is relatively low. The technology proposed in reference Wang, H 2022 [18] reduces the transmission power of the system from the perspective of eliminating interference. As the number of system users increases, the energy efficiency loss caused by eliminating interference also deepens. Therefore, the system’s sum-rate is lower than that in the other two comparison schemes.

6. Conclusions

This article focuses on the system model of distributed RIS-assisted CoMP-NOMA systems in the downlink. It analyzes the interaction mechanisms among RIS signal enhancement, NOMA user scheduling, and multi-point cooperative transmission, as well as the factors influencing communication performance. Firstly, it establishes RIS-enhanced edge user grouping to obtain the optimal RIS-enhanced signal and enhance service fairness, then coordinates NOMA user clusters based on this foundation. Secondly, by jointly optimizing inter-group power allocation and coordinated NOMA user cluster design, the system achieves a maximized sum-rate. After obtaining the optimal solution for inter-group power allocation, intra-group power is fixed, and through alternate optimization of the intra-group power allocation and phase shifts, the system maximizes the sum-rate for CoMP users, thereby effectively improving the communication quality for edge users. Additionally, simulation experiments validate the communication performance of distributed RIS-enhanced edge user groups and the reduced user power consumption under coordinated NOMA clusters, significantly enhancing both the system sum-rate and the communication quality for edge users. Given that the premise of this study assumes that all users are statically deployed, to align with the dynamic nature of mobile communications, future research will consider dynamic user deployment to further enhance system performance.

Author Contributions

Conceptualization, Q.Z. and Q.Y.; methodology, Q.Z. and Q.Y.; software, Q.Z.; validation, Q.Z., Q.Y. and Y.P.; formal analysis, Q.Z. and Q.Y.; investigation, Q.Z. and Q.Y.; resources, Q.Y. and Y.P.; data curation, Q.Z.; writing—original draft preparation, Q.Z.; writing—review and editing, Q.Z. and Q.Y.; visualization, Q.Z. and Q.Y.; supervision, Q.Y. and Y.P.; project administration, Q.Y. and Y.P.; funding acquisition, Q.Y. and Y.P. All authors have read and agreed to the published version of the manuscript.

Conflicts of Interest

The authors declare no conflicts of interest.

Figure 1 System model.

Figure 2 The impact of RIS user grouping on the system, L = 25.

Figure 3 The relationship between the system’s rate and transmission power, L = 25.

Figure 4 The relationship between CoMP users, rate, and transmission power.

Figure 5 The relationship between transmission power and reflecting units.

Figure 6 The relationship between the system rate and the users.

Figure 7 Comparison of experimental studies in the literature Mohamed, E., 2022 [22], Wang, H., 2022 [18] on changes in the system sum-rate with an increasing number of users at different powers.

sensors-24-03644-t001_Table 1 Table 1 Comparison of the proposed work with existing RIS-enabled multi-cell works.

Ref.	Cell(s)	RIS(s)	Work Objective	Beamforming	Cluster Strategy	Coordinate Cluster
Strategy	
[12]	Single	Single	Evaluating an IRS-enhanced mmWave-NOMAsystem	√	√	——	
[15]	Single	Single	Investigating the fundamental capacity limits ofIRS-assisted multi-user wireless communications	√	——	——	
[18]	Double	Single	Minimizing the transmission power	√	√	——	
[22]	Double	Single	Maximizing the network sum-rate	√	——	√	
[25]	Multi	Single	Maximizing the network sum-rate	√	√	——	
[26]	Double	Double	Investigating outage performance	√	√	——	
[27]	Multi	——	Maximizing the network sum-rate	——	√	√	
[28]	Multi	Single	Minimizing the total power consumption	√	——	——	
[29]	Multi	Multi	Maximizing the total spectral efficiency	√	——	——	
This work	Multi	Multi	Maximizing the network sum-rate and minimizing the total power consumption	√	√	√	

sensors-24-03644-t002_Table 2 Table 2 Simulation parameter settings.

Parameter	Value	
Bandwidth	10 MHz	
Noise power spectral density	−105 dB	
Number of users	36	
Maximum number of Iterations	20	
Free space loss model	125 + 36.6log10(d)	
Convergence threshold	10−3	
Minimum SINR	−10 dB	
Number of reflective surfaces	3	
Threshold ς	0.001~0.01	
The number of reflecting elements	10~30	

Disclaimer/Publisher’s Note: The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.
==== Refs
References

1. Song Y. Xu S. Xu R. Ai B. Weighted Sum-Rate Maximization for Multi-STAR-RIS-Assisted Mmwave Cell-Free Networks IEEE Trans. Veh. Technol. 2023 73 5304 5320 10.1109/TVT.2023.3332334
2. Liu R. Wu Q. Di Renzo M. Yuan Y. A path to smart radio environments: An industrial viewpoint on reconfigurable intelligent surfaces IEEE Wirel. Commun. 2022 29 202 208 10.1109/MWC.111.2100258
3. Fang F. Zhang L. Wu Z. Jiang J. Energy Consumption Minimization for Multi-carrier NOMA Visible Light Communication Downlinks Proceedings of the 2021 IEEE/CIC International Conference on Communications in China (ICCC) Xiamen, China 28–30 July 2021 876 880
4. Magalhaes S.R.C. Bayhan S. Heijenk G. Impact of Power Consumption Models on the Energy Efficiency of Downlink NOMA Systems IEEE Trans. Green Commun. Netw. 2023 7 1739 1753 10.1109/TGCN.2023.3286578
5. Hu L. Wu Q. Fan Y. Shi R. Huang S. Research on resource allocation algorithm for NOMA system based on fairness and optimal energy efficiency Proceedings of the 2021 13th International Conference on Wireless Communications and Signal Processing (WCSP) Changsha, China 20–22 October 2021
6. Zheng B. Wu Q. Zhang R. Intelligent Reflecting Surface-Assisted Multiple Access with User Pairing: NOMA or OMA? IEEE Commun. Lett. 2020 24 753 757 10.1109/LCOMM.2020.2969870
7. Zeng M. Li X. Li G. Hao W. Dobre O.A. Sum Rate Maximization for IRS-Assisted Uplink NOMA IEEE Commun. Lett. 2021 25 234 238 10.1109/LCOMM.2020.3025978
8. Peng Y. Wu T. Yang Q. Alternating optimization beamforming method for downlink RIS-NOMA system J. Beijing Univ. Posts Telecommun. 2023 46 64 69
9. Yang X. Wang H. Research on Upstream NOMA System and Rate Maximization Assisted by Active RIS J. Nanjing Univ. Posts Telecommun. 2023 43 46 52
10. Björnson E. Wymeersch H. Matthiesen B. Popovski P. Sanguinetti L. de Carvalho E. Reconfigurable Intelligent Surfaces: A signal processing perspective with wireless applications IEEE Signal Process. Mag. 2022 39 135 158 10.1109/MSP.2021.3130549
11. Zhu J. Huang Y. Wang J. Navaie K. Ding Z. Power Efficient IRS-Assisted NOMA IEEE Trans. Commun. 2021 69 900 913 10.1109/TCOMM.2020.3029617
12. Zuo J. Liu Y. Basar E. Dobre O.A. Intelligent Reflecting Surface Enhanced Millimeter-Wave NOMA Systems IEEE Commun. Lett. 2020 24 2632 2636 10.1109/LCOMM.2020.3009158
13. Ding Z. Poor V.H. A Simple Design of IRS-NOMA Transmission IEEE Commun. Lett. 2020 24 1119 1123 10.1109/LCOMM.2020.2974196
14. Xiu Y. Zhao J. Sun W. Di Renzo M. Gui G. Zhang Z. Wei N. Reconfigurable intelligent surfaces aided mmWave NOMA: Joint power allocation, phase shifts, and hybrid beamforming optimization IEEE Trans. Wirel. Commun. 2021 20 8393 8409 10.1109/TWC.2021.3092597
15. Mu X. Liu Y. Guo L. Lin J. Al-Dhahir N. Capacity and Optimal Resource Allocation for IRS Assisted Multi-User Communication Systems IEEE Trans. Commun. 2021 69 3771 3786 10.1109/TCOMM.2021.3062651
16. Hendraningrat D.K. Satrya G.B. Ramatryana I.N.A. Coordinated Beamforming for Multi-Cell Non-Orthogonal Multiple Access-Based Spatial Modulation IEEE Access 2020 8 113456 113466 10.1109/ACCESS.2020.3002920
17. Ali M.S. Hossain E. Downlink power allocation for CoMP-NOMA in multi-cell networks IEEE Trans. Commun. 2018 66 3982 3998 10.1109/TCOMM.2018.2831206
18. Wang H. Chen L. Zheng S. Power minimization for uplink RIS-assisted CoMP-NOMA networks with GSIC IEEE Trans. Commun. 2022 70 4559 4573 10.1109/TCOMM.2022.3177773
19. Hedayati M. Kim I.-M. CoMP-NOMA in the SWIPT networks IEEE Trans. Wirel. Commun. 2020 19 4549 4562 10.1109/TWC.2020.2985038
20. Hou T. Wang J. Liu Y. Sun X. Li A. Ai B. A joint design for STAR-RIS enhanced NOMA-CoMP networks: A simultaneous-signal-enhancement-and-cancellation-based (SSECB) design IEEE Trans. Veh. Technol. 2021 71 1043 1048 10.1109/TVT.2021.3129178
21. Elhattab M. Arfaoui A.M. Assi C. Power allocation in CoMP-empowered C-NOMA networks IEEE Netw. Lett. 2021 3 10 14 10.1109/LNET.2020.3045070
22. Mohamed E. Mohamed A. Ali G. RIS-Assisted Joint Transmission in a Two-Cell Downlink NOMA Cellular System IEEE J. Sel. Areas Commun. 2022 40 1270 1286
23. Sun Y. Ding Z. Dai X. Dobre O.A. On the performance of network NOMA in uplink CoMP systems: A stochastic geometry approach IEEE Trans. Commun. 2019 67 5084 5098 10.1109/TCOMM.2019.2906307
24. Wang W. Yang L. Meng A. Resource allocation for IRS-aided JP-CoMP downlink cellular networks with underlaying D2D communications IEEE Trans. Wirel. Commun. 2021 21 456 467 10.1109/TWC.2021.3128711
25. Ni W. Liu X. Liu Y. Tian H. Chen Y. Resource allocation for multi-cell IRS-aided NOMA networks IEEE Trans. Wirel. Commun. 2021 20 4253 4268 10.1109/TWC.2021.3057232
26. Zhang C. Yi W. Liu Y. Yang K. Ding Z. Reconfigurable intelligent surfaces aided multi-cell NOMA networks: A stochastic geometry model IEEE Trans. Commun. 2021 70 951 966 10.1109/TCOMM.2021.3126598
27. Chowdary A. Chopra G. Kumar A. Cenkeramaddi L.R. Enhanced user grouping and pairing scheme for CoMP-NOMA-based cellular networks Proceedings of the 2022 14th International Conference on Communication Systems & Networks (COMSNETS) Bangalore, India 4–8 January 2022 319 323
28. Cai W. Liu R. Liu Y. Li M. Liu Q. Intelligent reflecting surface assisted multi-cell multi-band wireless networks Proceedings of the 2021 IEEE Wireless Communications and Networking Conference (WCNC) Nanjing, China 29 March–1 April 2021 1 6
29. Khan W.U. Lagunas E. Mahmood A. Ali Z. Asif M. Chatzinotas S. Ottersten B. Integration of NOMA with reflecting intelligent surfaces: A multi-cell optimization with SIC decoding errors IEEE Trans. Green Commun. Netw. 2023 7 1554 1565 10.1109/TGCN.2023.3263121
30. Ren Y. Zhou R. Teng X. Meng S. Zhou M. Tang W. Li X. Li C. Jin S. On deployment position of RIS in wireless communication systems: Analysis and experimental results IEEE Wirel. Commun. Lett. 2023 12 1756 1760 10.1109/LWC.2023.3292125
