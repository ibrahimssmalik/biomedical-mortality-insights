
==== Front
Sensors (Basel)
Sensors (Basel)
sensors
Sensors (Basel, Switzerland)
1424-8220
MDPI

10.3390/s24113668
sensors-24-03668
Article
Assessment of Measurement Uncertainty for S-Parameter Measurement Based on Covariance Matrix
Zhu Jiangmiao Conceptualization Methodology Validation Formal analysis Writing – original draft Writing – review & editing Supervision Project administration Funding acquisition 1
https://orcid.org/0009-0003-4019-0590
Wang Yifan Conceptualization Methodology Software Validation Investigation Data curation Writing – original draft Writing – review & editing Visualization 1
Zhao Kejia Resources Project administration Funding acquisition 2*
Wang Yidi Conceptualization Investigation Visualization 1
Fu Chaoxian Validation Investigation Data curation 1
https://orcid.org/0009-0008-8701-1875
Man Kaige Investigation Visualization 1
Kobayashi Haruo Academic Editor
1 Faculty of Information Technology, Beijing University of Technology, Beijing 100124, China; zhujiangmiao@bjut.edu.cn (J.Z.); 18301192013@163.com (Y.W.); 18801002896@163.com (Y.W.); 17337691790@163.com (C.F.); 13911778235@163.com (K.M.)
2 National Institute of Metrology, Beijing 100029, China
* Correspondence: zhaokj@nim.ac.cn
05 6 2024
6 2024
24 11 366806 5 2024
27 5 2024
05 6 2024
© 2024 by the authors.
2024
https://creativecommons.org/licenses/by/4.0/ Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https://creativecommons.org/licenses/by/4.0/).
S-parameters are widely used to detail the scattering parameters of radio frequency (RF) components and microwave circuit modules. The vector network analyzer (VNA) is the most commonly used device for measuring S-parameters. Given the multiple frequency points, complex values, and intricate uncertainty propagation involved, accurately assessing the uncertainty of S-parameter measurements is difficult. In this study, we proposed a new method for assessing S-parameter uncertainty based on the covariance matrices, tracing back to the nominal uncertainty of calibration standards. First, we analyzed the relevant theory of uncertainty assessment using covariance matrices and subsequently deduced the mechanism of Type B uncertainty propagating from calibration standards to error model coefficients and S-parameter measurements to evaluate Type B measurement uncertainty. In this study, a novel measurement system was constructed for measuring grounded coplanar waveguides by using a VNA and calibration standards with 8- and 12-error models. Initially, the model assessed the Type B uncertainty of measuring four S-parameters of a grounded coplanar waveguide. Next, the VNA calibrated with the 12-error model was used to conduct multiple repeated measurements to assess the Type A uncertainty of the grounded coplanar waveguide. Finally, the composite uncertainty was constructed, which demonstrated that the proposed method can be used for assessing the uncertainty of S-parameters.

measurement uncertainty
covariance matrix
vector network analyzer (VNA)
S-parameters
National Key Research and Development Program “National Quality Infrastructure System”2022YFF0605902 National Key Research and Development program “Basic Scientific Research Conditions and Major Scientific Instruments and Equipment Research and Development”2022YFF0707104 This research was funded by the National Key Research and Development Program “National Quality Infrastructure System” key special project “Research and Application of Key RF Parameter Measurement Standards for Microelectromechanical Systems” (2022YFF0605902). This research was funded by the National Key Research and Development program “Basic Scientific Research Conditions and Major Scientific Instruments and Equipment Research and Development” and the key special project “Broadband Sampling Oscilloscope” (2022YFF0707104).
==== Body
pmc1. Introduction

With the rapid development of electronic communication technology, scattering parameters (S-parameters) can provide accurate characteristics of electromagnetic wave transmission in microwave components and circuit network modules. S-parameters are network parameters that are established based on the relationship between incident waves and reflected waves, and the accuracy of their measurement results directly affects the quality of microwave components. The vector network analyzer (VNA) is the most widely used equipment for measuring S-parameters. The measurement uncertainty of the VNA considerably influences the uncertainty of S-parameters and should be evaluated as a Type B uncertainty.

Measurement uncertainty is a scientific evaluation indicator for measurement results. Common methods for assessing uncertainty generally involve the law of propagation of uncertainty based on measurement uncertainty representation guidelines and the Monte Carlo method based on mathematical modeling [1,2]. However, for assessing the complex uncertainty of S-parameters involving multiple frequency points and variables, the covariance matrix method is preferred. The covariance matrix is considered an extension of linear propagation, which can effectively address the uncertainty evaluation and propagation of such complex objects [3,4,5,6].

Numerous studies have focused on the measurement uncertainty of VNA. However, most methods are limited to assessing Type A uncertainty of the measurement results of S-parameters and do not fully consider the influence of the instrument on measurement uncertainty. Type B uncertainty is not considered because of the difficulty in evaluation. Type B uncertainty has complex influencing factors and numerous unmeasurable intermediate quantities in the equipment that are typically ignored. Type A uncertainty is typically the uncertainty introduced by the randomness of measurements, which is generally assessed through multiple repeated measurements. Type B uncertainty, on the other hand, is the inherent uncertainty of the measurement system itself, requiring an in-depth analysis of the sources of uncertainty and the assessment methods [2]. Since the proposal of the 8-term and 12-term calibration error models in the 1970s [7], many scholars have conducted extensive research on sources of error in VNA measurements, the impact of various calibration error models on measurement results, and the relationship between calibration standards and error model coefficients, focusing on VNAs with bandwidths lower than 30 GHz and tens of sampling points [8,9,10,11,12]. Because the transmission bandwidth frequency reaches the terahertz level, higher requirements have been proposed for the bandwidth and number of sampling points in VNA uncertainty assessment, which is crucial for the subsequent propagation of S-parameter uncertainty [13,14].

This paper proposes a method to evaluate the uncertainty of VNA-measured S-parameters based on the covariance matrix. Using the 8-term and 12-term error models of dual-port calibration, the uncertainty is progressively propagated to the measured S-parameters. Additionally, our algorithm is suitable for more complex scenarios with higher bandwidths and more frequency points. To consider the multi-frequency measurement of VNA and the correlation between variables and facilitate the propagation of S-parameter uncertainty, the measurement uncertainty of VNA was evaluated using the covariance matrix. Experimental design schemes and formula derivations have been provided, and the same VNA is calibrated using 8- and 12-term error models. Experimental verification of Type B uncertainty assessment was performed by measuring the S-parameters of the ground coplanar waveguide. Finally, Type A uncertainty was assessed multiple times based on calibration with the 12-term error model, and the combined uncertainty was calculated.

2. Covariance Matrix Uncertainty Assessment

For complex measurement results, the covariance matrix is widely used in the uncertainty assessment method. When assessing the Type A uncertainty of multivariate measurements, the covariance of the off-diagonal elements can effectively retain the correlations between variables. However, when assessing Type B uncertainty, because of the complexity of uncertainty sources in the measurement system, tracing back to the final source requires multiple passes. Covariance matrix operations have numerous advantages; for example, the correlation between variables in the previous step affects the uncertainty of the covariance matrix in the next step, rendering such assessments scientifically reliable [15,16]. Although the law of propagation of uncertainty can be used to separately calculate the effect of correlations, in complex multi-input, multi-output propagation models, using the covariance matrix is highly convenient [17].

The covariance matrix is a semi-positive definite matrix. For a covariance matrix constructed for random variables, shown in Equation (1), the elements on the diagonal represent the variance of each random variable, and the off-diagonal elements represent the covariance of the corresponding random variables. Thus, the influence of correlations can be reflected by performing uncertainty propagation calculations as follows:(1) ∑=σ(x1,x1)……σ(xd,x1)……σ(x1,xd)……σ(xd,xd)d×d

Each element in Equation (1) can be determined by Equation (2); the covariance between the m-th and k-th random variables can be expressed as:(2) σxm,xk=1n−1∑i=1n(xmi−x¯m)(xki−x¯k)

Here, i represents the i-th measurement value of a random variable.

Suppose a random variable X of dimension m × 1 with a mean X0, and a functional relationship exists such that Y = f(X) between vector Y(n × 1) and X, where f is a continuously differentiable function near X0. Next, f (X) can be linearly approximated around X0 as given in Equation (3):(3) Y=fX≈fX0+J·X−X0+L,

where L represents the higher-order remainder term of the Taylor expansion. When analyzing specific problems, in most cases, the first-order expansion is sufficient, but sometimes checking whether the higher-order remainder term can be ignored (without affecting the overall result). Here, J is the Jacobian matrix, where each element represents the sensitivity coefficient for uncertainty propagation, calculated as follows:(4) Jij=∂Fi(X)∂xjx0=∂yi∂xjx0

Based on Equations (3) and (4), the covariance matrix relationship between random variables X and Y can be obtained as follows:(5) ∑Y=EY−Y0Y−Y0*≈EJX−X0JX−X0*≈J·∑X·J* .

The uncertainty covariance matrix of Y can be obtained using Equations (1)–(5). However, in many cases, the functional relationship between random variables is a complex implicit relationship that sometimes cannot be described using mathematical expressions. In such cases, numerical methods such as finite difference methods can be used to approximate the Jacobian matrix.

The combined uncertainty of measurement results includes Type A uncertainty and Type B uncertainty, as presented in Equation (6). For each measurement, a covariance matrix ∑Sk, is constructed to describe the Type B uncertainty of that measurement. After K measurements, a covariance matrix ∑r is constructed to describe the overall Type A uncertainty of K measurements.

With the increase in the number of measurements K, Type A uncertainty decreases, whereas Type B uncertainty remains unchanged, becoming the dominant component in the combined uncertainty as follows:(6) ∑U=1K∑k=1K(∑Sk)+1K∑r.

3. VNA Measurement Uncertainty Analysis

Calibration is necessary when measuring S-parameters with a VNA because of the presence of an error network between its measurement plane and the device under the test’s measurement plane. Calibration involves obtaining error model coefficients, which can be used to correct the directly measured results of the VNA and obtain accurate measurement results. Therefore, when analyzing the uncertainty of S-parameter measurements, the influence of the error model coefficients obtained through calibration on the final results should be considered, and the uncertainty of the error model coefficients can be traced back to the uncertainty of the calibration standards.

The process of measuring S-parameters with a VNA is a complex computational process, where uncertainty is progressively propagated according to the computational process, from the calibration standards to the error model coefficients and subsequently to the measured values of S-parameters. Figure 1 illustrates the flow of uncertainty propagation.

S-parameters are complex functions of frequency. When assessing the uncertainty of S-parameter measurements point by point, considering the correlation between frequency points and parameters as well as the stepwise propagation process, a covariance matrix can accurately describe this problem [10].

4. VNA Measurement Type B Uncertainty Assessment Process

4.1. Uncertainty Analysis of Calibration Standards

VNA calibration requires three calibration standards: short, open, and load. In two-port calibration, a thorough standard is also required. The manufacturer provides the corresponding nominal uncertainties for the calibration standards. Typically, the uncertainties of the short and open standards originate from phase errors, whereas the uncertainty of the load standard is given by the range of true values specified by the manager.

The corresponding error model coefficients can be obtained by analyzing the relationship between the measured values and the true values of the calibration standards before VNA correction. Ideally, the complex reflection coefficients of the three calibration standards are: Γshort=−1,Γopen=1,Γload=0. However, in practice, the true values of manufactured calibration standards deviate from the ideal values. A circuit model can be established based on their characteristics to calculate the true values.

For short-circuit calibration standards within hundreds of gigahertz, the values exhibit inductive characteristics. Their approximate circuit model is a frequency-dependent third-order curve fitting model:(7) Lf=L0+L1·f+L2·f2+L3·f3Γshort=j2πfLf−Z0j2πfLf+Z0e−j4πL/λ.

In Equation (7), L0−L3 represent the inductance parameter related to frequency, provided by the calibration device manufacturer. The specific parameters used in this paper are shown in Table 1 and Table 2, the specific parameters are provided by the calibration manufacturer. λ represents the wavelength of the electromagnetic wave, and f represents the frequency, Z0 represents the characteristic impedance value of the calibration standard, L represents the electrical length between the reference plane and the actual short circuit plane. Thus, the reflection coefficient at the reference plane is Γ0=e−4πLj/λ because of the existence of a length of transmission line between the real short circuit plane and the connection point with the VNA. Therefore, the complex reflection coefficient of the short circuit standard, Γshort can be expressed by Equation (7).

Similarly, open-circuit components exhibit capacitive characteristics, with their circuit model and complex reflection coefficient represented as follows:(8) Cf=C0+C1·f+C2·f2+C3·f3Γopen=1−j2πfCfZ01+j2πfCfZ0e−j4πL/λ.

The load component exhibits a resistance characteristic that is used to provide impedance matching within the measurement frequency band with the system. The performance of the component deteriorates with the increase in frequency, and the manufacturer provides the circuit loss of the load calibration component, typically in the range of several tens of dB, which can be used as the maximum uncertainty.

In dual-port calibration, a through calibration component is required, such as the most common short-load-open-through calibration, based on four fully known calibration components. Additionally, an unknown through calibration method can be used, adhering to the reciprocity condition S12 = S21 of the through calibration component in dual-port measurements. In this study, the method of unknown through calibration is used, and the uncertainty introduced by the through calibration component is ignored.

Because the S-parameters are complex, when assessing uncertainty, they should be divided into real and imaginary parts, rendering storage and computation easy. Typically, the nominal uncertainty of calibration components originates from phase; therefore, the nominal uncertainty of calibration components should be transferred to the uncertainty of their real and imaginary parts first. For nominal uncertainty, the correlation between various frequency points is not considered, and the covariance matrix of the nominal uncertainty of each calibration component is a diagonal matrix. Considering the open-circuit component as an example, the process of transferring the nominal uncertainty to the uncertainty of its real and imaginary parts is demonstrated. The relationship between real and imaginary parts given by Equation (9) and the calculation method of sensitivity coefficients to amplitude and phase are used to construct the required Jacobian matrix JΓo, as shown in Equation (10):(9) ReΓo=Γocos⁡ΦΓoImΓo=Γosin⁡ΦΓo∂ReΓo∂ΦΓ0=−ImΓo ∂ImΓo∂ΦΓo=ReΓo,

(10) JΓo=∂ReΓo∂ΦΓ0∂ImΓo∂ΦΓo=−ImΓoReΓo.

Such a Jacobian matrix exists at each frequency point. According to the uncertainty transfer process of Equation (5), the uncertainty covariance matrix of the real and imaginary parts of the open-circuit component can be obtained through Equation (11). In this matrix, the elements on the main diagonal are the squares of the uncertainties of the real and imaginary parts of the open-circuit component, and the off-diagonal elements are their covariance. (11) ∑Γo=JΓo∑ΦΓoJΓoT

Similarly, the covariance matrix of the short circuit component and the load component can be obtained. At each frequency point, the covariance matrices of the short-circuit, open-circuit, and load components are concatenated into a block diagonal matrix to obtain the overall covariance matrix of the calibration components.

4.2. Uncertainty Analysis of Error Models

4.2.1. Single-Port Measurement

The error model network used for single-port calibration consists of three error models [12] (Figure 2):

When conducting single-port measurements, the relationship between the reflection coefficient ΓDUT of the device under test (DUT) and its measured value ΓM is given by Equation (12), where e00,e11, and ∆e=e00e11–e01e10 represent the directional error, source match error, and frequency response error, respectively. Based on calibration-derived error model coefficients, a VNA can correct the raw measurement values of the device to obtain measurement results closer to the true values as follows:(12) ΓDUT=ΓM−e00ΓMe11−Δe

The calibration process follows Equation (12). During VNA calibration, the calibration kit type used is first selected, and the calibration process is similar to measuring the calibration kit with the VNA. By comparing the measured values of the calibration kit with their true values, the error model coefficients e00,e11, and ∆e are inversely solved to establish the functional relationship between the three types of calibration kits as follows:(13) e00=ΓOΓMOΓMSΓL−ΓMLΓS+ΓSΓMSΓMLΓO−ΓMOΓL+ΓLΓML(ΓMOΓO−ΓMSΓO)ΓOΓMOΓL−ΓS+ΓSΓMSΓO−ΓL+ΓLΓML(ΓS−ΓO) ;e11=ΓMOΓL−ΓS+ΓMSΓO−ΓL+ΓML(ΓS−ΓO)ΓOΓMOΓL−ΓS+ΓSΓMSΓO−ΓL+ΓLΓML(ΓS−ΓO) ;Δe=ΓOΓMOΓMS−ΓML+ΓSΓMSΓML−ΓMO+ΓLΓML(ΓMO−ΓMS)ΓOΓMOΓL−ΓS+ΓSΓMSΓO−ΓL+ΓLΓML(ΓS−ΓO) .

In Equation (13), ΓO,ΓL,ΓS are the true values of the calibration kits obtained through calculation and ΓMO,ΓML,ΓMS are the measured values of the calibration kits obtained from pre-calibration VNA measurements. Based on this functional relationship and Equation (4), the Jacobian matrix JE3 is constructed by taking the partial derivatives of the true values of the calibration standards with respect to each error model coefficient:(14) JE3=∂re(e00)∂re(ΓS)∂im(e00)∂re(ΓS)……∂im(Δe)∂re(ΓS)……∂re(e00)∂im(ΓL)∂im(e00)∂im(ΓL)……∂im(Δe)∂im(ΓL)6×6

(15) ∑E3=JE3 ∗ diag∑ΓS,ΓO,ΓL∗JE3′

(16) ∑E3=∑re(e00)covree00,ime00……cov(ree00,im∆e)……cov(im∆e,ree00)cov(im∆e,ime00)……∑(im(∆e))6×6

Uncertainties can be propagated to the three-error models using Equations (14) and (15). Similarly, based on Equation (12), the Jacobian matrix JS11 of the measurement of the S11 parameter with respect to the three-error model coefficients can be constructed as follows:(17) JS11=∂reS11∂ree00 ∂imS11∂ree00……∂reS11∂imΔe ∂imS11∂imΔe2×6;

(18) ∑S11=JS11∗∑E3∗JS11′

(19) ∑S11=∑reS11cov(reS11,imS11)cov(imS11,reS11)∑im(S11)

Through Equations (17) and (18), the covariance matrix ∑S11 of S11 can be obtained, as presented in Equation (19). This matrix determines the uncertainty of S11, which can then be propagated to other RF parameters.

4.2.2. Two-Port Measurement

Although single-port measurements have a simple model, they are seldom used in practice because they can only measure S11 parameters. Most measurements are double-port measurements, but they are based on the foundation of the single-port three-term error model. In the commonly used calibration methods, the 8- or 12-term error models [7], as shown in Figure 3 and Figure 4, are used:

The dual-port 8-term error model can be simplified to seven terms by setting e32 to 1; that is, first performing single-port calibration on each of the two single ports to obtain two 3-term error models, and subsequently performing thorough calibration to obtain the seventh term error model e01/e32, as presented in Equation (20). Among the four S-parameters, S11 and S22 are obtained by single-port measurements at ports A and B, respectively, relying only on two independent 3-term error models, namely S12 and S21, depending on the full 7-term error model. (20) e01e32=S12M(e00e11−∆e)S21M(e33e22−∆e′).

According to Equation (20), the coefficient of the seventh error model term is related to the coefficients of the previous six-error model terms, as well as to the forward and reverse transmission coefficients of the through a standard. When calibrating the unknown through standard, Equation (20) can be simplified using S12 = S21.

When constructing the Jacobian matrix for the 8-error model, because of the involvement of the collaborative transfer of e01/e32 and the two 3-error models, a Jacobian matrix should be first constructed to transfer the uncertainties from the coefficients of the first 6-error models (correlation between the three-error models for each port can be ignored) to e01/e32, and subsequently, synthesize the covariance matrix ∑E714×14, containing seven-error model coefficients. The Jacobian matrix used for collaborative transfer cannot be expressed in a single mathematical expression. Referring to Equation (14), using two Jacobian matrices is critical to separately calculate the covariance matrix and then concatenate them by blocks.

Because four S-parameters exist in dual-port measurements, storing them in the same covariance matrix facilitates the observation of their correlations. Similar to the method in Section 4.2.1, the Jacobian matrix Equation (21) should be constructed to obtain the covariance matrix ∑S8×8 of S-parameters measurements for dual-port through Equation (22). In this matrix, the primary diagonal stores the uncertainties squared of the real and imaginary parts of S11, S12, S21, and S22, respectively, whereas the off-diagonal elements preserve the correlations between S-parameters. (21) JS7=∂reS11∂ree00 ∂imS11∂ree00……∂imS22∂ree00……∂reS11∂ime01/e32 ∂imS11∂ime01/e32……∂imS22∂ime01/e328×14

(22) ∑S=JS7∗∑E7∗JS7′

In Equation (21), because the parameters S11 and S22 are independent of the seventh error term model e01/e32, the elements such as ∂reS11∂ree01/e32 have a value of 0. However, the parameters S12 and S21 are related to e01/e32.

As displayed in Figure 4, the 12-term error model is the most commonly used short-load-open-through dual-port calibration method, which involves forward and reverse measurements. For instance, the forward measurement includes directional error e00, source match error e11, reflection trace error e10·e01, transmission trace error e10·e32, load match error e22, and crosstalk error e30. The calibration process similarly starts with single-port calibration for each measurement port separately, obtaining directional error, source match error, and transmission trace error, totaling six terms. Next, a thorough calibration is performed to obtain the remaining error model. Typically, crosstalk error e03′ and e30 can be omitted, and the complete 12-term error model is seldom used, simplifying it to 10 terms.

Based on the signal flow graph, the relationship between the measured S-parameter results according to Equation (23) and the error model coefficients can be obtained as follows [11,18]:(23) S11M=e00+e10e01S11−e22ΔS1−e11S11−e22S22+e11e22ΔSS12M=e03′+e01′e23′S121−e11′S11−e22′S22+e11′e22′ΔSS21M=e30+e10e32S211−e11S11−e22S22+e11e22ΔSS22M=e33′+e32′e23′S22−e11′ΔS1−e11′S11−−e22′S22+e11′e22′ΔS 

In Equation (23), S11M–S22M represent the measured values of the device before calibration with the VNA, whereas S11–S22 represent the true values of the device’s S-parameters. Here, ΔS=S11·S22−S12·S21 is similar to the process of the 8-term error model. For obtaining the covariance matrix of the 12-term error model, first, the covariance matrix of some error model coefficients should be obtained. These coefficients should be transmitted to other error model coefficients. This can construct the covariance matrix ∑E1020×20 of the error model coefficients.

By simultaneously solving Equation (23), a system of equations can be solved to obtain the relationship between four S-parameters and their pre-calibration measured values and error model coefficients, as presented in Equation (24). When transmitting the covariance matrix of the error model ∑E10 to the covariance matrix of the S-parameters, the Jacobian matrix JS108×20 is constructed according to the following Equation and subsequently transmitted to the covariance matrix of the S-parameters. The process is similar to Equations (21) and (22) and is not elaborated here. (24) S11=(S11M−e00e10e011+e22′S22M−e33′e32′e23′−e22S21M−e30e10e32S12M−e03′e01′e23′)/KS12=(S12M−e03′e01′e23′1+e11−e11′S11M−e00e10e01)/K S21=(S21M−e30e10e321+(e22′−e22S22M−e33′e32′e23′))/KS22=(S22M−e33′e32′e23′1+e11S11M−e00e10e01−e11′S21M−e30e10e32S12M−e03′e01′e23′)/K

Here, K=1+e11S11M−e00e10e011+e22′S22M−e33′e32′e23′−e22e11′S21M−e30e10e32S12M−e03′e01′e23′.

5. Assessment of Uncertainty of S-Parameters of Grounded Coplanar Waveguide

5.1. Construction of the Measurement System

In this study, a measurement system was developed for measuring the S-parameters of a grounded coplanar waveguide (GCPW) by using a VNA. The Agilent E8361 VNA was used with its accompanying calibration kit, 85058B, the equipment is all manufactured by Keysight(USA, California). The calibration kit includes SHORT1, OPEN, LB LOAD, and THROUGH (FEMALE). The measurement bandwidth of the VNA was from DC to 67 GHz, and the calibration kit was universal for the frequency band. Other cables and adapters used are disregarded when evaluating uncertainty. Figure 5 and Figure 6 display the physical setup for the measurement.

Table 1 and Table 2 display their nominal uncertainties and related circuit parameters [19,20].

The proposed algorithm sets the input uncertainties for open and short calibration standards based on Table 1, using the return loss of the load standard as the maximum uncertainty in Table 1. The uncertainties and various parameters in the table are provided by the calibration manufacturer. The nominal uncertainty represents the maximum uncertainty of the calibration within this frequency range. In specific experiments, to ensure that the uncertainty deviation of the calibration standards remains within the nominal uncertainty range, the calibration standards should be periodically inspected to ensure reliability. Under favorable conditions, conducting uncertainty assessments on the three calibration standards prior to measurement could yield accurate results.

The measured GCPW developed independently in the laboratory [21] with a supported-layer, three-row via array had an effective bandwidth of approximately 60 GHz. Although its performance slightly diminishes in the high-frequency range, it does not affect the uncertainty assessment method. Figure 7 depicts the physical representation, and Figure 8 displays the S-parameter measurement results.

In practice, the measurements of three calibration standards are initially conducted without calibration, obtaining the measurement values of the calibration standards. Subsequently, GCPW measurements are performed to yield measurement values for the first four S-parameters before calibration. Next, calibration is performed on the VNA, selecting appropriate calibration standards and error models. On completion of calibration, error model data are extracted from the VNA. Finally, the calibrated VNA was used to measure the GCPW to achieve actual measurement values for the four S-parameters. The experiment sets the initial frequency at 10 MHz, with uniform sampling up to a cutoff frequency of 67 GHz, comprising 1000 frequency points.

In this study, the same calibration standards and VNA are used to measure the GCPW (Figure 7). VNA is calibrated using both 8- and 12-term error models, and a comparison of the uncertainty assessment results is conducted and analyzed.

The method of evaluating uncertainty using the covariance matrix involves multiple iterations, and its complex calculations are time-consuming. The computation can be simplified using the Cauchy–Riemann equations [22] during the complex differentiation stage. For example, the sensitivity coefficient of parameter S11 to the error model coefficient e00 is as follows:(25) ∂re(S11)∂re(e00)=∂im(S11)∂im(e00)∂re(S11)∂im(e00)=−∂im(S11)∂re(e00)

The operations required for constructing the Jacobian matrix can be halved, as presented in Equation (25).

5.2. Uncertainty Assessment Results Analysis

Figure 9 and Figure 10 display the Type B uncertainty of measuring S12 and S21 parameters during the calibration of 12- and 8-term error models. Because of computational complexity, in evaluating Type B uncertainty, the data collected by VNA are resampled at evenly spaced intervals, totaling 200 frequency points. In engineering applications, it is generally accepted that measurement results are considered reliable if the uncertainty is below 10%. The figures reveal that, with the exception of 3–5 outliers among the 200 frequency points, the measurement results at most frequency points were reliable, even if they were lower than 10%. Some outliers had significantly large uncertainty, possibly because of very small measured values at those frequency points. Most outliers occurred in frequency ranges beyond 50 GHz, which was related to the bandwidths of both VNA and GCPW nearing measurement limits, resulting in performance degradation. Additionally, the uncertainty of calibration standards increases with frequency, which may have influenced measurement results. Furthermore, in S12 and S21, outliers typically occurred at the same frequency points.

Figure 11 and Figure 12 display the uncertainty of measuring S11 and S22 during the calibration of 12- and 8-term error models, respectively. The uncertainty of reflection coefficients was greater than transmission coefficients, with slightly more outliers because the linear measurement values of reflection coefficients were smaller, rendering them more sensitive to error models and calibration standards. Most outliers were distributed in higher frequency ranges, but some outliers occurred near 40 GHz. Similar outliers were observed in the assessment of Type A uncertainty (as displayed in Figure 13) in the same frequency range, indicating possible performance problems with the GCPW at that point. Comparing the measurement results of the two error model calibrations revealed that the results of the 12-term error model calibration were slightly better than those of the 8-error model. This phenomenon could be attributed to the 12-term error model, which has both forward and reverse error networks, partially compensating for measurement errors at the port of the 8-term error model. However, generally, the two models do not differ considerably.

When measuring with a VNA calibrated by either an 8- or a 12-term error model, the measurement performance is generally reliable across most usable VNA frequency bands. However, performance degraded near the upper bandwidth limit frequencies of the instrument and the DUT. Because of the different principles of calibration between the 8- and 12-term error models, performance differs considerably when using the same VNA and calibration standards to measure the same GCPW, which leads to slightly different uncertainty.

In subsequent studies on the uncertainty assessment of practical situations, the accuracy of the measurement results and the computational complexity of uncertainty assessment should be considered. Compared with the assessment of uncertainty using an 8-term error model, the calculation is considerably more complex and time-consuming for a 12-term error model.

Compared with Type B uncertainty, assessing Type A uncertainty is simple. In this study, after calibrating the VNA with a 12-term error model, 10 measurements were conducted on GCPW, considering the data of each measurement a 1000-dimensional random variable. Based on Equation (2), the covariance matrix of the random uncertainty can be constructed. Considering the real parts of S11 and S12 as examples, as displayed in Figure 13, with the exception of the high-frequency range, several points near the 40 GHz frequency exhibit variances reaching the magnitude of 10−3, which considerably exceeds the normal range, indicating anomalous data. However, the measurement results at most frequency points satisfy the requirements. The solution of the covariance matrix for Type A uncertainty is simple, and only a few assessment results for Type A uncertainty are provided here.

After evaluating the uncertainty of Type A and Type B for the four parameters separately, the combined uncertainty can be obtained according to Equation (6), as presented in Figure 14 and Figure 15. The distribution of outliers for parameter S11 was scattered, resulting in a larger relative uncertainty. The maximum outlier for the real part of parameter S12 in combined uncertainty occurred at 40 GHz. Compared with Figure 9 and Figure 13, at this frequency point, both Type A and Type B uncertainty were considerably larger than normal values. Compared with Figure 9, the combined uncertainty included the average calculation of Type B uncertainty from multiple measurements. The uncertainty around 40 GHz near the outlier reduced considerably, which could indicate an anomaly at this frequency point in the measurement depicted in Figure 9, causing both Type A and Type B uncertainty to be abnormal. This phenomenon could be gradually eliminated by increasing the number of measurements to mitigate the effect of random errors in individual measurements.

This study simplified intermediate-step calculations by dividing S-parameters into real and imaginary parts for uncertainty assessment. Alternatively, uncertainty can be propagated back to the amplitude and phase of S-parameters according to Equation (9), as depicted in Figure 16, to represent the combined uncertainty of the amplitude and phase of the S11 parameter. Apart from a few isolated outliers, the curve matches the original measurement values accurately. At approximately 40 GHz, where outlier frequencies occur, the relative uncertainty of the phase exceeds 20%. Compared with the uncertainty results of the real and imaginary parts, the relative uncertainties of amplitude and phase are smaller, generally between 15% and 25%, because in S-parameters, the real part is smaller than the imaginary part (or vice versa). Even if its relative uncertainty is large, then the influence of the real part on the overall amplitude and phase of the S-parameter is small.

6. Conclusions

When assessing the uncertainty of S-parameter measurements with a VNA, both Type B and Type A uncertainty should be considered simultaneously. Evaluating Type B uncertainty is more challenging than evaluating Type A uncertainty. Thus, in this study, we first analyzed the sources and propagation process of S-parameter uncertainty during VNA measurements. Uncertainty is stepwise propagated to the S-parameter measurement results through the Jacobian matrix. Uncertainty in the S-parameter measurements of GCPW is evaluated for 8- and 12-error models. Most Type B uncertainty is concentrated in the high-frequency range, possibly because of performance deficiencies in the self-developed GCPW. However, evaluation results for other frequency ranges are satisfactory. Several anomalies in Type A uncertainty for the 12-error model appeared near 40 GHz, whereas measurement results at other frequency points are normal. Type B uncertainty dominated the combined uncertainty, and averaging multiple measurements reduced the effect of individual measurement anomalies. Experimental results demonstrated the applicability of the proposed method for assessing the uncertainty of S-parameters.

Author Contributions

Conceptualization, J.Z., Y.W. (Yifan Wang), K.Z. and Y.W. (Yidi Wang); methodology, J.Z. and Y.W. (Yifan Wang); software, Y.W. (Yifan Wang); validation, J.Z., Y.W. (Yifan Wang) and C.F.; formal analysis, J.Z.; investigation, Y.W. (Yifan Wang), Y.W. (Yidi Wang), C.F. and K.M.; resources, K.Z.; data curation, Y.W. (Yifan Wang) and C.F.; writing—original draft preparation, J.Z. and Y.W. (Yifan Wang); writing—review and editing, J.Z. and Y.W. (Yifan Wang); visualization, Y.W. (Yifan Wang), Y.W. (Yidi Wang) and K.M.; supervision, J.Z.; project administration, J.Z. and K.Z.; funding acquisition, J.Z. and K.Z. All authors have read and agreed to the published version of the manuscript.

Institutional Review Board Statement

Not applicable.

Informed Consent Statement

Not applicable.

Data Availability Statement

Data underlying the results presented in this paper are not publicly available at this time but may be obtained from the authors upon reasonable request.

Conflicts of Interest

The authors declare no conflicts of interest.

Figure 1 Flowchart of uncertainty propagation in VNA measurement of S-parameters.

Figure 2 Schematic of the three-error model for single-port measurements.

Figure 3 Schematic of the eight-error model for two-port measurements.

Figure 4 Schematic of a 12-term error model for dual-port measurement.

Figure 5 VNA E8361 was used in this study.

Figure 6 Calibration kit 80858B was used in this study.

Figure 7 Grounded coplanar waveguide (GCPW) with three-row via array and supported layer.

Figure 8 S-parameter measurement results of the GCPW.

Figure 9 Uncertainty of real and imaginary parts of S12 and S21 in the 12-term error model calibration.

Figure 10 Uncertainty of real and imaginary parts of S12 and S21 in the 8-term error model calibration.

Figure 11 Uncertainty plots of real and imaginary parts of S11 and S22 using a 12-term error model.

Figure 12 Uncertainty plots of real and imaginary parts of S11 and S22 using an 8-term error model.

Figure 13 (a) Covariance matrix of Type A uncertainties for the real parts of S11; (b) Covariance matrix of Type A uncertainties for the real parts of S12.

Figure 14 Combined uncertainty of the real and imaginary parts of S11.

Figure 15 Combined uncertainty of the real and imaginary parts of S12.

Figure 16 (a) Uncertainty superposition of the S11 phase; (b) uncertainty superposition of the S11 amplitude.

sensors-24-03668-t001_Table 1 Table 1 Nominal Uncertainty (Return Loss) of Short-Circuit, Open-Circuit, and Matched Load Components.

Bandwidth	Short-Uncertainty	Open-Uncertainty	Load-Return Loss	
DC~10 GHz	1.5°	2.5°	35 dB	
10 GHz~20 GHz	1.5°	3.5°	34 dB	
20 GHz~30 GHz	2.0°	3.5°	29 dB	
30 GHz~35 GHz	2.5°	3.5°	29 dB	
35 GHz~40 GHz	2.5°	3.5°	12 dB	
40 GHz~50 GHz	3.5°	3.5°	12 dB	
50 GHz~60 GHz	4.0°	5.0°	12 dB	
60 GHz~67 GHz	4.0°	5.0°	10 dB	

sensors-24-03668-t002_Table 2 Table 2 Short-Circuit and Open-Circuit Component Circuit Parameters.

Parameters	Short-Parameters	Open-Parameters	
L0/C0	1.4957 (10−12H)	−3.5342 (10−15F)	
L1/C1	−323.18 (10−24H/Hz)	425.24 (10−27F/Hz)	
L2/C2	11.624 (10−33H/Hz2)	−13.946 (10−36F/Hz2)	
L3/C3	−0.10939 (10−42H/Hz3)	0.12741 (10−45F/Hz3)	
Z0	50 (Ω)	50 (Ω)	

Disclaimer/Publisher’s Note: The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.
==== Refs
References

1. Ramnath V. Determining the covariance matrix for a nonlinear implicit multivariate measurement equation uncertainty analysis Int. J. Metrol. Qual. Eng. 2022 13 9 10.1051/ijmqe/2022008
2. BIPM IEC IFCC ILAC ISO IUPAC IUPAP OIML Evaluation of measurement data—Supplement 1 to the Guide to the expression of uncertainty in measurement—Propagation of distributions using a Monte Carlo method JCGM 2011 101 2008
3. Hall B.D. Expanded uncertainty regions for complex quantities in polar coordinates Metrologia 2015 52 486 10.1088/0026-1394/52/4/486
4. Hall B.D. Evaluating the measurement uncertainty of complex quantities: A selective review Metrologia 2016 53 S25 10.1088/0026-1394/53/1/S25
5. Hall B.D. Calculations of measurement uncertainty in complex-valued quantities involving ‘uncertainty in the uncertainty’ Proceedings of the 64th ARFTG Microwave Measurements Conference, Fall 2004 Orlando, FL, USA 2–3 December 2004 10.1109/ARFTGF.2004.1427565
6. Hall B.D. On the propagation of uncertainty in complex-valued quantities Metrologia 2004 41 173 177 10.1088/0026-1394/41/3/010
7. Hou Z. Huang D. Tong L. 8 Error Module of Vector Network Analyzer and Calibrating Theory Chin. J. Sci. Instrum. 2004 25 764 766
8. Mubarak F.A. Mascolo V. Hussain F. Rietveld G. Calculating-Parameters and Uncertainties of Coaxial Air-Dielectric Transmission Lines IEEE Trans. Instrum. Meas. 2024 73 8000511 10.1109/tim.2023.3338667
9. Zhang Y. Qi X. Lin M. Research on the propagation law and analysis method of uncertainty in VNA/NVNA/LSNA measurement based on covariance matrix J. Instrum. 2012 33 8 10.3969/j.issn.0254-3087.2012.11.014
10. Ridler N.M. Salter M.J. Propagating S-parameter uncertainties to other measurement quantities Proceedings of the 58th ARFTG Conference Digest San Diego, CA, USA 29–30 November 2001 10.1109/ARFTG.2001.327487
11. Wang M. Zhao Y.J. Jin Y.M. Zhou Y.G. Sensitivity analysis of multiport S-parameter measurements due to nonideal TRL calibration standards Radio Sci. 2017 52 1096 1105 10.1002/2017rs006380
12. Jin Y. Wang M. Zhao Y. Zhou Y. The influence of non ideal calibration components on the measurement results of S-parameters J. Microw. Sci. 2017 33 4 10.14183/j.cnki.1005-6122.201701018
13. Williams D. Lewandowski A. Clement T. Wang J. Hale P. Morgan J. Keenan D. Dienstfrey A. Covariance-based uncertainty analysis of the NIST electrooptic sampling system IEEE Trans. Microw. Theory Tech. 2006 54 481 491 10.1109/tmtt.2005.860492
14. Williams D.F. Hale P.D. Clement T.S. Morgan J.M. Mismatch Corrections for Electro-Optic Sampling Systems Proceedings of the 56th ARFTG Conference Digest Boulder, AZ, USA 30 November–1 December 2000 10.1109/ARFTG.2000.327447
15. Hale P.D. Dienstfrey A. Wang J.C.M. Williams D.F. Lewandowski A. Keenan D.A. Clement T.S. Traceable Waveform Calibration With a Covariance-Based Uncertainty Analysis IEEE Trans. Instrum. Meas. 2009 58 3554 3568 10.1109/tim.2009.2018012
16. Hale P.D. Wang C.M.J. Calculation of Pulse Parameters and Propagation of Uncertainty IEEE Trans. Instrum. Meas. 2009 58 639 648 10.1109/tim.2008.2005560
17. Dubois C. Leblond L. Pou J.-M. Ferrero A. Covariance Evaluation by Means of Uncertainty Assessment IEEE Instrum. Meas. Mag. 2018 21 13 10.1109/MIM.2016.7777646
18. Huang H. Liu X. Lv X. Monte-Carlo analysis of measurement uncertainties for on-wafer Short-Open-Load-Reciprocal calibrations Proceedings of the Asia-Pacific Microwave Conference 2011 Melbourne, VIC, Australia 5–8 December 2011
19. Keysight Technologies 85058B/E 1.85 mm Calibration Kits Available online: https://www.keysight.com.cn/cn/zh/support/85058B/standard-mechanical-calibration-kit-dc-67-ghz-1-85-mm.html (accessed on 6 March 2024)
20. Keysight Vector Network Analyzer Calibration Kit Standards Definitions Available online: https://www.keysight.com.cn/cn/zh/support/85058B/standard-mechanical-calibration-kit-dc-67-ghz-1-85-mm.html (accessed on 6 March 2024)
21. Zhu J. Wan Z. Zhao K. Method to Change the Through-Hole Structure to Broaden Grounded Coplanar Waveguide Bandwidth Sensors 2023 23 4342 10.3390/s23094342 37177548
22. Tong L. Zhang Y. Wu Z. Gou Y. Lin M. Covariance matrix analysis of VNA uncertainty propagation and its application in power meter calibration New Ind. 2012 12 1 11 10.1109/CPEM.2012.6250683
