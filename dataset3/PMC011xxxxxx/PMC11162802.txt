
==== Front
Nucleic Acids Res
Nucleic Acids Res
nar
Nucleic Acids Research
0305-1048
1362-4962
Oxford University Press

38686794
10.1093/nar/gkae314
gkae314
AcademicSubjects/SCI00010
Computational Biology
BGCFlow: systematic pangenome workflow for the analysis of biosynthetic gene clusters across large genomic datasets
https://orcid.org/0000-0003-3177-8299
Nuhamunada Matin The Novo Nordisk Foundation Center for Biosustainability, Technical University of Denmark, Kongens Lyngby 2800, Denmark

https://orcid.org/0000-0002-3240-1656
Mohite Omkar S The Novo Nordisk Foundation Center for Biosustainability, Technical University of Denmark, Kongens Lyngby 2800, Denmark

https://orcid.org/0000-0002-4122-6589
Phaneuf Patrick V The Novo Nordisk Foundation Center for Biosustainability, Technical University of Denmark, Kongens Lyngby 2800, Denmark

https://orcid.org/0000-0003-2357-6785
Palsson Bernhard O The Novo Nordisk Foundation Center for Biosustainability, Technical University of Denmark, Kongens Lyngby 2800, Denmark
Department of Bioengineering, University of California San Diego, La Jolla, CA 92093, USA

https://orcid.org/0000-0002-8260-5120
Weber Tilmann The Novo Nordisk Foundation Center for Biosustainability, Technical University of Denmark, Kongens Lyngby 2800, Denmark

To whom correspondence should be addressed. Tel: +45 24896132; Email: tiwe@biosustain.dtu.dk
Correspondence may also be addressed to Bernhard O. Palsson. Tel: +1 858 822 1144; Fax: +1 858 822 3120; Email: palsson@eng.ucsd.edu
The first two authors should be regarded as Joint First Authors.

10 6 2024
30 4 2024
30 4 2024
52 10 54785495
11 4 2024
22 3 2024
29 6 2023
© The Author(s) 2024. Published by Oxford University Press on behalf of Nucleic Acids Research.
2024
https://creativecommons.org/licenses/by/4.0/ This is an Open Access article distributed under the terms of the Creative Commons Attribution License (https://creativecommons.org/licenses/by/4.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

Abstract

Genome mining is revolutionizing natural products discovery efforts. The rapid increase in available genomes demands comprehensive computational platforms to effectively extract biosynthetic knowledge encoded across bacterial pangenomes. Here, we present BGCFlow, a novel systematic workflow integrating analytics for large-scale genome mining of bacterial pangenomes. BGCFlow incorporates several genome analytics and mining tools grouped into five common stages of analysis such as: (i) data selection, (ii) functional annotation, (iii) phylogenetic analysis, (iv) genome mining, and (v) comparative analysis. Furthermore, BGCFlow provides easy configuration of different projects, parallel distribution, scheduled job monitoring, an interactive database to visualize tables, exploratory Jupyter Notebooks, and customized reports. Here, we demonstrate the application of BGCFlow by investigating the phylogenetic distribution of various biosynthetic gene clusters detected across 42 genomes of the Saccharopolyspora genus, known to produce industrially important secondary/specialized metabolites. The BGCFlow-guided analysis predicted more accurate dereplication of BGCs and guided the targeted comparative analysis of selected RiPPs. The scalable, interoperable, adaptable, re-entrant, and reproducible nature of the BGCFlow will provide an effective novel way to extract the biosynthetic knowledge from the ever-growing genomic datasets of biotechnologically relevant bacterial species.

Graphical Abstract

Graphical Abstract

Novo Nordisk Foundation 10.13039/501100009708 NNF20CC0035580 NNF16OC0021746 Danish National Research Foundation 10.13039/501100001732 CeMiSt DNRF137 Novo Nordisk Foundation Copenhagen Bioscience PhD program NNF20SA0035588
==== Body
pmcIntroduction

The number of available genome sequences in public databases has exponentially increased for most bacterial species over the last decade (1). These datasets are becoming crucial for extracting functional knowledge from the diversity found across species pangenomes, the totality of genes found in available genomes of a species (2,3). Previous pangenome studies have discovered many biological features common across a particular species, with the first study appearing in 2013 and subsequently, specific associated traits to phylogenetic groups within species (4–6). Pangenome analysis has now reached the phylogenetic tree scale (3,4).

Several pangenome analyses include the investigation of biosynthetic gene clusters (BGCs) involved in producing important natural products or secondary metabolites (7–9). Many known secondary metabolites, which also are referred to as specialized metabolites, have bioactive properties, including antibiotic, antifungal, anticancer, insecticide, food preservatives, and biocontrol, with significant applications in medicinal, agriculture, and food biotechnology (10–12). Advances in genome mining have shown that most bacteria have significant genomic potential that may lead to the discovery of novel specialized/secondary metabolites with diverse bioactivities (13,14).

This biosynthetic potential varies within and across the species, as demonstrated in prior large-scale genome mining studies (7,15–20). The pangenome-wide BGC comparisons guide the selection of particular BGCs or strains for further characterization. Several genome mining tools and databases like antiSMASH (21,22), antiSMASH-DB (23), MIBiG (24), ARTS (25), BiG-SCAPE (26), BiG-SLICE (27), BiG-FAM (28) among others are routinely used to predict, search, and comprehensively analyze BGCs. However, each of these tools remains limited based on its scope and the parameters used for accurate predictions of BGC functions or similarity across BGCs. Thus, the integration of various phylogenomic, genome mining, and comparative genomics tools is becoming a central part of investigating secondary metabolite potential and their evolutionary relations across different bacterial genome datasets.

The growth in genome mining tools and available resources poses a strong need for a standardized platform that allows reproducible analyses and easy interoperability of the inputs and outputs required by each genome mining and analysis tool (13). Advances in data science workflows have been transformational in processing sequence data, running standard analytics pipelines, and readily accessing processed output reports (29,30). For example, different workflow management systems such as Snakemake (31), Nextflow (32), Cromwell (33) and others can assist in job scheduling, logging, and reporting of the key outputs (34). Further, these automated workflow managers can play a critical role in organizing the key results and data in a findable, accessible, interoperable, and reproducible (FAIR) manner assisting researchers in extracting the knowledge from the bacterial genomes efficiently (35). Recently, workflow management systems were applied to efficiently run genome assembly, annotation, or pangenome analysis pipelines (29,36–38). However, end-to-end large-scale investigation studies for secondary metabolite biosynthetic potential still require significant domain expertise.

Here, we introduce BGCflow, a versatile Snakemake workflow aimed to aid large-scale genome mining studies to comprehensively analyze the secondary metabolite potential of selected bacterial species. BGCflow integrates various genome analytics tools for organizing sample metadata, data selection, functional annotation, genome mining, phylogenetic placement, and comparative genomics. In particular, BGCFlow provides customizable, easy-to-interpret reports, visualizations, and an analytical database for downstream exploratory analysis. Further, we demonstrate the utility of BGCFlow by analyzing publicly available genomes in the genus Saccharopolyspora, a rare actinomycete known to be distributed across diverse habitats producing industrially high-value natural products like spinosyns, erythromycins, and others. We show that the BGCFlow-guided interoperable knowledge from different tools and databases can help in the targeted discovery of novel BGCs and more accurate functional clustering of BGCs.

Materials and methods

Installing and running BGCFlow using the BGCFlow wrapper

BGCFlow software environment consists of three components: (i) a snakemake workflow (https://github.com/NBChub/bgcflow), (ii) a dbt pipeline for extraction of tabular data (https://github.com/NBChub/bgcflow_dbt-duckdb) and (iii) a python command line interface called bgcflow_wrapper (https://github.com/NBChub/bgcflow_wrapper). The wrapper can be installed using PIP directly from the Python Package Index (PyPI) (pip install bgfcflow_wrapper), and has the command lines to access all of the features in BGCFlow. The BGCFlow WIKI (https://github.com/NBChub/bgcflow/wiki) contains information and documentation on installing, configuring, and running BGCFlow.

Design of the Snakemake rules for external software

As part of the Snakemake workflow, several external computational tools were selected for different stages of the analysis. In the first step, the installation guide from the individual software's repository was followed to create a conda-based environment using yaml files stored in the workflow/envs/ directory. The version of all dependencies and the main software can be changed in these environment files. For a few cases, additional rules were created for the installation, which typically involved downloading additional resources and databases. These additional resources are stored in the resources directory, and users can also provide the pre-downloaded resource directories in the main configuration yaml file. A typical script for the Snakemake rule includes paths to the conda environment, inputs and outputs of the software in the interim directory, along with the required parameters of the command line.

Customized Snakemake rules data wrangling

To seamlessly run various software included in BGCFlow, many customized rules were generated that make sure the formatting of input and output files were interoperable (Supplementary Table S2). Such data wrangling typically included rules that prepare the input formatting and process the outputs in tabular interoperable format stored in the processed directory of each project. These data-wrangling rules involved running custom Python scripts from the bgcflow Python package directory. Many of the customized rules also involved additional downstream analysis of visualizing data. On top of the main Snakemake workflow, BGCFlow also includes several sub-workflows for in depth analysis such as BGC centric comparison, evolutionary and population genetic analysis with lsaBGC (39), and other utility functions as described in Supplementary Table S3.

Visualizing Jupyter Notebook reports

Each of the major rules is supported with a templated Jupyter Notebook for exploratory analysis of the results. These templated notebooks can be run with the bgcflow build report command, which copies the template notebook from the workflow/notebooks directory to the processed directory of each project. These template notebooks are meant to be a starting point for exploratory analysis and thus can be edited and expanded for each project. The notebooks are then converted to MkDocs reports corresponding to each rule, which can be served as interactive web server using the command bgcflow serve –project. The online server provides navigation of the interactive reports for each rule. The reports are also connected to the main results and tables, providing options for downloads for downstream exploration. For example, the rules for antiSMASH, BiG-SCAPE, and BiG-SLICE provide links to HTML reports provided by these individual tools.

Exporting results tables in OLAP database

Once the BGCFlow run is complete, all tables from various pipelines are stored as Apache Parquet files for efficient data storage. The command bgcflow build database enables the ability to extract, load, and transform the data into SQL databases through the use of Data Build Tools (dbt). Here, a set of SQL schemas are generated to easily interconnect BGC and genome information with other analysis and metadata for data queries (Supplementary Figure S4). By default, BGCFlow utilizes DuckDB, an embedded Online Analytical Processing (OLAP) database management system. Users can create additional data models and use other database management systems by modifying dbt profiles (https://github.com/NBChub/bgcflow_dbt-duckdb). For an interactive exploration of the database, the command bgcflow serve –metabase will start up a Metabase server, a popular business intelligence and visualization tool. The resulting database can then be synchronized to Metabase using the command bgcflow sync.

Genome mining and comparative analysis of Saccharopolyspora BGCs

This study incorporates several BGCFlow projects, defined in the PEP formats (available at Zenodo: https://doi.org/10.5281/zenodo.8018055) as follows:

PEP definition for all quality Saccharopolospora genomes

We searched for the Saccharopolyspora genus at NCBI RefSeq with filters to include all assembly levels of the complete genome, chromosome, scaffold, and contig on 25 October 2022, resulting in the list of 42 accession IDs. The sample table with these 42 accession IDs was provided in the PEP configuration initiated with the project name qc_saccharopolyspora, which aimed to carry out the quality check and taxonomic placement (Data S1). The selected BGCFlow rules for this first example PEP included: checkm, gtdbtk, seqfu, and mash. The results of the run were investigated using the Jupyter Notebooks for each rule provided in the directory data/processed/qc_saccharopolyspora/docs/ and visualized with reports using bgcflow serve –project qc_saccharopolyspora command. Based on the assembly quality, the genomes were categorized into three groups: (i) HQ (high-quality genomes of complete genome or chromosome level assembly as defined by NCBI RefSeq), (ii) MQ (medium-quality genomes with <50 contigs, N50 score higher than 100 kb) and (iii) LQ (remaining low-quality genomes) (Supplementary Figure S6, Figure 3a). The generated GTDB taxonomy definitions were used for the downstream analysis. The MASH-distance calculation was used to group 42 genomes in 7 different clusters of genomes called phylogroups in this study.

PEP definition for medium to high-quality Saccharopolospora genomes

To demonstrate full-scale BGCFlow application, we selected 26 genomes from HQ and MQ categories as defined above in the second PEP configuration initiated with the project name mq_saccharopolyspora (Data S2). For the BGCFlow run of this PEP, 19 out of the 20 available rules were selected for analysis. The results of each rule are analyzed using the custom Jupyter Notebooks stored in the directory data/processed/mq_saccharopolyspora/docs. The autoMLST-based phylogenetic tree of all 26 genomes was used for downstream investigation including phylogenetic distribution of BGCs using the ggtree R package (40). The MASH-based clustering was used to group the genomes into seven phylogroups that were used across various visualizations. The BGC comparative analysis was carried out by BiG-SLICE and BiG-SCAPE and the networks were further visualized using Plotly (Figure 4).

Enriched GCF network exploration

The enriched similarity network of BGCs were built on top of the resulting BiG-SCAPE sequence similarity network by adding nodes and edges from the result of ARTS, KnownClusterBlast, and query against BiG-FAM database using the python package networkx. MIBiG entries from KnownClusterBlast, ARTS model, and BiG-FAM models were added as nodes, while new edges were created to connect BGC nodes with the newly introduced nodes. Shannon Index (\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{upgreek} \usepackage{mathrsfs} \setlength{\oddsidemargin}{-69pt} \begin{document} $\mathop \sum \limits_{i = l}^R {{p}_{i\ }}ln\ {{p}_i}$\end{document}) for each BiG-FAM models were calculated at the genus level, where \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{upgreek} \usepackage{mathrsfs} \setlength{\oddsidemargin}{-69pt} \begin{document} ${{p}_i}$\end{document} is the proportion of the \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{upgreek} \usepackage{mathrsfs} \setlength{\oddsidemargin}{-69pt} \begin{document} $i$\end{document}th genus in the model. BiG-FAM models 202087, 200946, 210179, 213140, 201682, 201608, 205957, 215277, 201830 and 202082 were removed from the network based on the low percentage of the assigned top genus (<30%) and high Shannon Index. Clusters of connected components were calculated using networkx but ignoring ARTS nodes. For clusters with \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{upgreek} \usepackage{mathrsfs} \setlength{\oddsidemargin}{-69pt} \begin{document} $n >2$\end{document}, a convex hull was drawn using the package scipy spatial.

Comparison of gene cluster families

Sets of selected GCFs and BGCs were defined in a PEP format and were run using a comparative BGC analysis sub-workflow (bgcflow run –snakefile workflow/BGC) and further refined in Jupyter Notebook scripts (https://github.com/NBChub/saccharopolyspora_manuscript). The sub-workflow included specific tools for an in-depth comparison of the BGC structure of sequence alignments (Supplementary Table S3). Briefly, MMSeqs2 was used to build a protein sequence similarity network of selected BGCs, which allowed us to cluster the coding sequences into candidate Clusters of Orthologous Groups of proteins (COGs) (41). A phylogenetic tree was built by concatenated alignment of single-copy orthologs which are conserved across all selected BGCs using Seqkit (42) and IQTree (43). The resulting phylogenetic tree and sequence similarity network are then visualized using the R package GGGenomes (https://github.com/thackl/gggenomes) (44) and GGTree (40). The gene comparison was enriched with CBlaster hits (45) to a selected reference BGCs and links between genes are made using CLinker (46). Multiple sequence alignments of the candidate precursor peptides are built using Clustal Omega (47) and visualized using the GGMSA R package (48).

Results

Integrated components of BGCFlow present a novel platform to efficiently explore BGC potential across genomes

BGCFlow allows users to collect, organize, explore, and visualize the BGC potential of a large set of genomes either directly collected from the public database (e.g. NCBI (49), PATRIC (50)) or custom-assembled genomes from internal sources. The workflow consists of five different components: (i) Snakemake workflow to manage the data files and integrate the execution of the different bioinformatic tools for genome and BGC analysis, (ii) project management with efficient configuration of samples and rules, (iii) job scheduling and monitoring, (iv) analytics database for storing key information, and (v) Jupyter-based notebooks for reproducible reports, analysis, and visualization (Figure 1). These five components also represent the command line options provided in the BGCFlow wrapper, such as deploy, init, run, build and serve.

Figure 1. Overview of the BGCFlow components. Overview of the key stages involved in large-scale genome mining analysis supported by BGCFlow commands. (A) Deployment of BGCFlow code along with various rules (command: bgcflow –deploy). (B) BGCFlow organizes multiple projects and samples metadata using Portable Encapsulated Projects (PEPs) and a global Snakemake configuration file (.yaml) to select the set of rules to run in a given project (command: bgcflow –init). (C) BGCfFlow can automatically run all selected rules using Snakemake job scheduling that can be monitored in live using panoptes (command: bgcflow –run –wms-monitor). (D) The generated tables can be readily accessed for downstream analysis through an OLAP database based on DuckDB and the data build tool (DBT) (command: bgcflow –build). (E) Processed data is then reorganized per projects, including interactive Jupyter Notebooks and markdown reports (command: bgcflow –serve). Additional commands provided in BGCFlow include –rules, –clone, etc. Details of different components can be found in Supplementary Figures S1 to S4.

The main component of BGCFlow includes running a set of well-established genome mining and analysis tools allowing the integration of biosynthetic knowledge provided by different resources. These various existing genome and BGC analysis tools are packaged as configurable Snakemake rules that can select for commonly deployed stages of genome mining studies (Figure 1A). Additional customized rules were added to create seamless interoperability across these various programs. In general, the individual rules carry out functions such as input data curation, data wrangling, running external software, managing interoperability between software, and processing the results. The main workflow of BGCFlow contains about 70 Snakemake rules (Figure 2B, Supplementary Table S2), whereas 20 (Supplementary Table S1) of these can be selected from the configuration to run any of the analyses.

Figure 2. BGCFlow supported rules to carry out common stages of large-scale genome mining studies. (A) Overview of the five main analysis stages supported in the BGCFlow. (B) Detailed Snakemake rulegraph of BGCFlow. Input nodes are colored green, nodes utilizing main bioinformatic tools are colored blue, and the remaining custom rules for interoperability are colored yellow. Nodes inside green boxes on the right are endpoints for individual pipelines that can be turned on and off by using configuration files. These end-point custom rules can be categorized into the five main analysis types: (A1) Data Selection, (A2) Functional Annotation, (A3) Phylogenomic placement, (A4) Genome Mining and (A5) Comparative genomics. Numbers on each node refer to Snakemake rules described in Supplementary Table S1 and S2.

Large-scale studies also include reanalyzing subsets of the initial dataset with different pipelines, leading to multiple projects within a study. For example, when selecting a dataset to build a pangenome, the size of genome samples in the project may change after running the filtering stage based on genome quality or taxonomic placements. To aid in managing sample datasets across multiple projects or studies, we adopted the Portable Encapsulated Project (PEP) specification (51) (Figure 1B, Supplementary Figure S1). PEP enables users to easily define the project and input configuration via human-readable ‘.yaml’ files for each project and subproject. A typical project configuration includes a path to the table containing a list of sample datasets (e.g. a list of NCBI accession identifiers) as the input, a description of the project, selection of the pipelines to be run by setting the value into TRUE or FALSE. The configuration also allows users to include predefined taxonomic classification results from GTDB-Tk (52) and a list of well-curated GenBank annotations to improve gene annotation while running Prokka (53). BGCFlow can then read multiple PEPs and efficiently assign appropriate computational resources to a selected list of jobs using the Snakemake workflow manager (31). Following Snakemake's best practices, users can use the dry-run function to get an overview of the number of planned jobs in the current analysis before executing the workflow. The set threads for each rule can be optimized and changed further by users through the Snakemake profile configuration file. Once the Snakemake run is started, BGCFlow monitors the progress across various jobs on a live server using Panoptes (https://github.com/panoptes-organization/panoptes) (Figure 1C, Supplementary Figure S2).

A major limitation of many bioinformatics workflows is the lack of interoperability between different tools and analyses. BGCFlow provides an effective solution for investigating the BGCs spread across the dataset by integrating various bioinformatics tools for genomic analyses. After completing all analysis pipelines, the essential data tables are extracted, loaded, and transformed using the data build tool (dbt) (https://www.getdbt.com/) into a database of choice (Figure 1D, Supplementary Figure S3). By default, BGCFlow utilizes DuckDB as a database. DuckDB is an embedded online analytical processing (OLAP) database suited to handle large volumes of data with complex queries (54). To allow easy interaction with the database, users can leverage Business Intelligence tools, such as Metabase (https://www.metabase.com/), for exploratory data analysis and perform interactive SQL queries. Such a platform provides a user-friendly graphical user interface (GUI) to query and visualize the output for downstream scientific investigation. Finally, BGCFlow provides reproducible Jupyter Notebooks for analyzing critical results for each pipeline, enabling customizable data storytelling for users. Using MkDocs (https://www.mkdocs.org/), the standard notebooks are then served as static HTML reports via markdown, inspired by other attempts at reproducible reporting, such as the work of Yang et al. (55) and the reproducible reports with MkDocs blog from Tim Vink (https://timvink.nl/blog/reproducible-reports-with-mkdocs/) (Figure 1E, Supplementary Figure S4). With these five components, BGCFlow can significantly assist users in efficiently carrying out large-scale end-to-end exploration of BGCs across bacterial species of interest. In particular, the adaptable and re-entrant nature of the workflow allows users to reenter any stage of the analysis for a selected subset of genomes and tools for more focused exploratory analysis.

BGCFlow automates common analysis stages of large-scale genome mining studies

A common aim in large-scale genome mining studies is to estimate the biosynthetic potential of strain collection and subsequently prioritize strains or BGCs of interest. Such analysis typically involves various stages, including data selection, functional annotation, genome mining, phylogenetic placement, and comparative analysis. Here, we describe these common analysis stages and their automation using various BGCFlow rules (Figure 2). We note that these stages are not always linear but typically involve cyclic logic for analysis.

Data selection based on genome quality and phylogenetic placement

In comparative genome mining analysis, selecting input datasets based on assembly quality and the phylogenetic group is crucial. Many types of BGCs contain repetitive sequence elements, which makes them hard to assemble and causes contig breaks. Thus, genome mining tools such as antiSMASH have the best accuracy with high-quality genomes as an input to capture complete BGCs (21). The data selection stage can be initiated by defining a starting dataset via PEP configuration (Supplementary Figure S1), which is a ‘yaml’ object file pointing to a sample table containing a list of user-provided genome fasta filenames or public NCBI/PATRIC accession identifiers (as ‘.csv’ formatted table file). Several pipelines can then be run to give an overview of the genome sample quality. The seqfu rule of BGCFlow runs Seqfu2 (56) to give a quick overview of assembly statistics such as total genome length, number of contigs, and N50 score. Moreover, the included checkm rule's contamination and completeness results are useful for filtering lower-quality genomes, especially if the study includes metagenome-assembled genomes (57–59). In a few cases, the number of BGCs detected on the contig edge in antiSMASH can also be used as an additional quality filter before running a comparative analysis of BGCs (this would require the antismash rule to have been executed).

An appropriate selection of genomes within or across the phylogenetic clades is important in the comparative analysis of BGCs distributed across species or genera. BGCFlow incorporates rules to retrieve taxonomic assignments from GTDB (60) for available genomes in the database. Whereas the GTDB-Tk (52) rule can also assign taxonomy locally for custom genomes. For more specific and customized grouping of input genomes into different phylogroup estimates, we provide the options to calculate MASH (61) and FastANI-based (62) genomic distances across the dataset. A typical PEP for this stage includes a pipeline with the selected rules from seqfu, gtdbtk, mash and fastani. In summary, BGCFlow enables users to iterate over the data selection process using different PEPs with different sample sizes and rules.

Consistent functional annotation of the genomes

The consistent gene calling and annotation process across the project ensures that the data are comparable, especially when combining data from multiple sources. Once the input dataset is selected for a particular analysis project, BGCFlow provides a custom annotation rule for Prokka (53) that uses prodigal (63) for gene finding. In particular, the configuration also supports the option for a user-provided list of well-annotated reference genomes of specific species as a priority to annotate while running Prokka. This approach to prioritizing well-annotated genomes is useful for having better species-specific annotations. The GenBank files generated in BGCFlow also add metadata on the time of data generation and the BGCFlow version used.

For extensive functional annotation, BGCFlow can run EggNOG-mapper (64) to predict ortholog groups based on HMM profiles. These extensive annotations include predicted orthologous genes from SEED (65), eggNOG (66), COG (67), GO (68), KEGG (69), and other databases. The classification of genes in COG categories is beneficial for assessing the genomic distribution across biological subsystems. Using the eggNOG rule in combination with Roary (70), which reconstructs the pangenome, provides an overview of the functional content of the entire pangenome of the given species in the project.

The number of functional annotation tools is easily expandable in the BGCFlow framework, as demonstrated by the inclusion of a specialized deep learning-based transcription factor prediction rule for deepTFactor (71). Finally, using the cblaster rule, it is also possible to generate a nonredundant DIAMOND database (72) of all gene sequences (nucleotide or protein), which can then be used to query particular genes or gene clusters across the project (45). This analysis stage can include a pipeline with the selected rules such as prokka, eggnog (or eggnog-roary), deeptfactor (or deeptfactor-roary), and cblaster-genome. Thus, BGCFlow enables users to easily access the various functional annotations across all genomes to increase interoperability in the analysis.

Phylogenetic analysis

One of the common questions in genome mining studies is to investigate the phylogenetic placement of the BGCs across or within species. As described earlier, the data selection stage also considers the taxonomic placement of genomes using GTDB or custom phylogroup placement using MASH or FastANI (52,61,62). A more detailed phylogenetic tree can also be reconstructed using autoMLST based on multi-locus sequence analysis of a few conserved genes with functions (30 by default with a maximum of 100) (73). The autoMLST tree provides a reference for studying the BGC distribution across the project. The template Jupyter Notebook provides basic tree visualization using ggtree (40) and a guide to extract tables for external visualization using iTOL (74). Users can always use the output in Newick format and various BGC metadata tables to visualize the results in other tools. Alternatively, the pangenome rule of running Roary provides a tree based on the alignment of genes in the core genome (70). This analysis stage provides essential data for studying the evolutionary relationships of BGCs across species or genera.

Genome mining and overview of BGCs

This pivotal stage of BGCFlow includes rules to identify and analyze the BGCs across the project. More than 70 types of BGCs can be detected using antiSMASH (version 6 or version 7) for detailed investigation (21,22). In addition to running antiSMASH on all genomes, we also provide summary tables that help get the overview of the BGCs across the dataset assisting in several downstream analyses. With the help of BGCFlow reports, users can also access all of the antiSMASH results interactively on the MkDocs server. BGCFlow configures the antismash rule to run ClusterBlast and KnownClusterBlast, allowing users to search for predicted similar BGCs in the antiSMASH-DB and the MIBiG database (23,75). As an alternative, BGCFlow also incorporates GECCO for the identification of BGCs (76). This offers users the chance to utilize machine learning-based approach to detect potential BGCs that might not be detected with the antiSMASH detection rules. In addition, targeted genome mining with ARTS2 adds information on potential resistance genes and other ARTS models present in close proximity to the BGCs (25). The presence of particular resistance genes within BGC can help prioritize BGC targets with potential bioactivities such as antibiotics. Another alternative reference that is available is the BiG-FAM database, which contains ∼1.2 million BGCs from public genomes that are grouped into different gene cluster families (GCFs) (28). Using the query BiG-SLICE rule, detected BGCs in the project can be mapped to GCFs in the large BiG-FAM database (27). In general, this stage of BGCFlow allows the integration of the most popular genome mining tools and databases with interoperability between the results.

Comparative analysis of BGCs and pangenome

When comparing a large dataset of BGCs, a common approach is to dereplicate BGCs by grouping them into different GCFs, which encode similar secondary metabolites. BGCFlow supports two commonly used tools, BiG-SCAPE (26) and BiG-SLICE (27), to predict GCFs in the given dataset. In addition to the previously explained query feature, the BiG-SLICE also offers fast calculations for GCF clustering in a given dataset and is usually deployed for much larger datasets. The BiG-SCAPE is typically slower but more accurate at identifying GCFs as it uses a combined distance metric based on the organization of protein domains and sequence similarity. In several cases, an optimal scenario is to do rapid GCF clustering using BiG-SLICE followed by BiG-SCAPE on the GCFs subfamilies for the BGCs of interest. The outputs, including similarity networks, BGC, and genome metadata, can directly be imported into the network visualization tools such as Cytoscape, displaying the diversity of GCFs present in the selected dataset.

On top of GCF calculation using multiple genome mining tools, BGCFlow provides the possibility to integrate information from different genome mining tools and databases like BiG-FAM, ARTS, and MIBiG. Such an integrated approach can guide more accurate GCF definitions and targeted comparative analysis. For example, the sequence similarity network from BiG-SCAPE can be enriched to provide an information graph where detected BGCs, MIBiG entries, BiG-FAM GCF models, and ARTS model are inserted as nodes, and the edges represent the connections across these resources. By following the provided guidelines, users can further expand this network with other connections.

In addition, the cblaster (45) rule provides a database of all genes in BGCs in the project, where users can then run a BLAST search of multiple profiles to find BGCs or genes of interest. This is a handy approach for BGC prioritization by querying for BGCs with specific profiles, such as PFAMs or SMCoGs encoding for special enzymes that support the modification of secondary metabolites. Finally, studying BGCs in the pangenome context can reveal interesting features of secondary metabolites (7,9,77). BGCFlow can reconstruct the pangenome of the genomes in the project (usually for a particular species) using Roary, which clusters similar protein ORFs as orthologous groups and provides basic pangenome characteristics, including gene presence-absence matrix (70). As explained in the functional annotation stage, a combined EggNOG and Roary rule assigns the COG category and other annotations to all genes detected in the pangenome. The approaches in this stage are valuable for analyzing GCF distribution and the pangenome of the dataset, providing a guide for further prioritization of strains or BGCs. Further, we provide sub-workflows within BGCFlow that can take BGC samples as inputs to run this stage of analysis on a selected set of BGCs.

A particular study can combine some of these stages by selecting various rules in the PEP definition, where the results can be integrated using DuckDB or Jupyter Notebooks for exploratory analysis. In the next section, we will demonstrate how these stages can be easily carried out using BGCFlow for selected genomes of the Saccharopolyspora genus.

BGCFlow guided data selection and phylogenetic analysis of Saccharopolyspora spp.

As a case study, we used BGCFlow to investigate the phylogenetic distribution of BGCs across Saccharopolyspora spp. Actinomycetes are an important family of bacteria composed of several well-known secondary metabolite producers. Several large-scale studies have revealed the diverse biosynthetic potential of various genera like Streptomyces (77,78), Amycolatopsis (17), Salinispora (79), and others. In this study, we selected the Saccharopolyspora genus to demonstrate BGCFlow because of the following: (i) many secondary metabolites like erythromycin, spinosyn, and others produced by Saccharopolyspora strains are of great importance to the medicinal (erythromycin), agriculture (spinosyn), and food industry, for example in Chinese liquors (80–84), (ii) there are no comprehensive studies on genome mining across this underexplored genus (80,85), (iii) the size of the dataset was sufficiently large for demonstrating all the steps of the BGCFlow.

Saccharopolyspora is a multi-spored actinomycete genus that was first isolated from sugar cane bagasse in 1975 (86). Over the years, Saccharopolyspora species have been isolated from various natural habitats like soil, desert, fodder, marine sponges and tunicates, deep-sea sediments, salt lake, and stony corals (80). Currently, as many as 46 species (https://lpsn.dsmz.de/genus/saccharopolyspora) and up to 74 strains are reported in the DSMZ databases (87). In this study, we selected 42 genomes from the NCBI RefSeq database on 25 October 2022 belonging to the Saccharopolyspora genus with all assembly qualities (Data S1). The number of Saccharopolyspora genomes has increased significantly from 3 in 2012, 13 in 2017, to 42 in 2022 (Supplementary Figure S5). In the first stage of data curation and selection, we created a PEP with rules checkm, gtdbtk, and seqfu to access the information on the quality of the genome assemblies and phylogenetic classification (Data S1). Here, the 42 genomes were classified into three categories based on N50 and number of contigs: (a) 16 genomes of high-quality (N50 > 5 Mb), (b) 10 genomes of medium-quality (number of contigs < 50) and (c) 16 genomes of low-quality (number of contigs ≥ 50) (Supplementary Figure S5). The CheckM analysis showed that most assemblies are over 99% complete and under 4% contaminated (Supplementary Figure S5) (58). The GTDB-based taxonomic placement led to the reclassification of 42 genomes into >22 species belonging to three genera: Sacharopolyspora (27 genomes), Sacharopolyspora_C (8 genomes), and Sacharopolyspora_D (7 genomes) (Supplementary Figure S5)(60). The species assignment from NCBI to GTDB was updated for a few species; for example, S. endophytica, S. terrae and S. karakumensis were reclassified into one GTDB-species S. endophytica. A previous study based on 16S rRNA genes assigned these three as separate species while noting that they belong to a similar cluster (85). Reclassification of taxonomy based on GTDB provides a more structured basis for downstream comparative analysis.

For the next PEP example, we chose the subset of 26 genomes with medium to high-quality genomes (Data S2). As the number of species defined using GTDB was still higher for effective comparison, we used the MASH-based hierarchical clustermap to group the genomes into eight phylogenetic groups (P1 to P8) with the lowest k-means distance (Supplementary Figure S6). These phylogroups represented optimal clustering at the level between genus and species and were used in downstream visualizations. The genomic properties such as genome length, GC content, and number of BGCs were associated with the defined phylogroups (Figure 3). The genome length varied from 5.8 to 9.6 Mb with an average of 7.6 Mb, whereas the GC content varied from 68% to 73% with an average of 70%. The phylogroup P7 with four genomes of S. spinosa and S. pogona had the largest genomes and lowest GC content, along with a high number of BGCs. Similarly, the phylogroup P6 of S. erythrea also had larger genomes with a high number of BGCs and higher GC content. Saccharopolyspora hordei A54 isolated from fodder (88) had the minimum number of 13 BGCs in its ∼5.78 Mb-sized genome. Similarly, Saccharopolyspora rhizosphaerae H219 isolated from rhizosphere soil (89) had only 14 BGCs in its ∼5.82 Mb-sized genome. A more detailed phylogenetic tree was also constructed using autoMLST based on 30 common genes, which generally matches with the phylogroups as well. The number of BGCs across this phylogenetic tree was quite diverse (Figure 3). Thus, the selected dataset of 26 genomes and the phylogenetic tree were used in more specific comparative analysis in the subsequent stages.

Figure 3. Overview of genomes and detected BGCs in the Saccharopolyspora genus. (A) Scatter plot representing the distribution of genome lengths against GC content across the dataset of 42 genomes of all quality, where the colors represent phylogroup and shapes represent sequence quality (Data S1). (B) Clustermap based on MASH-based genomic similarity classifying 26 genomes into eight phylogroups of species (P3, P4, P6 with one strain each) (Data S2). (C) Phylogenetic tree calculated using autoMLST displaying the distribution of the number of BGCs. Tree node colors display MASH-based phylogroup and shapes represent the sequence quality. The first stacked barplot represents the number of BGCs on the contig edge or complete. The second stacked bar represents BGCs of different classes as defined in the BiG-SCAPE.

Integrated genome mining analysis reveals the biosynthetic potential of Saccharopolyspora spp.

Here, various genome mining tools were used to predict BGCs and their association with databases such as MIBiG, BiG-FAM, and ARTS. The predicted mappings of BGCs against these different databases were used to reconstruct a treemap distribution (Figure 4A). Using antiSMASH, a total of 724 BGCs were predicted across 26 Saccharopolyspora genomes with a median of 25 BGCs per genome (Data S2). The BGCs were distributed across various types such as Saccharides (8 BGCs), PKS-NRP_Hybrids (37 BGCs), PKSI (45 BGCs), PKSother (60 BGCs), NRPS (82 BGCs), RiPPs (90 BGCs), Terpene (159 BGCs) and Others (243 BGCs). Based on the antiSMASH KnownClusterBlast similarity of greater than 80%, a total of 122 BGCs were mapped to the 16 MIBiG database entries of characterized secondary metabolites. Most common hits were geosmin (31 BGCs), ectoine (26 BGCs), 2-methylisoborneol (15 BGCs), and erythreapeptin (14 BGCs) which were found across multiple species. Whereas erythromycin (5 BGCs), flaviolin (5 BGCs), erythrochelin (5 BGCs), spinosyn (5 BGCs), and E-837 furanone (4 BGCs) were detected in specific species.

Figure 4. Integrating external BGC knowledgebases of MIBiG, BiG-FAM, and ARTS models. (A) Treemap distribution of the mapping of detected BGCs across different databases such as MIBiG, BiG-FAM, and ARTS. BGCs are grouped in antiSMASH known or unknown categories based on >80% similarity to MIBiG using KnownClusterBlast function of antiSMASH. Using BiG-SCAPE, BGCs are grouped in known or unknown if the GCF contains MIBiG BGC with a 0.3 cutoff on a similarity metric. Using BiG-SLICE, BGCs have detected a match against BiG-FAM of over 1.2 M BGCs detected across public genomes. Finally, the ARTS match represents whether a BGC contains resistance-related genes that can help in prioritization. (B) Scatter plot representing the Shannon index against the size of the 130 GCF models detected in the BiG-FAM database. GCFs are given color if there are genera that comprise 50% or more of the total members in that model. (C) BGCs with matches against genes from ARTS. Blue color represents detected BGC whereas other colors represent functional classes of genes from ARTS. Highlighted in red circle were the 17 BGCs in proximity to ARTS profile TIGR03997.

The comparison of BGCs against BiG-FAM can be used to investigate if detected BGCs are widely spread across other genomes from the public datasets. The BiG-SLICE-based query resulted in 391 BGCs having similarities against 131 GCF models from the BiG-FAM database (Data S3). From the 131 detected GCFs, there were 72 BiG-FAM GCFs that are specifically distributed in the genus Saccharopolyspora. Whereas several other GCFs included BGCs from different genera such as Streptomyces (47 GCFs), Amycolatopsis (31 GCFs), Kitasatospora (29 GCFs), Nocardia (25 GCFs), Pseudomonas_E (22 GCFs), and many others.

We further calculated the Shannon diversity index (H) for each of the GCFs representing the distribution of BGCs across different genera (Figure 4B). In this context, the Shannon index is used to measure the diversity of the taxa of the BGCs that belong to a certain BiG-FAM GCF. The Shannon diversity index is a metric for assessing biodiversity, calculated using the formula (\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{upgreek} \usepackage{mathrsfs} \setlength{\oddsidemargin}{-69pt} \begin{document} $\mathop \sum \limits_{i = l}^R {{p}_{i\ }}ln{{p}_i}$\end{document}), where \documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{upgreek} \usepackage{mathrsfs} \setlength{\oddsidemargin}{-69pt} \begin{document} ${{p}_{i\ }}$\end{document} represents the proportion of each genus relative to the total member included in the BiG-FAM GCF model. A high Shannon index in a GCF indicates a diverse distribution of BGCs across different genera. Such GCFs might represent biosynthetic pathways that are more universally utilized across various bacterial species, suggesting a broad ecological or biochemical significance. Meanwhile, GCFs with a low Shannon index, indicating a concentration in one or a few genera, which might represent specialized biosynthetic pathways that have evolved to confer specific advantages or adaptations to those genera.

The maximum theoretical Shannon index at the genus level, based on the GTDB bacterial genus, is 9.86, calculated using the natural logarithm of the number of genera in the database (60). However, in practice, BiG-FAM models rarely exhibit a Shannon index above 5. It is also important to highlight that it is challenging to establish a cutoff that accurately groups diverse BGCs in a way that reflects their chemical similarity. Given the understanding that most BGCs are inherited vertically (18), one should consider the limitation of the clustering tool when analyzing GCFs with high Shannon values. Based on these limitations, the study focuses on exploratory analysis of BiG-FAM models with distribution in more than half of the genera they include, as these better represent the biological diversity of BGCs.

Of the 59 GCFs with positive Shannon index, 33 were highly distributed across many genera with a Shannon index of greater than 2. The GCF_201888 with the lowest positive Shannon index (∼0.3) contained 12,444 BGCs distributed across 43 genera with the majority belonging to Staphylococcus (∼94.2%) followed by Acinetobacter (∼4.2%). The known BGC in the BiG-FAM GCF_201888 coded for the biosynthesis of staphylobactin (also known as staphyloferrin B), which is a siderophore with a role in the virulence of Staphylococcus aureus (90,91). The detailed comparative analysis of the predicted BGCs against the MIBiG entry showed that the Saccharopolypora genomes indeed possess a BGC that is very similar to the staphylobactin BGC from Staphylococcus aureus (Supplementary Figure S7, Data S4). Further population genetic analysis with lsaBGC showed median beta-rd values below 1 for the two staphylobactin-like GCFs in Saccharopolyspora, suggesting that these GCFs are unlikely to be the result of horizontal gene transfer (Supplementary Figure S10) (39). Co-phylogenetic distribution of the BGCs across representative taxa members of the BiG-FAM GCF_201888 were conducted by comparing the genome tree of the species with the BGC tree build using getphylo (92). The analysis suggested that the BGCs appear to have been inherited early in the phylogenetic history of these species (Supplementary Figure S11). The getphylo picked up the orthologs of the sbnA and sbnB for the phylogenetic tree building. These two genes are responsible for the biosynthesis of L-2,3-diaminopropionic acid (Dap), the main precursor of staphyloferrin B (91). While Saccharopolyspora has not been experimentally shown to produce staphyloferrin B, the presence of these genes, along with reports of staphyloferrin B production in other genera like Ralstonia (93), suggests a broader distribution of this biosynthetic pathway beyond Staphylococcus.

Other than the BiG-FAM model GCF_201888, our analysis also revealed several other GCFs that encompass BGCs that are predominantly found in other genera. BiG-FAM models like GCF_215691 (Shannon index: 0.35), GCF_220008 (Shannon index: 0.41), and GCF_203048 (Shannon index: 0.52) were found predominantly in genera such as Pseudomonas_E (1,241 genomes), Mycobacterium (227 genomes), and Streptomyces (114 genomes), respectively (Figure 4B). The occurrence of these BGCs in various genera, apart from Saccharopolyspora, suggests a potential for broader distribution of these GCFs.

Many BGCs coding for known antibiotics also contain genes assisting in self-resistance. By looking for these resistance models, ARTS2 assists in prioritizing novel target screening with potential bioactivity. We detected 296 BGCs that had hits against 599 (130 unique) gene profiles from the ARTS model (Figure 4C, Data S3). The interaction network represented an overview of BGCs in proximity to the ARTS resistance gene models (19 unique) or the core genes models (111 unique) from different functional categories (Figure 4C). We found that 102 BGCs had hits against resistance genes and are more likely to have an antibiotic potential. We also noted that 64 of the 102 BGCs had no similarity to known clusters (either from antiSMASH KnownClusterBlast or BiG-SCAPE results), thus representing underexplored biosynthetic potential of the genus. This analysis further motivated an exploratory analysis of a set of BGCs of unknown function that shared proximity to the same ARTS gene model (17 BGCs), as represented in the last section of mycofactocin-like BGCs of this study.

Enrichment of the BGC network with knowledgebases revealed more accurate detection and dereplication of GCFs

In order to investigate the diverse biosynthetic potential, it is common to generate sequence-based similarity networks of BGCs that help in identifying distinct gene cluster families (GCFs). Clustering of the detected BGCs in Saccharopolyspora using BIG-SCAPE (0.3 cutoff on distance metric) resulted in 330 GCFs. Among these GCFs, only 5 contained known BGCs from the MIBiG database: erythromycin, spinosyn, antimycin, 2-methylisoborneol, and erythreapeptin (Figure 5A, C). It is challenging to select an optimal cutoff for defining the GCFs, and thus we evaluated 3 different cutoffs of 0.3, 0.4 and 0.5, respectively (Supplementary Figure S8). For this study, the selected cutoff is set to 0.3, which is conservative enough to avoid misleading connections with unrelated BGCs and MIBiG references, as demonstrated in less stringent cutoffs (Supplementary Figure S8). However, we missed many of the known cluster hits due to reasons such as some clusters being hybrid types or having unclear boundaries.

Figure 5. Enriched similarity network with additional connections to different BGC knowledge bases. (A) Example of BGC similarity network using BiG-SCAPE 0.30 cutoff. (B) Examples of the same BGCs with additional connections made using known cluster blast predictions, BiG-SLICE query and ARTS against the databases of MIBiG, BiG-FAM, and ARTS model, respectively. (C) Overview of the similarity network of all 722 BGCs resulting in 330 connected components with 19 BGCs assigned to 5 known MIBiG entries and 209 singletons (Data S2). (D) Expanded network with information from antiSMASH KnownClusterBlast and BiG-SLICE similarity to BiG-FAM models resulting in 206 connected components with 45 BGCs assigned to 5 MIBiG entries, 89 BGCs assigned to 11 MIBiG entries with ≥80% similarity, and 51 singletons (Data S3). BiG-FAM models 202087, 200946, 210179, 213140, 201682, 201608, 205957, 215277, 201830 and 202082 were removed because the assigned top genus in the model is below 30%.

In this study, we leverage points of reference from available knowledgebases and tools to improve the dereplication accuracy of the GCFs. Our approach proposed within BGCFlow involved generating an extended graph where the BGCs were connected with additional nodes from external knowledgebases such as ARTS (gene profiles), antiSMASH KnownClusterBlast hits (MIBiG BGCs), and BiG-FAM (GCF models). The expanded network with information from antiSMASH KnownClusterBlast and BiG-SLICE similarity to BiG-FAM models was used to define more accurate GCFs. The ARTS gene profiles were not used to define the GCFs but can be used to navigate and prioritize GCFs with potentially similar bioactivities. Additionally, the different layers of knowledgebases enable a better explanation of the reason behind the clustering of GCFs.

The enriched network narrows down the 330 GCFs from BiG-SCAPE into 202 connected components with only 50 singletons (previously 209) (Data S3). Using KnownClusterBlast (>80% similarity) and matches to BiG-FAM models, we can assign 134 BGCs to 16 MIBiG entries, covering all known Saccharopolyspora BGCs and common BGCs such as geosmin and hopene. This information was missed using only the BiG-SCAPE network. One example of using this approach is highlighted by capturing the spinosyn GCF more accurately due to the connections from antiSMASH KnownClusterBlast hits, which were missed in BiG-SCAPE due to the variable boundary of hybrid clusters (Figure 5B, Supplementary Figure S1, Data S5). Another example included a more accurate definition and a deeper investigation erythreapeptin-like GCF, which was spread across six different BiG-SCAPE GCFs (Figure 6C). Overall, the enriched network can be used as a starting point for in-depth comparative analysis within specific GCFs as demonstrated in the next sections, where BGC comparison tools are used on these smaller PEP projects of each GCFs.

Figure 6. Alignment of lanthipeptide BGCs similar to erythreapeptin. (A) Phylogenetic tree and distribution of GCFs of all lanthipeptide classes. (B) Connected graph with nodes from KnownClusterBlast, ARTS, BiG-FAM. Difference GCFs are highlighted with the same background colors as panel A. (C) Alignment of detected erythreapeptin-like BGCs using clinker, ordered phylogenetically (Data S6). (D) Sequence variation in precursor peptides highlighting novel variants of erythreapeptin-like lanthipeptides in different phylogroups.

Distribution and sequence level variation across lanthipeptide GCFs

As an example of in-depth comparative BGCs analysis, we investigated the distribution of BGCs belonging to different types of lanthipeptides. Lanthipeptides consist of five diverse classes of ribosomally synthesized and post-translationally modified peptides (RiPPs) (94,95). Lanthipeptides are typically represented by peptides containing lanthionine bridges, which are post-translationally synthesized by linking the Cys thiol- and a dehydrated Ser hydroxy group. From the 121 RiPPs detected in the Saccharopolyspora genome dataset, we identified 58 BGCs of the various lanthipeptide classes namely class I (15 BGCs), class II (8 BGCs), class III (17 BGCs), class IV (17 BGCs) and class V (1 BGC) (Figure 6A). We found that different classes of lanthipeptides were predominant in specific phylogroups. For example, class II lanthipeptides were detected only in phylogroups P7 and P8. On the other hand, class I lanthipeptides were detected in all the other phylogroups except P7 and P8. The class IV lanthipeptides were predominant in phylogroups P1 and P8. The class III lanthipeptides were present in most but phylogroup P1 and P3. Interestingly, these class III lanthipeptides were spread across six different GCFs as per BiG-SCAPE but were detected as a single connected GCF based on the enriched network due to KnownClusterBlast similarity (Figure 6B).

We further carried out an in-depth exploratory analysis of the class III lanthipeptide GCF by defining a new PEP with BGC snakefile that used the BGCs of this GCF as samples and BGC alignment tools such as clinker (Data S6). We noted that most BGCs of this GCF contained all of the known biosynthetic genes for erythreapeptin (Figure 6C), a known lantibiotic produced by Saccharapolyspora (96). The only exception was a BGC in the phylogroup P6 which had the additional genes but was missing the core biosynthetic genes. We note that the additional genes were different in different phylogroups and thus explain the different GCFs detected using BiG-SCAPE. Finally, we also compared the amino acid sequence variations in the leader and the core peptides of the core gene eryS (Figure 6D). We note that the core peptide sequence is generally conserved across all phylogroups with some variations at specific positions. For example, the AA in the position 11 of the core peptide was N in phylogroups P7 and P8, A in P4, and Q or H in P2. We also note that the precursor peptide sequence also displayed variations across different phylogroups. Further experimental studies are required to assess if these variations will lead to lantibiotics with different activities.

Integrated genome mining leads to identification of mycofactocin-like BGCs in Saccharopolyspora

On top of known resistance gene models, ARTS2 reference set includes phylum-specific essential housekeeping genes (core models). Both models are checked for duplication, horizontal gene transfer and localization within a BGC, which signifies potential bioactivity (25). In this section, we carried out additional exploratory analysis for a selected subnetwork of 17 BGCs of ranthipeptide type with unknown functions. These 17 BGCs do not have a match through KnownClusterBlast and BiG-FAM, but all shared a hit against an ARTS2 core model TIGR03997 (Figure 7A). The TIGR03997 model was identified as a mycofactocin system oxidoreductase, a related biosynthetic component of a known redox cofactor in Mycobacterium tuberculosis (97). Even though this profile does not satisfy several ARTS criteria for self-resistance, it indicated that the detected BGCs might code for mycofactocin-like redox cofactors.

Figure 7. Identification of mycofactocin-like BGCs in Saccharopolyspora through integrated genome mining with ARTS2. (A) Integration of antiSMASH KnownClusterBlast, ARTS2, BiG-FAM hits and BiG-SCAPE sequence similarity networks enables quick exploration and visualization for unknown BGCs with potential bioactivities. The zoomed panel shows a group of Ranthipeptide BGCs with low KnownClusterBlast similarity score with hits to ARTS2 model (TIGR03997). (B) Cluster comparison of the putative mycofactocin BGCs (Data S7), classified as redox-cofactor type in antiSMASH, as described in (97). Alignment shows conserved RS-SPASM (MftC) and mycofactocin RRE (MftB) signature, but missing TIGR03966 profile in Saccharopolyspora. (C) the proposed mycofactocin biosynthesis pathway in Mycobacterium tuberculosis, adapted from (100). (D) Mycofactocin precursor peptide (MftA) comparison in Saccharopolyspora showed distinct conserved C-terminal residues (IDGMCGVY).

We did a further investigation into these 17 candidate BGCs by creating a new PEP with BGC snakefile (Data S7) and comparing the detected BGCs with a mycofactocin BGC from Mycobacterium tuberculosis. We found that the majority of the genes showed sequence similarities to at least six out of the seven genes involved in mycofactocin biosynthesis (Figure 7B and C), with the exception of mftD. Multiple sequence alignment of the candidate precursor peptides (mftA) exhibited the characteristic C-terminal pattern (IDGMCGVY) associated with mycofactocin (Figure 7D) (97). The missing gene signature (mftD) encodes an oxidoreductase (TIGR03966) that is required for the synthesis of pre-mycofactocin through oxidative deamination of 3-amino-5-[(p-hydroxyphenyl)methyl]-4,4-dimethyl-2-pyrrolidinone (AHDP) (97). The Saccharapolyspora BGCs contained a gene without signficant similarity to mftD but a hit against the ARTS profile TIGR03997, which is annotated as FadH/OYE family oxidoreductase with unknown function. Nevertheless, experimental evidence showed that S. erythraea is able to produce a methylated variant of mycofactocin (98). These findings strongly suggest that the investigated BGCs may be responsible for producing a compound that closely resembles mycofactocin, instead of a ranthipeptide as was initially discovered with the rule-based logic of antiSMASH. The classification discrepancy was likely due to the absence of the TIGR03966 (mftD) profile in the candidate BGCs, which are required by the antiSMASH version 6.1.1 rule to recognize redox cofactor BGCs. The missing profile then registers the BGC region as ranthipeptide, even though the clusters don’t seem to indicate the six Cys in forty-five residues (SCIFF) pattern in the precursor peptides (99). Hence, the BGCFlow framework provides a global overview and guidelines for investigating BGCs and GCFs in finer detail that can reveal more knowledge about the BGCs of interest.

Discussion

Genome mining tools like antiSMASH have revealed the significantly higher biosynthetic potential of various bacteria to produce novel secondary metabolites with various applications in medicine and industrial biotechnology (15). In recent years, the search for novel natural products with bioactivity is evolving from purely chemical and activity screening-based approaches to genome analysis-assisted discovery (14,101). This paradigm shift in the era of pangenome availability will require scientists to deploy comprehensive platforms to organize the large datasets, metadata, and results in a findable, accessible, interoperable, and reusable (FAIR) way. The data workflow management systems and databases provide effective solutions to organize large genome mining projects. Here, the BGCFlow demonstrates the first end-to-end analysis platform to unify large-scale BGC and genome data, increasing the support for FAIR data principles.

Currently, workflows such as AQUAMIS, ASA3P, TORMES, Bactopia, and others automate many of the ‘generic’ assembly, annotation, and pangenome analysis software (29,36–38), but provide no information on specialized metabolite BGCs. Many of the genome mining tools like antiSMASH, BiG-SCAPE and BiG-SLICE allow the detection of BGCs and GCFs, whereas databases like antiSMASH-DB, BiG-FAM, MIBiG provide precalculated BGCs, GCFs, or catalog of known BGCs (21,26–28,75,102). With a primary focus on integrating secondary/specialized metabolite genome mining resources under one platform, BGCFlow assists in automating the computational analysis in scalable, adaptable, reiterable fashion for various small to large-scale customized projects.

Particularly, any exploratory data analysis requires scientists to dynamically change the dataset, adding or removing samples and running different analytical tools as the investigation continues. The notebooks and the database provided here would be a starting point for many users to expand the exploratory analysis for the design of the study. Inspired by the cookiecutter data science project (https://drivendata.github.io/cookiecutter-data-science), BGCFlow data structure, combined with Snakemake, enables efficient re-use of data via input re-entries. While the notebooks are meant for flexible exploratory analysis, it is recommended to utilize the combined PEP configuration and Snakemake for reproducibility. On top of the main workflow, users can also utilize sub-workflows for direct comparison of BGCs (as demonstrated with examples of erythreapeptin and mycofactocin comparison) or write a custom pipeline.

Comparing BGCs and grouping them into functionally related GCFs remains a key challenge in genome mining studies (26,27,39,103–105). A BGC can be defined as a set of chromosomally adjacent genes which encode the necessary enzymes, regulatory proteins, and transporters for the production, processing, and export of specialized metabolites (106). In computational contexts, we define a BGC using the antiSMASH ‘region’ concept, which is a set of genes within the offset of cluster detection rules (107). On the other hand, a GCF comprises of BGCs sharing similar biosynthetic sequence profiles with the potential to produce similar compound or compound classes (26). Nevertheless, the definition of a GCF is heavily dependent on the clustering threshold set within sequence similarity comparison algorithms.

The accuracy of such comparisons can be influenced by several factors, depending on the scale and quality of the dataset. (i) Relying solely on gene sequence similarity for comparisons can lead to the grouping together of distinct BGCs that share repetitive sequences. (ii) Comparing hybrid regions of BGCs, which may contain multiple independent BGCs, can impact the assessment of similarity. (iii) The precise determination of BGC boundaries for comparison purposes is challenging. (iv) Poor assembly quality frequently results in BGCs being fragmented. (v) Effectively navigating and identifying relevant GCFs from a vast number of clusters demands the implementation of efficient prioritization strategies, as not all tools are equipped to handle larger datasets. By leveraging the knowledge extracted from antiSMASH KnownClusterBlast, MIBiG, BiG-SCAPE, BiG-FAM, and ARTS into an enriched sequence similarity network, BGCFlow enables the more accurate definition of GCFs and concise comparative analysis of BGCs.

As a case study, we ran the BGCFlow on a set of publicly available genomes of Saccharopolyspora genus, which is known to produce several industrially relevant natural products with still underexplored bioactive potential (80). Various steps of the analysis carried out on different subsets highlight the reiterable nature of BGCFlow analysis. The phylogenetic analysis provides a guideline for efficiently investigating the distribution of different BGCs across phylogroups, for example different classes of lanthipeptides. The calculated enriched similarity network of the BGCs with different genome mining resources improved classification of BGCs and GCFs compared to the individual tools. Our analysis revealed more accurate identification of spinosyn-like, erythreapeptin-like, and mycofactin-like GCFs through connections to KnownClusterBlast based MIBiG BGCs or ARTS profiles. For instance, when classifying spinosyn-like BGCs using BiG-SCAPE with a cutoff of 0.3, we encountered challenges due to multiple BGCs residing in the same genomic region, resulting in their classification into different GCFs. In another example, the integration of knowledge from ARTS allowed us to re-evaluate the antiSMASH rule-based classification of ranthipeptides. Our analysis uncovered 17 ranthipeptide BGCs actually resembling mycofactocin biosynthesis, a redox-cofactor type also recently identified to be produced by Saccharapolyspora (98). These findings highlight the importance of not only integration but also the need to carefully evaluate accuracy of each predicted GCF as per the case. While literature curated databases like MIBIG are valuable resources, they may still contain incomplete entries and significant gaps to current knowledge, especially considering the ever-growing volume of publications in the natural product field.

Despite several advances in genome mining tools over the last decade, it is important to note that many of the BGC related analyses and predictions still require experimental validations. Therefore, it is crucial to exercise caution and critically interpret the data-driven predictions. Nevertheless, analyzing large genomic datasets such as the BiG-FAM database, even with domain knowledge expertise, presents challenges due to variations in data quality, software versions, and database inconsistencies. To address these issues, BGCFlow aims to provide a scalable, explorable and reproducible platform for integrated genome mining analysis. By following workflow standards and incorporating data engineering best practices, BGCFlow provides a dynamic environment that facilitates not only the execution of various analysis tools but also enables critical exploratory analysis of BGCs at different scales of pangenome-level, BGC-level, and sequence-level. Thus, we expect that the BGCFlow will streamline the research process along with facilitating collaboration and knowledge sharing among researchers working in the genome mining field.

Supplementary Material

gkae314_Supplemental_File

Acknowledgements

We thank Kai Blin, Simon Shaw, Tue S. Jorgensen, Emre Özdemir, Roberto S. Navarro, Matiss Maleckis, Lasse J. D. Nielsen, Pernille K. Bech, Eva B. Sterndorff and Zhijie Yang for important discussion and feedback during the development and testing of BGCFlow.

Data availability

The three components of the BGCFlow software environment (bgcflow, bgcflow_dbt-duckdb, and bgcflow_wrapper) can be found as separate repositories in GitHub at https://github.com/NBChub/bgcflow, https://github.com/NBChub/bgcflow_dbt-duckdb, https://github.com/NBChub/bgcflow_wrapper or in Zenodo at https://doi.org/10.5281/zenodo.8084004, https://doi.org/10.5281/zenodo.8086694, https://doi.org/10.5281/zenodo.8086628. An extended documentation of BGCFlow is available in https://github.com/NBChub/bgcflow/wiki. The Jupyter Notebooks for the data analysis are available on GitHub at https://github.com/NBChub/saccharopolyspora_manuscript or in Zenodo at https://doi.org/10.5281/zenodo.8086714. A demo of the automated report can be found in https://nbchub.github.io/bgcflow_report_demo.

Supplementary data

Supplementary Data are available at NAR Online.

Funding

Novo Nordisk Foundation [NNF20CC0035580, NNF16OC0021746]; Danish National Research Foundation [CeMiSt, DNRF137]; M.N. was supported by the Novo Nordisk Foundation Copenhagen Bioscience PhD program [NNF20SA0035588]. Funding for open access charge: Novo Nordisk Foundation.

Conflict of interest statement. None declared.
==== Refs
References

1. Fullam  A., Letunic  I., Schmidt  T.S.B., Ducarmon  Q.R., Karcher  N., Khedkar  S., Kuhn  M., Larralde  M., Maistrenko  O.M., Malfertheiner  L.  et al .  proGenomes3: approaching one million accurately and consistently annotated high-quality prokaryotic genomes. Nucleic Acids Res.  2022; 51 :D760–D766.
2. Doron  S., Melamed  S., Ofir  G., Leavitt  A., Lopatina  A., Keren  M., Amitai  G., Sorek  R.  Systematic discovery of antiphage defense systems in the microbial pangenome. Science. 2018; 359 :eaar4120.29371424
3. Zhang  Y., Zhang  H., Zhang  Z., Qian  Q., Zhang  Z., Xiao  J.  ProPan: A comprehensive database for profiling prokaryotic pan-genome dynamics. Nucleic Acids Res.  2022; 51 :D767–D776.
4. Hyun  J.C., Monk  J.M., Palsson  B.O.  Comparative pangenomics: analysis of 12 microbial pathogen pangenomes reveals conserved global structures of genetic and functional diversity. BMC Genomics. 2022; 23 :7.34983386
5. Abram  K., Udaondo  Z., Bleker  C., Wanchai  V., Wassenaar  T.M., Robeson  M.S.  2nd, Ussery  D.W.  Mash-based analyses of Escherichia coli genomes reveal 14 distinct phylogroups. Commun. Biol.  2021; 4 :117.33500552
6. Mageiros  L., Méric  G., Bayliss  S.C., Pensar  J., Pascoe  B., Mourkas  E., Calland  J.K., Yahara  K., Murray  S., Wilkinson  T.S.  et al .  Genome evolution and the emergence of pathogenicity in avian Escherichia coli. Nat. Commun.  2021; 12 :765.33536414
7. Mohite  O.S., Lloyd  C.J., Monk  J.M., Weber  T., Palsson  B.O.  Pangenome analysis of Enterobacteria reveals richness of secondary metabolite gene clusters and their associated gene sets. Synth. Syst. Biotechnol.  2022; 7 :900–910.35647330
8. Shi  Y.-M., Hirschmann  M., Shi  Y.-N., Ahmed  S., Abebew  D., Tobias  N.J., Grün  P., Crames  J.J., Pöschel  L., Kuttenlochner  W.  et al .  Global analysis of biosynthetic gene clusters reveals conserved and unique natural products in entomopathogenic nematode-symbiotic bacteria. Nat. Chem.  2022; 14 :701–712.35469007
9. Kloosterman  A.M., Cimermancic  P., Elsayed  S.S., Du  C., Hadjithomas  M., Donia  M.S., Fischbach  M.A., van Wezel  G.P., Medema  M.H.  Expansion of RiPP biosynthetic space through integration of pan-genomics and machine learning uncovers a novel class of lanthipeptides. PLoS Biol.  2020; 18 :e3001026.33351797
10. Wright  G.D.  Opportunities for natural products in 21st century antibiotic discovery. Nat. Prod. Rep.  2017; 34 :694–701.28569300
11. Huang  M., Lu  J.-J., Ding  J.  Natural products in cancer therapy: past, present and future. Nat. Prod. Bioprospect.  2021; 11 :5–13.33389713
12. International Natural Product Sciences Taskforce Atanasov  A.G., Zotchev  S.B., Dirsch  V.M., Supuran  C.T.  Natural products in drug discovery: advances and opportunities. Nat. Rev. Drug Discov.  2021; 20 :200–216.33510482
13. Medema  M.H.  The year 2020 in natural product bioinformatics: an overview of the latest tools and databases. Nat. Prod. Rep.  2021; 38 :301–306.33533785
14. Ziemert  N., Alanjary  M., Weber  T.  The evolution of genome mining in microbes - a review. Nat. Prod. Rep.  2016; 33 :988–1005.27272205
15. Gavriilidou  A., Kautsar  S.A., Zaburannyi  N., Krug  D., Müller  R., Medema  M.H., Ziemert  N.  Compendium of specialized metabolite biosynthetic diversity encoded in bacterial genomes. Nat. Microbiol.  2022; 7 :726–735.35505244
16. Steinke  K., Mohite  O.S., Weber  T., Kovács  Á.T.  Phylogenetic distribution of secondary metabolites in the Bacillus subtilis species complex. Msystems. 2021; 6 :e00057-21.33688015
17. Adamek  M., Alanjary  M., Sales-Ortells  H., Goodfellow  M., Bull  A.T., Winkler  A., Wibberg  D., Kalinowski  J., Ziemert  N.  Comparative genomics reveals phylogenetic distribution patterns of secondary metabolites in Amycolatopsis species. BMC Genomics. 2018; 19 :426.29859036
18. Chase  A.B., Sweeney  D., Muskat  M.N., Guillén-Matus  D.G., Jensen  P.R.  Vertical inheritance facilitates interspecies diversification in biosynthetic gene clusters and specialized metabolites. mBio. 2021; 12 :e0270021.34809466
19. Medema  M.H., Cimermancic  P., Sali  A., Takano  E., Fischbach  M.A.  A systematic computational analysis of biosynthetic gene cluster evolution: lessons for engineering biosynthesis. PLoS Comput. Biol.  2014; 10 :e1004016.25474254
20. Donia  M.S., Cimermancic  P., Schulze  C.J., Wieland Brown  L.C., Martin  J., Mitreva  M., Clardy  J., Linington  R.G., Fischbach  M.A.  A systematic analysis of biosynthetic gene clusters in the human microbiome reveals a common family of antibiotics. Cell. 2014; 158 :1402–1414.25215495
21. Blin  K., Shaw  S., Kloosterman  A.M., Charlop-Powers  Z., van Wezel  G.P., Medema  M.H., Weber  T.  antiSMASH 6.0: improving cluster detection and comparison capabilities. Nucleic Acids Res.  2021; 49 :W29–W35.33978755
22. Blin  K., Shaw  S., Augustijn  H.E., Reitz  Z.L., Biermann  F., Alanjary  M., Fetter  A., Terlouw  B.R., Metcalf  W.W., Helfrich  E.J.N.  et al .  antiSMASH 7.0: new and improved predictions for detection, regulation, chemical structures and visualisation. Nucleic Acids Res.  2023; 51 :W46–W50.37140036
23. Blin  K., Medema  M.H., Kottmann  R., Lee  S.Y., Weber  T.  The antiSMASH database, a comprehensive database of microbial secondary metabolite biosynthetic gene clusters. Nucleic Acids Res.  2017; 45 :D555–D559.27924032
24. Kautsar  S.A., Blin  K., Shaw  S., Navarro-Muñoz  J.C., Terlouw  B.R., van der Hooft  J.J.J., van Santen  J.A., Tracanna  V., Suarez Duran  H.G., Pascal Andreu  V.  et al .  MIBiG 2.0: A repository for biosynthetic gene clusters of known function. Nucleic Acids Res.  2020; 48 :D454–D458.31612915
25. Mungan  M.D., Alanjary  M., Blin  K., Weber  T., Medema  M.H., Ziemert  N.  ARTS 2.0: feature updates and expansion of the Antibiotic Resistant Target Seeker for comparative genome mining. Nucleic Acids Res.  2020; 48 :W546–W552.32427317
26. Navarro-Muñoz  J.C., Selem-Mojica  N., Mullowney  M.W., Kautsar  S.A., Tryon  J.H., Parkinson  E.I., De Los Santos  E.L.C., Yeong  M., Cruz-Morales  P., Abubucker  S.  et al .  A computational framework to explore large-scale biosynthetic diversity. Nat. Chem. Biol.  2020; 16 :60–68.31768033
27. Kautsar  S.A., van der Hooft  J.J.J., de Ridder  D., Medema  M.H.  BiG-SLiCE: a highly scalable tool maps the diversity of 1.2 million biosynthetic gene clusters. Gigascience. 2021; 10 :giaa154.33438731
28. Kautsar  S.A., Blin  K., Shaw  S., Weber  T., Medema  M.H.  BiG-FAM: the biosynthetic gene cluster families database. Nucleic Acids Res.  2021; 49 :D490–D497.33010170
29. Petit  R.A.  3rd, Read  T.D.  Bactopia: a flexible pipeline for complete analysis of bacterial genomes. Msystems. 2020; 5 :e00190-20.32753501
30. Cornwell  M., Vangala  M., Taing  L., Herbert  Z., Köster  J., Li  B., Sun  H., Li  T., Zhang  J., Qiu  X.  et al .  VIPER: Visualization Pipeline for RNA-seq, a Snakemake workflow for efficient and complete RNA-seq analysis. BMC Bioinf.  2018; 19 :135.
31. Köster  J., Rahmann  S.  Snakemake—a scalable bioinformatics workflow engine. Bioinformatics. 2012; 28 :2520–2522.22908215
32. Di Tommaso  P., Chatzou  M., Floden  E.W., Barja  P.P., Palumbo  E., Notredame  C.  Nextflow enables reproducible computational workflows. Nat. Biotechnol.  2017; 35 :316–319.28398311
33. Voss  K., Van der Auwera  G., Gentry  J.  Full-stack genomics pipelining with GATK4 + WDL + Cromwell. ISCB Comm J. 2017; 6 :1–4.
34. Wratten  L., Wilm  A., Göke  J.  Reproducible, scalable, and shareable analysis pipelines with bioinformatics workflow managers. Nat. Methods. 2021; 18 :1161–1168.34556866
35. Chevrette  M.G., Handelsman  J.  Needles in haystacks: reevaluating old paradigms for the discovery of bacterial secondary metabolites. Nat. Prod. Rep.  2021; 38 :2083–2099.34693961
36. Deneke  C., Brendebach  H., Uelze  L., Borowiak  M., Malorny  B., Tausch  S.H.  Species-specific quality control, assembly and contamination detection in microbial isolate sequences with AQUAMIS. Genes. 2021; 12 :644.33926025
37. Schwengers  O., Hoek  A., Fritzenwanker  M., Falgenhauer  L., Hain  T., Chakraborty  T., Goesmann  A.  ASA3P: An automatic and scalable pipeline for the assembly, annotation and higher-level analysis of closely related bacterial isolates. PLoS Comput. Biol.  2020; 16 :e1007134.32134915
38. Quijada  N.M., Rodríguez-Lázaro  D., Eiros  J.M., Hernández  M.  TORMES: an automated pipeline for whole bacterial genome analysis. Bioinformatics. 2019; 35 :4207–4212.30957837
39. Salamzade  R., Cheong  J.Z.A., Sandstrom  S., Swaney  M.H., Stubbendieck  R.M., Starr  N.L., Currie  C.R., Singh  A.M., Kalan  L.R.  Evolutionary investigations of the biosynthetic diversity in the skin microbiome using lsaBGC. Microb. Genomics. 2023; 9 :mgen000988.
40. Yu  G., Smith  D.K., Zhu  H., Guan  Y., Lam  T.T.-Y.  Ggtree : An r package for visualization and annotation of phylogenetic trees with their covariates and other associated data. Methods Ecol. Evol.  2017; 8 :28–36.
41. Steinegger  M., Söding  J.  Clustering huge protein sequence sets in linear time. Nat. Commun.  2018; 9 :2542.29959318
42. Shen  W., Le  S., Li  Y., Hu  F.  SeqKit: a cross-platform and ultrafast toolkit for FASTA/Q file manipulation. PLoS One. 2016; 11 :e0163962.27706213
43. Nguyen  L.-T., Schmidt  H.A., von Haeseler  A., Minh  B.Q.  IQ-TREE: A fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies. Mol. Biol. Evol.  2015; 32 :268–274.25371430
44. Hackl  T., Duponchel  S., Barenhoff  K., Weinmann  A., Fischer  M.G.  Virophages and retrotransposons colonize the genomes of a heterotrophic flagellate. eLife. 2021; 10 :e72674.34698016
45. Gilchrist  C.L.M., Booth  T.J., van Wersch  B., van Grieken  L., H Medema  M., Chooi  Y.-H  cblaster: A remote search tool for rapid identification and visualization of homologous gene clusters. Bioinform. Adv.  2021; 1 :vbab016.36700093
46. Gilchrist  C.L.M., Chooi  Y.-H.  clinker & clustermap.js: automatic generation of gene cluster comparison figures. Bioinformatics. 2021; 37 :2473–2475.33459763
47. Sievers  F., Wilm  A., Dineen  D., Gibson  T.J., Karplus  K., Li  W., Lopez  R., McWilliam  H., Remmert  M., Söding  J.  et al .  Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal Omega. Mol. Syst. Biol.  2011; 7 :539.21988835
48. Zhou  L., Feng  T., Xu  S., Gao  F., Lam  T.T., Wang  Q., Wu  T., Huang  H., Zhan  L., Li  L.  et al .  ggmsa: A visual exploration tool for multiple sequence alignment and associated data. Brief. Bioinform.  2022; 23 :bbac222.35671504
49. Sayers  E.W., Bolton  E.E., Brister  J.R., Canese  K., Chan  J., Comeau  D.C., Farrell  C.M., Feldgarden  M., Fine  A.M., Funk  K.  et al .  Database resources of the National Center for Biotechnology Information in 2023. Nucleic Acids Res.  2023; 51 :D29–D38.36370100
50. Wattam  A.R., Abraham  D., Dalay  O., Disz  T.L., Driscoll  T., Gabbard  J.L., Gillespie  J.J., Gough  R., Hix  D., Kenyon  R.  et al .  PATRIC, the bacterial bioinformatics database and analysis resource. Nucleic Acids Res.  2014; 42 :D581–D591.24225323
51. Sheffield  N.C., Stolarczyk  M., Reuter  V.P., Rendeiro  A.F.  Linking big biomedical datasets to modular analysis with Portable Encapsulated Projects. Gigascience. 2021; 10 :giab077.34890448
52. Chaumeil  P.-A., Mussig  A.J., Hugenholtz  P., Parks  D.H.  GTDB-Tk: a toolkit to classify genomes with the Genome Taxonomy Database. Bioinformatics. 2019; 36 :1925–1927.31730192
53. Seemann  T.  Prokka: rapid prokaryotic genome annotation. Bioinformatics. 2014; 30 :2068–2069.24642063
54. Raasveldt  M., Mühleisen  H.  DuckDB: an embeddable analytical database. Proceedings of the 2019 International Conference on Management of Data, SIGMOD ’19. 2019; NY Association for Computing Machinery 1981–1984.
55. Yang  J., Liu  Y., Shang  J., Huang  Y., Yu  Y., Li  Z., Shi  L., Ran  Z.  BioVisReport: A Markdown-based lightweight website builder for reproducible and interactive visualization of results from peer-reviewed publications. Comput. Struct. Biotechnol. J.  2022; 20 :3133–3139.35782729
56. Telatin  A., Fariselli  P., Birolo  G.  SeqFu: a suite of utilities for the robust and reproducible manipulation of sequence files. Bioengineering (Basel). 2021; 8 :59.34066939
57. Sánchez-Navarro  R., Nuhamunada  M., Mohite  O.S., Wasmund  K., Albertsen  M., Gram  L., Nielsen  P.H., Weber  T., Singleton  C.M.  Long-read metagenome-assembled genomes improve identification of novel complete biosynthetic gene clusters in a complex microbial activated sludge ecosystem. Msystems. 2022; 7 :e0063222.36445112
58. Parks  D.H., Imelfort  M., Skennerton  C.T., Hugenholtz  P., Tyson  G.W.  CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes. Genome Res.  2015; 25 :1043–1055.25977477
59. Bowers  R.M., Kyrpides  N.C., Stepanauskas  R., Harmon-Smith  M., Doud  D., Reddy  T.B.K., Schulz  F., Jarett  J., Rivers  A.R., Eloe-Fadrosh  E.A.  et al .  Minimum information about a single amplified genome (MISAG) and a metagenome-assembled genome (MIMAG) of bacteria and archaea. Nat. Biotechnol.  2017; 35 :725–731.28787424
60. Parks  D.H., Chuvochina  M., Rinke  C., Mussig  A.J., Chaumeil  P.-A., Hugenholtz  P.  GTDB: an ongoing census of bacterial and archaeal diversity through a phylogenetically consistent, rank normalized and complete genome-based taxonomy. Nucleic Acids Res.  2022; 50 :D785–D794.34520557
61. Ondov  B.D., Treangen  T.J., Melsted  P., Mallonee  A.B., Bergman  N.H., Koren  S., Phillippy  A.M.  Mash: fast genome and metagenome distance estimation using MinHash. Genome Biol.  2016; 17 :132.27323842
62. Jain  C., Rodriguez-R  L.M., Phillippy  A.M., Konstantinidis  K.T., Aluru  S.  High throughput ANI analysis of 90K prokaryotic genomes reveals clear species boundaries. Nat. Commun.  2018; 9 :5114.30504855
63. Hyatt  D., Chen  G.-L., LoCascio  P.F., Land  M.L., Larimer  F.W., Hauser  L.J.  Prodigal: prokaryotic gene recognition and translation initiation site identification. BMC Bioinf.  2010; 11 :119.
64. Cantalapiedra  C.P., Hernández-Plaza  A., Letunic  I., Bork  P., Huerta-Cepas  J.  eggNOG-mapper v2: functional annotation, orthology assignments, and domain prediction at the metagenomic scale. Mol. Biol. Evol.  2021; 38 :5825–5829.34597405
65. Devoid  S., Overbeek  R., DeJongh  M., Vonstein  V., Best  A.A., Henry  C.  Automated genome annotation and metabolic model reconstruction in the SEED and Model SEED. Methods Mol. Biol.  2013; 985 :17–45.23417797
66. Hernández-Plaza  A., Szklarczyk  D., Botas  J., Cantalapiedra  C.P., Giner-Lamia  J., Mende  D.R., Kirsch  R., Rattei  T., Letunic  I., Jensen  L.J.  et al .  eggNOG 6.0: enabling comparative genomics across 12 535 organisms. Nucleic Acids Res.  2023; 51 :D389–D394.36399505
67. Galperin  M.Y., Wolf  Y.I., Makarova  K.S., Vera Alvarez  R., Landsman  D., Koonin  E.V.  COG database update: focus on microbial diversity, model organisms, and widespread pathogens. Nucleic Acids Res.  2021; 49 :D274–D281.33167031
68. The Gene Ontology resource: enriching a GOld mine. Nucleic Acids Res.  49 :D325–D334.33290552
69. Kanehisa  M., Furumichi  M., Sato  Y., Kawashima  M., Ishiguro-Watanabe  M.  KEGG for taxonomy-based analysis of pathways and genomes. Nucleic Acids Res.  2023; 51 :D587–D592.36300620
70. Page  A.J., Cummins  C.A., Hunt  M., Wong  V.K., Reuter  S., Holden  M.T.G., Fookes  M., Falush  D., Keane  J.A., Parkhill  J.  Roary: rapid large-scale prokaryote pan genome analysis. Bioinformatics. 2015; 31 :3691–3693.26198102
71. Kim  G.B., Gao  Y., Palsson  B.O., Lee  S.Y.  DeepTFactor: A deep learning-based tool for the prediction of transcription factors. Proc. Natl. Acad. Sci. U.S.A.  2021; 118 :e2021171118.33372147
72. Buchfink  B., Reuter  K., Drost  H.-G.  Sensitive protein alignments at tree-of-life scale using DIAMOND. Nat. Methods. 2021; 18 :366–368.33828273
73. Alanjary  M., Steinke  K., Ziemert  N.  AutoMLST: an automated web server for generating multi-locus species trees highlighting natural product potential. Nucleic Acids Res.  2019; 47 :W276–W282.30997504
74. Letunic  I., Bork  P.  Interactive Tree Of Life (iTOL) v4: recent updates and new developments. Nucleic Acids Res.  2019; 47 :W256–W259.30931475
75. Terlouw  B.R., Blin  K., Navarro-Muñoz  J.C., Avalon  N.E., Chevrette  M.G., Egbert  S., Lee  S., Meijer  D., Recchia  M.J.J., Reitz  Z.L.  et al .  MIBiG 3.0: A community-driven effort to annotate experimentally validated biosynthetic gene clusters. Nucleic Acids Res.  2022; 51 :gkac1049.
76. Carroll  L.M., Larralde  M., Fleck  J.S., Ponnudurai  R., Milanese  A., Cappio  E., Zeller  G.  Accurate de novo identification of biosynthetic gene clusters with GECCO. 2021; bioRxiv doi: 04 May 2021, preprint: not peer reviewed 10.1101/2021.05.03.442509.
77. Caicedo-Montoya  C., Manzo-Ruiz  M., Ríos-Estepa  R.  Pan-genome of the genus Streptomyces and prioritization of biosynthetic gene clusters with potential to produce antibiotic compounds. Front. Microbiol.  2021; 12 :677558.34659136
78. Otani  H., Udwary  D.W., Mouncey  N.J.  Comparative and pangenomic analysis of the genus Streptomyces. Sci. Rep.  2022; 12 :18909.36344558
79. Letzel  A.-C., Li  J., Amos  G.C.A., Millán-Aguiñaga  N., Ginigini  J., Abdelmohsen  U.R., Gaudêncio  S.P., Ziemert  N., Moore  B.S., Jensen  P.R.  Genomic insights into specialized metabolism in the marine actinomycete Salinispora. Environ. Microbiol.  2017; 19 :3660–3673.28752948
80. Sayed  A.M., Abdel-Wahab  N.M., Hassan  H.M., Abdelmohsen  U.R.  Saccharopolyspora: an underexplored source for bioactive natural products. J. Appl. Microbiol.  2020; 128 :314–329.31230389
81. Ma  D., Liu  S., Liu  H., Nan  M., Xu  Y., Han  X., Mao  J.  Developing an innovative raw wheat Qu inoculated with Saccharopolyspora and its application in Huangjiu. J. Sci. Food Agric.  2022; 102 :7301–7312.35757866
82. Garrod  L.P.  The erythromycin group of antibiotics. Br. Med. J.  1957; 2 :57–63.13436854
83. Kirst  H.A., Michel  K.H., Martin  J.W., Creemer  L.C., Chio  E.H., Yao  R.C., Nakatsukasa  W.M., Boeck  L.D., Occolowitz  J.L., Paschal  J.W.  et al .  A83543A-D, unique fermentation-derived tetracyclic macrolides. Tetrahedron Lett.  1991; 32 :4839–4842.
84. Sparks  T.C., Crouse  G.D., Durst  G.  Natural products as insecticides: the biology, biochemistry and quantitative structure–activity relationships of spinosyns and spinosoids. Pest Manag. Sci.  2001; 57 :896–905.11695182
85. Saygin  H., Ay  H., Guven  K., Inan-Bektas  K., Cetin  D., Sahin  N.  Saccharopolyspora karakumensis sp. nov., Saccharopolyspora elongata sp. nov., Saccharopolyspora aridisoli sp. nov., Saccharopolyspora terrae sp. nov. and their biotechnological potential revealed by genome analysis. Syst. Appl. Microbiol.  2021; 44 :126270.34653842
86. Lacey  J., Goodfellow  M., Lacy  J., Goodfellow  M.  A novel actinomycete from sugar-cane bagasse: Saccharopolyspora hirsuta gen. et. sp. nov. J. Gen. Microbiol.  1975; 88 :75–85.1097584
87. Reimer  L.C., Sardà Carbasse  J., Koblitz  J., Ebeling  C., Podstawka  A., Overmann  J.  BacDive in 2022: the knowledge base for standardized bacterial and archaeal data. Nucleic Acids Res.  2022; 50 :D741–D746.34718743
88. Goodfellow  M., Lacey  J., Athalye  M., Embley  T.M., Bowen  T.  Saccharopolyspora gregorii and Saccharopolyspora hordei: two new Actinomycete species from fodder. Microbiology. 1989; 135 :2125–2139.
89. Intra  B., Euanorasetr  J., Také  A., Inahashi  Y., Mori  M., Panbangred  W., Matsumoto  A.  Saccharopolyspora rhizosphaerae sp. nov., an actinomycete isolated from rhizosphere soil in Thailand. Int. J. Syst. Evol. Microbiol.  2019; 69 :1299–1305.30789325
90. Dale  S.E., Doherty-Kirby  A., Lajoie  G., Heinrichs  D.E.  Role of siderophore biosynthesis in virulence of Staphylococcus aureus: identification and characterization of genes involved in production of a siderophore. Infect. Immun.  2004; 72 :29–37.14688077
91. Cheung  J., Beasley  F.C., Liu  S., Lajoie  G.A., Heinrichs  D.E.  Molecular characterization of staphyloferrin B biosynthesis in Staphylococcus aureus. Mol. Microbiol.  2009; 74 :594–608.19775248
92. Booth  T.J., Shaw  S., Weber  T.  getphylo: rapid and automatic generation of multi-locus phylogenetic trees. 2023; bioRxiv doi: 31 July 2023, preprint: not peer reviewed 10.1101/2023.07.26.550493.
93. Bhatt  G., Denny  T.P.  Ralstonia solanacearum iron scavenging by the siderophore staphyloferrin B is controlled by PhcA, the global virulence regulator. J. Bacteriol.  2004; 186 :7896–7904.15547261
94. Repka  L.M., Chekan  J.R., Nair  S.K., van der Donk  W.A.  Mechanistic Understanding of Lanthipeptide Biosynthetic Enzymes. Chem. Rev.  2017; 117 :5457–5520.28135077
95. Xu  M., Zhang  F., Cheng  Z., Bashiri  G., Wang  J., Hong  J., Wang  Y., Xu  L., Chen  X., Huang  S.-X.  et al .  Functional genome mining reveals a class V lanthipeptide containing a d-amino acid introduced by an F420 H2 -dependent reductase. Angew. Chem. Int. Ed Engl.  2020; 59 :18029–18035.32648341
96. Völler  G.H., Krawczyk  J.M., Pesic  A., Krawczyk  B., Nachtigall  J., Süssmuth  R.D.  Characterization of new class III lantibiotics–erythreapeptin, avermipeptin and griseopeptin from Saccharopolyspora erythraea, Streptomyces avermitilis and Streptomyces griseus demonstrates stepwise N-terminal leader processing. ChemBioChem. 2012; 13 :1174–1183.22556031
97. Ayikpoe  R., Govindarajan  V., Latham  J.A.  Occurrence, function, and biosynthesis of mycofactocin. Appl. Microbiol. Biotechnol.  2019; 103 :2903–2912.30778644
98. Ellerhorst  M., Barth  S.A., Graça  A.P., Al-Jammal  W.K., Peña-Ortiz  L., Vilotijevic  I., Lackner  G.  S-Adenosylmethionine (SAM)-dependent methyltransferase MftM is responsible for methylation of the redox cofactor mycofactocin. ACS Chem. Biol.  2022; 17 :3207–3217.36288793
99. Hudson  G.A., Burkhart  B.J., DiCaprio  A.J., Schwalen  C.J., Kille  B., Pogorelov  T.V., Mitchell  D.A.  Bioinformatic mapping of radical S-adenosylmethionine-dependent ribosomally synthesized and post-translationally modified peptides identifies new Cα, Cβ, and Cγ-linked thioether-containing peptides. J. Am. Chem. Soc.  2019; 141 :8228–8238.31059252
100. Peña-Ortiz  L., Graça  A.P., Guo  H., Braga  D., Köllner  T.G., Regestein  L., Beemelmanns  C., Lackner  G.  Structure elucidation of the redox cofactor mycofactocin reveals oligo-glycosylation by MftF. Chem. Sci.  2020; 11 :5182–5190.33014324
101. Baltz  R.H.  Genome mining for drug discovery: progress at the front end. J. Ind. Microbiol. Biotechnol.  2021; 48 :kuab044.34279640
102. Blin  K., Shaw  S., Kautsar  S.A., Medema  M.H., Weber  T.  The antiSMASH database version 3: increased taxonomic coverage and new query features for modular enzymes. Nucleic Acids Res.  2021; 49 :D639–D643.33152079
103. Ziemert  N., Lechner  A., Wietz  M., Millán-Aguiñaga  N., Chavarria  K.L., Jensen  P.R.  Diversity and evolution of secondary metabolism in the marine actinomycete genus Salinispora. Proc. Natl. Acad. Sci. U.S.A.  2014; 111 :E1130–E1139.24616526
104. Cimermancic  P., Medema  M.H., Claesen  J., Kurita  K., Wieland Brown  L.C., Mavrommatis  K., Pati  A., Godfrey  P.A., Koehrsen  M., Clardy  J.  et al .  Insights into secondary metabolism from a global analysis of prokaryotic biosynthetic gene clusters. Cell. 2014; 158 :412–421.25036635
105. Doroghazi  J.R., Albright  J.C., Goering  A.W., Ju  K.-S., Haines  R.R., Tchalukov  K.A., Labeda  D.P., Kelleher  N.L., Metcalf  W.W.  A roadmap for natural product discovery based on large-scale genomics and metabolomics. Nat. Chem. Biol.  2014; 10 :963–968.25262415
106. Medema  M.H., Fischbach  M.A.  Computational approaches to natural product discovery. Nat. Chem. Biol.  2015; 11 :639–648.26284671
107. Blin  K., Shaw  S., Steinke  K., Villebro  R., Ziemert  N., Lee  S.Y., Medema  M.H., Weber  T.  antiSMASH 5.0: updates to the secondary metabolite genome mining pipeline. Nucleic Acids Res.  2019; 47 :W81–W87.31032519
