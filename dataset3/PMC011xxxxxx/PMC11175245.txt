
==== Front
Sensors (Basel)
Sensors (Basel)
sensors
Sensors (Basel, Switzerland)
1424-8220
MDPI

10.3390/s24113540
sensors-24-03540
Article
Bearing-Fault-Feature Enhancement and Diagnosis Based on Coarse-Grained Lattice Features
Li Xiaoyu Conceptualization Methodology Writing – original draft Visualization 1
https://orcid.org/0000-0001-9928-5242
Jia Baozhu Methodology Supervision Funding acquisition 123
Liao Zhiqiang Conceptualization Visualization Funding acquisition 123*
Wang Xin Data curation 1
Oyadiji Olutunde Academic Editor
1 Naval Architecture and Shipping College, Guangdong Ocean University, Zhanjiang 524088, China; yuxiaoenn@163.com (X.L.); jiabzh@gdou.edu.cn (B.J.); wx2112005027@126.com (X.W.)
2 Technical Research Center for Ship Intelligence and Safety Engineering of Guangdong Province, Zhanjiang 524088, China
3 Guangdong Provincial Key Laboratory of Intelligent Equipment for South China Sea Marine Ranching, Guangdong Ocean University, Zhanjiang 524088, China
* Correspondence: zhiqiangliao@gdou.edu.cn
30 5 2024
6 2024
24 11 354026 4 2024
24 5 2024
28 5 2024
© 2024 by the authors.
2024
https://creativecommons.org/licenses/by/4.0/ Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https://creativecommons.org/licenses/by/4.0/).
In view of the frequent failures occurring in rolling bearings, the strong background noise present in signals, weak features, and difficulties associated with extracting fault characteristics, a method of enhancing and diagnosing rolling bearing faults based on coarse-grained lattice features (CGLFs) is proposed. First, the vibrational signals of bearings are subjected to adaptive filtering to eliminate background noise. Second, frequency-domain transformation is performed, and a coarse-grained approach is used to continuously segment the spectrum. Within each segment, amplitude-enhancement operations are executed, transforming the data into a CGLF graph that enhances fault characteristics. This graph is then fed into a Swin Transformer-based pattern-recognition network. Third and finally, a high-precision fault diagnosis model is constructed using fully connected layers and Softmax, enabling the diagnosis of bearing faults. The fault recognition accuracy reaches 98.30% and 98.50% with public datasets and laboratory data, respectively, thereby validating the feasibility and effectiveness of the proposed method. This research offers an efficient and feasible fault diagnosis approach for rolling bearings.

rolling bearings
fault diagnosis
coarse-grained lattice features
Swin Transformer
feature enhancement
National Natural Science Foundation of China52201355 52071090 Program for Scientific Research Start-Up Funds of Guangdong Ocean University060302132101 060302132304 Guangdong Ocean University Education Teaching Reform ProgramPX-972023229 Zhanjiang Non-funded Science and Technology Research Project2022B01049 2023B01046 This research work is supported by the National Natural Science Foundation of China (52201355, 52071090), the Program for Scientific Research Start-Up Funds of Guangdong Ocean University (060302132101, 060302132304), and the Guangdong Ocean University Education Teaching Reform Program (PX-972023229), Zhanjiang Non-funded Science and Technology Research Project (2022B01049, 2023B01046).
==== Body
pmc1. Introduction

Rolling bearings serve as crucial supporting components for rotary equipment, playing a pivotal role in ensuring its normal operation. Bearing failures, accounting for approximately 41% of failure rates, are among the most frequent issues encountered in rotary equipment. Such failures can incapacitate the equipment, resulting in significant economic losses and potentially even casualties. Consequently, monitoring equipment status and diagnosing faults are paramount [1,2]. The working environment of bearings is typically complex and variable, and they are influenced by factors such as background noise and alternating load impacts. Accordingly, the vibration signals collected often exhibit subtle fault characteristics amidst numerous forms of interference. This necessitates the enhancement of weak fault characteristics to effectively improve fault recognition accuracy [3].

The issue of enhancing weak fault features in rotating equipment’s rolling bearings has been studied by numerous scholars. Techniques such as time-domain, frequency-domain, and time–frequency analysis, as well as signal–modal decomposition and filtering methods, are extensively utilized for fault feature enhancement [4]. Early bearing-fault analyses are relatively straightforward, relying on time-domain statistical analysis, including root-mean-square values, moments, spectral envelope analysis, and cepstral analysis [5,6,7,8,9]. However, these methods often prove ineffective owing to noise and interference from various sources [10]. Some classical time–frequency signal enhancement methods possess unresolved inherent flaws, such as the limited adaptability of the short-time Fourier transform (STFT), which is unable to fully satisfy the Heisenberg uncertainty principle [11]. Other challenges include selecting wavelet transform basis functions [12] and modal confusion issues with empirical mode decomposition (EMD) [13]. Accordingly, researchers have developed variants of EMD, including local mean decomposition [14,15], intrinsic time-scale decomposition [16], and local feature-scale decomposition [17]. However, the application of these variants and the original EMD method may give rise to similar drawbacks, such as boundary effects, modal mixing, a lack of a mathematical theory, and computational inefficiency [18]. Filtering is an effective method for noise reduction and fault feature enhancement. For instance, Yu et al. [19] propose using the harmonic significance index to quantify fault information in frequency bands, thereby determining bandpass filter parameters. Ma et al. [20] also describe the use of frequency-slice wavelet transform to select frequency bands for early fault transient signals. Given that fault signal resonance frequencies and bandwidths can be arbitrary, these methods require the manual adjustment of bandwidths, making the selection of appropriate fault-filtering frequency bands crucial [21]. Spectral kurtosis (SK) can represent the smoothness of a signal waveform and reflect impact fault features. Wang et al. [22] further discuss the use of kurtosis and gear-meshing index to extract resonant frequency bands related to bearing and gear faults. Wang et al. [23] introduce a maximum-kurtosis spectral-entropy deconvolution-fault feature-enhancement algorithm, which has been successfully applied for gearbox fault diagnosis. Therefore, this paper adopts an adaptive SK for extracting fault-related central frequency bands.

Pattern recognition is a critical step in equipment diagnostics. Deep learning theory, with its ability to stack multiple layers and multi-structured information representation layers, demonstrates hierarchical information representation capabilities in data modeling processes. This has become a research hotspot in the field of fault diagnosis [24]. Jiachi et al. implement a Deep Transfer Convolutional Neural Network (DTCNN) to achieve an accurate estimation of lithium-ion battery capacity [25]. Hoang et al. [26] apply convolutional neural networks (CNNs) for pattern recognition, but the limited receptive field of CNNs’ convolutional kernels leads to suboptimal diagnostic results. A vision transformer (ViT)-based local perception transformer fault diagnosis model is also proposed in the literature [27]. It overcomes the aforementioned CNN issues but neglects the correlation between local features. To address these issues, this paper uses a pattern-recognition method based on Swin Transformer. Swin Transformer integrates the hierarchical architecture of CNNs with the global self-attention mechanism of ViT, dividing the image into multiple windows to compute the self-attention within each window, thereby reducing computational load. It also uses a shifting window operation to enable information exchange between windows, thereby capturing global image information and effectively achieving multi-scale feature extraction and recognition [28].

To address the aforementioned situation, this paper proposes a feature enhancement and diagnosis method based on coarse-grained lattice features (CGLFs) which leverages the advantages of Swin Transformer in feature extraction and recognition. Vibration signals from bearings under various states are collected and labeled with state tags and then divided into training, validation, and test sets. The original signals undergo adaptive bandpass filtering to eliminate background noise, followed by fast Fourier transformation (FFT) for frequency-domain transformation to obtain spectra. The spectra are then continuously segmented using a coarse-grained method, with amplitude enhancement operations performed within each segment, transforming them into CGLF graphs with enhanced fault characteristics. These graphs are inputted into the Swin Transformer pattern-recognition network. Finally, a high-precision fault diagnosis model is established through fully connected layers and Softmax, facilitating bearing-fault diagnosis. The proposed method is validated on public datasets and laboratory data, confirming its feasibility and effectiveness.

2. Theoretical Background

2.1. Adaptive Bandpass Filtering

When local damage occurs in a bearing, high-frequency vibrations are excited owing to the impacts between components during loaded operation [29]. Filtering methods are effective for studying impact frequencies. Traditional bandpass filters require engineers to repeatedly adjust filter parameters, affecting diagnostic efficiency [30]. Accordingly, this paper adopts an adaptive filtering method based on SK.

Wang et al. [31] define SK based on Wold–Crammer decomposition, which describes any random non-stationary process as the output of a causal, linear, and time-varying system, i.e., (1) x(n)=∫−1212H(n,f)ej2π/ndZx(f)

In the equation, dZx(f) is the standard orthogonal spectral increment, and H(n,f) is the complex envelope of x(n) at frequency f [32].

In SK, Kx(f) is defined as the fourth-order normalized cumulant:(2) Kx(f)=H(n,f)4H(n,f)22−2

The equation shows that the kurtosis value of a stationary process is a constant function of frequency, and the kurtosis value of a Gaussian process is zero. The frequency band dominated by transient impact signals has a larger SK, whereas the frequency band dominated by stationary Gaussian noise has a smaller one. Therefore, the frequency band of transient impact signals can be identified by the magnitude of the kurtosis value [33]. Consequently, the frequency band of the bandpass filter is determined by the size of the kurtosis value and changes with it, thereby achieving adaptive determination of the central frequency band.

2.2. CGLF Principle

CGLF is a feature-enhancement fusion method based on spectral analysis. It can effectively extract fault features under strong background noise. It is simple in structure and has high computational efficiency. First, FFT is used to transform the signal from the time domain to the frequency domain to obtain the spectrum.

Step 1: A coarse-grained sampling coefficient is set, and the spectrum is segmented into continuous j segments, with amplitude and enhancement operations performed within each segment. The specific calculation process is as follows:(3) j=fix(r/d)

(4) Fcn(j)=sum(Fc((j−1)×d+1:j×d))

Here, d is the coarse-grained sampling coefficient, r is the spectral width, fix() represents a function that performs downward rounding, and Fcn represents the corresponding amplitude value.

Step 2: Based on the number of new features, we set the feature value range (S = j) and adjust the magnitude of each feature accordingly within the range (S). (5) Fcm(j)=fix((Fcn(j)−Fcnmin)×SFcnmax−Fcnmin)

Here, Fcm() denotes the final feature values, Fcnmin is the minimum feature value, and Fcnmax is the maximum feature value.

2.3. Evaluation Metrics for Diagnostic Models

The model performance is evaluated using four parameters: Accuracy (Acc), Precision (P), Recall (R), and F1 Score. Accuracy represents the ratio of correctly predicted samples to the total number of samples. Precision indicates the proportion of true positive samples among those predicted as positive by the model, reflecting the accuracy of the predictions. Recall represents the proportion of true positive samples correctly identified by the model, indicating the model’s ability to recognize positive samples. The F1 Score is the harmonic mean of Precision and Recall, used for a comprehensive evaluation of the model’s performance, especially in cases of imbalanced data. (6) Acc=TP+TNTP+TN+FP+FN×100%

(7) P=TPTP+FP×100%

(8) R=TPTP+FN×100%

(9) F1=2P∗RP+R×100%

In Equations (6)–(9), TP represents the number of true positive samples, TN denotes the number of true negative samples, FP indicates the number of false positive samples, and FN signifies the number of false negative samples.

2.4. Swin Transformer

Swin Transformer (Figure 1), improved by incorporating the ViT and CNN models, shows potential beyond classic CNNs in image processing and pattern-recognition tasks [34,35]. Swin Transformer blocks comprise a Window Multi-head Self-Attention (W-MSA) module and a Shifted Windows Multi-Head Self-Attention (SW-MSA) module, followed by two Multilayer Perceptrons (MLPs). They are connected through a GELU activation function to enhance the nonlinear capabilities of the entire network. Before W-MSA, SW-MSA, and MLP, a normalization layer (LN) exists, and each module is followed by a residual connection to improve the fitting ability of the entire network structure. The flow of the entire Swin Transformer algorithm is as follows: A three-channel RGB image signal is used as input, and the original image is cut into non-overlapping patches through a patch partition operation, resulting in 4 × 4 patches. After flattening the patches, features with the shape (H/4, W/4, 48) are obtained. These features are then inputted into a linear embedding layer for dimensionality reduction, yielding a feature block with the shape (H/4, W/4, C). This feature block serves as input to the Swin Transformer module for feature extraction. After completing a Stage operation, the image size is halved, and the channel number is doubled through a patch-merging operation. The output features after each Stage are (H/8, W/8, 2C), (H/16, W/16, 4C), and (H/32, W/32, 8C), respectively. Finally, image feature recognition classification is achieved through a fully connected layer and Softmax.

3. Fault Diagnosis Process

The fault diagnosis process proposed in this paper based on CGLF is described as follows: Vibration signals of bearings under different states are collected, labeled with status tags, and divided into training, validation, and test sets. The vibration signals are subjected to adaptive bandpass filtering, followed by frequency-domain transformation to obtain the spectrum. The spectrum is then segmented continuously using the coarse-graining method to transform it into a CGLF graph with enhanced fault characteristics. This graph is inputted into the Swin Transformer pattern-recognition network. Finally, a high-precision fault diagnosis model is established through fully connected layers and Softmax, achieving fault diagnosis of the bearings. The flowchart of the process is shown in Figure 2. The pseudocode for calculating the CGLFs is shown in Algorithm 1. Algorithm 1. Pseudocode for CGLF	
Input: The collected vibration signal data
Output: Plots of CGLF
1: Load the data
2: Extract data from the struct
3: Set sampling_rate
4: Compute the FFT of the extracted data
5: Get the length of the data
6: Compute frequency bins
7: Select frequency indices within the specified range
8: Extract corresponding FFT values
9: Extract corresponding frequencies
10: Compute absolute values of the selected FFT values
11: Set coarse sampling factor: d
12: Compute spectrum length: r
13: j = floor(r/d)
14: For e from 1 to j:
15:  av = (e − 1) × d + 1
16:  bv = e × d
17:  xa = abs_fft(a:b)
18:  k = sum(xa)
19:  kv (e) = k
20:  y = min(kv)
21:  z = max(kv)
22:  cg = floor((k − y)/(z − y) × j)
23:  cg_v (e) = cg
24: end for
25: For e from 1 to j:
26:  Scatter plot cg_v for the current segment
27:  hold on
28: end for	

The major steps are as follows:

Step 1: Vibration signals of the rolling bearings are collected, and fixed-length time series under different states are extracted. Then, they are numbered and divided into training, validation, and test sets according to proportion.

Step 2: The fault feature frequency band is determined through an adaptive bandpass filter, and then FFT transformation is performed. We set a coarse-graining coefficient and use the coarse-graining method to continuously segment the spectrum, converting it into a CGLF graph with enhanced fault characteristics.

Step 3: A Swin Transformer network is constructed, and the relevant parameters are set. After inputting the training set into the network in batches for hyperparameter training, the trained network model is saved.

Step 4: The test set is inputted to validate the trained model and identify the bearing status.

4. Experimental Verification and Analysis

4.1. Public Dataset Validation

The feasibility of the method proposed in this paper is verified using experimental data from the bearing-fault experiment platform of the Electrical Laboratory at Case Western Reserve University (CWRU). The experimental platform comprises a motor, torque sensor, dynamometer, and electronic controller (Figure 3). The drive-end bearing model is a 6205-2RS deep-groove ball bearing, and the bearing vibration signals are collected using an accelerometer. The bearing faults are induced by electro-spark single-point damage. The experiment is conducted with a rotation speed of 1750 rpm, a load of 2 HP, a sampling frequency of 12 kHz, a sampling time of 0.682 s, and 8192 sampling points. A total of 10 types of data are selected for four states: rolling element faults, outer ring faults, inner ring faults, and normal bearings. The specific experimental data are presented in Table 1, including data for fault sizes of 7 mils, 14 mils, and 21 mils.

The adaptive SK method is used to process the CWRU laboratory’s fault-bearing data, and the results are shown in Figure 4, which shows the SK graphs of the vibration signals for the rolling element faults, outer ring and inner ring faults, and normal bearings, as well as the corresponding original signals and filtered spectra.

Figure 4 further shows that the highest kurtosis values of the vibration signals for the rolling element faults, outer ring faults, inner ring faults, and normal bearings are located at the center frequencies of 2.81, 3.0, 3.5, and 0.84 kHz, respectively. The bandwidths where the potential fault information is located are 0.37, 2.0, 1.0, and 0.19 kHz, respectively. Considering the above, a signal segment with a bandwidth of 2 kHz centered at the center frequency is selected for analysis and processing. A coarse-graining sampling coefficient of 12 is set, and the coarse-grained lattice feature values within the bandwidth are calculated, resulting in 113 feature values. They are then transformed into a CGLF graph (Figure 5).

Figure 5 shows that CGLF can reduce the impact of noise and enhance the fault impact components, demonstrating a significant data feature enhancement and fusion effect. The Swin Transformer network is constructed, and the input network parameters are set as follows: the input image is adjusted to 224 × 224, the batch processing size is 16, the learning rate is 1 × 10−3, the weight decay is 1 × 10−5, the number of iterations is 50, the number of classification categories is 10, the optimizer is stochastic gradient descent, and the loss function is the cross-entropy loss function. The experimental results are extracted from the training logs and analyzed visually, as shown in Figure 6, Figure 7 and Figure 8.

Figure 6 and Figure 7 indicate that the method proposed in this paper has good fault-state-identification performance. The training curve accuracy gradually increases, reaching 100% around the 45th iteration, and the validation set accuracy reaches 97.99%. The optimal model is loaded, and the test set accuracy reaches 98.30%. In terms of stability, the accuracy and loss curves are generally stable, indicating superior stability and small training fluctuations. An analysis of Figure 8 reveals that the model proposed in this paper also demonstrates satisfactory performance in distinguishing between similar, easily confused types and faults of varying degrees. In general, the method proposed in this paper exhibits excellent performance in terms of identification accuracy, convergence, stability, and classification of faults with different severities, thereby validating the feasibility and effectiveness of the proposed approach.

4.2. Experimental Test Validation

The practical performance of the model built in this paper is further validated on a bearing-fault test bench (Figure 9). The fault bearing used in this test bench is a 6304 deep-groove ball bearing (parameters shown in Table 2), with a rotation speed of 1200 rpm, a sampling frequency of 16,384 Hz, and a 0 HP load condition. Vibration signals are obtained through a ZD-518 radial acceleration sensor (100 mv/g), and the test data include 100 samples each for outer ring faults, inner ring faults, rolling element faults, composite faults, and normal conditions. Each sample has 8192 sampling points, divided into training, validation, and test sets in a 3:1:1 ratio (Table 3).

The adaptive SK method is used to process the laboratory fault-bearing data, and the results are shown in Figure 10. Figure 10 shows the SK graphs of the vibration signals for the rolling element, outer ring, inner ring, and composite faults and normal bearings, as well as the corresponding original signals and filtered spectra.

Analyzing the SK graphs of rolling element faults, outer ring faults, inner ring faults, composite faults, and normal bearing vibration signals in Figure 10, the center frequencies are found to be 4.43, 1.024, 1.02, 4.60, and 3.92 kHz, respectively. The fault impact signals are concentrated in bandwidths of 0.68, 0.68, 0.68, 1.02, and 0.34 kHz, respectively. Considering the above, a signal segment with a bandwidth of 2 kHz centered at the center frequency is selected for analysis and processing. A coarse-graining sampling coefficient of 12 is set, and the coarse-grained lattice feature values within the bandwidth are calculated. This results in 83 feature values, which are transformed into a CGLF graph (Figure 11).

Figure 11 shows that CGLF can reduce the impact of noise and enhance the fault impact components, demonstrating a significant data feature enhancement and fusion effect. The Swin Transformer network is initialized, and the input network parameters are set as follows: the input image is adjusted to 224 × 224, the batch processing size is 16, the learning rate is 1 × 10−3, the weight decay is 1 × 10−5, the number of iterations is 50, the number of classification categories is 5, the optimizer is stochastic gradient descent, and the loss function is the cross-entropy loss function. The experimental results are extracted from the training logs and analyzed visually, as shown in Figure 12, Figure 13 and Figure 14.

Figure 12 indicates that the method proposed in this paper has good fault-state-identification performance. The training set accuracy steadily increases, reaching 100% at around the 42nd iteration. The validation set accuracy reaches 97.91%. The optimal model is loaded, and the test set accuracy reaches 98.50%, further proving the good stability and scalability of the proposed method. Figure 13 shows that the loss values of the training and validation set steadily decrease and converge, indicating the good generalization ability of the proposed method. An analysis of Figure 14 shows that the proposed method also performs well in distinguishing between similar faults and faults with different degrees of severity. In summary, the method exhibits good stability and scalability, excellent generalization performance, and superior performance in classifying similar and different degrees of faults, confirming its feasibility and effectiveness.

4.3. Comparative Experiment

To further validate the diagnostic effectiveness of the proposed method, it is compared and analyzed with some existing research results. (1) The S-CNN method first obtains the time–frequency diagram of the original data of the bearings through S-transform and then extracts the features through CNN for fault classification [36]. (2) The STFT-sparse autoencoder (SAE) method obtains the time–frequency diagram of the original vibration signal through STFT, uses a stacked SAE network to extract fault features, and realizes fault classification through softmax regression [37]. (3) The original voltage signals are proposed to be converted into grayscale images using empirical wavelet transform (EWT), and the proposed deep CNN model is applied to classify the EWT grayscale images for fault diagnosis [38]. (4) Wavelet transform is used to decompose and reconstruct the signals, which are then used as inputs for the back propagation neural network (BPNN) for decision making and classification [39]. To ensure the comparability of the results, the above algorithms use the public bearing dataset from CWRU and the laboratory-collected dataset, with specific results shown in Table 4.

4.4. Analysis of Test Results

The experimental results on the CWRU public dataset and laboratory data indicate that the proposed method performs well in terms of Accuracy, Precision, Recall, and F1 Score, surpassing other methods, as shown in Table 4. Specifically, on the public dataset, the proposed method achieved an Accuracy of 98.30%, a Precision of 99.0%, an F1 Score of 98.7%, and a Recall of 98.4%. On the laboratory dataset, it achieved an Accuracy of 98.50%, a Precision of 99.2%, an F1 Score of 98.9%, and a Recall of 98.6%. These comparative experiments further demonstrate that the proposed method effectively enhances the integration of fault features, improves the distinction between fault types, and provides better generalization performance and stability, thereby achieving efficient intelligent fault diagnosis for rolling bearings.

5. Conclusions

This paper proposes a feature enhancement and diagnosis method based on CGLF and validates it using the CWRU public dataset and laboratory data. The results indicate that the proposed method can effectively achieve intelligent fault diagnosis for rolling bearings. The method is computationally simple, simplifying the feature extraction process and reducing computational complexity through spectrum segmentation and amplitude enhancement. Adaptive bandpass filtering automatically determines the frequency band range, reducing human intervention and randomness, thereby improving the reliability of the results. The method demonstrates superior generalization and stability across different datasets, excelling at classifying similar faults and faults with varying degrees of severity, confirming its feasibility and effectiveness in practical applications. In summary, the proposed method is computationally simple, is low in randomness, and exhibits good generalization and stability, providing significant theoretical and practical value for the safe and stable operation of rolling bearings.

Author Contributions

Conceptualization, X.L. and Z.L.; Methodology, X.L. and. B.J.; Data curation, X.W.; Writing—original draft, X.L.; Visualization, X.L. and Z.L.; Supervision, B.J.; Funding acquisition, Z.L. and B.J. All authors have read and agreed to the published version of the manuscript.

Institutional Review Board Statement

Not applicable.

Informed Consent Statement

Not applicable.

Data Availability Statement

This data comes from the public data set of Case Western Reserve University, and the link is https://engineering.case.edu/bearingdatacenter/apparatus-and-procedures (accessed on 12 July 2023).

Conflicts of Interest

The authors declare no conflicts of interest.

Figure 1 The architecture of Swin Transformer.

Figure 2 Flowchart of rolling-bearing = fault diagnosis.

Figure 3 CWRU bearing-fault experiment platform.

Figure 4 SK graphs of bearings in four conditions and spectral diagrams before and after filtering. (a) SK graph (Ball fault). (b) Frequency domain (Before and after ball fault filtering). (c) SK graph (Outer ring fault). (d) Frequency domain (Before and after outer fault filtering). (e) SK graph (Inner ring fault). (f) Frequency domain (Before and after inner fault filtering). (g) SK graph (Normal bearing). (h) Frequency domain (Before and after normal bearing filtering).

Figure 5 CGLF graph for four bearing states. (a) Ball fault. (b) Outer ring fault. (c) Inner ring fault. (d) Normal bearing.

Figure 6 Accuracy curves for the training and validation sets.

Figure 7 Loss curves of the training and validation sets for the public dataset.

Figure 8 Confusion matrix for the test sets.

Figure 9 Bearing-fault test bench.

Figure 10 SK graphs of bearings in five conditions and spectral diagrams before and after filtering. (a) SK graph (Ball fault). (b) Frequency domain (Before and after ball fault filtering). (c) SK graph (Outer ring fault). (d) Frequency domain (Before and after outer fault filtering). (e) SK graph (Inner ring fault). (f) Frequency domain (Before and after inner fault filtering). (g) SK graph (composite fault). (h) Frequency domain (Before and after composite fault filtering). (i) SK graph (Normal bearing). (j) Frequency domain (Before and after normal bearing filtering).

Figure 11 CGLF graph for five bearing states. (a) Ball fault. (b) Outer race fault. (c) Inner race fault. (d) Composite fault. (e) Normal bearing.

Figure 12 Accuracy curves for the training and validation set.

Figure 13 Loss curves of the training and validation sets for Bearing-fault test bench data.

Figure 14 Confusion matrix for the test set.

sensors-24-03540-t001_Table 1 Table 1 CWRU bearing-fault experiment platform data.

Sample Type	Fault Diameter/Mils	Label	Training Set	Validation Set	Test Set	
Normal bearing	0	0	60	20	20	
Inner ring fault	7/14/21	1/2/3	60/60/60	20/20/20	20/20/20	
Ball fault	7/14/21	4/5/6	60/60/60	20/20/20	20/20/20	
Outer ring fault	7/14/21	7/8/9	60/60/60	20/20/20	20/20/20	

sensors-24-03540-t002_Table 2 Table 2 Bearing parameters.

Component	Value	
Bore diameter	0.787 in	
Outside diameter	2.047 in	
Width	0.591 in	

sensors-24-03540-t003_Table 3 Table 3 Bearing-fault test bench data.

Sample Type	Training/Validation/Test Set	Label	
Normal bearing	60/20/20	0	
Inner ring fault	60/20/20	1	
Ball fault	60/20/20	2	
Outer ring fault	60/20/20	3	
Combination fault	60/20/20	4	

sensors-24-03540-t004_Table 4 Table 4 Comparison of different diagnostic methods.

Model	Dataset Types	Accuracy	Precision	F1 Score	Recall	
S-CNN	CWRU dataset	92.10	89.83	86.4	83.2	
CGLF-Swin Transformer	CWRU dataset	98.30	99.0	98.7	98.4	
CGLF-CNN	CWRU dataset	94.13	95.3	92.1	89.0	
S-Swin Transformer	CWRU dataset	96.20	92.4	91.2	90.0	
STFT-SAE	CWRU dataset	93.45	89.5	87.5	85.5	
EWT-CNN	CWRU dataset	91.31	92.42	91.31	91.86	
WT-BP	CWRU dataset	87.25	85.45	87.25	86.34	
S-CNN	Laboratory dataset	86.67	77.6	76.4	75.2	
CGLF-Swin Transformer	Laboratory dataset	98.50	99.2	98.9	98.6	
CGLF-CNN	Laboratory dataset	93.50	94.2	88.4	83.2	
S-Swin Transformer	Laboratory dataset	92.82	93.3	89.1	85.2	
STFT-SAE	Laboratory dataset	87.00	78.6	77.3	76.0	
EWT-CNN	Laboratory dataset	88.32	85.12	88.32	86.69	
WT-BP	Laboratory dataset	84.42	81.45	84.42	82.91	

Disclaimer/Publisher’s Note: The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.
==== Refs
References

1. Ren B. Yang M. Chai N. Li Y. Xu D. Fault Diagnosis of Motor Bearing Based on Speed Signal Kurtosis Spectrum Analysis Proceedings of the 2019 22nd International Conference on Electrical Machines and Systems (ICEMS) Harbin, China 11–14 August 2019 IEEE Harbin, China 2019 1 6
2. Ke Z. Di C. Bao X. Adaptive Suppression of Mode Mixing in CEEMD Based on Genetic Algorithm for Motor Bearing Fault Diagnosis IEEE Trans. Magn. 2022 58 8200706 10.1109/TMAG.2021.3082138
3. Deng W. Zhang S. Zhao H. Yang X. A Novel Fault Diagnosis Method Based on Integrating Empirical Wavelet Transform and Fuzzy Entropy for Motor Bearing IEEE Access 2018 6 35042 35056 10.1109/ACCESS.2018.2834540
4. Liao Z. Song X. Jia B. Chen P. Bearing Fault Feature Enhancement and Diagnosis Based on Statistical Filtering and 1.5-Dimensional Symmetric Difference Analytic Energy Spectrum IEEE Sens. J. 2021 21 9959 9968 10.1109/JSEN.2021.3054502
5. Kan M.S. Tan A.C.C. Mathew J. A Review on Prognostic Techniques for Non-Stationary and Non-Linear Rotating Systems Mech. Syst. Signal Process. 2015 62–63 1 20 10.1016/j.ymssp.2015.02.016
6. El-Thalji I. Jantunen E. A Summary of Fault Modelling and Predictive Health Monitoring of Rolling Element Bearings Mech. Syst. Signal Process. 2015 60–61 252 272 10.1016/j.ymssp.2015.02.008
7. Yan R. Gao R.X. Chen X. Wavelets for Fault Diagnosis of Rotary Machines: A Review with Applications Signal Process. 2014 96 1 15 10.1016/j.sigpro.2013.04.015
8. Rai A. Upadhyay S.H. A Review on Signal Processing Techniques Utilized in the Fault Diagnosis of Rolling Element Bearings Tribol. Int. 2016 96 289 306 10.1016/j.triboint.2015.12.037
9. Wang Y. Xiang J. Markert R. Liang M. Spectral Kurtosis for Fault Detection, Diagnosis and Prognostics of Rotating Machines: A Review with Applications Mech. Syst. Signal Process. 2016 66–67 679 698 10.1016/j.ymssp.2015.04.039
10. Udmale S.S. Singh S.K. Application of Spectral Kurtosis and Improved Extreme Learning Machine for Bearing Fault Classification IEEE Trans. Instrum. Meas. 2019 68 4222 4233 10.1109/TIM.2018.2890329
11. Feng Z. Liang M. Chu F. Recent Advances in Time–Frequency Analysis Methods for Machinery Fault Diagnosis: A Review with Application Examples Mech. Syst. Signal Process. 2013 38 165 205 10.1016/j.ymssp.2013.01.017
12. Yu X. Liang Z. Wang Y. Yin H. Liu X. Yu W. Huang Y. A Wavelet Packet Transform-Based Deep Feature Transfer Learning Method for Bearing Fault Diagnosis under Different Working Conditions Measurement 2022 201 111597 10.1016/j.measurement.2022.111597
13. Liu X. Bo L. Luo H. Bearing Faults Diagnostics Based on Hybrid LS-SVM and EMD Method Measurement 2015 59 145 166 10.1016/j.measurement.2014.09.037
14. Cheng J. Yang Y. Yang Y. A Rotating Machinery Fault Diagnosis Method Based on Local Mean Decomposition Digit. Signal Process. 2012 22 356 366 10.1016/j.dsp.2011.09.008
15. Hu Y. Bao W. Tu X. Li F. Li K. An Adaptive Spectral Kurtosis Method and Its Application to Fault Detection of Rolling Element Bearings IEEE Trans. Instrum. Meas. 2020 69 739 750 10.1109/TIM.2019.2905022
16. Frei M.G. Osorio I. Intrinsic Time-Scale Decomposition: Time–Frequency–Energy Analysis and Real-Time Filtering of Non-Stationary Signals Proc. R. Soc. A Math. Phys. Eng. Sci. 2006 463 321 342 10.1098/rspa.2006.1761
17. Zheng J. Cheng J. Yang Y. A Rolling Bearing Fault Diagnosis Approach Based on LCD and Fuzzy Entropy Mech. Mach. Theory 2013 70 441 453 10.1016/j.mechmachtheory.2013.08.014
18. Zheng J. Pan H. Yang S. Cheng J. Adaptive Parameterless Empirical Wavelet Transform Based Time-Frequency Analysis Method and Its Application to Rotor Rubbing Fault Diagnosis Signal Process. 2017 130 305 314 10.1016/j.sigpro.2016.07.023
19. Yu K. Lin T.R. Tan J. Ma H. An Adaptive Sensitive Frequency Band Selection Method for Empirical Wavelet Transform and Its Application in Bearing Fault Diagnosis Measurement 2019 134 375 384 10.1016/j.measurement.2018.10.086
20. Ma P. Zhang H. Fan W. Wang C. Early Fault Diagnosis of Bearing Based on Frequency Band Extraction and Improved Tunable Q-Factor Wavelet Transform Measurement 2019 137 189 202 10.1016/j.measurement.2019.01.036
21. Guo W. An Optimal Band-Pass Filter Based on Adaptive Identification of Bearing Resonant Frequency Band Proceedings of the 2020 Asia-Pacific International Symposium on Advanced Reliability and Maintenance Modeling (APARM) Vancouver, BC, Canada 20–23 August 2020 IEEE Vancouver, BC, Canada 2020 1 7
22. Wang T. Chu F. Han Q. Kong Y. Compound Faults Detection in Gearbox via Meshing Resonance and Spectral Kurtosis Methods J. Sound Vib. 2017 392 367 381 10.1016/j.jsv.2016.12.041
23. Wang Z. Zhou J. Wang J. Du W. Wang J. Han X. He G. A Novel Fault Diagnosis Method of Gearbox Based on Maximum Kurtosis Spectral Entropy Deconvolution IEEE Access 2019 7 29520 29532 10.1109/ACCESS.2019.2900503
24. Sarker I.H. Deep Learning: A Comprehensive Overview on Techniques, Taxonomy, Applications and Research Directions SN Comput. Sci. 2021 2 420 10.1007/s42979-021-00815-1 34426802
25. Yao J. Han T. Data-Driven Lithium-Ion Batteries Capacity Estimation Based on Deep Transfer Learning Using Partial Segment of Charging/Discharging Data Energy 2023 271 127033 10.1016/j.energy.2023.127033
26. Hoang D.-T. Kang H.-J. Rolling Element Bearing Fault Diagnosis Using Convolutional Neural Network and Vibration Image Cogn. Syst. Res. 2019 53 42 50 10.1016/j.cogsys.2018.03.002
27. Sharma C. Kapil S.R. Chapman D. Person Re-Identification with a Locally Aware Transformer arXiv 2021 2106.03720
28. Liu Z. Lin Y. Cao Y. Hu H. Wei Y. Zhang Z. Lin S. Guo B. Swin Transformer: Hierarchical Vision Transformer Using Shifted Windows arXiv 2021 2103.14030
29. Li H. Liu T. Wu X. Chen Q. Application of Optimized Variational Mode Decomposition Based on Kurtosis and Resonance Frequency in Bearing Fault Feature Extraction Trans. Inst. Meas. Control 2020 42 518 527 10.1177/0142331219875348
30. Zhang S. Li L. Liu S. Li J. Truncation Filtering Method for Envelope Analysis Int. J. Adapt Control Signal Process 2019 33 475 492 10.1002/acs.2971
31. Wang H. Lai Z. Wu D. Zhang K. Zheng M. Investigation of the Friction-Induced Vibration of a Novel Four-Way Reversing Valve Using Spectral Kurtosis and Number of Peaks Spectrum Mech. Syst. Signal Process. 2022 166 108425 10.1016/j.ymssp.2021.108425
32. Ma Z. Li X. Liu S. Ge Y. Lu F. Envelope Demodulation Method Based on SET for Fault Diagnosis of Rolling Bearings under Variable Speed JAMDSM 2020 14 20 00345 10.1299/jamdsm.2020jamdsm0104
33. Wang L. Liu Z. Miao Q. Zhang X. Time–Frequency Analysis Based on Ensemble Local Mean Decomposition and Fast Kurtogram for Rotating Machinery Fault Diagnosis Mech. Syst. Signal Process. 2018 103 60 75 10.1016/j.ymssp.2017.09.042
34. Yang Z. Cen J. Liu X. Xiong J. Chen H. Research on Bearing Fault Diagnosis Method Based on Transformer Neural Network Meas. Sci. Technol. 2022 33 085111 10.1088/1361-6501/ac66c4
35. Tang X. Xu Z. Wang Z. A Novel Fault Diagnosis Method of Rolling Bearing Based on Integrated Vision Transformer Model Sensors 2022 22 3878 10.3390/s22103878 35632289
36. Qin Y. Shi X. Fault Diagnosis Method for Rolling Bearings Based on Two-Channel CNN under Unbalanced Datasets Appl. Sci. 2022 12 8474 10.3390/app12178474
37. Liu H. Li L. Ma J. Rolling Bearing Fault Diagnosis Based on STFT-Deep Learning and Sound Signals Shock. Vib. 2016 2016 6127479 10.1155/2016/6127479
38. Hsueh Y.-M. Ittangihal V.R. Wu W.-B. Chang H.-C. Kuo C.-C. Fault Diagnosis System for Induction Motors by CNN Using Empirical Wavelet Transform Symmetry 2019 11 1212 10.3390/sym11101212
39. Zhang J. Sun H. Sun Z. Dong W. Dong Y. Fault Diagnosis of Wind Turbine Power Converter Considering Wavelet Transform, Feature Analysis, Judgment and BP Neural Network IEEE Access 2019 7 179799 179809 10.1109/ACCESS.2019.2958409
