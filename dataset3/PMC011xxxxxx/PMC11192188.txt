
==== Front
Cyborg Bionic Syst
Cyborg Bionic Syst
CBSYSTEMS
Cyborg and Bionic Systems
2097-1087
2692-7632
AAAS

10.34133/cbsystems.0115
0115
Research Article
Adaptive Gait Training of a Lower Limb Rehabilitation Robot Based on Human–Robot Interaction Force Measurement
Yu Fuyang 1 2 3
Liu Yu 3 *
https://orcid.org/0000-0003-2338-5217
Wu Zhengxing 1 2 *
Tan Min 1 2
Yu Junzhi 2 4
1 School of Artificial Intelligence, University of Chinese Academy of Sciences, Beijing, China.
2 The Key Laboratory of Cognition and Decision Intelligence for Complex Systems, Institute of Automation, Chinese Academy of Sciences, Beijing, China.
3 School of Mechanical Engineering & Automation, Northeastern University, Shenyang, China.
4 State Key Laboratory for Turbulence and Complex System, Department of Advanced Manufacturing and Robotics, BIC-ESAT, College of Engineering, Peking University, Beijing, China.
* Address correspondence to: zhengxing.wu@ia.ac.cn (Z.W.); yuliu@me.neu.edu.cn (Y.L.)
21 6 2024
2024
5 011523 11 2023
22 3 2024
21 6 2024
Copyright © 2024 Fuyang Yu et al.
2024
Fuyang Yu et al.
https://creativecommons.org/licenses/by/4.0/ Exclusive licensee Beijing Institute of Technology Press. No claim to original U.S. Government Works. Distributed under a Creative Commons Attribution License 4.0 (CC BY 4.0).

The existing fixed gait lower limb rehabilitation robots perform a predetermined walking trajectory for patients, ignoring their residual muscle strength. To enhance patient participation and safety in training, this paper aims to develop a lower limb rehabilitation robot with adaptive gait training capability relying on human–robot interaction force measurement. Firstly, a novel lower limb rehabilitation robot system with several active and passive driven joints is developed, and 2 face-to-face mounted cantilever beam force sensors are employed to measure the human–robot interaction forces. Secondly, a dynamic model of the rehabilitation training robot is constructed to estimate the driven forces of the human lower leg in a completely passive state. Thereafter, based on the theoretical moment from the dynamics and the actual joint interaction force collected by the sensors, an adaptive gait adjustment method is proposed to achieve the goal of adapting to the wearer’s movement intention. Finally, interactive experiments are carried out to validate the effectiveness of the developed rehabilitation training robot system. The proposed rehabilitation training robot system with adaptive gaits offers great potential for future high-quality rehabilitation training, e.g., improving participation and safety.

National Natural Science Foundation of China http://dx.doi.org/10.13039/501100001809 62033013 Min Tan National Natural Science Foundation of China http://dx.doi.org/10.13039/501100001809 62022090 Zhengxing Wu Youth Innovation Promotion Association of the Chinese Academy of Sciences http://dx.doi.org/10.13039/501100004739 2019138 Zhengxing Wu
==== Body
pmcIntroduction

Due to population aging and various diseases, the number of individuals suffering from lower limb movement disorders gradually increases for the past few years. Traditional rehabilitation training is mainly assisted by medical and nursing professionals, whose effect is limited by the professional abilities and number of support personnel required. Besides, it is challenging to be applied in remote and underdeveloped areas, making it difficult to widely meet the training needs of people with movement disabilities. With the development of robotic technology, rehabilitation training robots have emerged and received increasing attention [1,2]. Many mature products have appeared on the market. For instance, Indego, a wearable lower limb exoskeleton, was developed by Parker Hannifin Corporation for walking rehabilitation training of patients with hemiplegia or spinal damage [3,4]. Ailegs robots, developed by Beijing Da Ai Robotics Co., Ltd., was capable of providing natural gait training to restore muscle movement and balance abilities in patients [5]. Auto LEE was developed as a self-balancing lower limb exoskeleton featuring 10 degrees of freedom [6,7]. Samsung unveiled the GEMS series exoskeleton [8], and Technaid introduced the third-generation robot Exo-H3 [9], boasting more intelligent mobile phone APP control functions. These advancements have effectively expanded the possibilities and accessibility of rehabilitation training for individuals with lower limb movement disorders.

For patients with lower limb movement disorders, their lower limb muscles are weak or unable to actively contract. Rehabilitation training robots can provide patients with auxiliary support and strength, helping to prevent muscle atrophy through repetitive walking and other exercises [10], and ultimately restore partial or complete muscle function. Early rehabilitation robots often use passive training control strategies, such as the Ekso GT exoskeleton robot developed by Ekso Corporation [11], which passively train patients through imitating human walking. Some exoskeleton robots such as Indego [3,4] are equipped with attitude sensors, which can change the passive motion state according to the moving posture. However, passive training methods cannot provide personalized training for patients, and the participation and comfort in recovery training varies from person to person.

In fact, most patients with lower limb movement disorders still retain some residual muscle strength, making complete passive training inefficient as it cannot fully utilize their residual muscle strength [12]. To enhance patient participation in rehabilitation training, exoskeleton robots should be able to sense the patient’s intentions and interact better with them during rehabilitation training. Some researchers have employed electromyographic (EMG) or electroencephalographic (EEG) signals to perceive patients’ motion intentions [13,14]. For instance, Sun et al. [15] utilized surface electromyography to predict knee joint motion intentions and adjust rehabilitation training movements in real time. Li et al. [16] presented an adjustment method for the stair climbing motion of rehabilitation exoskeletons by combining EMG and EEG. Gordleeva et al. [17] proposed a multichannel signal processing method combining EEG and EMG for rehabilitation robots. However, employing EEG and EMG signals requires high acquisition accuracy and stability, leading to complex acquisition equipments. In recent years, some neural-network-based methods have been proposed to process visual information [18,19] and other signals of rehabilitation robots, thus regulating gait phase, joint angle, and joint torque [20–24]. However, these methods often solely focus on predicting the robot’s posture and lack strong perception of the patient’s own motion intentions. Consequently, some studies have investigated human–robot interactions by employing position-based impedance control or force-based admittance control to achieve active motion modes [25,26]. However, in passive rehabilitation training, where the gait training trajectory remains fixed, active patient engagement is limited. To address this issue, it is crucial to dynamically fine-tune the passive gait throughout human–robot interactions. Xu et al. [27] integrated a dynamic movement primitive (DMP) coupled model into mirror therapy, managing the training trajectory of the affected leg via an impedance model, and further refined the coupled DMP model through reinforcement learning to enhance the adaptability to the gait trajectory. Meanwhile, Ma et al. [28] introduced an innovative online gait planning approach leveraging the finite state machine model, which dynamically identifies key gait points through a model based on the transfer of the center of gravity. Further, Xu et al. [29] enhanced the trajectory deformation algorithm and incorporated an auxiliary controller predicated on interaction torque estimation, culminating in improved gait adaptation. More commonly, numerous studies have integrated admittance control strategies within passive training trajectories, facilitating instantaneous gait adjustments. Zhu et al. [30–32] proposed a sliding mode admittance control method to track the position of the human body, enabling the lower limb rehabilitation robot to follow the legs more accurately. Wang et al. [33] applied an impedance control method based on forward dynamics to predict gait and achieved certain results in computer simulation. Unlike electromyography signals, direct measurement of interaction torque is simpler and more reliable. However, during compliance control, there is a tendency to overlook variations among patients and different stages of the gait cycle, resulting in inconsistent utilization of residual muscle force across individuals and movement stages.

Based on the aforementioned observations, this article presents an adaptive gait adjustment method for lower limb rehabilitation robots by introducing human leg dynamics within the framework of the admittance control approach. Combining the active and passive driven styles, a novel lower limb rehabilitation robot system is developed, whose hip and knee joints each have one active degree of freedom, while waist and ankle joints each have one passive degree of freedom. More importantly, 2 face-to-face mounted cantilever beam force sensors are employed to measure the human–robot interaction forces. Thereafter, based on the Lagrange method, a human–robot interaction dynamic model of the developed rehabilitation training robot system is constructed to estimate the driven force of the human leg in a completely passive state. Further, considering the human leg dynamics and residual muscle forces, an adaptive gait regulation method based on admittance control is proposed to realize real-time adaptive gait adjustment of the lower limb rehabilitation robot. Finally, practical interactive experiments are carried out to validate the effectiveness of the developed rehabilitation training robot system as well as the proposed control method, which effectively improves the safety and convenience of rehabilitation training.

The rest of this paper is organized as follows. Materials and Methods describes the mechatronic design of the rehabilitation training robot, proposes a dynamic model of human–robot interaction, and introduces the proposed admittance control method for the training gait. The experiments on human–robot interaction and gait adjustment are conducted in Results and Discussion. Finally, Conclusion summarizes this paper.

Materials and Methods

Robot structure and system design

Mechatronic design

The developed lower limb rehabilitation training robot is composed of a main robot body and an auxiliary support framework, as shown in Fig. 1. The robot body consists of hip joints, knee joints, ankle joints, connecting rods, and bandages, with a total weight of 22.5 kg. The auxiliary framework is made of aluminium alloy extrusions, which is 1 m in length, 1 m in width, and 1.2 m in height. When used in conjunction with the support frame, the robot is capable of sharing a portion of the user’s weight. In order to connect the patient to the lower limb rehabilitation training robot, the bandages are employed; therefore, the robot can effectively drive the patient’s movement, while the patient’s muscles also generate forces to influence the human–robot interaction. Each side of the robot incorporates 2 passive degrees of freedom located at the waist and ankle, as illustrated in Fig. 1A. The waist degree of freedom ensures unrestricted swinging of the legs in the coronal plane, while the ankle joint degree of freedom permits swinging of the feet in the front and back planes. As shown in Fig. 1A, these 2 active degrees of freedom on each side are powered by motors, with each motor driving one degree of freedom. The hip-joint driven motor is mounted on the lumbar support and securely fastened to the waist to make the thigh swing. The knee-joint driven motor is securely fastened to the thigh, and its output flange converts the motor rotation into lower leg swing. In order to obtain enough continuous torque, the RMD-X8pro motor (Myactuator, Suzhou, China) is employed for these joints, which is rated at 166 W and capable of producing an instantaneous torque up to 25 N·m after deceleration by a 1:9 planetary gear reducer. After deceleration, the peak rotational speed of the motor can reach 160 r/min, which meets the requirements of the rehabilitation training gait cycle of the robot, i.e., 4 to 10 s. Besides, based on the CAN (Controller Area Network) bus communication, the control mode of the employed motors can flexibly select position mode, speed mode, and force control mode on demand. Two passive degrees of freedom on each side are actuated by springs to ensure a safe range. The human ankle joint is a ball and socket joint consisting of the tibia, fibula, and ankle joint surfaces, offering 3 degrees of rotational freedom. Proper positioning of the ankle joint is crucial for ensuring good contact between the foot and the ground during walking [34]. For the purpose of ensuring secure rehabilitation training, the ankle joint of the robot is constrained to rotation within the front and back planes. Additionally, a passive driving method utilizing a spring connection can meet the training requirements. The passive connection cushions the ankle, protects the patient’s ankle, and provides the driven force needed for the foot to lift off and land.

Fig. 1. The developed rehabilitation training robot system. (A) Robot structure. (B) Hardware control system.

The control system is designed to collect sensor data on interactive forces and adjust the position of the motor in real time. Figure 1B depicts the whole control process. Specifically, the designed controller of the rehabilitation training robot consists of a computer and an STM32F103 microprocessor. Four sets of 8 cantilever force sensors are applied to measure the interactive forces between the rehabilitation training robot and the patient, which is processed by an A/D converter (HX711, a precision 24-bit analog-to-digital converter) and sent to the STM32 microprocessor. After being processed by the control module, the position compensation amount is generated. The microprocessor sends 8-byte real-time position commands to the 4 motors through the CAN bus. The adopted RMD-X8pro is equipped with a motor controller that controls the motor position based on real-time instructions. The computer can modify gait data and control parameters and synchronize real-time parameters to the STM32-based controller every 100 ms.

Human–robot interaction force measurement

To measure the interaction force between human and the rehabilitation training robot, the developed system incorporates 8 cantilever beam sensors. These sensors are strategically placed in 4 groups on both the left and right legs, responsible for measuring the interaction torque of the hip and knee joints on each side. Notably, the robot features an adjustable height design, and to accommodate this, the sensors are affixed to connecting rods that remain relatively fixed to the measured joints. This design ensures the maintenance of a consistent measuring force arm when adapting to individuals of varying heights. At each measurement position, 2 cantilever force sensors are installed, and 2 strain gauges of every cantilever sensor are installed face-to-face, as illustrated in Fig. 2. The 2 ends of the cantilever beam are separately connected to the robot and leg straps. Thus, the interaction forces between the legs and the robot are easily obtained based on the deformation of the cantilever beam.

Fig. 2. Schematic diagram of the interactive force measurement.

It is worth noting that there are 2 sensors installed in reverse to measure the one-way forces acting on the forward and backward directions, respectively. As a result, the interaction force between the robot and the patient causes the deformation in 2 identical cantilever beams; therefore, the actual forces applied should be twice the measurement value of a single sensor. During the sensor installation, a pretension force is applied to ensure the initial value of the sensor is not zero. This approach effectively circumvents the nonlinear behavior observed in small-value readings of cantilever beam sensors. Additionally, each of the 2 sensors installed in a face-to-face arrangement has an individual measurement range of 20 kg. This design allows the sensors to distribute the burden of the interaction force, thus preventing nonlinearity even at high sensor readings. Define Fforward and Fbackward as the forward force and backward force of the sensors, respectively. Taking into account the above factors, the actual interaction forces can be obtained as the difference between the 2 measured results on either side. Thereafter, we can obtain the human–robot interaction torque of a single joint as follows:Tint=2×Fforward−Fbackward×l(1)

where Tint is the human–robot interaction torque; l is the distance between the sensor’s leg connection end and the joint.

Human–robot interaction modeling

In this section, we will conduct the human–robot interaction dynamics of the developed rehabilitation training system, which will provide the solid foundation for the following robot system performance evaluation and the admittance controller construction.

Figure 3 illustrates the human–robot coupling model. In particular, θ1 and θ2 denote the hip and knee joint angles of the robot, respectively, while θ3 and θ4 represent the corresponding angles for the human leg. Define Θ = [θ1, θ2]T to represent the joint coordinate vector of the robot. a1 and a2 denote the length of the thigh and calf links, respectively. Irrespective of the human leg’s involvement, the exoskeleton is considered as an independent system, and its torque output is generated by joint motors. Define Tr = [τ1, τ2]T to represent the torque output vector of the robot. The weights of the robot’s thigh and calf links are denoted as m1 and m2, respectively. We assume that the center of mass for each link is located at the center of the link itself. As a result, the centroids of the 2 links are positioned at a distance of a1/2 and a2/2, respectively.

Fig. 3. Human–robot coupling model.

The dynamic model of the lower limb rehabilitation training robot is constructed based on Lagrange equations. The Lagrange function is defined as the difference between the kinetic energy and potential energy of the system, expressed as L = K − P, where K and P represent the system’s kinetic and potential energies, respectively. Based on the Lagrange method, it is easy to obtain the dynamic model of the lower limb rehabilitation training robot as follows:τ1τ2=Tdis+fΘ·+MΘθ¨1θ¨2+12m2a1a2sinθ2−2θ·1θ·2−θ·22θ·12+GΘ(2)

where Tdis represents external disturbances to the robot system, fΘ· represents system friction, and it is related to joint motion speed. M(Θ) is the inertia matrix of the robot, and G(Θ) is the gravity matrix, expressed as follows:MΘ=M11M12M21M22GΘ=G11G21M11=14m1+m2a12+14m2a22+m2a1a2cosθ2M12=14m2a22+12m2a1a2cosθ2M21=14m2a22+12m2a1a2cosθ2M22=14m2a22G11=12m1+m2ga1cosθ1+12m2ga2cosθ1+θ2G21=12m2ga2cosθ1+θ2(3)

In the robot system, in addition to the influence of gravity, there is also interaction force between the robot and human legs. To account for this, a human–robot coupling model is established based on the theoretical interaction force estimation method [30]. In the coupling model, the motors serve as the power source, and the human legs do not generate active muscle force. As a result, the Lagrange equation incorporating passive leg participation can be expressed as follows:Tr=Tdis+fΘ·+Th+MΘθ¨1θ¨2+12m2a1a2sinθ2−2θ·1θ·2−θ·22θ·12+GΘ(4)

where Th represents the interactive torque of the human leg to the robot system when no muscle force is exerted. Based on the stiffness modeling method for human–robot connections presented in [35,36], we suppose the existence of a fixed stiffness connection between the human leg and the robot. The corresponding motion relationship is illustrated in Fig. 3. The interaction force between the human leg and the robot is established based on an elastic relationship, and the magnitude of this interaction force is intricately linked to the stiffness and displacement difference of the human–robot connection. Since the angular difference between the human and the robot is small, the torque magnitude can be expressed in terms of the stiffness coefficient and deformation.Th=Th1Th2Th1=ka122sinθ1−θ3+ka1sinθ1−θ3+a22sinθ2−θ4a1cosθ2+a22Th2=ka1sinθ1−θ3+a22sinθ2−θ4a22(5)

where k is the elastic coefficient between the lower limb of the human body and the robot, determined by the connection method between the robot and the leg. Obviously, its numerical value represents the system stiffness.

In practice, it is difficult to calculate the driven torque of the leg generated by elasticity through either an accurate model or direct measurement. Considering that the human leg is entirely propelled by the robot to generate motion in passive training mode, we simplify the interaction force generated by the strap connection as the force driving the movement of the human leg. To address this, we have developed a dynamic model to estimate the driving torque of the legs in the absence of muscle forces, with the legs serving as the primary focus of the model.Th=Mhθ¨3θ¨4+12mla1a2sinθ4−2θ·3θ·4−θ·42θ·32+Gh(6)

where Mh is the inertia matrix of human lower leg, Gh is the gravity matrix, and ml represents the theoretical weight of the lower leg.

Adaptive gait training method based on admittance control

In the human–robot coupled dynamic model, the joint motors provide driven torques, and the leg is in a state of no muscle force. However, during actual rehabilitation trains, it should consider the participation of residual muscle strength in the human leg. Training without residual muscle strength is entirely passive. In a passive training state, when a muscle generates force in the same direction as the leg moves, the robot will restrict the range of motion of the patient; otherwise, it will impede the muscle’s ability to exert forces. To address this issue, an impedance model is introduced to describe the relationship between the rehabilitation training robot and the human leg, which utilizes the forces generated by the human leg for compliance control of the robot.MdΔΘ¨+BdΔΘ·+KdΔΘ=Tad(7)

where ΔΘ represents the difference between the current joint angle and the target angle. Md, Bd, and Kd are preset admittance parameters that separately represent the rotational inertia, damping, and stiffness matrices of the rehabilitation training robot interacting with the human leg. Tad = Tint − Th represents the magnitude of residual muscle force of the leg, which is the difference between the actual human–robot interaction torque collected by the sensors and the theoretical torque of the dynamic model. When human muscles exert force, there is a difference between the actual interaction force and the theoretical value. To comply with the patient’s movement trend, the joint position and speed can be solved and adjusted in real time based on Eq. 7. Appearently, the admittance characteristics of the rehabilitation training robot represent its ability to track the human leg’s movements.

According to Eq. 7, it is evident that in the admittance control model, the input is the interaction force Tint, and the output is the position error Δq. The robot system exhibits second-order characteristics and can be expressed as:s2+2ξωns+ωn2=0ξ=Bd2MdKdωn=KdMd(8)

where ξ is the damping ratio and ωn is the natural frequency of the system. The stability of the control model can be ensured by modifying the admittance parameters [37].

Figure 4 shows the whole adaptive gait training process based on admittance control for the developed rehabilitation training robot. In gait generation state, according to the collected gait data, the joint angle state Θ can easily be obtained. Thereafter, based on the constructed kinematic and dynamic models of the human leg, the human–robot interaction torque Th without any muscle force is calculated. Subsequently, the admittance controller starts to work. Specifically, the input control target is set as T = 0. It means the difference between the human–robot interaction torque Th and Tint is fully utilized as admittance control to minimize the obstruction caused by the robot to the human leg movement. Meanwhile, the admittance control module calculates the real-time angle adjustment amount ΔΘ of the joints. These calculated results are superposed with the theoretical joint angles to obtain a new real-time gait. Under actions of the employed servo motors, these newly generated gaits can be easily and effectively executed by the rehabilitation training robot. During the whole time, the installed cantilever force sensors will collect the interactive forces and calculate Tint for feedback.

Fig. 4. Framework of the adaptive gait control system.

Results and Discussion

Lower limb gait collection

As for the lower limb rehabilitation training robots, no matter what control strategy employed, human gait curves are very important. Only having suitable gait curves, the rehabilitation training robots can aid the patients better in their recovery. In actual operation, more important for gait curves lies in their generation and testing for stability [38]. Many factors will affect the extraction of the gait curves, such as the accuracy and stability of the sensors and environmental interference. Therefore, it is necessary to filter the extracted gait data to ensure the stability of the gait curves. Following the existing gait curves generation approach [39], we collected 9 key positions of the hip joint and 12 key positions of the knee joint within a gait cycle of each joint. Table tabulates the collected serialized positions of both knee joint and hip joint. These key points are more densely located at positions with large curve change rates, and the redundancy of key points ensures the stability and smoothness of the generated gait.

Table. Serialized Positions of the knee and hip joint in a gait cycle

Knee joint	Hip joint	
Cycle
proportion	Angle (°)	Cycle
proportion	Angle (°)	
0	8.18347	0	−15.79609	
0.11	34.53819	0.04	−14.00131	
0.22	58.68233	0.21	11.52780	
0.24	58.78970	0.41	24.87653	
0.41	22.20942	0.43	24.87214	
0.43	18.53719	0.5	24.72710	
0.5	13.34561	0.89	−10.29988	
0.57	14.36569	0.9	−10.97715	
0.59	14.32100	1	−15.79609	
0.89	0			
0.9	0.30874			
1	8.18347			

Through performing the cubic spline interpolation of these collected joint angles, i.e., 9 positions of the hip joint and 12 positions of the knee joint, we can obtain the final gait curves, as shown in Fig. 5. Taking the left leg for example, we can easily observe 2 obvious stages from the gait curves, i.e., stance and swing, which is visually depicted in orange and purple background colors in Fig. 5. As for the stance stage, it can be further divided into a single-leg stance phase and a double-leg stance phase. As the right leg steps forward, the left leg transitions into a single-leg stance. Subsequently, it shifts to a double-leg stance along with the right leg lands. As for the swing stage, it is composed of an initial phase and a final phase. The former commences as the left foot lifts off, and the latter starts as the center of gravity readjusts. Figure 5 illustrates the motion sequence diagram of the whole process, demonstrating relatively smooth motion simulation results, thus serving as the fundamental gait for rehabilitation training experiments.

Fig. 5. The key positions and interpolation results of knee and hip joints.

Human–robot interaction experiment

The following experiments focus on the human–robot interaction force measurement and analysis based on the admittance control method. According to the interaction information between the patient’s legs and the rehabilitation training robot, the admittance control is employed to regulate the positions of the knee and hip joints of the robot, thus completing the force-position control process [40]. The relationship between the interaction force and joint angles is easily established based on Eq. 7. Meanwhile, using the installed cantilever force sensors, we can directly measure the interaction forces between the lower leg and the robot. Here, we take the left knee joint as the experimental object. To test the effect of the employed admittance control method, we fixed the gait curve of the knee joint, and set the input gait angle to always be 0°, that is, Θ = 0. The servo motor of knee joint was operated in position control mode, receiving position commands via the CAN bus. In the calculation of the admittance model, we processed the first- and second-order differentials in the form of positional differences, with a period of 100 ms.

According to Eq. 8, we can easily make out that in admittance model, the system performance is decided by some key parameters, for example, Kd for stiffness, Bd for damping, and Md for inertia. Through changing these key system parameters, we can obtain different angle compensation response characteristics. Therefore, it is very important to explore how these parameters affect the system performance. Figure 6 illustrates the experimental results of the built robotic system in varying key parameters. More concretely, the first tests were executed under the conditions of changing Kd with a fixed Bd = 10 N · m · s/rad and Md = 2 N · m · s2/rad, as shown in Fig. 6A. We can find that as Kd increases, the angle compensation amount obviously decreases. Therefore, it is crucial to increase Kd to limit angle compensation range appropriately to ensure system stability. Figure 6B depicts the outcomes of changing Bd with a fixed Kd = 50 N · m/rad and Md = 2 N · m · s2/rad. We can find that as Bd increases, the system response slows down, but the fluctuation decreases. Therefore, increasing Bd appropriately prevents overshoot of the joint when it reaches its extreme point, thus improving training safety. With a fixed Kd = 50 N · m/rad and Bd = 10 N · m · s/rad, the system inertia increases and the response slows down as Md increases, as shown in Fig. 6C. In active mode admittance control, tracking error is commonly employed as an assessment indicator for parameter selection [41]. In our study, we employed admittance models and human dynamic models to implement trajectory-adaptive control in passive training. Consequently, parameter selection is conducted to adjust the passive training trajectory mode based on interaction force, aiming to maximize patient engagement while simultaneously ensuring safety. Based on the experimental results, the parameters of the adaptive rehabilitation gait control system are set to Kd = 50 N · m/rad, Bd = 10 N · m · s/rad, and Md = 2 N · m · s2/rad.

Fig. 6. The results of human–robot interaction experiments. (A) Results of changing Kd with a fixed Bd = 10 N · m · s/rad and Md = 2 N · m · s2/rad. (B) Results of changing Bd with a fixed Kd = 50 N · m/rad and Md = 2 N · m · s2/rad. (C) Results of changing Md with a fixed Kd = 50 N · m/rad and Bd = 10 N · m · s/rad. (D) Guiding force is applied to the robot system.

Gait optimized by admittance method

In the following experiments, a volunteer is employed to wear the developed rehabilitation training robot to do some tests. The volunteer is 180 cm tall and weighs 60 kg. According to the human body parameter estimation method in [42], we can estimate the dynamic parameters of the volunteer, taking the thigh mass as 8.5 kg, the calf mass as 4.5 kg, the thigh length as 0.37 m, and the calf length as 0.47 m. Meanwhile, assume uniform mass distribution along the human leg.

At first, the interactive forces in both direction of the left knee joint during walking training can be collected by the installed cantilever force sensors. In the test, the training gait cycle was set to 4 s. Figure 7A displays the cantilever force sensor data collected within 4 walking cycles. Due to installation errors, connection stiffness, and other factors, the obtained sensor data exhibited poor stability. To compensate for errors caused by sensor measurements, Kalman filtering approach was employed to perform recursive data processing, contributing to enhanced signal stability and reduced sensor errors [43]. After processing the data, the human–robot interaction moments of the left knee joint during 4 gait cycles were obtained, as shown in Fig. 7B. In particular, the interaction moments are depicted by the blue and red curves, which represent the moment changes before and after filtering, respectively.

Fig. 7. Measured knee joint interaction forces and moments. (A) Lower leg force sensor data and filtered results. (B) Human–robot interaction moment of knee joint.

To derive the admittance equations, it is necessary to calculate the driving forces of the human leg in the absence of any muscle force. To achieve this, a dynamic model of the human leg is established based on Eq. 6. Through solving the theoretical interaction moment Th throughout a gait cycle (4 s), we can obtain the 2 joint moments displayed in Fig. 8A. These results are consistent throughout the cycle and similar to the walking moment estimation outcomes for normal individuals in [42], demonstrating the feasibility of the constructed estimation method in Eq. 6. The relationship between the left knee joint interaction force and admittance control force was analyzed under experimental conditions. According to Tad = Tint − Th, we can obtain the changes in Tad of the left knee joint over 4 cycles, as shown in Fig. 8B. We know that Tad is a system moment in knee joint admittance control. Since the volunteer is a healthy individual during the experiment, there are typically substantial active muscle force during walking; therefore, Tint exerted on the rehabilitation training robot was mostly opposite to the theoretical moment Th when the patient has no muscle force. In such a scenario, the admittance moment Tad represented greater compensation to the human leg in the same direction as the motion. According to Eq. 7, we performed a differential calculation to calculate the compensation angle ΔΘ. Considering the results of the human–robot interaction experiment above, we set the parameters as follows: Kd = 50 N · m/rad, Bd = 10 N · m · s/rad and Md = 2 N · m · s2/rad.

Fig. 8. The curves of theoretical moment and admittance moment. (A) Theoretical moment Th of joint in 1 cycle. (B) Admittance moment in 4 cycles.

Figure 9 presents the input curve and compensation results of the left knee joint during the experiment. As the volunteer was healthy, the leg muscle strength caused the forward and backward movements to occur ahead of the input curve. However, the admittance control system was able to predict the leads and adjust the gait curve through angle compensation. As a result, the range of joint motion in the real-time adjusted curve was larger, which met the expectations for adjustment.

Fig. 9. Compensation results of knee joint angle.

Discussion

The proposed admittance-control-based adaptive gait training method, which takes into account human leg dynamics, proves to be highly beneficial in harnessing the residual muscle strength of the disable lower limb. Through optimizing the training gait in real time, this developed rehabilitation training robot effectively enhances patient participation and safety, while ensuring an effective training. In comparison to fully active control methods like those in [44], adaptive passive training methods offer more stable training curves, ensuring both safety and stability. While existing passive rehabilitation training methods [45,46] can achieve gait adjustment during training, they often struggle to fully utilize residual muscle strength. By incorporating human leg dynamics, the proposed training process can adapt to diverse individuals and stages, thereby enhancing training participation. In this study, we conducted interactive experiments using a human–robot dynamic model and estimated optimal admittance parameters. The subsequent rehabilitation training experiments, encompassing 4 gait cycles, showed the stationarity and efficacy of the proposed adaptive gait method.

However, the reliance on a basic gait pattern and the current 10-Hz control frequency limit our ability to accurately access and respond to the patient’s other motion intentions during rehabilitation training, such as initiating and halting walking movements. In order to address this issue, more diverse ranges of training postures should be incorporated into the basic gait pattern. Furthermore, the patient’s motion frequency is set as a preset value, necessitating further exploration in enhancing the adaptability of the admittance control parameters to accommodate individual variations in walking frequencies. By enhancing the gait adaptation ability of the rehabilitation training robot, we can better tailor the training program to meet the unique needs of each patient.

Conclusion

In this paper, we have developed a novel lower limb rehabilitation training robot with the abilities of adaptive gait adjustment. In order to obtain the joint interaction torque, the developed lower limb rehabilitation training robot employs 2 face-to-face mounted cantilever beam force sensors to measure the human–robot interaction forces in 2 directions. Relying on Lagrange equations, a dynamic model of the human–robot interaction system is constructed to estimate the driven force of the human leg in a completely passive state. Thus, the residual muscle force of the human leg can be obtained through comparing the theoretical moment with the actual joint interaction force collected by the sensors, and the real-time joint position compensation angle can be obtained after processing the admittance moment generated by the residual muscle force. Based on this, an adaptive gait adjustment method is proposed to achieve the goal of adapting to the wearer’s movement intention. Several experiments are carried out to verify the developed lower limb rehabilitation training robots. The results shows that the adaptive gait training method based on admittance control can effectively improve the rehabilitation training engagement and safety.

Future work will focus on analyzing the disparities in gait cycles between rehabilitation robots and patients, fine-tuning the robot’s gait speed to better accommodate the patient’s walking pace, and enhancing the safety and engagement of rehabilitation training.

Acknowledgments

Funding: This work was supported in part by the National Natural Science Foundation of China under Grants 62373353, and 62033013 and in part by Youth Innovation Promotion Association CAS (2019138).

Author contributions: F.Y., Y.L., and Z.W. proposed the concept and methodology. F.Y. wrote the initial draft of the manuscript. Z.W. polished the manuscript. M.T. and J.Y. managed and reviewed the manuscript. All authors read and approved the final manuscript.

Competing interests: The authors declare that there is no conflict of interest regarding the publication of this article.

Data Availability

The data used to support the findings of this study are available from the corresponding author upon request.

Supplementary Materials

Supplementary 1 Movie S1
==== Refs
References

1. Shi D, Zhang W, Zhang W, Ding X. A review on lower limb rehabilitation exoskeleton robots. Chin J Mech Eng. 2019;32 :74.
2. Meng W, Liu Q, Zhou Z, Ai Q, Sheng B, Xie S. Recent development of mechanisms and control strategies for robot-assisted lower limb rehabilitation. Mechatronics. 2015;31 :132–145.
3. Martinez A, Lawson B, Goldfarb M. A controller for guiding leg movement during overground walking with a lower limb exoskeleton. IEEE Trans Robot. 2018;34 (1 ):183–193.
4. Ha KH, Murray SA, Goldfarb M. An approach for the cooperative control of FES with a powered exoskeleton during level walking for persons with paraplegia. IEEE Trans Neural Syst Rehabil Eng. 2016;24 (4 ):455–466.25915961
5. Chen S, Wang Z, Li Y, Tang J, Wang X, Huang L, Fang Z, Xu T, Xu J, Guo F, et al. Safety and feasibility of a novel exoskeleton for locomotor rehabilitation of subjects with spinal cord injury: A prospective, multi-center, and cross-over clinical trial. Front Neurorobot. 2022;16 : Article 848443.35645758
6. He Y, Wang C, Li N, Fu R, and Wu X. Auto-LEE: A novel autonomous lower extremity exoskeleton for walking assistance. Paper presented at: 2018 IEEE International Conference on Information and Automation (ICIA); 2018 Aug 11–13, Wuyishan, China.
7. He Y, Li N, Wang C, Lq X, Yong X, Xy W. Development of a novel autonomous lower extremity exoskeleton robot for walking assistance. Front Inform Technol Elect Eng. 2019;20 :318–329.
8. Lim B, Jang J, Lee J, Choi B, Lee Y, Shim Y. Delayed output feedback control for gait assistance and resistance using a robotic exoskeleton. IEEE Robot Autom Lett. 2019;4 (4 ):3521–3528.
9. Inkol KA, McPhee J. Assessing control of fixed-support balance recovery in wearable lower limb exoskeletons using multibody dynamic modelling. Paper presented at: 2020 8th IEEE RAS/EMBS International Conference for Biomedical Robotics and Biomechatronics (BioRob); 2020 Nov 29–Dec 1; New York, NY.
10. Zhang J, Wang T, Zhao Q, Liu S. Impacts of a lower limb exoskeleton robot on the muscle strength of tibialis anterior muscle in stroke patients. Paper presented at: 2020 International Conference on Energy, Environment and Bioengineering (ICEEB 2020). Vol. 185. E3S Web of Conferences. 2020:03036.
11. Milia P, Salvo F, Caserio M, Cope T, Weber P, Santella C, Fiorini S, Baldoni G, Bruschi R, Bigazzi B, et al. Neurorehabilitation in paraplegic patients with an active powered exoskeleton (Ekso). Digit Med. 2016;2 (4 ):163.
12. Zhang X, Yue Z, Wang J. Robotics in lower-limb rehabilitation after stroke. Behav Neurol. 2017;2017 :3731802.28659660
13. Sakamoto S, Hutabarat Y, Owaki D, Hayashibe M. Ground reaction force and moment estimation through EMG sensing using long short-term memory network during posture coordination. Cyborg Bionic Syst. 2023;4 :0016.37000191
14. Xu D, Wang Q. Noninvasive human-prosthesis interfaces for locomotion intent recognition: A review. Cyborg Bionic Syst. 2021;2021 :9863761.36285130
15. Sun N, Cao M, Chen Y, Chen Y, Wang J, Wang Q, Chen X, Liu T. Continuous estimation of human knee joint angles by fusing kinematic and myoelectric signals. IEEE Trans Neural Syst Rehabil Eng. 2022;30 :2446–2455.35994557
16. Li Z, Yuan Y, Luo L, Su W, Zhao K, Xu C, Huang J, Pi M. Hybrid brain/muscle signals powered wearable walking exoskeleton enhancing motor ability in climbing stairs activity. IEEE Trans Med Robot Bionics. 2019;1 (4 ):218–227.
17. Gordleeva SY, Lobov SA, Grigorev NA, Savosenkov AO, Shamshin MO, Lukoyanov MV, Khoruzhko MA, Kazantsev VB. Real-time EEG-EMG human-machine interface based control system for a lower-limb exoskeleton. IEEE Access. 2020;8 :84070–84081.
18. Bao W, Villarreal D, Chiao JC. Vision-based autonomous walking in a lower-limb powered exoskeleton. Paper presented at: 2020 IEEE 20th International Conference on Bioinformatics and Bioengineering (BIBE); 2020 Oct 26–28, Cincinnati, OH.
19. Liu DX, Xu J, Chen C, Long X, Tao D, Wu X. Vision-assisted autonomous lower-limb exoskeleton robot. IEEE Trans Syst Man Cybern. 2021;51 (6 ):3759–3770.
20. Li H, Guo S, Wang H, Bu D. Subject-independent continuous estimation of sEMG-based jint angles using both multisource domain adaptation and BP neural network. IEEE Trans Instrum Meas. 2023;72 :4000910.
21. Liu J, Wang C, He B, Li P, Wu X. Metric learning for robust gait phase recognition for a lower limb exoskeleton robot based on sEMG. IEEE Trans. Med. Robot Bionics. 2022;4 (2 ):472–462.
22. Kang I, Kunapuli P, Young AJ. Real-time neural network-based gait phase estimation using a robotic hip exoskeleton. IEEE Trans. Med. Robot Bionics. 2020;2 (1 ):28–37.
23. Gui K, Liu H, Zhang D. A practical and adaptive method to achieve EMG-based torque estimation for a robotic exoskeleton. IEEE-ASME Trans Mechatron. 2019;24 (2 ):483–494.
24. Liu L, Illian M, Leonhardt S, Misgeld BJE. Iterative learning control for cascaded impedance controlled compliant exoskeleton with adaptive reaction to spasticity. IEEE Trans Instrum Meas. 2023;72 :4008211.
25. Liang C, Hsiao T. Admittance control of powered exoskeletons based on joint torque estimation. IEEE Access. 2020;8 :94404–94414.
26. Zhou J, Li Z, Li X, Wang X, Song R. Human-robot cooperation control based on trajectory deformation algorithm for a lower limb rehabilitation robot. IEEE-ASME Trans Mechatron. 2021;26 (6 ):3128–3138.
27. Xu J, Xu L, Ji A, Li Y, Cao K. A DMP-based motion generation scheme for robotic mirror therapy. IEEE-ASME Trans Mechatron. 2023;28 (6 ):3120–3131.
28. Ma Y, Wu X, Yang SX, Dang C, Liu DX, Wang C, Wang C, Chen C. Online gait planning of lower-limb exoskeleton robot for paraplegic rehabilitation considering weight transfer process. IEEE Trans Autom Sci Eng. 2021;18 :414–425.
29. Xu J, Huang K, Zhang T, Cao K, Ji A, Xu L, Li Y. A rehabilitation robot control framework with adaptation of 481 training tasks and robotic assistance. Front Bioeng Biotechnol. 2023;11 :1244550.37849981
30. Tu Y, Zhu A, Song J, Shen H, Shen Z, Zhang X, Cao G. An adaptive sliding mode variable admittance control method for lower limb rehabilitation exoskeleton robot. Appl Sci. 2020;10 (7 ):2536.
31. Zhu A, Tu Y, Zheng W, Shen H, Zhang X. Adaptive control of man-machine interaction force for lower limb exoskeleton rehabilitation robot. Paper presented at: 2018 IEEE International Conference on Information and Automation (ICIA); 2018 Aug 11–13; Wuyishan, China.
32. Wang Y, Zhu A, Wu H, Zhu P, Zhang X, Cao G. Control of lower limb rehabilitation exoskeleton robot based on CPG neural network. Paper presented at: 2019 16th International Conference on Ubiquitous Robots (UR); 2019 June 24–27; Jeju, South Korea.
33. Wang Y, Liu Z, Zhu L, Li X, Wang H. An impedance control method of lower limb exoskeleton rehabilitation robot based on predicted forward dynamics. Paper presented at: 2020 IEEE 19th International Conference on Trust, Security and Privacy in Computing and Communications (TrustCom); 2020 Dec 29–2021 Jan 1; Guangzhou, China.
34. Gao M, Wang Z, Pang Z, Sun J, Li J, Li S, Zhang H. Electrically driven lower limb exoskeleton rehabilitation robot based on anthropomorphic design. Mach Des. 2022;10 (4 ):266.
35. Langlois K, Rodriguez-Cianca D, Serrien B, de Winter J, Verstraten T, Rodriguez-Guerrero C, Vanderborght B, Lefeber D. Investigating the effects of strapping pressure on human-robot interface dynamics using a soft robotic cuff. IEEE Trans Med Robot Bionics. 2021;3 (1 ):146–155.
36. Ma X, Zhu A, Wu X, Tu Y, Zhang Y, Hou W. Design and implementation of human-robot interaction system with variable stiffness for exoskeleton. Paper presented at: 2022 International Conference on Advanced Robotics and Mechatronics (ICARM); 2022 July 09–11; Guilin, China.
37. Kronander K, Billard A. Stability considerations for variable impedance control. IEEE Trans Robot. 2016;32 (5 ):1298–1305.
38. Zhang X, Jiang W, Li Z, Song S. A hierarchical Lyapunov-based cascade adaptive control scheme for lower-limb exoskeleton. Eur J Control. 2019;50 :198–208.
39. Wang X, Liang L. A method of gait pattern generating and regulating for lower limb rehabilitation exoskeleton robot. Contr Eng China. 2022;29 :18–26.
40. Nagarajan U, Aguirre-Ollinger G, Goswami A. Integral admittance shaping: A unified framework for active exoskeleton control. Robot Auton Syst. 2016;75 :310–324.
41. Chen Z, Guo Q, Li T, Yan Y, Jiang D. Gait prediction and variable admittance control for lower limb exoskeleton with measurement delay and extended-state-observer. IEEE Trans Neural Netw Learn Syst. 2023;34 (11 ):8693–8706.35302939
42. Li G, Wang Y, Li X, Du Z, Chen Y. Structure design and experiment of multipurpose lower limb rehabilitation exoskeleton. J Mech Strength. 2021;43 :1125–1133.
43. Moore B. Principal component analysis in linear systems: Controllability, observability, and model reduction. IEEE Trans Autom Control. 1981;26 (1 ):17–32.
44. Huang P, Li Z, Zhou M, Li X, Cheng M. Fuzzy enhanced adaptive admittance control of a wearable walking exoskeleton with step trajectory shaping. IEEE Trans Fuzzy Syst. 2022;30 (6 ):1541–1552.
45. Wang A, Li W, Yu J, Zhang S. Impedance control based on the human gait data for lower limb rehabilitation robot. Paper presented at: 2021 China Autommation Congress (CAC); 2021 Oct 22–24; Beijing, China.
46. Zhong B, Guo K, Yu H, Zhang M. Toward gait symmetry enhancement via a cable driven exoskeleton powered by series elastic actuators. IEEE Robot Autom Lett. 2022;7 (2 ):786–793.
