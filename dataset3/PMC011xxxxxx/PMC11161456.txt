
==== Front
Bull Math Biol
Bull Math Biol
Bulletin of Mathematical Biology
0092-8240
1522-9602
Springer US New York

38847946
1310
10.1007/s11538-024-01310-3
Original Article
Evolutionary Game Dynamics with Environmental Feedback in a Network with Two Communities
Betz Katherine 1
Fu Feng 23
http://orcid.org/0000-0003-1567-801X
Masuda Naoki naokimas@gmail.com

145
1 grid.273335.3 0000 0004 1936 9887 Department of Mathematics, State University of New York at Buffalo, Buffalo, NY 14260-2900 USA
2 https://ror.org/049s0rh22 grid.254880.3 0000 0001 2179 2404 Department of Mathematics, Dartmouth College, Hanover, NH 03755 USA
3 grid.254880.3 0000 0001 2179 2404 Department of Biomedical Data Science, Geisel School of Medicine at Dartmouth, Lebanon, NH 03755 USA
4 grid.273335.3 0000 0004 1936 9887 Institute for Artificial Intelligence and Data Science, State University of New York at Buffalo, Buffalo, NY 14260-2900 USA
5 https://ror.org/03tgsfw79 grid.31432.37 0000 0001 1092 3077 Center for Computational Social Science, Kobe University, Kobe, 657-8501 Japan
7 6 2024
7 6 2024
2024
86 7 8426 4 2024
8 5 2024
© The Author(s) 2024
https://creativecommons.org/licenses/by/4.0/ Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/.
Recent developments of eco-evolutionary models have shown that evolving feedbacks between behavioral strategies and the environment of game interactions, leading to changes in the underlying payoff matrix, can impact the underlying population dynamics in various manners. We propose and analyze an eco-evolutionary game dynamics model on a network with two communities such that players interact with other players in the same community and those in the opposite community at different rates. In our model, we consider two-person matrix games with pairwise interactions occurring on individual edges and assume that the environmental state depends on edges rather than on nodes or being globally shared in the population. We analytically determine the equilibria and their stability under a symmetric population structure assumption, and we also numerically study the replicator dynamics of the general model. The model shows rich dynamical behavior, such as multiple transcritical bifurcations, multistability, and anti-synchronous oscillations. Our work offers insights into understanding how the presence of community structure impacts the eco-evolutionary dynamics within and between niches.

Keywords

Evolutionary game theory
Feedback-evolving games
Oscillatory dynamics
Bifurcation analysis
http://dx.doi.org/10.13039/501100020963 Moonshot Research and Development Program JPMJMS2021 Masuda Naoki http://dx.doi.org/10.13039/100000001 National Science Foundation 2052720 2204936 Masuda Naoki http://dx.doi.org/10.13039/501100000646 Japan Society for the Promotion of Science London JP21H04595 JP23H03414 Masuda Naoki Kobe UniversityOpen Access funding provided by Kobe University.

issue-copyright-statement© The Author(s) under exclusive licence to Society for Mathematical Biology 2024
==== Body
pmcIntroduction

Evolutionary game theory is the study of population changes driven by competition among different strategies. A recent adjustment of evolutionary game models with the aim of better representing the natural world is the inclusion of strategy-dependent feedback, specifically, environmental feedback (Weitz et al. 2016). This type of game is called an eco-evolutionary game. This type of strategy-dependent feedback can be seen in many complex systems, such as ecological metacommunities (Leibold and Chase 2018), collectives of insect individuals (Hanski 2011; Stella et al. 2022b), microbial populations (West et al. 2006; Sanchez and Gore 2013; Estrela et al. 2018), and human social and reproductive structures (Mullon et al. 2017; Rand et al. 2017). A major question with models of eco-evolutionary game dynamics is conditions under which cooperation in a population can thrive when the payoff matrix, which we regard as the environment, is influenced by the action of players. Extensions of the original eco-evolutionary game dynamics models include the addition of finite carrying capacity (Bairagya et al. 2021), renewable and decaying resources (Tilman et al. 2020; Wang and Fu 2020; Yan et al. 2021), imitation and aspiration dynamics (Arefin and Tanimoto 2021), mutation of players (Gong et al. 2022), reciprocity dynamics (Ma et al. 2024), and extension to public goods games (Shao et al. 2019; Wang and Fu 2020; Jiang et al. 2023; Han et al. 2024). The models can also be extended in terms of additional types of dynamic feedback, such as non-constant enhancement or degradation rates of the environmental variable, which depends on the payoff of players (Cao and Wu 2021), and global and local environment fluctuations (Jiang et al. 2023).

Given that players of the game are embedded in structured populations in reality, evolutionary game models have been extended to the case of various networks (Nowak 2006; Szabó and Fáth 2007; Perc et al. 2013; Wang et al. 2024). Similarly, players involved in an eco-evolutionary game may be better interpreted to inhabit on nodes of a network. Therefore, eco-evolutionary games have been extended to the case of networks. For example, in eco-evolutionary games on regular graphs, it was found that a higher degree of the node creates oscillatory behavior in the population and that a lower degree promotes spread of cooperation (Stella et al. 2022a; Zhang et al. 2023). Spatial networks are also commonly used for exploring how environmental feedback promotes cooperation (Jin et al. 2018; Szolnoki and Chen 2018; Wu et al. 2018, 2019; Hauert et al. 2019; Lin and Weitz 2019; Yang and Zhang 2021; Ding et al. 2023; He et al. 2023; Lu et al. 2023; Zhu 2023). Lastly, through the use of bimatrix payoffs, which are equivalent to the complete bipartite graph as population structure in the case of symmetric payoff matrices, periodic orbits in the state space have been proven to exist (Gong et al. 2018; Kawano et al. 2019; Liu et al. 2020; Shu and Fu 2022).

However, there are some vital gaps missing in the prior research on eco-evolutionary games on networks. First, in complete bipartite graphs (Gong et al. 2018; Kawano et al. 2019; Liu et al. 2020; Shu and Fu 2022), the players do not interact within each community. This assumption is suitable for modeling situations in which the population of players is divided into two different roles but otherwise not in general. Second, in most of the previous studies, the environmental state is assumed to be either a globally shared variable (Gong et al. 2018; Kawano et al. 2019; Liu et al. 2020; Shu and Fu 2022; Stella et al. 2022a; Zhang et al. 2023) or local to each node (i.e., player) (Jin et al. 2018; Szolnoki and Chen 2018; Wu et al. 2018, 2019; Hauert et al. 2019; Lin and Weitz 2019; Yang and Zhang 2021; Ding et al. 2023; He et al. 2023; Lu et al. 2023; Zhu 2023). However, it may be more realistic to assume that the environment is shared across some, but not all, players (Fahimipour et al. 2022; Guimarães 2020). For example, a meta-community in ecological systems may be an appropriately sized unit for considering an environmental variable (Holyoak 2009; Brechtel et al. 2018; Leibold and Chase 2018; Gross et al. 2020). Other eco-evolutionary game models assume network structure and assign a local environmental variable to each edge between a pair of players (He et al. 2023; Zhu 2023).

In the present study, we extend a previously proposed model of eco-evolutionary dynamics (Weitz et al. 2016) to the case of networks with equally sized two communities. Unlike the complete bipartite graph models proposed in Gong et al. (2018), Kawano et al. (2019), and Shu and Fu (2022) where the players in each community only interact with those in the other community, we assume that players not only interact with those in the other community but also with those in the same community. Next, we assume that the state of the environment depends on the type of edge in the network, similarly to He et al. (2023) and Zhu (2023). We crucially assign one environmental variable to each type of edge, i.e., the edges within the first community, those within the second community, and those connecting the two communities. In this manner, we model the situation in which two players forming an edge may improve or deteriorate their shared environment, which is assumed to be on the edge. We do not distinguish between edges of the same type because of the symmetric population structure assumed. Unlike the previous studies similarly assuming edge-dependent environmental states (He et al. 2023; Zhu 2023), our two-community network model, which is a minimal network model, allows analytical investigations.

Our paper is organized as follows. In Sect. 2, we describe our model in detail and focus on eco-evolutionary dynamics with two network communities. In Sects. 3 and 4, respectively, we present our stability analysis of the simplified replicator dynamics resulting from different symmetry assumptions. In Sect. 5, we numerically investigate the rich dynamical behavior of the general model. Finally, we discuss contributions of the current work along with an outlook for future work.

Model

Consider an eco-evolutionary game in a population composed of two communities. Each player chooses either of the two actions, i.e., cooperation or defection. We assume that there are N players in total and N/2 players in each community. We assume that the entire population is infinite (i.e., N→∞) and that the players interact with each other player within the same community at rate 1-δ and with each player in the other community at rate δ>0. See Fig. 1 for a schematic.Fig. 1 Schematic of the two-community network. A filled circle represents a player. Two players from the same community interact at rate 1-δ. Two players from the opposite communities interact at rate δ. Without loss of generality, we normalize the rate parameter 0<δ<1. We only show some edges for visualization purposes

We consider replicator dynamics for a population on the two-community network with feedback-evolving games. Crucially, we assume that the state of the environment depends on the type of edge in the network. We denote by n1∈[0,1] the state of the environment in community 1, representing the edges within community 1, by n2∈[0,1] the state of the environment in community 2, and by n12∈[0,1] the state of the environment used when a player in community 1 and one in community 2 interact. The environment-dependent payoff matrices for community 1, 2, and in between are assumed to be given by1 A(n)=(1-n)R0S0T0P0+nR1S1T1P1,

where n is either n1, n2, or n12. We assume that, if n=0, then cooperation is the unique Nash equilibrium, i.e., R0>T0 and S0>P0. If n=1, then defection is the unique Nash equilibrium, i.e., R1<T1 and S1<P1. We label the prior inequalities as2 R0>T0,S0>P0,R1<T1,S1<P1.

Let us define q1 and q2 as the two-dimensional payoff vector for a player in community 1 and 2, respectively. The first entry of the vector is the payoff for a cooperator. The second entry of the vector is the payoff for a defector. Define x and y as the fraction of cooperators in community 1 and 2, respectively. The fraction of defectors in community 1 and 2 is 1-x and 1-y, respectively. We obtain3 q1=(1-δ)A(n1)x+δA(n12)y,

4 q2=(1-δ)A(n2)y+δA(n12)x,

where x=x1-x⊤, y=y1-y⊤, and ⊤ denotes the transposition. The first term on the right-hand side of Eqs. (3) and (4) is the payoff obtained by playing with the other players in the same community. The second term is the payoff obtained by playing with the players in the opposite community.

We assume that the competition between cooperation and defection occurs only within each community because players inhabiting different communities may perceive the different environments due to the different state of the environment. Then, the replicator dynamics are given by5 x˙=x(1-x)(q11-q12),

6 y˙=y(1-y)(q21-q22),

where q11, q12, q21, and q22 are defined by7 qi=qi1qi2

with i∈{1,2}.

We give the dynamics of the environmental state of each type of edge by8 n˙1=n1(1-n1)θ1x-(1-x),

9 n˙2=n2(1-n2)θ2y-(1-y),

10 n˙12=n12(1-n12)θ12z-(1-z),

where z is the fraction of cooperators in the entire population, i.e., z≡(x+y)/2, and θ1>0, θ2>0, and θ12>0 are the ratio of enhancement to degradation of the environmental variable for the respective edge type. For example, if θ1 is large, then enhancement of the environment in community 1 occurs at a relatively small fraction of cooperators, x.

We let R3=R0-R1, T3=T0-T1, P3=P0-P1, and S3=S0-S1. Then, we obtain the five-dimensional dynamical system given by11 x˙=x(1-x)[(R0-T0-S0+P0)x+S0-P0-n1(S3-P3)-δ[(R0-T0-S0+P0)(x-y)-(R3-T3-S3+P3)(n1x-n12y)-(S3-P3)(n1-n12)]],

12 y˙=y(1-y)[(R0-T0-S0+P0)y+S0-P0-n2(S3-P3)-δ[(R0-T0-S0+P0)(y-x)-(R3-T3-S3+P3)(n2y-n12x)-(S3-P3)(n2-n12)]],

and Eqs. (8), (9), and (10).

Three-Dimensional System with θ1≠θ12

In this section, we assume that θ1=θ2, and that the initial condition satisfies x=y and n1=n2. Then, x=y and n1=n2 hold true for any t>0. We further assume that θ1=θ2≠θ12. In this case, the original five-dimensional dynamical system is reduced to the three-dimensional dynamical system given by13 x˙=x(1-x)[(R0-T0-S0+P0)x+S0-P0-n1(1-δ)+δn12[(R3-S3-T3+P3)x+(S3-P3)]],

14 n˙1=n1(1-n1)[θ1x-(1-x)],

15 n˙12=n12(1-n12)[θ12x-(1-x)].

We analyze the equilibria and dynamics of this three-dimensional dynamical system. The Jacobian of this dynamical system is given by16 J(x,n1,n12)=x(1-x)∂g∂xx(1-x)∂g∂n1x(1-x)∂g∂n12+(1-2x)g(x,n1,n12)-n1(θ1x+x-1)n1(1-n1)(1+θ1)+(1-n1)(θ1x+x-1)0-n12(θ1x+x-1)n12(1-n12)(1+θ1)0+(1-n12)(θ1x+x-1),

where17 g(x,n1,n12)=q11-q12,

and q11 and q12 are given by Eq. (7).

Corner Equilibria

We denote by x∗ the equilibrium of x and similar for the other dynamical variables. By setting x∗, n1∗, and n12∗ to 0 or 1, specifying the corners of the unit cube defined by 0≤x,n1,n12≤1, we obtain 8 corner equilibria. We show in Appendix A that each corner equilibrium is a saddle.

Interior Equilibria

In this section, we seek interior equilibria, i.e., those in which 0<x∗, n1∗, n12∗<1. By setting n˙1=0 and n˙12=0 in Eqs. (14) and (15), respectively, we obtain x∗=11+θ1 and x∗=11+θ12, which is a contradiction, because we assumed θ1≠θ12. Therefore, there are no internal equilibria.

Edge Equilibria

Let us examine possible equilibria on the edge of the unit cube, which we call edge equilibria. At an edge equilibrium, one variable out of x∗, n1∗, or n12∗ is between 0 and 1, and the other two variables are either 0 or 1. If x∗=0 or 1, then Eqs. (14) and (15) imply that n1∗,n12∗∈{0,1}, leading to corner equilibria. Therefore, there is no edge equilibrium satisfying x∗∈{0,1}. Therefore, we search for edge equilibria such that 0<x∗<1 and n1,n12∈{0,1}. Pairs (n1,n12)=(0,0) and (1, 1) violate Eq. (2). The other two pairs, i.e., (n1,n12)=(0,1) and (1, 0), provide equilibria.

The edge equilibrium (x∗,n1∗,n12∗)=P0-S0-δ(P0-P1-S0+S1)R0-T0-S0+P0-δγ,0,1, where18 γ=R0-R1-T0+T1-S0+S1+P0-P1,

is stable if and only if19 (P0-S0)(R1-T1)>(P1-S1)(R0-T0),

20 δc,1<δ<δc,2,

and21 θ12>θ1,

where22 δc,1≡R0-T0-P0θ1+S0θ1ρ1,

23 δc,2≡R0-T0-P0θ12+S0θ12ρ12,

24 ρ1=R0-R1-T0+T1-P0θ1+P1θ1+S0θ1-S1θ1,

25 ρ12=R0-R1-T0+T1-P0θ12+P1θ12+S0θ12-S1θ12.

If either Eqs. (19), (20), or (21) is not met, the equilibrium is unstable. We derive Eqs. (19), (20), and (21) in Appendix B.

The equilibrium (x∗,n1∗,n12∗)=P1-S1+δ(P0-P1-S0+S1)R1-T1-S1+P1+δγ,1,0 is stable if and only if Eq. (19),26 δc,3<δ<δc,4,

and27 θ12<θ1,

where28 δc,3≡-R1+T1+P1θ1-S1θ1ρ1

and29 δc,4≡-R1+T1+P1θ12-S1θ12ρ12,

hold true. If either Eqs. (19), (26), or (27) is not met, the equilibrium is unstable. The derivation is given in Appendix B.

Face Equilibria

In this section, we seek equilibria on the face of the unit cube, i.e., those in which just one of x∗, n1∗, or n12∗ is either 0 or 1 and the other two are between 0 and 1. We call these equilibria face equilibria. Similarly to the case of the edge equilibria, if we let x∗=0 or 1, then we obtain a corner equilibrium. Therefore, we assume that 0<x∗<1. By setting just one of n1∗ or n12∗ to 0 or 1, we obtain the four face equilibria shown in Table 1.Table 1 Face equilibria of the three-dimensional dynamics when θ1≠θ12

x∗	n1∗	n12∗	
11+θ1	R0-T0-P0θ1+S0θ1(1-δ)ρ1	0	
11+θ12	1	R1-T1-P1θ12+S1θ12+δρ12δρ12	
11+θ1	R0-T0-P0θ1+S0θ1-δρ1(1-δ)ρ1	1	
11+θ12	0	R0-T0-P0θ12+S0θ12δρ12	
We recall that ρ1 and ρ12 are defined by Eqs. (24) and (25), respectively

For the equilibrium (x∗,n1∗,n12∗)=11+θ1,R0-T0-P0θ1+S0θ1(1-δ)ρ1,0, the Jacobian is given by30 J=J11(1)J12(1)J13(1)J21(1)0000J33(1),

where31 J11(1)=(P1-S1)(R0-T0)-(P0-S0)(R1-T1)θ1(1+θ1)ρ1,

32 J12(1)=-(1-δ)θ1ρ1(1+θ1)3,

33 J13(1)=-δθ1ρ1(1+θ1)3,

34 J21(1)=-(1+θ1)R0-T0-(P0-S0)θ1(R1-T1-P1θ1+S1θ1+δρ1)(1-δ)2ρ12,

35 J33(1)=θ12-θ11+θ1.

The characteristic equation is given by,36 det(J-λI)=J33(1)-λλ2-J11(1)λ-J12(1)J21(1)=0.

Eigenvalue λ1=J33(1)=θ12-θ11+θ1 is negative if and only if θ12<θ1 (i.e., Eq. (27)). The other two eigenvalues, denoted by λ2 and λ3, are solutions of λ2-J11(1)λ-J12(1)J21(1)=0. The real part of λ2 and λ3 is negative if and only if -J11(1)>0 and -J12(1)J21(1)>0. Equation (2) guarantees that both ρ1 and ρ12 are positive. Therefore, -J11(1)>0 if and only if Eq. (19) holds true. Equation (32) combined with ρ1>0 implies that J12(1)<0. Therefore, -J12(1)J21(1)>0 if and only if J21(1)>0, which holds true if and only if37 δ<δc,3.

Note that, in Eq. (34), R0-T0-(P0-S0)θ1>0 because R0-T0>0 and P0-S0<0. Therefore, this equilibrium is marginally stable if and only if Eqs. (19), (27), and (37) hold true.Fig. 2 Convergence to face equilibria. Shown are numerically obtained trajectories of the three-dimensional system given by Eqs. (13), (14), and (15). The green dots represent the face equilibria given in Table 1. We use the payoff matrices given by Eq. (38) and initial conditions (x,n1,n12)=(0.5,0.4,0.1) and (0.6, 0.5, 0.8), of which the corresponding trajectories are shown in blue and orange, respectively. a θ1=8, θ12=5, and δ=0.6. b θ1=8, θ12=5, and δ=0.8. c θ1=5, θ12=8, and δ=0.2. d θ1=5, θ12=8, and δ=0.4

For numerical demonstration, we set38 R0S0T0P0=5130andR1S1T1P1=3082,

which satisfy Eq. (2). We also set θ1=8, θ12=5, and δ=0.6, yielding λ1=-13 and λ2,3=-0.014±0.437i. We show two numerically simulated trajectories starting from different initial conditions in Fig. 2a. Figure 2a indicates that the trajectories spiral into the presently discussed face equilibrium.

The derivation of the conditions for stability of the other three face equilibria is similar; see Appendix C for the derivation.

Equilibrium (x∗,n1∗,n12∗)=11+θ12,1,R1-T1-P1θ12+S1θ12+δρ12δρ12 is stable if and only if Eqs. (19), (27), and39 δ>δc,4

hold true. For numerical demonstration of this face equilibrium, we set θ1=8,θ12=5, and δ=0.8, yielding λ1=-12 and λ2,3=-0.019±0.232i. As expected, Fig. 2b shows that two trajectories starting from different initial conditions spiral into the presently discussed face equilibrium.

Equilibrium (x∗,n1∗,n12∗)=11+θ1,R0-T0-P0θ1+S0θ1-δρ1(1-δ)ρ1,1 is stable if and only if (19), (21), and40 δ<δc,1

hold true. For numerical simulations, we set θ1=5, θ12=8, and δ=0.2, yielding λ1=-12 and λ2,3=-0.019±0.554i. As expected, two trajectories, shown in Fig. 2c, spiral into the presently discussed face equilibrium.

Equilibrium (x∗,n1∗,n12∗)=11+θ12,0,R0-T0-P0θ12+S0θ12δρ12 is stable if and only if Eqs. (19), (21), and41 δ>δc,2

hold true. For numerical simulations, we set θ1=5, θ12=8, and δ=0.4, yielding λ1=-13 and λ2,3=-0.014±0.437i. Two trajectories, shown in Fig. 2d, spiral into the presently discussed face equilibrium.Fig. 3 Impact of the inter-community interaction rate δ on stability. Stable edge and face equilibria when θ1≠θ12 are shown as a function of δ. In both a and b, we use the payoff values given by Eq. (38). a θ1<θ12. The face equilibrium with n12∗=1 is stable for δ<δc,1. The edge equilibrium (x1∗,n1∗,n12∗)=P0-S0-δ(P0-P1-S0+S1)R0-T0-S0+P0-δγ,0,1 is stable for δc,1<δ<δc,2. The face equilibrium with n1∗=0 is stable for δ>δc,2. b θ1>θ12. The face equilibrium with n12∗=0 is stable for δ<δc,3. The edge equilibrium (x1∗,n1∗,n12∗)=P1-S1+δ(P0-P1-S0+S1)R1-T1-S1+P1+δγ,1,0 is stable for δc,3<δ<δc,4. The face equilibrium with n1∗=1 is stable for δ>δc,4. In a, we set θ1=5 and θ12=8, yielding δc,1=7/22 and δc,2=10/21. In b, we set θ1=8 and θ12=5, yielding δc,3=21/31 and δc,4=15/22

Fig. 4 Visualization of the transcritical bifurcations as δ varies. We use the payoff matrices given by Eq. (38). The solid and dashed lines indicate stable and unstable equilibria, respectively, both disregarding the 0 eigenvalues along the direction of L in the case of θ1=θ12. a Movement of three equilibria in the full state space as δ varies when θ1=5 and θ12=8. A transcritical bifurcation occurs involving the face equilibrium on n12=1 and the edge equilibrium x∗,0,1, where x∗=1/6, at δ=7/22. The second transcritical bifurcation occurs involving the face equilibrium on n1=0 and the edge equilibirium x∗,0,1, where x∗=1/9, at δ=10/31. b Positions of all the same three edge and face equilibria as a function of δ. The θ1 and θ12 values are the same as those used in a. In b, the three curves do not meet at a single point, as shown in the inset, which is a magnification of the main panel. c Same as a but when θ1=θ12=5. A transcritical bifurcation occurs involving the face equilibrium on n12=1 and that on n1=0 at 16,0,1 when δ=7/22. Edge equilibrium x∗,0,1 also collides with the two face equilibria at this value of δ. d Same as b but when θ1=θ12=5. There is another triplet of equilibria in addition to the triplet of equilibria shown in c. For this second set of triplet of equilibria, a transcritical bifurcation occurs involving the face equilibrium on n12=0 and that on n1=1, and edge equilibrium x∗,1,0 collides with the bifurcation point, at δ=15/22. Note that x∗ is not constant along the trajectories in b, whereas it is in d

Movement of Stable Equilibria as δ Varies

The results in Sects. 3.1–3.4 indicate that, for given θ1 and θ12 (≠θ1) values, there are three equilibria, two of which are face equilibria and one is an edge equilibrium. Just one of these three equilibria is stable for a given value of δ.

Specifically, when θ1<θ12, a face equilibrium is stable when 0<δ<δc,1, an edge equilibrium is stable when δc,1<δ<δc,2, and another face equilibrium is stable when δc,2<δ<1; see Fig. 3a. As δ varies, the position of the stable equilibrium continuously moves, including through δ=δc,1 and δ=δc,2. The dynamical system undergoes a transcritical bifurcation at δ=δc,1, with which the face equilibrium and the edge equilibrium exchange the stability. Another similar transcritical bifurcation occurs at δ=δc,2. See Fig. 4a, b for visualization. When θ1>θ12, a different set of three equilibria, which reside on the opposite side of the unit-cube state space, are stable for a respective range of δ, as shown in Fig. 3b. Similarly to the case of θ1<θ12, these equilibria undergo transcritical bifurcations at δ=δc,3 and δc,4.Fig. 5 Real part of the eigenvalues of the Jacobian near transcritical bifurcations as a function of δ. We use the payoff matrices given by Eq. (38). It should be noted that the third eigenvalue in a and b is always negative and thus is not shown, and that the third eigenvalue in c and d is always 0. a θ1=5 and θ12=8. Each color represents a face or edge equilibrium. Two eigenvalues become 0 at δ=δc,1=7/22≈0.31818, and another two eigenvalues become 0 at δ=δc,2=10/31≈0.32258. Each of these δ values marks a transcritical bifurcation. At δ≈0.31822 and 0.32321, the eigenvalues of the stable face equilibrium turns from real to imaginary and vice versa. b θ1=8 and θ12=5. Two eigenvalues become 0 at δ=δc,3=21/31≈0.67742, and another two eigenvalues become 0 at δ=δc,4=15/22≈0.68182. Each of these δ values marks a transcritical bifurcation. At δ≈0.67732 and 0.68194, the eigenvalues of the stable face equilibrium turns from real to imaginary and vice versa. c θ1=θ12=5 and near the first transcritical bifurcation at δ=δc,1=7/22≈0.31818. At δ≈0.31806 and 0.31830, the eigenvalues of the stable face equilibrium turns from real to imaginary and vice versa. d θ1=θ12=5 and near the second transcritical bifurcation at δ=δc,3=15/22≈0.68182. At δ≈0.68170 and 0.68194, the eigenvalues of the stable face equilibrium turns from real to imaginary and vice versa

We point out that, as the transcritical bifurcation is approached as δ gradually increases from 0, the two eigenvalues are both first complex conjugates with negative real parts and then change to real negative values. Figure 5a shows the dependence of the real part of the two eigenvalues on δ around δ=δc,1. When the stable face equilibrium approaches an edge of the unit cube, it becomes a sink, enabling the transcritical bifurcation on the edge. The dependence of the Jacobian eigenvalues of the three equilibria near δ=δc,2 is qualitatively the same as that near δ=δc,1 (see Fig. 5b).

Three-Dimensional System with θ1=θ12

In this section, as in Sect. 3, we assume that θ1=θ2 and that the initial condition satisfies x=y and n1=n2. Then, x=y and n1=n2 hold true for any t>0. We now further assume that θ1=θ2=θ12.

Corner Equilibria

By setting x∗, n1∗, and n12∗ to 0 or 1, we obtain eight corner equilibria. Similar to the case of θ1≠θ12 (see Sect. 3.1), each corner equilibrium is a saddle. See Appendix D for the proof.

Interior Equilibria

In this section, we look for equilibria in the interior of the unit cube, i.e., those satisfying 0<x∗,n1∗,n12∗<1. By setting n˙1=0 and n˙12=0 in Eqs. (14) and (15), respectively, with θ1=θ12, and imposing n1∗,n12∗∉{0,1}, we obtain42 x∗=11+θ1.

By substituting Eq. (42) in Eq. (13) and imposing x˙=0, we obtain43 n1∗(1-δ)+n12∗δ=R0-T0-P0θ1+S0θ1ρ1.

Any point on this line is an equilibrium. We call Eq. (43) the line of equilibria and denote it by L; it is the equilibrium manifold.Fig. 6 System’s behavior near the equilibrium manifold L. Shown are trajectories of the three dimensional system given by Eqs. (13), (14), and (15) when θ1=θ12 = 5 for two initial conditions. The green line indicates L, the line of equilibria given by Eq. (43). We use the payoff matrices given by Eq. (38), initial conditions (x,n1,n12)=(0.5,0.4,0.1), shown in blue, and (0.1, 0.9, 0.9), shown in orange, and set δ=0.5

We show in Appendix E that L is neutrally stable along the direction of L and that the other two eigenvalues, λ2 and λ3, have negative real part if Eqs. (2) and (19) hold true. In this case, line L attracts trajectories near L.

To demonstrate L, we numerically simulate trajectories with θ1=5 and δ=0.5, for which λ2,3=-0.019±0.810i. We show trajectories of the dynamics starting from two initial conditions in Fig. 6. The figure indicates that the solution spirals into L as expected.

Edge Equilibria

Let us examine possible edge equilibria. It should be noted that ρ1=ρ12 when θ1=θ12; we recall that ρ1 and ρ12 are defined in Eqs. (24) and (25), respectively. We find that there are just two edge equilibria when θ1=θ12, which are the same as those found for the case θ1≠θ12 in Sect. 3.3. These two edge equilibria occur where line L intersects the edge specified by n1∗=0,n12∗=1 or that specified by n1∗=1,n12∗=0.

We show in Appendix F that the edge equilibrium (x∗,n1∗,n12∗)=P0-S0-δ(P0-P1-S0+S1)R0-T0-S0+P0-δγ,0,1 is marginally stable with two zero eigenvalues and one negative eigenvalue if and only if Eq. (19) holds true and44 δ=δc,1=δc,2.

When δ≠δc,1, the Jacobian has two positive eigenvalues and one negative eigenvalue. Similarly, the edge equilibrium (x∗,n1∗,n12∗)=P1-S1+δ(P0-P1-S0+S1)R1-T1-S1+P1+δγ,1,0 is marginally stable if and only if Eq. (19) holds true and45 δ=δc,3=δc,4.

When δ≠δc,3, the Jacobian has two positive eigenvalues and one negative eigenvalue.Fig. 7 Existence of an invariant point on the line of equilibria, L, given by Eq. (43) for various values for δ. The legend shows the value of δ for each line. We use the payoff matrices given by Eq. (38) and set θ1=θ12=5. Because x∗=1/6, we take the slice of the unit cube with x∗=1/6 to examine the position of L as a function of n1∗ and n12∗. Line L intercepts the point 16,0,1 when δ=δc,1=7/22 and the point 16,1,0 when δ=δc,3=15/22. All the lines cross at 16,722,722, which owes to Eq. (46)

Face Equilibria

Similarly to the case of the edge equilibria, if we let x∗=0 or 1, then we obtain a corner equilibrium. Therefore, we assume that 0<x∗<1. By setting just one of n1∗ or n12∗ to 0 or 1, we obtain the four face equilibria shown in Table 1 but with θ1=θ12. Therefore, x∗=11+θ1 for any face equilibria. These face equilibria are stable under the same conditions as those found in Sect. 3.4, i.e., Eq. (19), and the conditions for δ given by Eqs. (37), (39), (40), and (41), i.e., δ<δc,3, δ>δc,4(=δc,3), δ<δc,1, and δ>δc,2(=δc,1), respectively. We also find that these stability requirements for δ coincide with the requirements for the face equilibria to exist. For example, line L intersects the n12=0 face of the unit cube defined by 0≤x,n1,n12≤1 if and only if δ satisfies Eq. (37), i.e., δ<δc,3.

To understand the location of the face equilibria depending on the value of δ, we examine the movement of line L on the (n1, n12) plane as we vary δ. The two intersections of L with the boundary of the square defined by 0≤n1,n12≤1, combined with x∗=11+θ1, give the two face equilibria. When the intersection is at a corner of the square, it is an edge equilibrium. We show L as a function of δ in Fig. 7 for the payoff matrices given by Eq. (38). Figure 7 indicates that the two edge equilibria are realized at different δ values, which is consistent with the results shown in Sect. 4.3. The figure also indicates that L passes through a particular point regardless of the δ value. By setting both the coefficient of δ and the constant term to 0 in Eq. (43), we obtain this point as follows:46 (x∗,n1∗,n12∗)=11+θ1,R0-T0-P0θ1+S0θ1ρ1,R0-T0-P0θ1+S0θ1ρ1.

Figure 7 also indicates that, when δ is small, n1∗ is highly variable between 0 and 1, but the range of n12∗ is small. When δ is large, the converse is true. This result is natural because a larger δ implies that more interaction between players occur between the two communities than in the same community.

As δ varies, our three-dimensional dynamical system undergoes two bifurcations at δ=δc,1 and δ=δc,3. When 0<δ<δc,1, the face equilibrium with n12∗=1 is stable except along the direction of L (therefore, the Jacobian has two negative eigenvalues and one 0 eigenvalue), and the edge equilibrium given by (x∗,n1∗,n12∗)=P0-S0-δ(P0-P1-S0+S1)R0-T0-S0+P0-δγ,0,1 and the face equilibrium with n1∗=0 are saddles (when disregarding the 0 eigenvalue along the direction of the line of equilibria; same in the following text). When δ=δc,1, the dynamical system undergoes a transcritical bifurcation and the stability of the two face equilibria switches. At δ=δc,1, the edge equilibrium has two 0 eigenvalues and one negative eigenvalue. These three equilibria collide at δ=δc,1, which we depict in Fig. 4c, d. When δc,1<δ<1, the face equilibrium with n12∗=1 and the edge equilibrium given by (x∗,n1∗,n12∗)=P0-S0-δ(P0-P1-S0+S1)R0-T0-S0+P0-δγ,0,1 are saddles, and the face equilibrium with n1∗=0 is stable. There are three other equilibria located at the other end of L intersecting a face or edge of the state space, i.e., the unit cube. The structure of the bifurcation occurring at δ=δc,3, involving this second triplet of equilibria, which are composed of two face equilibria (one with n1∗=1 and the other with n12∗=0) and one edge equilibrium given by (x∗,n1∗,n12∗)=P1-S1+δ(P0-P1-S0+S1)R1-T1-S1+P1+δγ,1,0, is qualitatively the same.

Similarly to when θ1≠θ12, as δ gradually increases from 0 to approach the first transcritical bifurcation, the two eigenvalues except the 0 eigenvalue are first complex conjugates with negative real parts and then change to real negative values. Figure 5c shows the dependence of the real part of the two eigenvalues on δ around δ=δc,1. Therefore, when L intersects the unit cube at a point not close to an edge, trajectories on the face spiral into the stable face equilibria, which is consistent with the numerical results shown in Fig. 6. When the stable face equilibrium approaches an edge of the unit cube, it becomes a sink, enabling the transcritical bifurcation on the edge. The dependence of the Jacobian eigenvalues of the three equilibria near δ=δc,3 is qualitatively the same as that near δ=δc,1 (see Fig. 5d).Fig. 8 Rich dynamical behavior of the full model. Shown are time courses of trajectories of the five-dimensional system for different parameter choices and initial conditions. a θ1=3, θ2=5, θ12=8, and δ=0.95 with initial condition (x,y,n1,n2,n12)=(0.5,0.3,0.5,0.1,0.5). b Same parameter values as a but with initial condition (x,y,n1,n2,n12)=(0.4,0.8,0.8,0.6,0.2). c θ1=3, θ2=5, θ12=8, and δ=0.31 with initial condition (x,y,n1,n2,n12)=(0.1,0.5,0.1,0.9,0.5). d θ1=3, θ2=5, θ12=8, and δ=0.4 with initial condition (x,y,n1,n2,n12)=(0.1,0.5,0.1,0.9,0.5). e θ1=0.3, θ2=0.4, θ12=0.45, and δ=0.29 with initial condition (x,y,n1,n2,n12)=(0.5,0.5,0.5,0.5,0.5). f θ1=0.3, θ2=0.4, θ12=0.45, and δ=0.35 with initial condition (x,y,n1,n2,n12)=(0.5,0.5,0.5,0.5,0.5)

Five-Dimensional System

In this section, we analyze the five-dimensional dynamical system given by Eqs. (8)– (12) without assuming symmetry between the two communities. We exhaustively examine its equilibria as follows. First, we search for all possible combinations of x,y,n1,n2, and n12 by classifying the value of each variable to be either 0, 1, or between 0 and 1. Because three options are available for each variable, there are 35=243 possible combinations. Second, we find that the 25=32 corners of the state space given by x,y,n1,n2,n12∈{0,1} are equilibria, more specifically, saddles. Third, out of the remaining 211 combinations, we have found that 60 combinations are equilibria; the other 151 combinations are not. We show these equilibria in Appendix G. By analyzing the Jacobian of the 60 equilibria with the assistance of Mathematica, we find that 21 of them are stable under some conditions (see Appendix G).

In contrast to the reduced three-dimensional dynamical system, there is multistability in the present five-dimensional dynamical system. There are 11 multistable pairs of equilibria, and these equilibria tend to be multistable when δ is large. Six of these 11 pairs are multistable for any δ>0.75. The other five pairs require δ to be larger, approximately δ>0.9. We demonstrate a multistable pair of equilibria in Fig. 8a, b, which show two trajectories for θ1=3, θ2=5, θ12=8, and δ=0.95. The initial condition is (x,y,n1,n2,n12)=(0.5,0.3,0.5,0.1,0.5) in Fig. 8a and (x,y,n1,n2,n12)=(0.4,0.8,0.8,0.6,0.2) in Fig. 8b. The trajectory converges towards (x∗,y∗,n1∗,n2∗,n12∗)≈(0.222,0,0,0,0.523) in Fig. 8a and ≈(0,0.222,0,1,0.450) in Fig. 8b.

Figure 8c shows an oscillatory trajectory for θ1=3, θ2=5, θ12=8, δ=0.31, and initial condition (x,y,n1,n2,n12)=(0.1,0.5,0.1,0.9,0.5). The inset of the figure, showing the time courses of x and y, indicates anti-synchronization behavior during the oscillatory dynamics. We point out the environmental state between the two communities is bountiful (i.e., n12≈1) and almost constant despite the anti-synchronous dynamics between x and y. When one increases δ to δ=0.4, with all the other parameter values being the same as those used in Fig. 8c, the oscillations become apparently aperiodic while keeping anti-synchronous behavior between x and y (see Fig. 8d). We observe n12≈1 and n2≈0 during this apparently aperiodic dynamics. It should be noted that n1 is similarly aperiodic.

We show in Fig. 8e the trajectory for θ1=0.3, θ2=0.4, θ12=0.45, δ=0.29, and initial condition (x,y,n1,n2,n12)=(0.5,0.5,0.5,0.5,0.5). Similar to Fig. 8c, the trajectory shown in Fig. 8e shows apparent convergence to a limit cycle and approximate anti-synchronization between x and y, but accompanying sudden jumps in various variables in each cycle. When δ is increased to 0.35, the amplitude of oscillation becomes larger, in particular in terms of n1 and n2 (see Fig. 8f).

Discussion

We extended a previously proposed model of eco-evolutionary dynamics (Weitz et al. 2016) to the case of networks with two equally sized communities. In the three-dimensional dynamical system given by Eqs. (13), (14), and (15), which assumes symmetry between the two communities, a further assumption that n1=n12 lends the model the same as the original well-mixed population model (Weitz et al. 2016), and the requirement for the stability of equilibria, i.e., Eq. (19), is the same as that derived in Weitz et al. (2016) as well.

Under the generic condition n1≠n12, our stability requirement for the equilibria again contained that of Weitz et al. (2016), i.e., Eq. (19). However, the stability of the equilibria in our model also requires conditions on the edge weight between two communities, i.e., δ, and on environment recovery rates, i.e., θ1 (=θ2) and θ12. When θ1=θ12, the line of equilibria, L, only requires Eq. (19) for stability, but the position of L depends on θ1 and δ. This result implies that the network has no effect on the stability requirements when θ1=θ12. In contrast, when θ1≠θ12, the network and the environment recovery rates affect the stability of the system. As a remark, it was mathematically found (Gong et al. 2022) that the eco-evolutionary dynamical system proposed in Weitz et al. (2016) has no limit cycles. This mathematical result corroborates with the theoretical results in Weitz et al. (2016), in which it was proven that the oscillations converge to a heteroclinic cycle, and our numerical results; because we have analytically shown that there is no internal unstable equilibrium, it is unlikely that our system has a limit cycle.

There exists another commonly explored family of dynamic payoff matrices dependent on environmental feedback, given by47 A(n)=(1-n)TPRS+nRSTP,

where T>R and P>S (Weitz et al. 2016; Gong et al. 2018; Kawano et al. 2019; Liu et al. 2020; Stella et al. 2022a; Zhang et al. 2023). With Eq. (47), we retain mutual cooperation as a Nash equilibrium when n=0 and mutual defection when n=1. In addition, this payoff matrix causes Eq. (19) to be satisfied with equality. By using this payoff matrix and holding the assumption that θ1=θ12, it is straightforward to analytically obtain a neutrally stable interior line of equilibria, which implies closed periodic orbits in the interior of the state space, corroborating the results in Weitz et al. (2016). When θ1≠θ12, our system with Eq. (47) in fact shows a closed periodic orbit on a face of the hypercubic state space. Therefore, we claim that the closed periodic orbits found in the previous studies with Eq. (47) are at least partially due to the symmetry in the payoff matrix given by Eq. (47). In the absence of such a symmetry, our results suggest that convergence to stable equilibria is a norm regardless of the population structure.

When we removed the assumption of symmetry between the two communities by allowing θ1≠θ2, we obtained a rich repertoire of stable equilibria, some of which coexist to realize multistability, especially when δ is large. Multistability was also found in other eco-evolutionary models (Tilman et al. 2020; Bairagya et al. 2021), but these models are ecological extensions of Weitz et al. (2016) and are not network-based models as our model is. Bistability was also found in a spatial eco-evolutionary model (Hauert et al. 2019), but for the trivial equilibria (i.e., bistability between an equilibrium with no cooperators in a replete environment and an equilibrium only with cooperators in a rich environment) and under the snowdrift game. In contrast to these previous studies showing multistability in eco-evolutionary game dynamics, our model is a direct network extension of the original model proposed in Weitz et al. (2016) and without additional ecological assumptions. The present results suggest that multistability may be commonly found in the same eco-evolutionary model on various networks. We also found anti-synchronization behavior during oscillatory population dynamics. This type of behavior was found in a prior complete bipartite graph model (Liu et al. 2020), but for the division of labor game rather than the typical prisoner’s dilemma game. When our stability requirements are not satisfied, our system may converge to a heteroclinic cycle. Further exploring different types of oscillatory behavior in networked eco-evolutionary game dynamics may be interesting.

We emphasize that our model substantially varies from the previously proposed model composed of two interacting subpopulations, or precisely, complete bipartite graphs (Gong et al. 2018; Kawano et al. 2019; Shu and Fu 2022). Their model does not allow interaction between players in the same subpopulation, whereas our model does. Furthermore, these previous studies adopted the dynamic payoff matrix given by Eq. (47), which led to closed periodic orbits, as we discussed above. In Gong et al. (2018) and Kawano et al. (2019), such cyclic orbits do not accompany anti-synchronous oscillation of the fraction of cooperation in the two subpopulations. Instead, the cyclic behavior originates from interplay of the fraction of one of the two subpopulations and the environmental variable. On the other hand, the orbits obtained in Shu and Fu (2022) show largely in-phase synchronous oscillation between the two subpopulations. The model in Gong et al. (2018) and Kawano et al. (2019) was extended in Liu et al. (2020) to include a different form of A(n) and different influences of strategies in two subpopulations on the environment. The inclusion of these parameters produces periodic orbits as did the models proposed in Gong et al. (2018) and Kawano et al. (2019). In contrast, our model showed anti-phase oscillations in terms of the fraction of cooperators in the two communities (i.e., x and y) and multistability. Therefore, even within the family of two-subpopulation networks, which is one of the simplest network model, qualitatively different dynamical behavior may arise depending on the assumption on the environmental dynamics.

Prior extensions of the eco-evolutionary game models to larger networks include those to spatial lattices and regular graphs. The spatial extensions have been to the case of square lattices (Jin et al. 2018; Szolnoki and Chen 2018; Wu et al. 2018, 2019; Hauert et al. 2019; Lin and Weitz 2019; Yang and Zhang 2021; Ding et al. 2023; He et al. 2023; Lu et al. 2023; Zhu 2023). A lattice model of eco-evolutionary game dynamics assuming local environmental variables, meaning that each node (i.e., player) has its own dynamical environmental state, resulted in spatiotemporal patterns, including clustering, flickering, and wave-like patterns (Lin and Weitz 2019). Enhanced cooperation due to the environmental feedback was also found in eco-evolutionary models on square lattices (Jin et al. 2018; Szolnoki and Chen 2018; Wu et al. 2018, 2019; Ding et al. 2023; He et al. 2023; Lu et al. 2023; Zhu 2023). Another type of network that has been studied with eco-evolutionary feedback is regular graphs, in which all nodes have degree k. Through the use of pair approximation, the extension of the original model (Weitz et al. 2016) to regular graphs (therefore using the payoff matrix given by Eq. (47)) has clarified that an increased k induces the internal stable equilibrium to become neutrally stable, producing periodic orbits (Stella et al. 2022a; Zhang et al. 2023). These models are substantially different from ours not only in the network structure but also in that their model assumes that the environment is global to all nodes. Assigning an environmental state nij to each edge (i, j), as has been done for square lattices in previous studies (He et al. 2023; Zhu 2023) and for a two-community network in the present study, in the case of regular graphs and general networks may be an interesting generalization.

In addition to the extension of the network structure, edge-dependent environmental state variable, and weighted networks, which we discussed above, there are further possible extensions of the present model as future work. First, in well-mixed populations, incorporation of intrinsic environmental dynamics, such as resource growth and decay, results in multistability and limit cycles (Tilman et al. 2020), which one can explore for networks. Second, the incorporation of dynamic recovery and degradation rates for the environmental state, which are boosted by cooperators’ and defectors’ payoffs (Cao and Wu 2021), leads to the same stability requirement as that in Weitz et al. (2016), i.e., Eq. (19). One can extend the present model to the case of dynamic rates of environment recovery and degradation by letting, e.g., θ1 depend on x and n1. Third, the use of finite carrying capacity in an environment, which excludes any periodic orbits and enables bistability in the original model (Bairagya et al. 2021), should be possible. Fourth, the incorporation of aspiration dynamics, with which players update their strategies based on whether or not they are satisfied with their current payoff (Arefin and Tanimoto 2021) is another possible direction of research. Lastly, although we studied the prisoner’s dilemma, as other eco-evolutionary game dynamics models, our model can be studied for other games such as the prisoner’s dilemma with voluntary participation (Liu et al. 2020; Li et al. 2021), coordination game (Weitz et al. 2016; Lin and Weitz 2019; Bairagya et al. 2021; Shu and Fu 2022), anti-coordination game (Weitz et al. 2016; Lin and Weitz 2019; Bairagya et al. 2021), and division-of-labor game (Liu et al. 2020).

In conclusion, we have studied an eco-evolutionary game dynamics model with two distinct network communities. We find that the interaction rates both within and between these communities significantly impact on the resulting dynamical behavior and the determination of possible equilibrium classes (i.e., interior, face, edge, and corner) of the system. In addition to numerical investigation of the full model, we have performed comprehensive stability analysis of the simplified system under symmetry conditions. Our work highlights the importance of community structures in impacting eco-evolutionary dynamics across different ecological niches.

Appendix A:  Corner Equilibria of the Three-Dimensional System with θ1≠θ12

By evaluating Eq. (16) at each corner equilibrium, we obtain48 J(0,0,0)=S0-P0000-1000-1,

49 J(0,0,1)=-P0(1-δ)-P1δ+S0(1-δ)+S1δ000-10001,

50 J(0,1,0)=-P0δ-P1(1-δ)+S0δ+S1(1-δ)0001000-1,

51 J(0,1,1)=S1-P100010001,

52 J(1,0,0)=T0-R0000θ1000θ12,

53 J(1,0,1)=-R0(1-δ)-R1δ+T0(1-δ)+T1δ000θ1000-θ12,

54 J(1,1,0)=-R0δ-R1(1-δ)+T0δ+T1(1-δ)000-θ1000θ12,

55 J(1,1,1)=T1-R1000-θ1000-θ12.

By Eq. (2), we obtain that S0-P0>0, T0-R0<0, S1-P1<0, and T1-R1>0. Therefore, each of these Jacobians has at least one positive eigenvalue and one negative eigenvalue, and each corner equilibrium is a saddle.

Appendix B:  Edge Equilibria of the Three-Dimensional System with θ1≠θ12

B.1  Equilibrium (x∗,n1∗,n12∗)=P0-S0-δ(P0-P1-S0+S1)R0-T0-S0+P0-δγ,0,1

For the equilibrium (x∗,n1∗,n12∗)=P0-S0-δ(P0-P1-S0+S1)R0-T0-S0+P0-δγ,0,1, the Jacobian, Eq. (16), is reduced to56 J=J11(2)J12(2)J13(2)0J22(2)000J33(2),

where57 J11(2)=[(P0-S0)(1-δ)+δ(P1-S1)][(R0-T0)(1-δ)+δ(R1-T1)]R0-T0-S0+P0-δγ,

58 J12(2)=(1-δ)ω[(P0-S0)(1-δ)+δ(P1-S1)][(R0-T0)(1-δ)+δ(R1-T1)](R0-T0-S0+P0-δγ)3,

59 J13(2)=δω[(P0-S0)(1-δ)+δ(P1-S1)][(R0-T0)(1-δ)+δ(R1-T1)](R0-T0-S0+P0-δγ)3,

60 J22(2)=-R0-T0-P0θ1+S0θ1-δρ1R0-T0-S0+P0-δγ,

61 J33(2)=R0-T0-P0θ12+S0θ12-δρ12R0-T0-S0+P0-δγ,

and62 ω=(P0-S0)(R1-T1)-(P1-S1)(R0-T0).

The eigenvalues of J are given by λ=J11(2),J22(2),J33(2). Using the fact that each eigenvalue has a common denominator, which we refer to as63 μ1≡R0-T0-S0+P0-δγ,

we determine the stability of the edge equilibrium by examining the following four possible cases.

Case 1: γ>0 and μ1>0

First, γ is positive if and only if64 R0-T0-R1+T1>S0-P0-S1+P1.

Under this condition, μ1 is positive if and only if65 δ<R0-T0-S0+P0γ.

For positive δ values satisfying Eq. (65) to exist, it must hold true that R0-T0>S0-P0.

Eigenvalues J22(2) and J33(2) are negative if and only if66 δ<R0-T0-P0θ1+S0θ1ρ1

and67 δ>R0-T0-P0θ12+S0θ12ρ12,

respectively. Lastly, eigenvalue J11(2) is negative if either68 δ<minP0-S0P0-S0-P1+S1,R0-T0R0-T0-R1+T1

or69 δ>maxP0-S0P0-S0-P1+S1,R0-T0R0-T0-R1+T1

holds true. However, we find that there is no δ value that simultaneously satisfies Eqs. (65), (66), (67), and (68), or one that simultaneously satisfies Eqs. (65), (66), (67), and (69).

Case 2: γ>0 and μ1<0

If γ>0, then μ1<0 if and only if70 δ>R0-T0-S0+P0γ.

For positive δ values satisfying Eq. (70) to exist and be less than 1, it must hold true that R1-T1<S1-P1. Eigenvalues J22(2) and J33(2) are negative if and only if71 δ>R0-T0-P0θ1+S0θ1ρ1=δc,1

and72 δ<R0-T0-P0θ12+S0θ12ρ12=δc,2,

respectively. For a δ value satisfying Eqs. (71) and (72) to exist, it must hold true that θ12>θ1.

Lastly, because we have assumed that μ1<0, the numerator of Eq. (57) has to be positive for eigenvalue J11(2) to be negative. Then, either both (P0-S0)(1-δ)+δ(P1-S1) and (R0-T0)(1-δ)+δ(R1-T1) are positive or both are negative.

If both (P0-S0)(1-δ)+δ(P1-S1) and (R0-T0)(1-δ)+δ(R1-T1) are positive, we obtain73 δ>P0-S0P0-S0-P1+S1

and74 δ<R0-T0R0-T0-R1+T1.

We find that there is no δ value that simultaneously satisfies Eqs. (70), (71), (72), (73), and (74).

If both (P0-S0)(1-δ)+δ(P1-S1) and (R0-T0)(1-δ)+δ(R1-T1) are negative, we obtain75 δ<P0-S0P0-S0-P1+S1

and76 δ>R0-T0R0-T0-R1+T1.

A δ value satisfying Eqs. (75) and (76) exists if and only if77 R0-T0R0-T0-R1+T1<P0-S0P0-S0-P1+S1,

which is equivalent to Eq. (19).

Such a δ value satisfying δ∈(0,1) exists if and only if the right-hand side (RHS) of Eq. (75) is positive and that of Eq. (76) is less than 1. In fact, because P0-S0<0 and S1-P1<0, the numerator and denominator on the RHS of Eq. (75) are negative, which implies that the RHS is positive. The RHS of Eq. (76) is less than 1 because we obtain R0-T0>0 and R1-T1<0 from Eq. (2). Lastly, the intersection of the conditions derived for δ, given by Eqs. (70), (71), (72), (75), and (76), yields Eq. (20), i.e., δc,1<δ<δc,2.

Case 3: γ<0 and μ1>0

In this section, we assume that γ<0, i.e78 R0-T0-R1+T1<S0-P0-S1+P1.

Then, μ1>0 if and only if Eq. (70) is satisfied. For positive δ values satisfying Eq. (70) to exist and be less than 1, it must hold true that R1-T1<S1-P1. If μ1>0, then we obtain Eqs. (66), (67), (68), and (69), and again find that there is no δ value that simultaneously satisfies these inequalities.

Case 4: γ<0 and μ1<0

In this section, we assume that γ<0 and μ1<0, which requires Eq. (65) to be satisfied. For positive δ values satisfying Eq. (65) to exist, it must hold true that R0-T0>S0-P0. The derivation of the stability of this case follows the same derivation as Case 2, and we find that the equilibrium is stable if and only if Eqs. (19), (20), and (27) hold true.

B.2  Equilibrium (x∗,n1∗,n12∗)=P1-S1+δ(P0-P1-S0+S1)R1-T1-S1+P1+δγ,1,0

For the equilibrium (x∗,n1∗,n12∗)=P1-S1+δ(P0-P1-S0+S1)R1-T1-S1+P1+δγ,1,0, the Jacobian is given by79 J=J11(3)J12(3)J13(3)0J22(3)000J33(3),

where80 J11(3)=[(P1-S1)(1-δ)+δ(P0-S0)][(R1-T1)(1-δ)+δ(R0-T0)]R1-T1-S1+P1+δγ,

81 J12(3)=(1-δ)ω[(P1-S1)(1-δ)+δ(P0-S0)][(R1-T1)(1-δ)+δ(R0-T0)](R1-T1-S1+P1+δγ)3,

82 J13(3)=δω[(P1-S1)(1-δ)+δ(P0-S0)][(R1-T1)(1-δ)+δ(R0-T0)](R0-T0-S0+P0-δγ)3,

83 J22(3)=R1-T1-P1θ1+S1θ1+δρ1R1-T1-S1+P1+δγ,

84 J33(3)=-R1-T1-P1θ12+S1θ12+δρ12R1-T1-S1+P1+δγ.

The eigenvalues of J are given by λ=J11(3),J22(3),J33(3). Similarly to the prior equilibrium, we see that each eigenvalue has a common denominator, which we refer to as85 μ2≡R1-T1-S1+P1+δγ.

We determine the stability of the edge equilibrium by examining the following four possible cases.

Case 1: γ>0 and μ2>0

First, γ is positive if and only if Eq. (64) is satisfied. Then, μ2 is positive if and only if86 δ>-(R1-T1-S1+P1)γ.

For positive δ values satisfying Eq. (86) to exist and be less than 1, it must hold true that R0-T0>S0-P0.

Eigenvalues J22(3) and J33(3) are negative if and only if87 δ<-(R1-T1-P1θ1+S1θ1)ρ1

and88 δ>-(R1-T1-P1θ12+S1θ12)ρ12,

respectively. Lastly, J11(3) is negative if either89 δ<min-(P1-S1)P0-S0-P1+S1,-(R1-T1)R0-T0-R1+T1

or90 δ>max-(P1-S1)P0-S0-P1+S1,-(R1-T1)R0-T0-R1+T1

holds true. However, we find that there is no δ value that simultaneously satisfies Eqs. (86), (87), (88), and (89) or Eqs. (86), (87), (88), and (90).

Case 2: γ>0 and μ2<0

If γ is positive, then μ2<0 if and only if91 δ<-(R1-T1-S1+P1)γ.

For positive δ values satisfying Eq. (91) to exist, it must hold true that R1-T1<S1-P1. Eigenvalues J22(3) and J33(3) are negative if and only if92 δ>-R1+T1+P1θ1-S1θ1ρ1=δc,3

and93 δ<-R1+T1+P1θ12-S1θ12ρ12=δc,4,

respectively. For a δ value satisfying Eqs. (92) and (93) to exist, it must hold true that θ12<θ1.

Because we have assunmed that μ2<0, the numerator of Eq. (80) has to be positive for eigenvalue J11(3) to be negative. Then, either both (P1-S1)(1-δ)+δ(P0-S0) and (R1-T1)(1-δ)+δ(R0-T0) are positive or both are negative.

If both (P1-S1)(1-δ)+δ(P0-S0) and (R1-T1)(1-δ)+δ(R0-T0) are positive, we obtain94 δ<-(P1-S1)P0-S0-P1+S1

and95 δ>-(R1-T1)R0-T0-R1+T1.

We find that there is no δ value that simultaneously satisfies Eqs. (91), (92), (93), (94), and (95).

If both (P1-S1)(1-δ)+δ(P0-S0) and (R1-T1)(1-δ)+δ(R0-T0) are negative, we obtain96 δ>-(P1-S1)P0-S0-P1+S1

and97 δ<-(R1-T1)R0-T0-R1+T1.

A value of δ satisfying Eqs. (96) and (97) exists if and only if98 -(R1-T1)R0-T0-R1+T1<-(P1-S1)P0-S0-P1+S1,

which is equivalent to Eq. (19). Such a δ value satisfying δ∈(0,1) exists if and only if the RHS of Eq. (96) is less than 1 and that of Eq. (97) is positive. In fact, the RHS of Eq. (96) is less than 1 because we obtain P0-S0<0 and P1-S1>0 from Eq. (2). Because R0-T0>0 and T1-R1>0, the numerator and denominator on the RHS of Eq. (97) are positive, which implies that the RHS is positive. Lastly, the intersection of the conditions derived for δ, given by Eqs. (91), (92), (93), (96), and (97), yields Eq. (26), i.e., δc,3<δ<δc,4.

Case 3: γ<0 and μ2>0

In this section, we assume that γ<0, i.e., Eq. (78). Then, μ2>0 if and only if Eq. (91) is satisfied. For positive δ values satisfying Eq. (91) to exist, it must hold true that R1-T1<S1-P1. If μ2>0, then we obtain (87), (88), (89), (90) and (91). However, there is no δ value that simultaneously satisfies these inequalities.

Case 4: γ<0 and μ2<0

In this section, we assume that γ<0 and μ2<0, which requires Eq. (86). For positive δ values satisfying Eq. (86) to exist and be less than 1, it must hold true that R0-T0>S0-P0. The derivation of the stability of this case follows the same derivation as Case 2, and we find that the equilibrium is stable if and only if Eqs. (19), (26), and (27) hold true.

Appendix C:  Three Face Equilibria of the Three-Dimensional System with θ1≠θ12

In this section, we derive the stability conditions for three face equilibria of the three-dimensional system with θ1≠θ12.

C.1  Equilibrium (x∗,n1∗,n12∗)=11+θ12,1,R1-T1-P1θ12+S1θ12+δρ12δρ12

At (x∗,n1∗,n12∗)=11+θ12,1,R1-T1-P1θ12+S1θ12+δρ12δρ12, the Jacobian is reduced to99 J=J11(4)J12(4)J13(4)0J22(4)0J31(4)00,

where100 J11(4)=(P1-S1)(R0-T0)-(P0-S0)(R1-T1)θ12(1+θ12)ρ12,

101 J12(4)=-(1-δ)θ12ρ12(1+θ12)3,

102 J13(4)=-δθ12ρ12(1+θ12)3,

103 J22(4)=θ12-θ1θ12+1,

104 J31(4)=-(1+θ12)R1-T1-(P1-S1)θ12(R1-T1-P1θ12+S1θ12+δρ12)δ2ρ122.

The characteristic equation is given by105 J22(4)-λλ2-J11(4)λ-J13(4)J31(4)=0.

Eigenvalue λ1=J22(4)=θ12-θ1θ12+1 is negative if and only if θ12<θ1 (i.e., Eq. (27)). The real part of the other two eigenvalues is negative if and only if -J11(4)>0 and -J13(4)J31(4)>0. Equation (100) combined with ρ12>0 implies that -J11(4)>0 if and only if Eq. (19) holds true. Because J13(4)<0, condition -J13(4)J31(4)>0 is equivalent to J31(4)>0, which holds true if and only if δ>δc,4 (i.e., Eq. (39)).

In sum, this face equilibrium is stable if and only if Eqs. (19), (27), and (39) hold true.

C.2  Equilibrium (x∗,n1∗,n12∗)=11+θ1,R0-T0-P0θ1+S0θ1-δρ1(1-δ)ρ1,1

At (x∗,n1∗,n12∗)=11+θ1,R0-T0-P0θ1+S0θ1-δρ1(1-δ)ρ1,1, the Jacobian is reduced to106 J=J11(5)J12(5)J13(5)J21(5)0000J33(5),

where107 J11(5)=J11(1),

108 J12(5)=J12(1),

109 J13(5)=J13(1),

110 J21(5)=-(1+θ1)R1-T1-(P1-S1)θ1(R0-T0-P0θ1+S0θ1-δρ1)(1-δ)2ρ12,

111 J33(5)=-J33(1).

The characteristic equation is given by112 J33(5)-λλ2-J11(5)λ-J12(5)J21(5)=0.

Eigenvalue λ1=J33(5)=θ1-θ12θ1+1 is negative if and only if θ12>θ1 (i.e., Eq. (21)). The real part of the other two eigenvalues is negative if and only if -J11(5)>0 and -J12(5)J21(5)>0. Recall that -J11(5)=-J11(1)>0 if and only if Eq. (19) holds true. Because ρ1 and θ1 are positive, J12(5) is negative. Therefore, -J12(5)J21(5)>0 is equivalent to J21(5)>0, which holds true if and only if δ<δc,1 (i.e., Eq. (40)).

In sum, this face equilibrium is stable if and only if Eqs. (19), (21), and (40) hold true.

C.3  Equilibrium (x∗,n1∗,n12∗)=11+θ12,0,R0-T0-P0θ12+S0θ12δρ12

At (x∗,n1∗,n12∗)=11+θ12,0,R0-T0-P0θ12+S0θ12δρ12, the Jacobian is reduced to113 J=J11(6)J12(6)J13(6)0J22(6)0J31(6)00,

where114 J11(6)=J11(4),

115 J12(6)=J12(4),

116 J13(6)=J13(4),

117 J22(6)=-J22(4),

118 J31(6)=-(1+θ12)R0-T0-(P0-S0)θ12(R0-T0-P0θ12+S0θ12-δρ12)δ2ρ122.

The characteristic equation is given by119 J22(6)-λλ2-J11(6)λ-J13(6)J31(6)=0.

Eigenvalue λ1=J22(6)=θ1-θ12θ12+1 is negative if and only if θ12>θ1 (i.e., Eq. (21)). The real part of the other two eigenvalues is negative if and only if -J11(6)>0 and -J13(6)J31(6)>0. Recall that -J11(6)=-J11(4)>0 if and only if Eq. (19) holds true. Because ρ12 and θ12 are positive, J13(6) is negative. Therefore, -J13(6)J31(6)>0 is equivalent to J31(6)>0, which holds true if and only if δ>δc,2 (i.e., Eq. (41)).

In sum, this face equilibrium is stable if and only if Eqs. (19), (21), and (41) hold true.

Appendix D:  Corner Equilibria of the Three-Dimensional System with θ1=θ12

By evaluating Eq. (16) at each corner equilibrium, we obtain the same Jacobians as those in Appendix A with θ1=θ12. The stability analysis of these corner equilibria is the same as that in Appendix A, and we find that each Jacobian has at least one positive eigenvalue and one negative eigenvalue. Therefore, each of these corner equilibria is a saddle.

Appendix E:  Interior Equilibria of the Three-Dimensional System with θ1=θ12

In this section, we derive the stability requirements for the line of interior equilibria, L. By setting θ1=θ12 and x∗=11+θ1, we obtain the (2, 2) and (3, 3) entries of the Jacobian given by Eq. (16) as follows:120 -n1(θ1x+x-1)+(1-n1)(θ1x+x-1)=0

and121 -n12(θ1x+x-1)+(1-n12)(θ1x+x-1)=0.

Therefore, we obtain122 J(x,n1,n12)=x(1-x)∂g∂xx(1-x)∂g∂n1x(1-x)∂g∂n12+(1-2x)g(x,n1,n12)n1(1-n1)(1+θ1)00n12(1-n12)(1+θ1)00.

By substituting x∗=11+θ1, we obtain123 ∂g∂n1=∂q11∂n1-∂q12∂n1=-x(R3-S3-T3+P3)-(S3-P3)+δ(R3-T3-S3+P3)x=-(R3-T3)(1-δ)-(S3-P3)(θ1+δ)1+θ1.

Therefore, we obtain124 x(1-x)∂g∂n1=11+θ11-11+θ1-(R3-T3-P3θ1+S3θ1)+δ(R3-S3-T3+P3)1+θ1=-θ1[(R3-T3)(1-δ)+(S3-P3)(θ1+δ)](θ1+1)3≡σ2.

Likewise, using x∗=11+θ1, we obtain125 ∂g∂n12=-δ[(R3-T3-S3+P3)+(S3-P3)(1+θ1)]1+θ1

and126 x(1-x)∂g∂n12=11+θ11-11+θ1-δ(R3-T3+S3θ1-P3θ1)1+θ1=-δθ1(R3-T3+S3θ1-P3θ1)(θ1+1)3≡σ3.

Now, let us calculate the quantity for x(1-x)∂g∂x+(1-2x)g(x,n1,n12). We obtain127 ∂g∂x=∂q11∂x-∂q12∂x=(R0-T0-S0+P0)-(R3-S3-T3+P3)n1(1-δ)+n12δ.

By substituting Eq. (43) in Eq. (127), we obtain128 ∂g∂x=(R0-T0-S0+P0)-(R3-S3-T3+P3)R0-T0-P0θ1+S0θ1R3-T3-P3θ1+S3θ1=(θ1+1)[(P1-S1)(R0-T0)+(R1-T1)(S0-P0)]R0-R1-T0+T1-P0θ1+P1θ1+S0θ1-S1θ1.

Next, using x∗=11+θ1 and Eq. (43), we find129 g(x,n1,n12)=q11-q12=(R0-T0-S0+P0)x+S0-P0-n1(1-δ)+δn12[(R3-S3-T3+P3)x+(S3-P3)]=0.

Using Eqs. (128) and (129), we obtain130 x(1-x)∂g∂x=θ1[(P1-S1)(R0-T0)+(R1-T1)(S0-P0)](θ1+1)(R0-R1-T0+T1-P0θ1+P1θ1+S0θ1-S1θ1)≡σ1.

Using Eqs. (124), (126), and (130), we find that the Jacobian at any point of L is given by131 J=σ1σ2σ3σ400σ500,

where132 σ4=n1∗(1-n1∗)(1+θ1),

133 σ5=n12∗(1-n12∗)(1+θ1).

The characteristic equation is given by134 λλ2-σ1λ-(σ2σ4+σ3σ5)=0.

Eigenvalue λ1=0 reflects the fact that the line of equilibria, L, is neutrally stable along the direction of L. The other two eigenvalues, λ2 and λ3, are given by135 λ2,3=σ1±σ12+4(σ2σ4+σ3σ5)2.

Let α=-σ1 and β=-σ2σ4-σ3σ5. The real part of λ2 and λ3 is negative if and only if α>0 and β>0. Because the denominator of Eq. (130) is positive, then α>0 if and only if Eq. (19) holds true.

Now we seek the conditions under which β>0. Because n1∗ and n12∗ are positive, we obtain σ4>0 and σ5>0. Therefore, a sufficient condition for β>0 is that both σ2 and σ3 are negative. Using the assumptions in Eq. (2), we find that the numerators of σ2 and σ3 are always negative. Thus, under Eqs. (2) and (19), we obtain α>0 and β>0 such that the real parts of λ2 and λ3 are negative.

Appendix F:  Edge Equilibria of the Three-Dimensional System with θ1=θ12

F.1  Equilibrium (x∗,n1∗,n12∗)=P0-S0-δ(P0-P1-S0+S1)R0-T0-S0+P0-δγ,0,1

For the equilibrium (x∗,n1∗,n12∗)=P0-S0-δ(P0-P1-S0+S1)R0-T0-S0+P0-δγ,0,1, the Jacobian, Eq. (16), is reduced to136 J=J11(7)J12(7)J13(7)0J22(7)000J33(7),

where137 J11(7)=[(P0-S0)(1-δ)+δ(P1-S1)][(R0-T0)(1-δ)+δ(R1-T1)]R0-T0-S0+P0-δγ,

138 J12(7)=(1-δ)ω[(P0-S0)(1-δ)+δ(P1-S1)][(R0-T0)(1-δ)+δ(R1-T1)](R0-T0-S0+P0-δγ)3,

139 J13(7)=δω[(P0-S0)(1-δ)+δ(P1-S1)][(R0-T0)(1-δ)+δ(R1-T1)](R0-T0-S0+P0-δγ)3,

140 J22(7)=-R0-T0-P0θ1+S0θ1-δρ1R0-T0-S0+P0-δγ,

141 J33(7)=-J22(7),

and142 ω=(P0-S0)(R1-T1)-(P1-S1)(R0-T0).

The eigenvalues of J are given by λ=J11(7),J22(7), and J33(7). Using the fact that each eigenvalue has a common denominator, which we refer to as143 μ3≡R0-T0-S0+P0-δγ,

we determine the stability of the edge equilibrium by examining the following four possible cases.

Case 1: γ>0 and μ3>0

First, γ is positive if and only if144 R0-T0-R1+T1>S0-P0-S1+P1.

Under this condition, μ3 is positive if and only if145 δ<R0-T0-S0+P0γ.

For positive δ values satisfying Eq. (145) to exist, it must hold true that R0-T0>S0-P0.

Eigenvalues J22(7) and J33(7) are non-positive if and only if146 δ≤R0-T0-P0θ1+S0θ1ρ1

and147 δ≥R0-T0-P0θ1+S0θ1ρ1,

respectively, which implies that148 δ=R0-T0-P0θ1+S0θ1ρ1.

Lastly, eigenvalue J11(7) is negative if either149 δ<minP0-S0P0-S0-P1+S1,R0-T0R0-T0-R1+T1

or150 δ>maxP0-S0P0-S0-P1+S1,R0-T0R0-T0-R1+T1

holds true. However, we find that there is no δ value that simultaneously satisfies Eqs. (145), (148), and (149), or one that simultaneously satisfies Eqs. (145), (148), and (150).

Case 2: γ>0 and μ3<0

If γ>0, then μ3<0 if and only if151 δ>R0-T0-S0+P0γ.

For positive δ values satisfying Eq. (151) to exist and be less than 1, it must hold true that R1-T1<S1-P1. Eigenvalues J22(7) and J33(7) are non-positive if and only if152 δ≥R0-T0-P0θ1+S0θ1ρ1

and153 δ≤R0-T0-P0θ1+S0θ1ρ1,

respectively, which implies that154 δ=R0-T0-P0θ1+S0θ1ρ1.

Because we have assumed that μ3<0, the numerator of Eq. (137) has to be positive for eigenvalue J11(7) to be negative. Then, either both (P0-S0)(1-δ)+δ(P1-S1) and (R0-T0)(1-δ)+δ(R1-T1) are positive or both are negative.

If both (P0-S0)(1-δ)+δ(P1-S1) and (R0-T0)(1-δ)+δ(R1-T1) are positive, we obtain155 δ>P0-S0P0-S0-P1+S1

and156 δ<R0-T0R0-T0-R1+T1.

We find that there is no δ value that simultaneously satisfies Eqs. (151), (154), (155), and (156).

If both (P0-S0)(1-δ)+δ(P1-S1) and (R0-T0)(1-δ)+δ(R1-T1) are negative, we obtain157 δ<P0-S0P0-S0-P1+S1

and158 δ>R0-T0R0-T0-R1+T1.

A δ value satisfying Eqs. (157) and (158) exists if and only if159 R0-T0R0-T0-R1+T1<P0-S0P0-S0-P1+S1,

which is equivalent to Eq. (19).

Such a δ value satisfying δ∈(0,1) exists if and only if the RHS of Eq. (157) is positive and that of Eq. (158) is less than 1. In fact, because P0-S0<0 and S1-P1<0, the numerator and denominator on the RHS of Eq. (157) are negative, which implies that the RHS is positive. The RHS of Eq. (158) is less than 1 because we obtain R0-T0>0 and R1-T1<0 from Eq. (2). Lastly, the intersection of the conditions derived for δ, given by Eqs. (151), (154), (157), and (158), yields Eq. (44), i.e., δc,1=δc,2.

Case 3: γ<0 and μ3>0

In this section, we assume that γ<0, i.e160 R0-T0-R1+T1<S0-P0-S1+P1.

Then, μ3>0 if and only if Eq. (151) is satisfied. For positive δ values satisfying Eq. (151) to exist and be less than 1, it must hold true that R1-T1<S1-P1. If μ3>0, then we obtain Eqs. (148), (149), and (150), and again find that there is no δ value that simultaneously satisfies these inequalities.

Case 4: γ<0 and μ3<0

In this section, we assume that γ<0 and μ3<0, which requires Eq. (145) to be satisfied. For positive δ values satisfying Eq. (145) to exist, it must hold true that R0-T0>S0-P0. The derivation of the stability of this case follows the same derivation as Case 2, and we find that the equilibrium is marginally stable if and only if Eqs. (19) and (44) hold true.

F.2  Equilibrium (x∗,n1∗,n12∗)=P1-S1+δ(P0-P1-S0+S1)R1-T1-S1+P1+δγ,1,0

For the equilibrium (x∗,n1∗,n12∗)=P1-S1+δ(P0-P1-S0+S1)R1-T1-S1+P1+δγ,1,0, the Jacobian, Eq. (16), is reduced to161 J=J11(8)J12(8)J13(8)0J22(8)000J33(8),

where162 J11(8)=[(P1-S1)(1-δ)+δ(P0-S0)][(R1-T1)(1-δ)+δ(R0-T0)]R1-T1-S1+P1+δγ,

163 J12(8)=(1-δ)ω[(P1-S1)(1-δ)+δ(P0-S0)][(R1-T1)(1-δ)+δ(R0-T0)](R1-T1-S1+P1+δγ)3,

164 J13(8)=δω[(P1-S1)(1-δ)+δ(P0-S0)][(R1-T1)(1-δ)+δ(R0-T0)](R0-T0-S0+P0-δγ)3,

165 J22(8)=-R1-T1-P1θ1+S1θ1+δρ1R1-T1-S1+P1+δγ,

166 J33(8)=-J22(8).

The eigenvalues of J are given by λ=J11(8), J22(8), and J33(8). Similarly to the prior equilibrium, each eigenvalue has a common denominator, which we refer to as167 μ4≡R1-T1-S1+P1+δγ.

We determine the stability of the edge equilibrium by examining the following four possible cases.

Case 1: γ>0 and μ4>0

First, γ is positive if and only if Eq. (144) is satisfied. When γ>0 is satisfied, μ4 is positive if and only if168 δ>-(R1-T1-S1+P1)γ.

For positive δ values satisfying Eq. (168) to exist and be less than 1, it must hold true that R0-T0>S0-P0.

Eigenvalues J22(8) and J33(8) are non-positive if and only if169 δ≤-(R1-T1-P1θ1+S1θ1)ρ1

and170 δ≥-(R1-T1-P1θ1+S1θ1)ρ1,

respectively, which implies that171 δ=-(R1-T1-P1θ1+S1θ1)ρ1.

Lastly, J11(8) is negative if either172 δ<min-(P1-S1)P0-S0-P1+S1,-(R1-T1)R0-T0-R1+T1

or173 δ>max-(P1-S1)P0-S0-P1+S1,-(R1-T1)R0-T0-R1+T1

holds true. However, we find that there is no δ value that simultaneously satisfies Eqs. (168), (171), and (172) or Eqs. (168), (171), and (173).

Case 2: γ>0 and μ4<0

If γ is positive, then μ4<0 if and only if174 δ<-(R1-T1-S1+P1)γ.

For positive δ values satisfying Eq. (174) to exist, it must hold true that R1-T1<S1-P1. Eigenvalues J22(8) and J33(8) are non-positive if and only if175 δ≤-R1-T1-P1θ1+S1θ1ρ1

and176 δ≥-R1-T1-P1θ1+S1θ1ρ1,

respectively, which implies that177 δ=-(R1-T1-P1θ1+S1θ1)ρ1.

Because we have assumed that μ4<0, the numerator of Eq. (162) has to be positive for eigenvalue J11(8) to be negative. Then, either both (P1-S1)(1-δ)+δ(P0-S0) and (R1-T1)(1-δ)+δ(R0-T0) are positive or both are negative.

If both (P1-S1)(1-δ)+δ(P0-S0) and (R1-T1)(1-δ)+δ(R0-T0) are positive, we obtain178 δ<-(P1-S1)P0-S0-P1+S1

and179 δ>-(R1-T1)R0-T0-R1+T1.

We find that there is no δ value that satisfies Eqs. (174), (177), (178), and (179).

If both (P1-S1)(1-δ)+δ(P0-S0) and (R1-T1)(1-δ)+δ(R0-T0) are negative, we obtain180 δ>-(P1-S1)P0-S0-P1+S1

and181 δ<-(R1-T1)R0-T0-R1+T1.

A value of δ satisfying Eqs. (180) and (181) exists if and only if182 -(R1-T1)R0-T0-R1+T1<-(P1-S1)P0-S0-P1+S1,

which is equivalent to Eq. (19). Such a δ value satisfying δ∈(0,1) exists if and only if the RHS of Eq. (180) is less than 1 and that of Eq. (181) is positive. In fact, the RHS of Eq. (180) is less than 1 because we obtain P0-S0<0 and P1-S1>0 from Eq. (2). Because R0-T0>0 and T1-R1>0, the numerator and denominator on the RHS of Eq. (181) are positive, which implies that the RHS is positive. Lastly, the intersection of the conditions derived for δ, given by Eqs. (174), (177), (180), and (181), yields Eq. (45), i.e., δc,3=δc,4.

Case 3: γ<0 and μ4>0

In this section, we assume that γ<0, i.e., Eq. (78). Then, μ4>0 if and only if Eq. (174) is satisfied. For positive δ values satisfying Eq. (174) to exist, it must hold true that R1-T1<S1-P1. If μ4>0, then we obtain Eqs. (171), (172), (173), and (174), and find that there is no δ value that simultaneously satisfies these inequalities.

Case 4: γ<0 and μ4<0

In this section, we assume that γ<0 and μ4<0, which requires Eq. (168). For positive δ values satisfying Eq. (168) to exist and be less than 1, it must hold true that R0-T0>S0-P0. The derivation of the stability of this case follows the same derivation as Case 2, and we find that the equilibrium is stable if and only if Eqs. (19) and (45) hold true.

Appendix G:  Equilibria of the Five-Dimensional System

We show the 60 equilibria of the five-dimensional system with their stability requirements in Table 2.Table 2 Equilbria of the five-dimensional system with their stability requirements

x∗	y∗	n1∗	n2∗	n12∗	Stability conditions	
0	a	0	0	1	S0-P0>R0-T0,R1-T1<S1-P1,θ12>1+2θ2,1+2θ23+4θ2<δ<θ121+2θ12	
0	a	0	0	a	S0-P0>R0-T0,R1-T1<S1-P1,δ>θ121+2θ12,θ12>1+2θ2	
0	a	0	1	0	Never stable	
0	a	0	1	a	S0-P0>R0-T0,R1-T1<S1-P1,1<θ12<1+2θ2,δ>91+52θ12+9θ12293+54θ12+9θ122	
					S0-P0<R0-T0,R1-T1<S1-P1,1<θ12<1+2θ2,δ>91+52θ12+9θ12293+54θ12+9θ122	
0	a	0	a	0	Never stable	
0	a	0	a	1	S0-P0>R0-T0,R1-T1<S1-P1,θ2<12(-1+θ12),0.471<δ<1+2θ23+4θ2	
0	a	1	0	1	Never stable	
0	a	1	0	a	Never stable	
0	a	1	1	0	Never stable	
0	a	1	1	a	Never stable	
0	a	1	a	0	Never stable	
0	a	1	a	1	Never stable	
1	a	0	0	1	Never stable	
1	a	0	0	a	Never stable	
1	a	0	1	0	Never stable	
1	a	0	1	a	Never stable	
1	a	0	a	0	Never stable	
1	a	0	a	1	Never stable	
1	a	1	0	1	Never stable	
1	a	1	0	a	S0-P0>R0-T0,R1-T1<S1-P1,θ22+θ2<θ12<1,δ>9+20θ12+9θ1229+24θ12+13θ122	
1	a	1	1	0	S0-P0>R0-T0,R1-T1<S1-P1,θ2>2,θ12<12,34<δ<5-θ126	
1	a	1	1	a	S0-P0<R0-T0,R1-T1<S1-P1,θ12<θ22+θ2,δ>41+17θ1242+18θ12	
					S0-P0>R0-T0,R1-T1<S1-P1,θ2>2,θ12<12,5-θ126<δ<0.766	
1	a	1	a	0	S0-P0>R0-T0,R1-T1<S1-P1,θ2<2,5(1+θ2)6+7θ2<δ<5+2θ26+3θ2,θ12<0.454	
1	a	1	a	1	Never stable	
a	0	0	0	1	S0-P0>R0-T0,R1-T1<S1-P1,θ12>1,1+2θ1<θ12,1+2θ13+4θ1<δ<θ121+2θ12	
a	0	0	0	a	S0-P0>R0-T0,R1-T1<S1-P1,θ12>1+2θ1,δ>θ121+2θ12	
a	0	0	1	1	Never stable	
a	0	0	1	a	Never stable	
a	0	1	0	0	Never stable	
a	0	1	0	a	S0-P0<R0-T0,R1-T1<S1-P1,1<θ12<1+2θ1,δ>91+52θ12+9θ12293+54θ12+9θ122	
					S0-P0>R0-T0,R1-T1<S1-P1,1<θ12<1+2θ1,δ>9+8θ12+2θ12211+10θ12+2θ122	
a	0	1	1	0	Never stable	
a	0	1	1	a	Never stable	
a	0	a	0	0	Never stable	
a	0	a	0	1	S0-P0>R0-T0,R1-T1<S1-P1,θ12>1,θ12>1+2θ1,0.43<d<1+2θ13+4θ1	
a	0	a	1	0	Never stable	
a	0	a	1	1	Never stable	
a	1	0	0	1	Never stable	
a	1	0	0	a	Never stable	
a	1	0	1	1	Never stable	
a	1	0	1	a	S0-P0>R0-T0,R1-T1<S1-P1,θ12+θ1<θ12<1,δ>3+20θ12+9θ1223+24θ12+13θ122	
a	1	1	0	0	Never stable	
a	1	1	0	a	Never stable	
a	1	1	1	0	S0-P0>R0-T0,R1-T1<S1-P1,θ12<12,θ1>2,34<δ<5-θ126	
a	1	1	1	a	S0-P0<R0-T0,R1-T1<S1-P1,0<θ12<θ12+θ1,δ>41+17θ1242+18θ12	
					S0-P0>R0-T0,R1-T1<S1-P1,θ1>2.71,θ12<0.574,δ>0.76667	
a	1	a	0	0	Never stable	
a	1	a	0	1	Never stable	
a	1	a	1	0	S0-P0>R0-T0,R1-T1<S1-P1,θ12<0.454,1.66<θ1<2,5+5θ16+7θ1<δ<5+2θ16+3θ1	
a	1	a	1	1	Never stable	
a	a	0	0	1	S0-P0>R0-T0,R1-T1<S1-P1,θ2<12,θ2<θ12<12,θ1<θ2,1+2θ26+4θ2<δ<1+2θ126+4θ12	
a	a	0	a	1	Never stable	
a	a	0	a	a	Never stable	
a	a	1	1	0	S0-P0<R0-T0,R1-T1<S1-P1,θ12<θ2<θ1,5+2θ27+3θ2<δ<5+2θ127+3θ12	
					S0-P0>R0-T0,R1-T1<S1-P1,θ2>12,θ12<12,θ1>θ2,5+2θ26+4θ2<δ<34	
a	a	1	a	0	S0-P0<R0-T0,R1-T1<S1-P1,θ12<θ2<θ1,5+2θ127+3θ12<δ<1+2θ11+3θ1	
					S0-P0>R0-T0,R1-T1<S1-P1,θ2>2,θ12<12,0.58<δ<5+2θ27+3θ2	
a	a	1	a	a	Never stable	
a	a	a	0	a	Never stable	
a	a	a	0	a	Never stable	
a	a	a	1	0	Never stable	
a	a	a	1	a	Never stable	
a	a	a	a	0	S0-P0<R0-T0,R1-T1<S1-P1,θ1+θ2+2θ1θ2>θ12(2+θ1+θ2),δ<0.666	
					S0-P0>R0-T0,R1-T1<S1-P1,θ1+θ2+2θ1θ2>θ12(2+θ1+θ2),δ<0.58	
a	a	a	a	1	S0-P0<R0-T0,R1-T1<S1-P1,θ1+θ2+2θ1θ2>θ12(2+θ1+θ2),δ<0.04	
					S0-P0>R0-T0,R1-T1<S1-P1,θ1+θ2+2θ1θ2>θ12(2+θ1+θ2),δ<0.288	
Symbol “a” represents an equilibrium value between 0 and 1. When the analytical expression is too complicated, we show the numerical values to the third significant digit

Acknowledgements

N.M. acknowledges support from the Japan Science and Technology Agency (JST) Moonshot R &D (under Grant No. JPMJMS2021), the National Science Foundation (under Grant Nos. 2052720 and 2204936), and JSPS KAKENHI (under Grant Nos. JP 21H04595 and 23H03414).

Funding

Open Access funding provided by Kobe University.

Publisher's Note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
==== Refs
References

Arefin MR Tanimoto J Imitation and aspiration dynamics bring different evolutionary outcomes in feedback-evolving games Proc R Soc A 2021 477 20210240 10.1098/rspa.2021.0240
Bairagya JD Mondal SS Chowdhury D Chakraborty S Game-environment feedback dynamics in growing population: effect of finite carrying capacity Phys Rev E 2021 104 044407 10.1103/PhysRevE.104.044407 34781515
Brechtel A Gramlich P Ritterskamp D Drossel B Gross T Master stability functions reveal diffusion-driven pattern formation in networks Phys Rev E 2018 97 032307 10.1103/PhysRevE.97.032307 29776185
Cao L Wu B Eco-evolutionary dynamics with payoff-dependent environmental feedback Chaos Solitons Fractals 2021 150 111088 10.1016/j.chaos.2021.111088
Ding R Wang X Liu Y Zhao J Gu C Evolutionary games with environmental feedbacks under an external incentive mechanism Chaos Solitons Fractals 2023 169 113318 10.1016/j.chaos.2023.113318
Estrela S Libby E van Cleve J Débarre F Deforet M Harcombe W Peña J Brown S Hochberg M Environmentally mediated social dilemmas Trends Ecol Evol 2018 34 6 18 10.1016/j.tree.2018.10.004 30415827
Fahimipour AK Zeng F Homer M Traulsen A Levin SA Gross T Sharp thresholds limit the benefit of defector avoidance in cooperation on networks Proc Natl Acad Sci USA 2022 119 e2120120119 10.1073/pnas.2120120119 35939706
Gong L, Gao J, Cao M (2018) Evolutionary game dynamics for two interacting populations in a co-evolving environment. In: IEEE conference on decision and control (CDC), pp 3535–3540
Gong L Yao W Gao J Cao M Limit cycles analysis and control of evolutionary game dynamics with environmental feedback Automatica 2022 145 110536 10.1016/j.automatica.2022.110536
Gross T Allhoff KT Blasius B Brose U Drossel B Fahimipour AK Guill C Yeakel JD Zeng F Modern models of trophic meta-communities Philos Trans R Soc B 2020 375 20190455 10.1098/rstb.2019.0455
Guimarães PR The structure of ecological networks across levels of organization Annu Rev Ecol Evol Syst 2020 51 433 460 10.1146/annurev-ecolsys-012220-120819
Han W Zhang Z Zhu Y Xia C Co-evolutionary dynamics in optimal multi-agent game with environment feedback Neurocomputing 2024 581 127510 10.1016/j.neucom.2024.127510
Hanski IA Eco-evolutionary spatial dynamics in the glanville fritillary butterfly Proc Natl Acad Sci USA 2011 108 14397 14404 10.1073/pnas.1110020108 21788506
Hauert C Saade C McAvoy A Asymmetric evolutionary games with environmental feedback J Theor Biol 2019 462 347 360 10.1016/j.jtbi.2018.11.019 30471298
He J Wang J Yu F Chen W Xu W Dai W Persistence-dependent dynamic interactive environment enhances cooperation Phys Lett A 2023 469 128748 10.1016/j.physleta.2023.128748
Holyoak M Metacommunities: spatial dynamics and ecological communities 2009 Chicago University of Chicago Press
Jiang Y Wang X Liu L Wei M Zhao J Zheng Z Tang S Nonlinear eco-evolutionary games with global environmental fluctuations and local environmental feedbacks PLoS Comput Biol 2023 19 e1011269 10.1371/journal.pcbi.1011269 37379330
Jin J Chu C Shen C Guo H Geng Y Jia D Shi L Heterogeneous fitness promotes cooperation in the spatial Prisoner’s dilemma game Chaos Solitons Fractals 2018 106 141 146 10.1016/j.chaos.2017.11.020
Kawano Y Gong L Anderson BDO Cao M Evolutionary dynamics of two communities under environmental feedback IEEE Control Syst Lett 2019 3 254 259 10.1109/LCSYS.2018.2866775
Leibold MA Chase JM Metacommunity ecology 2018 Princeton Princeton University Press
Li B, Liu C, Wu Z, Guan J (2021) Game-environment feedback dynamics for voluntary Prisoner’s dilemma games. arXiv:2111.10011
Lin Y Weitz JS Spatial interactions and oscillatory tragedies of the commons Phys Rev Lett 2019 122 148102 10.1103/PhysRevLett.122.148102 31050474
Liu S Han J Zhang J Evolutionary dynamics of individual strategies and game environments in the framework of feedback control J Inf Telecommun 2020 4 363 382
Lu S Zhu G Zhang L Antisocial behavior-based environmental feedback in spatial Prisoner’s dilemma game Chaos Solitons Fractals 2023 174 113810 10.1016/j.chaos.2023.113810
Ma X, Quan J, Wang X (2024) Effect of reciprocity mechanisms on evolutionary dynamics in feedback-evolving games. Nonlinear Dyn 112:709–729
Mullon C Keller L Lehmann L Social polymorphism is favoured by the co-evolution of dispersal with social behaviour Nat Ecol Evol 2017 2 132 140 10.1038/s41559-017-0397-y 29203923
Nowak MA Evolutionary dynamics: exploring the equations of life 2006 Cambridge Harvard University Press
Perc M Gómez-Gardeñes J Szolnoki A Florìa LM Moreno Y Evolutionary dynamics of group interactions on structured populations: a review J R Soc Interface 2013 10 20120997 10.1098/rsif.2012.0997 23303223
Rand DG Tomlin D Bear A Ludvig EA Cohen JD Cyclical population dynamics of automatic versus controlled processing: an evolutionary pendulum Psychol Rev 2017 124 626 642 10.1037/rev0000079 28703606
Sanchez A Gore J Feedback between population and evolutionary dynamics determines the fate of social microbial populations PLoS Biol 2013 11 1 9 10.1371/journal.pbio.1001547
Shao Y Wang X Fu F Evolutionary dynamics of group cooperation with asymmetrical environmental feedback EPL 2019 126 40005 10.1209/0295-5075/126/40005
Shu L Fu F Eco-evolutionary dynamics of bimatrix games Proc R Soc A 2022 478 20220567 10.1098/rspa.2022.0567
Stella L, Baar W, Bauso D (2022a) Lower network degrees promote cooperation in the prisoner’s dilemma with environmental feedback. IEEE Control Syst Lett 6:2725–2730
Stella L, Bauso D, Colaneri P (2022b) Mean-field game for collective decision-making in honeybees via switched systems. IEEE Trans Autom 67:3863–3878
Szabó G Fáth G Evolutionary games on graphs Phys Rep 2007 446 97 216 10.1016/j.physrep.2007.04.004
Szolnoki A Chen X Environmental feedback drives cooperation in spatial social dilemmas EPL 2018 120 58001 10.1209/0295-5075/120/58001
Tilman AR Plotkin JB Akçay E Evolutionary games with environmental feedbacks Nat Commun 2020 11 915 10.1038/s41467-020-14531-6 32060275
Wang X Fu F Eco-evolutionary dynamics with environmental feedback: cooperation in a changing world EPL 2020 132 10001 10.1209/0295-5075/132/10001
Wang C, Perc M, Szolnoki A (2024) Evolutionary dynamics of any multiplayer game on regular graphs. arXiv:2401.11686
Weitz JS, Eksin C, Paarporn K, Brown SP, Ratcliff WC (2016) An oscillating tragedy of the commons in replicator dynamics with game-environment feedback. Proc Natl Acad Sci USA 113:E7518–E7525
West SA Griffin AS Gardner A Diggle SP Social evolution theory for microorganisms Nat Rev Microbiol 2006 4 597 607 10.1038/nrmicro1461 16845430
Wu Y Zhang S Zhang Z Environment-based preference selection promotes cooperation in spatial Prisoner’s dilemma game Sci Rep 2018 8 15616 10.1038/s41598-018-34116-0 30353150
Wu Y Zhang Z Yan M Zhang S Environmental feedback promotes the evolution of cooperation in the structured populations Chaos 2019 29 113101 10.1063/1.5120049 31779368
Yan F Chen X Qiu Z Szolnoki A Cooperator driven oscillation in a time-delayed feedback-evolving game New J Phys 2021 23 053017 10.1088/1367-2630/abf205
Yang L Zhang L Environmental feedback in spatial public goods game Chaos Solitons Fractals 2021 142 110485 10.1016/j.chaos.2020.110485
Zhang T, Gupta H, Suprabhat K, Stella L (2023) A multi-agent reinforcement learning approach to promote cooperation in evolutionary games on networks with environmental feedback. In: IEEE conference on decision and control (CDC), pp 2196–2201
Zhu X The dynamic edge environment under interactive diversity is a double-edged sword Appl Math Comput 2023 436 127505
