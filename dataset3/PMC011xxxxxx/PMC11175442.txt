
==== Front
PLoS One
PLoS One
plos
PLOS ONE
1932-6203
Public Library of Science San Francisco, CA USA

PONE-D-23-38359
10.1371/journal.pone.0303178
Research Article
Medicine and Health Sciences
Cardiology
Arrhythmia
Research and Analysis Methods
Bioassays and Physiological Analysis
Electrophysiological Techniques
Cardiac Electrophysiology
Electrocardiography
Computer and Information Sciences
Artificial Intelligence
Machine Learning
Deep Learning
Physical Sciences
Mathematics
Applied Mathematics
Algorithms
Research and Analysis Methods
Simulation and Modeling
Algorithms
Medicine and Health Sciences
Cardiology
Heart Rate
Tachycardia
Medicine and Health Sciences
Cardiology
Arrhythmia
Atrial Fibrillation
Medicine and Health Sciences
Cardiology
Research and Analysis Methods
Database and Informatics Methods
Deep learning based ECG segmentation for delineation of diverse arrhythmias
Deep learning based ECG delineation of diverse arrhythmias
Joung Chankyu Conceptualization Formal analysis Investigation Methodology Software Validation Writing – original draft Writing – review & editing 1
https://orcid.org/0009-0003-4329-6016
Kim Mijin Conceptualization Data curation Investigation Methodology Writing – original draft 2
Paik Taejin Resources Software Validation Writing – review & editing 1
Kong Seong-Ho Data curation Supervision 3 4
Oh Seung-Young Data curation Project administration 4 5
Jeon Won Kyeong Data curation 6
Jeon Jae-hu Project administration Supervision 7
Hong Joong-Sik Funding acquisition Supervision 7
Kim Wan-Joong Supervision 7
Kook Woong Funding acquisition Supervision Writing – review & editing 1 3
Cha Myung-Jin Data curation Funding acquisition Methodology 2 *
https://orcid.org/0000-0002-3596-7524
van Koert Otto Visualization Writing – original draft Writing – review & editing 1 *
1 Department of Mathematical Sciences and Research Institute of Mathematics, Seoul National University, Gwanak-gu, Seoul, South Korea
2 Division of Cardiology, Department of Internal Medicine, Asan Medical Center, University of Ulsan College of Medicine, Seoul, South Korea
3 AI Institute, Seoul National University, Seoul, South Korea
4 Department of Surgery, Seoul National University Hospital and Seoul National University College of Medicine, Seoul, South Korea
5 Department of Critical Care Medicine, Seoul National University Hospital, Seoul, South Korea
6 Department of Internal Medicine, Seoul National University Hospital, Seoul, South Korea
7 Medifarmsoft Co., Ltd., Seoul, South Korea
Hammad Mohamed Editor
Menoufia University, EGYPT
Competing Interests: I have read the journal’s policy and the authors of this manuscript have the following competing interests: CJ, TP, WK and OvK received financial support through NRF grants 2022R1A5A6000840 as well as RS-2022-00165404, NRF2023005562, funded by the Korean Government. SHK, SYO, JHJ, JSH, WJK and MJC received financial support through grants 1711174270, RS-2021-KD000008 funded by the Korean government. In addition, SHK, SYO, JHJ, JSH, WJK and MJC are Stockholders of Medifarmsoft Co., Ltd.

* E-mail: chamj81@gmail.com (MJC); okoert@snu.ac.kr (OK)
2024
13 6 2024
19 6 e030317815 12 2023
20 4 2024
© 2024 Joung et al
2024
Joung et al
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.

Accurate delineation of key waveforms in an ECG is a critical step in extracting relevant features to support the diagnosis and treatment of heart conditions. Although deep learning based methods using segmentation models to locate P, QRS, and T waves have shown promising results, their ability to handle arrhythmias has not been studied in any detail. In this paper we investigate the effect of arrhythmias on delineation quality and develop strategies to improve performance in such cases. We introduce a U-Net-like segmentation model for ECG delineation with a particular focus on diverse arrhythmias. This is followed by a post-processing algorithm which removes noise and automatically determines the boundaries of P, QRS, and T waves. Our model has been trained on a diverse dataset and evaluated against the LUDB and QTDB datasets to show strong performance, with F1-scores exceeding 99% for QRS and T waves, and over 97% for P waves in the LUDB dataset. Furthermore, we assess various models across a wide array of arrhythmias and observe that models with a strong performance on standard benchmarks may still perform poorly on arrhythmias that are underrepresented in these benchmarks, such as tachycardias. We propose solutions to address this discrepancy.

National Research Foundation (KR) NRF2023005562 https://orcid.org/0000-0002-3596-7524
van Koert Otto http://dx.doi.org/10.13039/501100004085 Ministry of Education, Science and Technology 1711174270 Hong Joong-Sik http://dx.doi.org/10.13039/501100003625 Ministry of Health and Welfare RS-2021-KD000008 Hong Joong-Sik National Research Foundation (KR) RS-2022-00165404 Kook Woong National Research Foundation (KR) 2022R1A5A6000840 Kook Woong This work was supported by the Korea Medical Device Development Fund grant funded by the Korea government (the Ministry of Science and ICT, the Ministry of Trade, Industry and Energy, the Ministry of Health \& Welfare, the Ministry of Food and Drug Safety) (Project Number: 1711174270, RS-2021-KD000008), (JSH, JHJ). https://www.msit.go.kr/eng/index.do In addition, WK and OvK receive support from the National Research Foundation of Korea (NRF) Grant 2022R1A5A6000840 (joint), as well as (MSIP) [RS-2022-00165404 (WK), NRF2023005562 (Ovk)], funded by the Korean Government. https://ernd.nrf.re.kr/index.do None of the funders played a role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. Data AvailabilityThe internal database cannot be shared publicly because the IRB of Seoul National University Hospital hasn’t cleared this data (anonymized ECGs) for publication. Data are available from the Seoul National University Hospital Institutional Data Access / Ethics Committee The contact information of the IRB of SNUH is as follows: Seoul National University Medical College/Seoul National University Hospital Medical Research Ethics Review Committee Tel: 82-02-2072-0694/2266 FAX: 82-02-3675-6824 03080, 101 Daehak-ro, Jongno-gu, Seoul, Republic of Korea http://hrpp.snuh.org/irb/introirb/_/singlecont/view.do Email requests for data access can be sent toirb@snuh.org or to Myung-Jin Cha, chamj81@gmail.com The other data underlying the results presented in the study are available from Physionet, specifically QTDB, LUDB, MIT-BIH and PTB-XL. These public databases are available at https://physionet.org/content/qtdb/1.0.0/ https://physionet.org/content/ludb/1.0.1/ https://physionet.org/content/mitdb/1.0.0/ https://physionet.org/content/ptb-xl/1.0.3/.
Data Availability

The internal database cannot be shared publicly because the IRB of Seoul National University Hospital hasn’t cleared this data (anonymized ECGs) for publication. Data are available from the Seoul National University Hospital Institutional Data Access / Ethics Committee The contact information of the IRB of SNUH is as follows: Seoul National University Medical College/Seoul National University Hospital Medical Research Ethics Review Committee Tel: 82-02-2072-0694/2266 FAX: 82-02-3675-6824 03080, 101 Daehak-ro, Jongno-gu, Seoul, Republic of Korea http://hrpp.snuh.org/irb/introirb/_/singlecont/view.do Email requests for data access can be sent toirb@snuh.org or to Myung-Jin Cha, chamj81@gmail.com The other data underlying the results presented in the study are available from Physionet, specifically QTDB, LUDB, MIT-BIH and PTB-XL. These public databases are available at https://physionet.org/content/qtdb/1.0.0/ https://physionet.org/content/ludb/1.0.1/ https://physionet.org/content/mitdb/1.0.0/ https://physionet.org/content/ptb-xl/1.0.3/.
==== Body
pmc1 Introduction

An electrocardiogram (ECG) is a basic medical diagnostic tool that monitors the electrical activity of the heart. It is non-invasive, relatively quick to perform, and inexpensive while providing a wealth of information about the overall health of the heart. Traditionally, the analysis of the structural elements in an ECG, including the durations and morphology of the QRS complex, the P and T waves (see Fig 1), plays a key role in identifying abnormalities or irregularities in the heart’s electrical activity that may point towards underlying heart conditions [1]. Precise delineation, which involves identifying the onset and offset of these waves and not just the peaks, is hence critical.

10.1371/journal.pone.0303178.g001 Fig 1 A schematic representation of an ECG signal measured in lead I or lead II with the main complexes indicated.

As such, automatic delineation of ECGs has been an important and well-developed topic, starting with rule-based techniques for locating the QRS complex, to wavelet transform-based delineation, [2–4] and deep learning techniques. Wavelet transforms deliver state-of-the-art performance in the benchmark QT database (QTDB), [5]. However, as [6, 7] point out, rule-based approaches typically require the adjustment of a threshold value for high scores, which may limit their generalizability to other datasets. Deep learning offers an alternative as shown for example in [6–8]: Jimenez-Perez et al. [6] used a U-Net type architecture [9] to achieve delineation performance comparable to wavelet-based methods on QTDB, and Moskalenko et al. [8] reported higher delineation performance compared to wavelet-based algorithms on the Lobachevsky University Database (LUDB) [10].

Although deep learning based delineation has shown excellent performance on benchmarks, arrhythmias pose a particular challenge in two important ways. First of all, there is a lack of data, reflected in the fact that the benchmark datasets are quite small and their samples tend to have relatively low heart rates. As a result, the variety of arrhythmias for the purpose of testing delineation quality is limited despite the careful preparation of these databases. A second important obstacle is that many arrhythmias cause significant changes in the structural elements and morphological features of an ECG. These changes are particularly striking in case of the P wave, which usually has the lowest signal to noise ratio. For example, in atrial fibrillation (AFIB) and atrial flutter (AFL) the P wave is absent, and a fibrillatory signal or flutter wave is found instead. As noted in [11, 12], false P wave predictions during such events present a significant challenge for delineation algorithms in clinical practice. Other arrhythmias, such as atrioventricular (AV) block, affect not only the position of P waves in relation to the QRS complex, but also their occurrence. This can result in P waves and QRS complexes following independent rhythms. In all of these cases, the performance of a P wave delineation algorithm is affected adversely. For instance, Aziz et al. [13] report a considerable drop in sensitivity for P wave detection in the case of ECGs exhibiting arrhythmia.

In this paper, we investigate this two-fold problem in the setting of deep learning and develop remedies. Specifically, we evaluate the performance of deep learning models, and find that the performance drops markedly in the presence of certain arrhythmia, such as various forms of tachycardia. An example of such failure is shown in Fig 6. Because tachycardia are underrepresented in both QTDB and LUDB, this drop doesn’t affect the average performance of delineation in these benchmarks much, which explains why previous approaches still performed well on the benchmark tests. As remedies, we build on prior studies and devise a segmentation model with a U-Net like architecture to delineate ECG signals with diverse arrhythmias by training on a new dataset consisting of a large number of recordings with various arrhythmia types. In addition, we develop a segmentation model using a hybrid loss function that combines segmentation with the task of arrhythmia classification. This classification guided approach can ameliorate false P wave predictions for AFIB and AFL in short signals. A flow diagram of the model is shown in Fig 2.

10.1371/journal.pone.0303178.g002 Fig 2 Flow diagram for ECG delineation: An ECG input signal is segmented by a U-Net like model using an optional classification branch, and post-processed for noise, before producing final delineation results.

The key contributions of this paper can be summarized as follows:

Training a segmentation model that accurately delineates a chosen set of common arrhythmia types, achieved by using a diverse training set and employing a suitable post-processing strategy.

Identifying common failure cases of segmentation models through separate validation on different arrhythmia types.

Evaluating our model’s performance on benchmark datasets QTDB and LUDB, demonstrating generalizability by results comparable with previous research.

Introducing a classification guided strategy to reduce false P wave predictions for AFIB and AFL in short signals.

The rest of the paper is structured as follows. The Related Work Section 2 provides a review of relevant literature on ECG delineation and deep learning-based ECG analysis. The Methods Section 3 outlines the databases used for this study and presents the proposed delineation algorithm. The Results Section 4 presents performance evaluation metrics and reports experimental results. The Discussion Section 5 offers interpretations, implications, and discusses limitations and future directions. Finally, the Conclusion Section 6 concludes the paper.

2 Related work

2.1 Traditional approaches for ECG delineation

Early works on ECG delineation were primarily focused on developing rule-based methods to identify and locate the QRS complex. Pan and Tompkins [14] presented a seminal example of detecting the QRS complex by utilizing slope, amplitude, and width information. Subsequently, more advanced techniques have been employed to identify also the P and T waves. These include digital signal processing such as the wavelet transform [2–4, 15], the Hilbert transform [16, 17], and the phasor transform [18]. Additionally, classical machine learning approaches like hidden Markov models [19, 20] and Gaussian mixture models [21] have also been employed. Among these, wavelet-based methods have been widely cited as being the state-of-the-art, based on their delineation performance on public datasets such as QTDB and LUDB [4]. However, despite their effectiveness, traditional methods typically require manual feature extraction or domain-specific knowledge, whereas wavelet-based algorithms demand careful threshold selection for consistent results on different datasets.

2.2 Deep learning based ECG delineation

In recent years, deep learning has shown remarkable success in ECG processing such as arrhythmia classification [22–25], which led to its increasing popularity in various downstream tasks [26]. Deep learning has been adopted in ECG delineation as well, where a segmentation model with a CNN architecture is typically trained to locate the P, QRS, and T waves, which is then used to carry out the delineation task. The use of CNN architectures in segmentation tasks offers the advantage of automatically learning hierarchical features from the ECG signals [27], enabling the model to effectively identify and localize the relevant waveforms. Jimenez-Perez et al. [28] presented an adaptation of the U-Net architecture [9] to 1-dimensional data, while Sereda et al. [29] deployed an 8-layer convolutional network and studied the effects of using an ensemble of networks as opposed to using a single network for the segmentation. Moskalenko et al. [8] developed a U-Net-like architecture that achieved state-of-the-art performance on LUDB in terms of F1-score, when compared to previous deep learning approaches [29] and wavelet-based methods [4]. In a similar study, Jimenez-Perez et al. [6] again adapted a U-Net for segmentation but with added emphasis on regularization techniques for training with limited data. Their model, when cross-validated on QTDB, demonstrated comparable performance to those using digital signal processing techniques such as wavelet transforms [3]. Recently, Chen et al. [7] developed a 1D-U-Net model for classifying the sample points of a single heart-beat into P, QRS, T, and none categories. Together with their proposed post-processing strategy, the delineation algorithm outperformed other algorithms in terms of sensitivity for both QTDB and LUDB. Additionally, advanced architectures for ECG delineation models were explored in Nurmaini et al. [30] using convolutional recurrent networks, and in Li et al. [31] through an enhanced U-Net model combined with the transformer’s encoder module.

2.3 Classification guided segmentation

In developing a neural network for semantic segmentation, it is sometimes beneficial to add an extra classification task. This approach has been particularly effective in the field of medical image segmentation, where detection of false positives is common for images in which the object of interest is not present. Huang et al. [32] addressed this problem of over-segmentation by introducing a classification guided module (CGM) where the model is trained with the additional classification objective of deciding whether or not a given image contains an organ. By filtering out the segmentation output using the classification output, the number of false positives is reduced. A similar approach was taken by Shuvo et al. [33], where a separate localizer branch was added together with an additional classifier branch.

In the ECG literature, classification and segmentation tasks have remained separate for the most part, while deep learning architectures have shown great success for both tasks [26]. In our current work, we experiment with combining the two tasks by training an ECG segmentation model together with an additional arrhythmia classification learning objective. Previous studies have demonstrated the effectiveness of convolutional neural networks for arrhythmia classification. For example, Hannun et al. [22] trained a 34-layer convolutional neural network for arrhythmia classification of single-lead ECG signals, showing performance comparable to that of cardiologists. Ribeiro et al. [34] later used a residual network architecture, an architecture first developed by He et al. [35] in the context of image classification, for the reliable diagnosis of 12-lead ECG signals. For a detailed review of deep learning applications in arrhythmia classification, we refer to the systematic reviews conducted by Xiao et al. [36] and Ansari et al. [37].

3 Methods

3.1 Data

For this study, we have used both internal and external datasets to develop and test our algorithm. The internal database was used for training the segmentation model and assessing delineation accuracy across diverse arrhythmias. The standard public datasets QTDB and LUDB were used for external validation of our algorithm. The characteristics of these datasets are summarized in Table 1 and elaborated upon in subsequent sections.

10.1371/journal.pone.0303178.t001 Table 1 Descriptions of signals and their annotations for each of the databases.

Data Source	# Recordings	Duration	Frequency	Leads	Boundary Annotations	
Internal Database	1557	10 seconds	500Hz, 250Hz	2 (I, II)	P, QRS, T on/offsets	
QTDB [5]	105	15 minutes	250Hz	2	P, QRS on/offsets, T offsets	
LUDB [10]	200	10 seconds	500Hz	12	P, QRS, T on/offsets	

3.2 Internal dataset

We have assembled an internal database of ECG signals from 1,557 patients by searching the electrocardiography database (GE MUSE, GE Healthcare, Waukesha, WI) in a single center (Seoul National University Hospital, Seoul, South Korea). In the process of ECG extraction, all personal information was anonymized, so the consent form was waived. This study was then approved by the institutional review board of the participating center (H-1906–163-1044, continued as D-2010–096-1165). Data extraction commenced on May 31, 2022 and was completed on December 16, 2022. During data extraction, some of the authors (MJK, SHK, SYO, MJC) had access to information that could identify individual participants.

Our intent was to collect a dataset in order to conduct experiments to elucidate the segmentation performance for signals during arrhythmia. To do so, we identified 155 subjects with atrial fibrillation (AFIB) and 59 with atrial flutter(AFL). Among the rest, arrhythmia types were identified for 490 subjects as normal sinus rhythm (NSR), 84 as sinus tachycardia (ST), 115 as bundle branch block (BBB), 197 as first degree atrioventricular block (AVB1) and 29 as ventricular tachycardia (VT). The remaining 428 subjects had other heart conditions (not arrhythmia in the usual sense), such as premature atrial contraction (PAC) or premature ventricular contraction (PVC). A summary can be found in Table 2.

10.1371/journal.pone.0303178.t002 Table 2 Distribution of arrhythmia of internal database.

Arrhythmia type	AFIB	AFL	AVB1	BBB	NSR	ST	VT	Other	Total	
# Recordings	155	59	197	115	490	84	29	428	1557	

Initial selection of ECGs from the electrocardiography database was based on the presence of common clinically significant cardiac arrhythmias. After reviewing ECG records, we excluded ECGs where disagreement on the review result was found, as well as ECGs that were too noisy to interpret reliably. The original arrhythmia automatic diagnosis from the database, the commercial interpretation product, the MUSE Cardiology Information System by GE, confirmed by an overreader, was then independently reviewed by two expert cardiologists. Only when both readings were in agreement was it applied to the analysis. After that, the onsets and offsets for P, QRS, and T waves were manually annotated for each lead independently by a cardiologist using a custom-made software tool. The annotation results were then confirmed by another cardiologist. As a quality control measure, we include in the S1 Appendix statistics on the difference between lead I and lead II annotations.

For each subject, the extracted data consisted of a recording with a duration of 10 seconds for leads I and II with a sampling frequency of either 250Hz or 500Hz. The dataset was partitioned into a training set and a test set. The training set comprised 1032 recordings and was organized to include approximately 70% of recordings for each identified arrhythmia class. The test set was composed of the remaining 525 recordings.

3.3 The QT Database (QTDB)

The QT database (QTDB) [5] is a publicly available database that has been used widely for developing and evaluating ECG delineation algorithms, due to its inclusion of manual annotations. The database collects recordings from multiple databases including the MIT-BIH arrhythmia database [38], the European ST-T Database [39], and other databases to represent various QRS and ST-T morphologies. In total, there are 105 two-lead signals sampled at 250Hz with each signal lasting for 15 minutes. Manual annotations by cardiologists are included for at least 30 beats per record, which amounts to more than 3600 beats. The annotations include the peaks and boundaries of waveforms, and in particular include the onset and offset of the P wave, the onset and offset of the QRS complex, and the offset of the T wave. These annotations will be used to measure the delineation quality of our algorithm and to compare with previous wavelet based methods [4, 7, 40].

3.4 Lobachevsky University Database (LUDB)

The Lobachevsky University Database (LUDB) is a more recently published database, also developed as an open-access tool for validating ECG delineation algorithms. Unlike QTDB, LUDB consists of short signals of 10 seconds from 200 unique subjects, with 12-lead recordings sampled at 500Hz included for each subject. Furthermore, LUDB contains a complete set of annotations for all onsets and offsets of P, QRS, and T waves, which is included for each single lead signal. In particular, the total number of annotated beats is considerably higher than that of QTDB, and this large number of annotated single-lead signals has led studies to take advantage by using LUDB as training data for their ECG segmentation models [8, 29]. In this paper, we use LUDB for two purposes. First, we use LUDB alongside QTDB to validate our delineation algorithm and compare with existing methods [4, 8, 29]. Second, we study the delineation performance on various arrhythmias when the segmentation model is trained on LUDB as opposed to the diverse training set sourced from our internal dataset.

3.5 Overview of delineation algorithm

The proposed algorithm consists of two stages. The first is a segmentation stage where a single lead input signal is passed through a deep learning based segmentation model. As a result, the signal is segmented into intervals that belong to one of four types: P wave, QRS complex, T wave, or none of these. The second stage consists of post-processing in which the final decision on the onset and offset for each of the waveforms is made. The details of each stage are given in the following sections.

3.6 Segmentation model

We have adapted the encoder-decoder structure of U-Net [9] to our model in a similar fashion as in the previous papers [6, 8, 29] to work in the context of ECG signals. Namely, the original convolutions are replaced with 1D convolutions to work with time series data. We have further modified the structure by incorporating full-scale skip connections, and adding a separate classification branch whose role will be discussed in the Arrhythmia Classification Guidance Section 3.8. The resulting high-level architecture of our model is shown in Fig 3.

10.1371/journal.pone.0303178.g003 Fig 3 Segmentation model architecture.

Our architecture is similar to U-Net3+, but uses 1D convolutional blocks and has an additional classifier branch.

The encoder takes a single-lead ECG signal sampled at 500Hz as input and encodes it into five feature maps at multiple scales through a series of 1D convolutional blocks and MaxPooling layers which downsample by a factor 2. The decoder uses convolutional blocks and linear interpolation layers to transform these features into an output consisting of four channels of the same resolution as the input. As in the U-Net variants [32, 41], we allow the decoder networks to learn from and aggregate features coming from multiple levels by adapting the full-scale skip connections of [32]. The final segmentation output is obtained by passing the output of the decoder through a convolutional layer with 4 filters and kernel size 1 and applying a softmax classifier for four classes: P wave, QRS complex, T wave, and none of these. This gives four class probabilities for each time stamp.

Note that for all other convolutional layers, we use a kernel size of 9 and padding of 4. As for the activation function, we use a leaky rectified linear unit with negative slope 0.01 for all layers. More specific details can be found in our implementation, which is available at https://github.com/ckjoung/ecg-segmentation.

3.7 Post-processing

The waveform boundaries are determined from the segmentation output through a post-processing stage, which consists of the following three steps. First, we extract segments of each type (P wave, QRS, T wave, none) by taking connected intervals where the probability of that type outputted by the model is highest. As a second noise reduction step, we discard short connected regions (of a duration less than 40 ms) and adjust the label based on the segmentation results of the adjacent intervals. In particular, we adjust the label according to the following rule:

if the two intervals adjacent to a short region have the same label, we regard the short segment as having the same label, thereby gluing the two regions to a single segment;

if the labels of the adjacent intervals are different, we discard the short region and label it as being none of the waveforms.

In the final step, we proceed by choosing the longest intervals labeled as P wave and T wave between consecutive QRS intervals and obtain their onsets and offsets. It can of course happen that there is no P wave, for example in the case of atrial fibrillation, or no T wave, which is very rare. This procedure automatically removes noise and returns unambiguous results.

3.8 Arrhythmia classification guidance

Here, we introduce an arrhythmia classification guided strategy for segmentation. The idea is to train the segmentation model jointly with a classification loss based on the arrhythmia type of each input signal. This is done by adding a classification branch following the deepest layer of the encoder, which predicts the arrhythmia type of the input signal. The weights of the model are affected by the joint training, and in addition, we can directly suppress the P wave segmentation output when the signal is predicted to belong to AFIB or AFL (see Fig 3). In the Reduced False P wave Predictions Section 4.4, we show that this approach can effectively reduce the number of false positive P wave predictions when delineating 10-second ECG signals. However, for other experiments, we only use the segmentation model without the classifier branch. Note that the proposed approach is similar to the classification guided modules of [32, 33], which have been used in the context of biomedical image segmentation. Here, we have re-designed the structure for the task of arrhythmia classification of ECG signals.

The structure of the arrhythmia classification branch is shown in Fig 4. The classification branch itself consists of two convolutional layers using 512 filters and a kernel size of 17. We apply batch normalization and dropout for regularization following the classification models of [22, 34]. The arrhythmia classification is performed by the final fully connected layer with softmax activation, whose output represents the probabilities of the signal belonging to either an AFIB or an AFL episode or not. A final prediction is made using an argmax function. Note that we have allowed the classification branch to take as input not just the feature of the last encoder block, but of encoder blocks of all levels. This is done by an aggregation scheme which works as follows. We first downsample the features of the first four encoder blocks to a size equal to that of the last encoder block. The downsampling is done using an average pooling layer. After the features have been resampled to the same shape, we concatenate the features to get a single aggregated feature.

10.1371/journal.pone.0303178.g004 Fig 4 Arrhythmia classification branch network architecture.

3.9 Training

We have trained the network from scratch with convolutional weights initialized as in He et al. [42] using the Adam optimizer [43] with default parameters. The learning rate was initialized to be 0.001 and set to follow a cosine annealing schedule. To increase the diversity of training data, we applied data augmentation using transformations designed to mimic probable physiological noise, such as baseline wander and powerline noise, as used in [44]. The equations for these transformations are given as follows:

Baseline wander: nblw(t)=∑k=150akcos(2πtkΔf+ϕk) (1)

Powerline noise: npln(t)=∑k=13akcos(2πtkfn+ϕ1) (2)

where Δf = 0.01Hz, fn = 50Hz, with ak and ϕk uniformly sampled from [0, 1) and [0, 2π). We have also randomly resized the input signal by a factor exp(α) where α is uniformly sampled from [log0.5, log2], added random Gaussian noise with zero mean and standard deviation 0.01mV, and applied a constant baseline shift by an offset sampled from a Gaussian distribution. Fig 5 shows examples of the used transformations.

10.1371/journal.pone.0303178.g005 Fig 5 Examples of transformations used for data augmentation.

(a) Original, (b) baseline wander, (c) baseline shift, (d) resize, (e) powerline noise and (f) Gaussian noise.

We adopt focal loss as introduced in [45] as our segmentation loss function. Focal loss modifies the standard cross-entropy loss by providing smaller weights to well-classified time stamps, letting the model focus on regions that are difficult to classify. The focal loss generalized to our multi-class segmentation setting can be written in the following form: Lfocal=-1N∑n=1N∑c=1C(1-y^n,c)γyn,clogy^n,c (3)

Here, y^n,c denotes the predicted probability of time stamp n belonging to class c, while yn is the one-hot vector of the true class label for time stamp n. In our experiments, we use the default value of γ = 1.0. During arrhythmia classification guidance of the Arrhythmia Classification Guidance Section 3.8, we use the standard binary cross-entropy loss Lbce for the classification branch. This gives the overall loss function: Ltotal=Lfocal+αLbce. (4)

The additional trade-off parameter α can be adjusted to balance the effect of classification and segmentation losses during training. For all our experiments, we used α = 1.

We train and validate our model using single lead ECG signals. To prevent potential issues arising from incomplete annotations for waveforms near the beginning and the end of a signal, we proceed as in [8] to exclude the initial and final 2 seconds of our signals during the training process. Hence, our model performs segmentation and classification using a signal of duration 6 seconds during training, and of 10 seconds during validation. While this scheme was designed mainly due to its practicality, we note that ECG recordings of 5 or 10 seconds have been shown to be successful for a CNN based arrhythmia classification [46]. We only use signals from leads I and II for training and validation of our model. Each input signal is resampled to 500Hz.

4 Results

4.1 Evaluation metrics

In order to evaluate the performance of the proposed delineation algorithm, we compare the ground truth annotations for the onsets and offsets of P, QRS, and T waves with the predicted annotations. We follow the usual standard chosen by The Association for the Advancement of Medical Instrumentation(AAMI) [47], which considers an onset or an offset to be correctly detected if an algorithm locates the same type of annotation in a neighborhood of 150ms. Using this threshold value, we examine for each predicted point whether the prediction correctly detects a point in the ground truth annotation.

If a ground truth annotation is correctly detected, we count a true positive(TP). In this case, the error is measured as the time deviation of the predicted point from the manual annotation. If there is no point of the ground truth annotation in the 150ms neighborhood of the prediction, then we count a false positive(FP). Once every prediction has been compared with the manual labels, we count for each point of the ground truth annotation which has not been related to any prediction a false negative(FN).

Based on this, we calculate the following evaluation metrics:

mean error m

standard deviation of error σ

sensitivity Se=TPTP+FN (5)

positive predictive value PPV=TPTP+FP (6)

F1-score F1=2·Se·PPVSe+PPV (7)

Se indicates the algorithm’s ability to identify true positives among all ground truth annotations, while PPV quantifies the algorithm’s precision in detecting annotations. Furthermore, the F1-score, defined as the harmonic mean of Se and PPV, offers a unified assessment of the algorithm’s performance. These metrics have been commonly used in the literature for the evaluation of ECG delineation algorithms [3, 4, 8, 40], and we use them to evaluate performance of our model.

4.2 Delineation performance on Arrhythmia

In this section we report how lack of arrhythmia diversity in training data affects evaluation results of our model using a test set with a diverse range of arrhythmia. We will describe detailed results in the table below, but first let us illustrate how the model’s performance is directly affected by lack of diverse training data through various ECG signals from the PTB-XL dataset [48]. In Figs 6–8 we present delineation output of two models, namely model a), trained on LUDB data, and model b) trained using the internal dataset. In Fig 6, we observe that model a) fails to detect any P wave in a signal during sinus tachycardia. Looking at other arrhythmias, specifically AVB1 in Fig 7, both models perform well in detection of QRS complexes and T waves, but model a) has trouble with identifying the P waves. As a final example, Fig 8 presents the performance of the two models on a signal with bundle branch block and premature ventricular complexes. In this case, both models detect all waves correctly according to the standard of AAMI. However, model a) underestimates the width of the QRS complex: it puts the S wave offset well before the J point. We note that this type of defect is only visible in the mean error. The other metrics do not reveal this type of flaw. We will now check these phenomena systematically by delineating the test set of the internal dataset, which contains a wide range of arrhythmia. We point out that model a) and b) both perform well on QTDB (and LUDB); performance on these benchmark sets is addressed in the next section.

10.1371/journal.pone.0303178.g006 Fig 6 Delineation of an ECG showing sinus tachycardia (PTB-XL ECG-ID: 857) using two different models: (a) a model trained on LUDB, which is somewhat short on tachycardia samples, fails to detect the fairly obvious P waves; (b) a model trained on more diverse data with otherwise identical settings, performs much better.

10.1371/journal.pone.0303178.g007 Fig 7 Delineation of an ECG showing sinus tachycardia and AVB1 (PTB-XL ECG-ID: 3337) using two different models: (a) a model trained on LUDB delineates all QRS complexes and T waves, including the premature ventricular complex, correctly, but misses P waves that are in shorter RR intervals; (b) a model trained on more diverse data with otherwise identical settings, finds all P waves.

10.1371/journal.pone.0303178.g008 Fig 8 Delineation of an ECG showing bundle branch block and premature ventricular complex (PTB-XL ECG-ID: 287) using two different models: (a) a model trained on LUDB detects all waves correctly, but underestimates the width of all QRS complexes with the exception of the PVC; (b) a model trained on more diverse data with otherwise identical settings, detects the onsets and offsets accurately.

To assess the model’s ability to handle signals with diverse arrhythmias, we measure the F1-scores separately for each of the following arrhythmia types: normal sinus rhythm (NSR), sinus tachycardia (ST), bundle branch block (BBB), first degree atrioventricular block (AVB1), atrial fibrillation (AFIB), atrial flutter (AFL) and ventricular tachycardia (VT). We also examine how the arrhythmia distribution of the training set can affect the delineation performance. For this, we train a separate segmentation model using LUDB as the only training set and compare the resulting delineation performance. LUDB has often been used in previous studies [7, 29] for training a segmentation model for the purposes of delineation. Here, we follow the same approach but test it on the internal dataset in order to measure performance for different arrhythmias. For a reliable comparison, each evaluation is repeated 20 times and the average score is reported.

Table 3 shows the F1-scores for the onset and offset delineation. From the results, we see that the model trained on the internal dataset can accurately delineate signals of each of the identified arrhythmia types. The F1-scores are mostly above 0.99, and all above 0.97 except for VT and P waves for AVB1. By contrast, the model trained on LUDB shows a much higher variation across different arrhythmia types. For normal sinus rhythm, exceptional F1-scores (over 0.99) are achieved. However, the effect of arrhythmia in delineation accuracy is noticeable in the F1-scores for P waves during ST and AVB1, and T waves during ST, AFIB, AFL, and VT.

10.1371/journal.pone.0303178.t003 Table 3 Arrhythmia dependence of onset and offset delineation performance on a test set comprised of diverse arrhythmia.

The training data strongly affects the models’ performance as highlighted in the bold-faced F1-scores: scores can drop more than 15%.

T raining	Rhythm	F1-scores (%)	
P onset	P offset	QRS onset	QRS offset	T onset	T offset	
Trained on LUDB (limited diversity)	NSR	99.84	99.84	99.83	99.84	99.97	99.97	
ST	81.54	81.54	99.93	99.93	97.59	98.83	
BBB	98.89	98.89	99.94	99.94	99.89	99.94	
AVB1	90.53	90.97	99.82	99.82	100.00	100.00	
AFIB	-	-	99.29	99.29	97.92	97.60	
AFL	-	-	99.21	99.21	92.67	93.00	
VT	-	-	91.04	91.11	78.78	78.63	
All	90.37	90.46	99.45	99.46	97.42	97.54	
Trained on diverse dataset	NSR	99.69	99.69	99.78	99.81	99.95	99.95	
ST	97.19	97.19	99.91	99.91	99.90	99.94	
BBB	99.00	99.00	99.94	99.94	99.88	99.89	
AVB1	95.93	95.93	99.84	99.84	100.00	100.00	
AFIB	-	-	99.54	99.54	99.56	99.54	
AFL	-	-	98.97	98.97	98.56	97.57	
VT	-	-	97.83	96.84	94.49	94.61	
All	96.47	96.46	99.71	99.69	99.67	99.63	

4.3 External validation on QTDB and LUDB

In this section we will see that the improved performance in case of arrhythmia does not come at the cost of a good benchmark score. Our algorithm’s ability to handle previously unseen signals is verified using the public datasets QTDB and LUDB. For LUDB, we compared our results with delineation algorithms using wavelets [4] and previous deep segmentation based methods [8, 29]. The evaluation was conducted on LUDB signals from leads I and II. Regarding QTDB, we benchmark against wavelet-based techniques [4, 40] and a recent deep learning approach [7]. Detailed results and comparisons with existing methods are shown in Table 4. Note that there are some discrepancies in annotation format which we shall elaborate in the following section.

10.1371/journal.pone.0303178.t004 Table 4 Comparison of delineation performance on QTDB and LUDB.

For a direct comparison, we have considered the results of Moskalenko et al. [8] which uses single lead input, namely lead II. N/A: not applicable, N/R: not reported. This table shows that the performance of model, trained on diverse arrhythmia, has a performance that is comparable to that of other recent models.

Database	Method	Metrics	P onset	P offset	QRS onset	QRS offset	T onset	T offset	
QTDB	Di Marco et al. [40]	Se (%)	98.15	98.15	100.0	100.0	-	99.77	
PPV (%)	91.00	91.00	N/A	N/A	97.76	
m ± σ (ms)	-4.5 ± 13.4	-2.5 ± 13.0	-5.1 ± 7.2	0.9 ± 8.7	1.3 ± 18.6	
Kalyakulina et al. [4]	Se (%)	97.46	97.53	98.42	98.42	-	96.16	
PPV (%)	97.86	97.93	98.24	98.24	94.87	
m ± σ (ms)	3.5 ± 13.8	3.4 ± 12.7	-5.1 ± 6.6	4.7 ± 9.5	13.4 ± 18.5	
Chen et al. [7]	Se (%)	99.58	99.78	100.0	100.0	-	98.63	
PPV (%)	N/R	N/R	N/A	N/A	N/R	
m ± σ (ms)	-0.6 ± 20.9	4.9 ± 19.5	1.3 ± 11.4	3.8 ± 18.8	7.4 ± 32.5	
Our Method	Se (%)	96.51	96.55	100.0	100.0	-	97.50	
PPV (%)	97.94	97.97	N/A	N/A	95.31	
m ± σ (ms)	13.0 ± 16.1	-3.3 ± 18.5	4.1 ± 11.2	2.8 ± 17.3	-0.4 ± 35.1	
LUDB	Kalyakulina et al. [4]	Se (%)	98.46	98.46	99.61	99.61	-	98.03	
PPV (%)	96.41	96.41	99.87	99.87	98.84	
m ± σ (ms)	-2.7 ± 10.2	0.4 ± 11.4	-8.1 ± 7.7	3.8 ± 8.8	5.7 ± 15.5	
Sereda et al. [29]	Se (%)	95.20	95.39	99.51	99.50	97.95	97.56	
PPV (%)	82.66	82.59	98.17	97.96	94.81	94.96	
m ± σ (ms)	2.7 ± 21.9	-7.4 ± 28.6	2.6 ± 12.4	-1.7 ± 14.1	8.4 ± 28.2	-3.1 ± 28.2	
Moskalenko et al. [8]	Se (%)	98.61	98.59	99.99	99.99	99.32	99.40	
PPV (%)	95.61	95.59	99.99	99.99	99.02	99.10	
m ± σ (ms)	-4.1 ± 20.4	3.7 ± 19.6	1.8 ± 13.0	-0.2 ± 11.4	-3.6 ± 28.0	-4.1 ± 35.3	
Our Method	Se (%)	98.16	98.20	99.67	99.97	99.82	99.63	
PPV (%)	96.39	96.36	99.29	99.59	99.66	99.42	
m ± σ (ms)	7.4 ± 14.1	-1.8 ± 9.9	6.1 ± 10.5	2.0 ± 10.7	3.0 ± 25.2	4.5 ± 24.4	

4.3.1 Discrepancies in annotation format

The study utilizes three databases: internal, LUDB, and QTDB, each annotated by different cardiologist experts. These databases differ not only in the number of leads but also in the duration of recordings. Specifically, the internal and LUDB databases contain short 10-second signals with complete waveform boundary annotations except possibly for one or two initial and final cardiac cycles [8]. In contrast, QTDB consists of 15-minute recordings with annotations included for selected beats. Notably, the annotation format of QTDB, as discussed in [3, 40], does not allow us to measure the exact PPV value. In fact, when there is no annotation, we cannot decide whether the waveform is not present or the annotation is simply not included. To address this, we adopt the approach from [3, 40] and treat an absent manual annotation on a predicted beat as a non-included annotation. To ensure consistency with [4, 40], we select the lead with the lowest error for each boundary point.

4.4 Reduced false P wave predictions

Arrhythmia classification guidance was presented in the Arrhythmia Classification Guidance Section 3.8 as a method to reduce the number of false P wave detections which occur frequently during atrial fibrillation and flutter events. To evaluate its effectiveness, we compared the number of false positive P wave predictions generated by models trained with and without classification guidance. Table 5 shows the results, including the PPV and Se scores for the entire test set as a reference.

10.1371/journal.pone.0303178.t005 Table 5 Number of false positive P annotations for AFIB and AFL.

The PPV and Se scores for the entire test set are shown for reference. The values are averaged over 20 runs.

	AFIB (1437 beats)	AFL (540 beats)	All (14418 beats)	
False Positives	False Positives	PPV (Precision)	Se (Recall)	
P onset	P offset	P onset	P offset	P onset	P offset	P onset	P offset	
Trained w/o classification	62.35	62.35	34.25	34.25	97.53	97.52	95.43	95.43	
Trained w/ classification	13.85	13.85	1.85	1.9	98.70	98.69	95.31	95.31	

4.5 Examples of delineation results

This section presents examples of our algorithm’s delineation outcomes on the MIT-BIH arrhythmia database [38]. We have chosen multiple instances of arrhythmia to showcase how our algorithm handles them, as depicted in Fig 9. Other challenges are shown in Fig 10, including noise, baseline wander, and loss of signal.

10.1371/journal.pone.0303178.g009 Fig 9 Segmentation results on the MIT-BIH arrhythmia database.

(a) Atrial fibrillation in record 221. The small bumps are not misidentified as P waves, and we have observed the same correct behavior in the presence of atrial flutter. (b) First degree atrioventricular block in record 228, with correct detection of longer-than-normal PR intervals. (c) Bundle branch block in record 212, featuring a wide QRS complex. (d) Sinus tachycardia in record 209, with heart rate slightly over 100 bpm.

10.1371/journal.pone.0303178.g010 Fig 10 More segmentation results on the MIT-BIH arrhythmia database.

(a) Normal sinus rhythm in record 101, with baseline oscillations and noise. (b) The onset of an episode of atrial flutter in record 222. The early signal displays normal sinus rhythm with PAC, and P waves being detected. Later, atrial flutter without P waves is observed. (c) An episode of loss of signal in record 232. (d) Ventricular trigeminy in record 201.

Our method provides accurate delineation in all the presented examples, highlighting its versatility in several aspects. First, with the exception of signal resampling, no additional signal processing techniques were used to achieve the results. Second, due to the convolutional nature of the segmentation model, the algorithm can accommodate signals of varying lengths. This greatly enhances its utility, particularly in the context of Holter recordings containing potential arrhythmias, allowing for the algorithm’s application to windows of sizes chosen for convenience. Our pytorch implementation segments and delineates an ECG record of 30 minutes in under 2s-3s on an Ubuntu machine with 64GB DRAM equipped with an NVIDIA 3080Ti with 12GB memory. The model itself uses a little under 20 ⋅ 106 parameters, and needs about 80 MB of memory. In particular, this is both suitable for real time analysis and the intended application of the analysis of long Holter recordings. Finally, it is worth noting that no parameter tuning was necessary for the delineation when applied to the MIT-BIH arrhythmia database.

5 Discussion

5.1 Delineation of ECGs with arrhythmia

In Table 3 we see that there is a significant difference between the LUDB trained model and the model trained on internal data with regard to ECGs with certain arrhythmia. There is almost no performance difference for NSR and BBB, but for the arrhythmias that are not so well-represented in LUDB, the difference is striking. For example, in LUDB, 15 recordings represent signals with atrial fibrillation, while only three recordings with atrial flutter and four recordings with sinus tachycardia are available [10]. The performance drops especially in the latter case. Fig 3 shows that in some cases of tachycardia all P waves can be missed by an improperly trained model. Similar problems can occur in AVB1. This brings us to another problem; the LUDB trained model has a high number of false positive P waves for AFIB and AFL. Without testing the model on a dataset that has a balanced distribution of arrhythmias, it is difficult to identify such failure cases. Overall, the results from Table 3 highlight the importance of using a well-curated dataset that encompasses a broad range of arrhythmias commonly seen in clinical practice for developing and validating an ECG delineation algorithm. For completeness, we reiterate that model a), trained on LUDB, although it has poor performance on tachycardia, still performs well on the benchmark QTDB (and of course on LUDB). The model trained on more diverse data has much better performance in cases of arrhythmia, while retaining a good performance on the standard benchmark tests as we will discuss next.

5.2 Performance on standard benchmarks

From Table 4 we see that our method shows performance comparable to existing methods in terms of accuracy and error metrics. Particularly on QTDB, our method shows high performance in delineating P wave onsets and offsets, achieving a PPV of over 97.9%, outperforming the methods we compared against. In the case of LUDB, our method’s strength lies in accurate T wave delineation, with both Se and PPV exceeding 99.4%, an improvement over other methods. Taken together, these results underscore the consistent accuracy of our proposed delineation algorithm across various waveforms. Our method’s weakest point is observed in the standard deviation of error (σ), particularly noticeable for the T offset of QTDB signals. In fact, we can observe from Table 4 that deep learning-based methods tend to exhibit higher σ compared to wavelet-based methods. This also aligns with the observations of Jimenez-Perez et al. [6], where their deep learning-based delineation also reported a σ larger than 30ms for T offset delineation in QTDB. We also observe that the onset errors for P and QRS are shifted positively while the standard deviation remains relatively similar to other methods, which may partially be an artifact of the independent annotations for training and test data.

It is worth noting that the comparable performance on the public datasets has been achieved by training exclusively on the internal dataset. This is important as it implies the high generalization ability of the proposed algorithm and deep learning based methods in general. As noted in [6, 8], the ability to handle unseen signals without the need for additional tuning of parameters is a key advantage of deploying a deep learning model compared to wavelet-based methods. By using a private dataset as opposed to a portion of either QTDB or LUDB for training, we have made a clear demonstration of the effectiveness at which deep segmentation models can be applied to diverse scenarios.

5.3 Arrhythmia guidance

The results on arrhythmia classification guidance, Table 5, indicate a significant reduction in false positives for both atrial fibrillation and atrial flutter. When compared to the total number of beats corresponding to the same rhythm type (indicated in the header row of Table 5), the number of false positives for the classification guided model is less than 1%. The reduction in false predictions is reflected in the improved PPV scores for P waves belonging to the entire test set, while recall scores only decreased slightly. As a result, the total F1-score increased from 96.47% to 96.97%. From the results, we conclude that the classification guided strategy can be effective in reducing false P wave predictions during AFIB and AFL episodes while maintaining the overall delineation quality.

We point out that there are two mechanisms via which classification guidance can affect delineation performance. Firstly, the weights of the segmentation model are influenced by training with the hybrid loss function (4) which combines both segmentation and classification losses. Secondly, the P wave segmentation output is suppressed according to the output of the classification branch. To illustrate this, delineation results for AFIB in Fig 11 show outcomes using a model trained with arrhythmia classification guidance: (a) without P wave suppression and (b) with P wave suppression. The positive output from the classification branch triggers P wave suppression, removing multiple false P wave predictions from the segmentation output. Note that this direct suppression of P wave segmentation is primarily applicable to short signals without rhythm changes. In ECGs with rhythm changes, rhythms cannot be unambiguously classified. A potential avenue for improvement could involve combining with accurate per-beat classification, which would require more refined training data.

10.1371/journal.pone.0303178.g011 Fig 11 Delineation of atrial fibrillation sample (PTB-XL ECG-ID: 5634) using a model trained with arrhythmia classification guidance (a) without P wave suppression and (b) with P wave suppression.

5.4 Limitations and future directions

The current delineation algorithm has limitations which should be considered when applying it to clinical practice. Firstly, it can only detect a single P wave within an RR interval due to the post-processing step (Post-processing Section 3.7), where one P wave segment is selected per RR interval. This design is particularly effective for mitigating noise, but limits applicability to abnormal rhythms, such as second or third-degree atrioventricular blocks, where multiple P waves may precede a QRS complex. Secondly, the assumption of non-overlapping waveforms (P, QRS, and T) in the algorithm’s output is a further restriction; overlapping waveforms can for example occur in first, second or third-degree atrioventricular blocks. We note that these limitations are not unique to our algorithm but are common in deep learning based delineation approaches [7, 8].

To address these limitations, future work may incorporate flexibility into a delineation algorithm’s output by allowing for the detection of multiple P waves within RR intervals, implementing multi-label classification techniques or separate models for QRS/T waves (depolarization/repolarization of ventricles) and P waves (depolarization of atria). Moreover, advanced data augmentation techniques should be investigated to accommodate other arrhythmias for which collecting annotated data may be challenging or impractical. These future directions aim to enhance delineation performance and widen its scope of application in clinical settings.

6 Conclusion

One of the main challenges in ECG delineation is to accurately identify and delineate waveforms within irregular cardiac rhythms. This study aimed to develop a deep learning-based segmentation model capable of detecting the onsets and offsets of P, QRS, and T waves in signals with potential arrhythmias. By evaluating on the internal dataset, we have highlighted the impact of arrhythmias on delineation quality. We observed significant drops in F1-scores for waveform boundary detection, particularly with arrhythmias such as ST, AVB1, AFIB, AFL, and VT, with reductions of up to 15% in certain cases, emphasizing the need to account for arrhythmias when developing and evaluating segmentation models for ECG analysis. To address this, we experimented with training on a diverse dataset and employing a post-processing strategy that can handle noise during the final delineation step. Furthermore, we assessed generalization capability through experiments on the QTDB and LUDB datasets. Our model demonstrated strong performance on the LUDB dataset, achieving Se and PPV scores above 99% for QRS and T wave boundaries, and above 98% and 96% respectively for P waves, showing comparable performance without direct training on LUDB signals. Overall, our study shows a deep learning based segmentation model to be a versatile tool for delineation which can be highly adaptive to various situations, while addressing the challenge of accurately delineating waveforms in abnormal cardiac rhythms. Future research and development could focus on broadening the scope of automatic delineation to encompass a wider range of arrhythmias, through more manual annotations or advanced data augmentation techniques.

Supporting information

S1 Appendix (PDF)

10.1371/journal.pone.0303178.r001
Decision Letter 0
Hammad Mohamed Academic Editor
© 2024 Mohamed Hammad
2024
Mohamed Hammad
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.
Submission Version0
27 Feb 2024

PONE-D-23-38359Deep Learning based ECG Segmentation for Delineation of Diverse ArrhythmiasPLOS ONE

Dear Dr. van Koert,

Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.

 perceived impact.

==============================

Please submit your revised manuscript by Apr 12 2024 11:59PM. If you will need more time than this to complete your revisions, please reply to this message or contact the journal office at plosone@plos.org. When you're ready to submit your revision, log on to https://www.editorialmanager.com/pone/ and select the 'Submissions Needing Revision' folder to locate your manuscript file.

Please include the following items when submitting your revised manuscript:A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). You should upload this letter as a separate file labeled 'Response to Reviewers'.

A marked-up copy of your manuscript that highlights changes made to the original version. You should upload this as a separate file labeled 'Revised Manuscript with Track Changes'.

An unmarked version of your revised paper without tracked changes. You should upload this as a separate file labeled 'Manuscript'.

If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter. Guidelines for resubmitting your figure files are available below the reviewer comments at the end of this letter.

If applicable, we recommend that you deposit your laboratory protocols in protocols.io to enhance the reproducibility of your results. Protocols.io assigns your protocol its own identifier (DOI) so that it can be cited independently in the future. For instructions see: https://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols. Additionally, PLOS ONE offers an option for publishing peer-reviewed Lab Protocol articles, which describe protocols hosted on protocols.io. Read more information on sharing protocols at https://plos.org/protocols?utm_medium=editorial-email&utm_source=authorletters&utm_campaign=protocols.

We look forward to receiving your revised manuscript.

Kind regards,

Mohamed Hammad, Ph.D.

Academic Editor

PLOS ONE

Journal Requirements:

When submitting your revision, we need you to address these additional requirements.

1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at 

https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf and 

https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf

2. We note that you have indicated that there are restrictions to data sharing for this study. For studies involving human research participant data or other sensitive data, we encourage authors to share de-identified or anonymized data. However, when data cannot be publicly shared for ethical reasons, we allow authors to make their data sets available upon request. For information on unacceptable data access restrictions, please see http://journals.plos.org/plosone/s/data-availability#loc-unacceptable-data-access-restrictions. 

Before we proceed with your manuscript, please address the following prompts:

a) If there are ethical or legal restrictions on sharing a de-identified data set, please explain them in detail (e.g., data contain potentially identifying or sensitive patient information, data are owned by a third-party organization, etc.) and who has imposed them (e.g., a Research Ethics Committee or Institutional Review Board, etc.). Please also provide contact information for a data access committee, ethics committee, or other institutional body to which data requests may be sent.

b) If there are no restrictions, please upload the minimal anonymized data set necessary to replicate your study findings to a stable, public repository and provide us with the relevant URLs, DOIs, or accession numbers. Please see http://www.bmj.com/content/340/bmj.c181.long for guidelines on how to de-identify and prepare clinical data for publication. For a list of recommended repositories, please see https://journals.plos.org/plosone/s/recommended-repositories. You also have the option of uploading the data as Supporting Information files, but we would recommend depositing data directly to a data repository if possible.

Please update your Data Availability statement in the submission form accordingly.

[Note: HTML markup is below. Please do not edit.]

Reviewers' comments:

Reviewer's Responses to Questions

Comments to the Author

1. Is the manuscript technically sound, and do the data support the conclusions?

The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented.

Reviewer #1: Yes

Reviewer #2: Partly

**********

2. Has the statistical analysis been performed appropriately and rigorously?

Reviewer #1: Yes

Reviewer #2: No

**********

3. Have the authors made all data underlying the findings in their manuscript fully available?

The PLOS Data policy requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.

Reviewer #1: Yes

Reviewer #2: Yes

**********

4. Is the manuscript presented in an intelligible fashion and written in standard English?

PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.

Reviewer #1: Yes

Reviewer #2: Yes

**********

5. Review Comments to the Author

Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)

Reviewer #1: 1- The abstract did not explain the working database, nor the standards adopted to measure the model’s efficiency, nor the steps of the algorithm in a simplified manner

2- The size of the tables is very small

3-Equations are not numbered

4-Research included in related works is not arranged according to years of publication (from oldest to newest)

5- Explaining the researcher’s contributions in clear steps. In addition to placing a paragraph at the end of the introduction section that explains the structure of the research in general

6- Prepare a diagram showing the structure of the proposed model

7-Conclusions: No numerical values were indicated for the results to be discussed concretely, in addition to developing a future plan for those working in this field

8-Adding recent research as references published in the year 2023, in addition to unifying the format of references

Reviewer #2: this paper presents an important investigation into the challenges of ECG delineation in the presence of diverse arrhythmias and proposes strategies to improve segmentation model performance.

- The abstract provides a clear overview of the paper's objectives and contributions. However, it would benefit from briefly mentioning the methodology and key findings.

- Introduction lacks a clear statement of the paper's objectives and contributions.

- While the authors have provided extensive information about the dataset, additional details regarding the specific criteria used for arrhythmia classification and the annotation process for waveform boundaries would enhance the clarity and rigor of the methodology.

-Provide detailed information on how arrhythmia types were identified and classified within the internal dataset.

- Elaborate on the methodology employed for annotating the onsets and offsets of P, QRS, and T waves in the internal dataset. Describe any quality control measures implemented to ensure accuracy and consistency in the annotations.

- Provide additional details on the preprocessing steps applied to the training data, particularly regarding the augmentation techniques used to simulate physiological noise.

- Include a brief discussion on the limitations of the proposed methodology, such as potential biases introduced by the dataset composition or model architecture choices. Additionally, suggest potential avenues for future research to address these limitations and further enhance the algorithm's performance.

- The authors have appropriately chosen evaluation metrics commonly used in the literature for ECG delineation algorithms. However, it would be beneficial to provide a brief explanation or definition of each metric

- The authors have effectively demonstrated the impact of arrhythmia diversity on delineation performance using both the internal dataset and LUDB. The systematic comparison of F1-scores for various arrhythmia types provides valuable insights. However, including specific examples or case studies illustrating delineation outcomes for different arrhythmias could further enrich the discussion.

- it would be helpful to provide a brief discussion on any observed discrepancies or challenges encountered during the validation process, particularly regarding differences in annotation formats and their impact on performance evaluation.

- The evaluation of arrhythmia classification guidance to reduce false positive P wave detections is a valuable contribution. However, the discussion could be enhanced by providing insights into the underlying reasons for the observed improvements and discussing any potential limitations or trade-offs associated with this approach.

- Related work Section provides a concise summary of rule-based methods and classical machine learning approaches for ECG delineation. However, it would be beneficial to briefly mention the limitations or challenges associated with these traditional techniques, such as their dependence on handcrafted features and susceptibility to noise.

- it would be helpful to include a brief explanation of the rationale behind using CNN architectures for segmentation tasks, emphasizing their ability to automatically learn hierarchical features from raw data.

**********

6. PLOS authors have the option to publish the peer review history of their article (what does this mean?). If published, this will include your full peer review and any attached files.

If you choose “no”, your identity will remain anonymous but your review may still be made public.

Do you want your identity to be public for this peer review? For information about this choice, including consent withdrawal, please see our Privacy Policy.

Reviewer #1: No

Reviewer #2: No

**********

[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files.]

While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, https://pacev2.apexcovantage.com/. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email PLOS at figures@plos.org. Please note that Supporting Information files do not need this step.

10.1371/journal.pone.0303178.r002
Author response to Decision Letter 0
Submission Version1
10 Apr 2024

First of all we would like to thank the reviewers for their careful reading and for their suggestions. We have revised the paper according to their suggestions. We will now briefly address each comment:

Points raised by reviewer #1:

1- The abstract did not explain the working database, nor the standards adopted to measure the model’s efficiency, nor the steps of the algorithm in a simplified manner:

We have expanded the abstract to address these points.

2- The size of the tables is very small

We have increased the size of all tables.

3-Equations are not numbered

Fixed

4-Research included in related works is not arranged according to years of publication (from oldest to newest)

We believe that, after unifying and cleaning up the references (as in suggestion 8 of the reviewer), the ordering is now correct. The order of appearance is first by topic and then by year.

5- Explaining the researcher’s contributions in clear steps. In addition to placing a paragraph at the end of the introduction section that explains the structure of the research in general

We have included a brief summary of the key contributions at the end of the introduction.

6- Prepare a diagram showing the structure of the proposed model

A flow diagram showing the structure of the model has been included in Fig 2 appearing at the end of the introduction.

7-Conclusions: No numerical values were indicated for the results to be discussed concretely, in addition to developing a future plan for those working in this field

We have rewritten part of the conclusion to address these points. Regarding the development of a future plan, we have written most in a new section “Limitations and Future Directions” appearing just before the conclusion (section 5.4)

8-Adding recent research as references published in the year 2023, in addition to unifying the format of references

We have included additional references, including some from 2023, and cleaned up the references.

Points raised by reviewer #2:

- The abstract provides a clear overview of the paper's objectives and contributions. However, it would benefit from briefly mentioning the methodology and key findings.

The extended abstract now mentions these points briefly.

- Introduction lacks a clear statement of the paper's objectives and contributions.

The end of the introduction now contains a list of key contributions, following the objectives.

- While the authors have provided extensive information about the dataset, additional details regarding the specific criteria used for arrhythmia classification and the annotation process for waveform boundaries would enhance the clarity and rigor of the methodology.

We have added a paragraph (lines 196-207) and an appendix to address these points.

-Provide detailed information on how arrhythmia types were identified and classified within the internal dataset.

This is now also explained in this additional paragraph.

- Elaborate on the methodology employed for annotating the onsets and offsets of P, QRS, and T waves in the internal dataset. Describe any quality control measures implemented to ensure accuracy and consistency in the annotations.

The methology is described in the additional paragraph. The appendix presents statistics on the consistency of lead I and lead II annotation. These statistics give an indication of the accuracy and consistency of the annotation depending on the type of wave.

- Provide additional details on the preprocessing steps applied to the training data, particularly regarding the augmentation techniques used to simulate physiological noise.

Formulas for the augmentation methods are now provided in Formulas (1) and (2). The surrounding text has been expanded to provide additional detail.

- Include a brief discussion on the limitations of the proposed methodology, such as potential biases introduced by the dataset composition or model architecture choices. Additionally, suggest potential avenues for future research to address these limitations and further enhance the algorithm's performance.

This has been addressed in the additional section 5.4 on Limitations and Future Directions (lines 538-556)

- The authors have appropriately chosen evaluation metrics commonly used in the literature for ECG delineation algorithms. However, it would be beneficial to provide a brief explanation or definition of each metric

We have added lines 373-376 to explain these metrics.

- The authors have effectively demonstrated the impact of arrhythmia diversity on delineation performance using both the internal dataset and LUDB. The systematic comparison of F1-scores for various arrhythmia types provides valuable insights. However, including specific examples or case studies illustrating delineation outcomes for different arrhythmias could further enrich the discussion.

We have included three examples in Figures 6, 7 and 8 by annotating samples from the PTB-XL database. These samples were chosen based on the increased error rate in certain arrhythmias and are indicative of the biases Deep Learning models can obtain.

- it would be helpful to provide a brief discussion on any observed discrepancies or challenges encountered during the validation process, particularly regarding differences in annotation formats and their impact on performance evaluation.

This has been done in the additional section 4.3.1, lines 429-435.

- The evaluation of arrhythmia classification guidance to reduce false positive P wave detections is a valuable contribution. However, the discussion could be enhanced by providing insights into the underlying reasons for the observed improvements and discussing any potential limitations or trade-offs associated with this approach.

An explicit example of arrhythmia guidance suppression is now provided in Fig 11. An additional paragraph, lines 525-537, contains a discussion of potential limitations and drawbacks.

- Related work Section provides a concise summary of rule-based methods and classical machine learning approaches for ECG delineation. However, it would be beneficial to briefly mention the limitations or challenges associated with these traditional techniques, such as their dependence on handcrafted features and susceptibility to noise.

We thank the reviewer for pointing this out and have added these observations in lines 117-121.

- it would be helpful to include a brief explanation of the rationale behind using CNN architectures for segmentation tasks, emphasizing their ability to automatically learn hierarchical features from raw data.

We have included these observations in lines 127-130

We thank the reviewers once again.

On behalf of the authors,

Sincerely yours,

Otto van Koert

Attachment Submitted filename: reponse_to_reviewers_pone-d-23-38359.pdf

10.1371/journal.pone.0303178.r003
Decision Letter 1
Hammad Mohamed Academic Editor
© 2024 Mohamed Hammad
2024
Mohamed Hammad
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.
Submission Version1
22 Apr 2024

Deep Learning based ECG Segmentation for Delineation of Diverse Arrhythmias

PONE-D-23-38359R1

Dear Dr. van Koert,

We’re pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it meets all outstanding technical requirements.

Within one week, you’ll receive an e-mail detailing the required amendments. When these have been addressed, you’ll receive a formal acceptance letter and your manuscript will be scheduled for publication.

An invoice will be generated when your article is formally accepted. Please note, if your institution has a publishing partnership with PLOS and your article meets the relevant criteria, all or part of your publication costs will be covered. Please make sure your user information is up-to-date by logging into Editorial Manager at Editorial Manager® and clicking the ‘Update My Information' link at the top of the page. If you have any questions relating to publication charges, please contact our Author Billing department directly at authorbilling@plos.org.

If your institution or institutions have a press office, please notify them about your upcoming paper to help maximize its impact. If they’ll be preparing press materials, please inform our press team as soon as possible -- no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact onepress@plos.org.

Kind regards,

Mohamed Hammad, Ph.D.

Academic Editor

PLOS ONE

Additional Editor Comments (optional):

Reviewers' comments:

Reviewer's Responses to Questions

Comments to the Author

1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.

Reviewer #1: All comments have been addressed

Reviewer #2: All comments have been addressed

**********

2. Is the manuscript technically sound, and do the data support the conclusions?

The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented.

Reviewer #1: Yes

Reviewer #2: Yes

**********

3. Has the statistical analysis been performed appropriately and rigorously?

Reviewer #1: Yes

Reviewer #2: Yes

**********

4. Have the authors made all data underlying the findings in their manuscript fully available?

The PLOS Data policy requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.

Reviewer #1: Yes

Reviewer #2: Yes

**********

5. Is the manuscript presented in an intelligible fashion and written in standard English?

PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.

Reviewer #1: Yes

Reviewer #2: Yes

**********

6. Review Comments to the Author

Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)

Reviewer #1: (No Response)

Reviewer #2: Dear Authors,

Congratulations!

All comments have been addressed.

**********

7. PLOS authors have the option to publish the peer review history of their article (what does this mean?). If published, this will include your full peer review and any attached files.

If you choose “no”, your identity will remain anonymous but your review may still be made public.

Do you want your identity to be public for this peer review? For information about this choice, including consent withdrawal, please see our Privacy Policy.

Reviewer #1: No

Reviewer #2: No

**********

10.1371/journal.pone.0303178.r004
Acceptance letter
Hammad Mohamed Academic Editor
© 2024 Mohamed Hammad
2024
Mohamed Hammad
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.
10 May 2024

PONE-D-23-38359R1

PLOS ONE

Dear Dr. van Koert,

I'm pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now being handed over to our production team.

At this stage, our production department will prepare your paper for publication. This includes ensuring the following:

* All references, tables, and figures are properly cited

* All relevant supporting information is included in the manuscript submission,

* There are no issues that prevent the paper from being properly typeset

If revisions are needed, the production department will contact you directly to resolve them. If no revisions are needed, you will receive an email when the publication date has been set. At this time, we do not offer pre-publication proofs to authors during production of the accepted work. Please keep in mind that we are working through a large volume of accepted articles, so please give us a few weeks to review your paper and let you know the next and final steps.

Lastly, if your institution or institutions have a press office, please let them know about your upcoming paper now to help maximize its impact. If they'll be preparing press materials, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact onepress@plos.org.

If we can help with anything else, please email us at customercare@plos.org.

Thank you for submitting your work to PLOS ONE and supporting open access.

Kind regards,

PLOS ONE Editorial Office Staff

on behalf of

Dr. Mohamed Hammad

Academic Editor

PLOS ONE
==== Refs
References

1 Gacek A , Pedrycz W , editors. ECG Signal Processing, Classification and Interpretation: A Comprehensive Framework of Computational Intelligence. London: Springer London; 2012.
2 Li C , Zheng C , Tai C . Detection of ECG characteristic points using wavelet transforms. IEEE Transactions on Biomedical Engineering. 1995;42 (1 ):21–28. doi: 10.1109/10.362922 7851927
3 Martinez JP , Almeida R , Olmos S , Rocha AP , Laguna P . A Wavelet-Based ECG Delineator: Evaluation on Standard Databases. IEEE Transactions on Biomedical Engineering. 2004;51 (4 ):570–581. doi: 10.1109/TBME.2003.821031 15072211
4 Kalyakulina AI , Yusipov II , Moskalenko VA , Nikolskiy AV , Kozlov AA , Zolotykh NY , et al . Finding Morphology Points of Electrocardiographic-Signal Waves Using Wavelet Analysis. Radiophysics and Quantum Electronics. 2019;61 (8 ):689–703. doi: 10.1007/s11141-019-09929-2
5 Laguna P, Mark RG, Goldberg A, Moody GB. A database for evaluation of algorithms for measurement of QT and other waveform intervals in the ECG. In: Computers in Cardiology 1997. IEEE; 1997. p. 673–676.
6 Jimenez-Perez G , Alcaine A , Camara O . Delineation of the electrocardiogram with a mixed-quality-annotations dataset using convolutional neural networks. Scientific Reports. 2021;11 (1 ):863. doi: 10.1038/s41598-020-79512-7 33441632
7 Chen Z , Wang M , Zhang M , Huang W , Gu H , Xu J . Post-processing refined ECG delineation based on 1D-UNet. Biomedical Signal Processing and Control. 2023;79 :104106. doi: 10.1016/j.bspc.2022.104106
8 Moskalenko V , Zolotykh N , Osipov G . Deep learning for ECG segmentation. In: Advances in Neural Computation, Machine Learning, and Cognitive Research III. Springer International Publishing; 2020. p. 246–254.
9 Ronneberger O, Fischer P, Brox T. U-Net: Convolutional Networks for Biomedical Image Segmentation. In: Medical Image Computing and Computer-Assisted Intervention—MICCAI 2015. Springer International Publishing; 2015. p. 234–241.
10 Kalyakulina AI , Yusipov II , Moskalenko VA , Nikolskiy AV , Kosonogov KA , Osipov GV , et al . LUDB: A New Open-Access Validation Tool for Electrocardiogram Delineation Algorithms. IEEE Access. 2020;8 :186181–186190. doi: 10.1109/ACCESS.2020.3029211
11 Saclova L , Nemcova A , Smisek R , Smital L , Vitek M , Ronzhina M . Reliable P wave detection in pathological ECG signals. Scientific Reports. 2022;12 (1 ):6589. doi: 10.1038/s41598-022-10656-4 35449228
12 Hong J , Li HJ , Yang Cc , Han CL , Hsieh Jc . A clinical study on Atrial Fibrillation, Premature Ventricular Contraction, and Premature Atrial Contraction screening based on an ECG deep learning model. Applied Soft Computing. 2022;126 :109213. doi: 10.1016/j.asoc.2022.109213
13 Aziz S , Ahmed S , Alouini MS . ECG-based machine-learning algorithms for heartbeat classification. Scientific Reports. 2021;11 (1 ):18738. doi: 10.1038/s41598-021-97118-5 34548508
14 Pan J , Tompkins WJ . A Real-Time QRS Detection Algorithm. IEEE Transactions on Biomedical Engineering. 1985;BME-32 (3 ):230–236. doi: 10.1109/TBME.1985.325532 3997178
15 Sabherwal P , Agrawal M , Singh L . Independent detection of T-waves in single lead ECG signal using Continuous Wavelet Transform. Cardiovasc Eng Technol. 2023;14 (2 ):167–181. doi: 10.1007/s13239-022-00643-1 36163602
16 Benitez DS, Gaydecki PA, Zaidi A, Fitzpatrick AP. A new QRS detection algorithm based on the Hilbert transform. In: Computers in Cardiology 2000. Vol.27 (Cat. 00CH37163); 2000. p. 379–382.
17 Mukhopadhyay SK, Mitra M, Mitra S. Time plane ECG feature extraction using Hilbert transform, variable threshold and slope reversal approach. In: 2011 International Conference on Communication and Industrial Application; 2011. p. 1–4.
18 Martínez A, Alcaraz R, J Rieta J. Automatic electrocardiogram delineator based on the Phasor Transform of single lead recordings. In: 2010 Computing in Cardiology; 2010. p. 987–990.
19 Graja S , Boucher JM . Hidden Markov tree model applied to ECG delineation. IEEE Transactions on Instrumentation and Measurement. 2005;54 (6 ):2163–2168. doi: 10.1109/TIM.2005.858568
20 Akhbari M , Shamsollahi MB , Sayadi O , Armoundas AA , Jutten C . ECG segmentation and fiducial point extraction using multi hidden Markov model. Computers in Biology and Medicine. 2016;79 :21–29. doi: 10.1016/j.compbiomed.2016.09.004 27744177
21 Dubois R , Maison-Blanche P , Quenet B , Dreyfus G . Automatic ECG wave extraction in long-term recordings using Gaussian mesa function models and nonlinear probability estimators. Computer Methods and Programs in Biomedicine. 2007;88 (3 ):217–233. doi: 10.1016/j.cmpb.2007.09.005 17997186
22 Hannun AY , Rajpurkar P , Haghpanahi M , Tison GH , Bourn C , Turakhia MP , et al . Cardiologist-level arrhythmia detection and classification in ambulatory electrocardiograms using a deep neural network. Nature Medicine. 2019;25 (1 ):65–69. doi: 10.1038/s41591-018-0268-3 30617320
23 De Melo Ribeiro H , Arnold A , Howard JP , Shun-Shin MJ , Zhang Y , Francis DP , et al . ECG-based real-time arrhythmia monitoring using quantized deep neural networks: A feasibility study. Comput Biol Med. 2022;143 (105249 ):105249. doi: 10.1016/j.compbiomed.2022.105249 35091363
24 Sivapalan G , Nundy KK , Dev S , Cardiff B , John D . ANNet: A lightweight neural network for ECG anomaly detection in IoT edge sensors. IEEE Trans Biomed Circuits Syst. 2022;16 (1 ):24–35. doi: 10.1109/TBCAS.2021.3137646 34982689
25 Zhang Y , Liu S , He Z , Zhang Y , Wang C . A CNN model for cardiac arrhythmias classification based on individual ECG signals. Cardiovasc Eng Technol. 2022;13 (4 ):548–557. doi: 10.1007/s13239-021-00599-8 34981316
26 Hao W, Jingsu K. Investigating Deep Learning Benchmarks for Electrocardiography Signal Processing. arXiv. 2022; p. 2204.04420.
27 Zeiler MD, Fergus R. Visualizing and Understanding Convolutional Networks. In: Fleet D, Pajdla T, Schiele B, Tuytelaars T, editors. Computer Vision—ECCV 2014. Lecture Notes in Computer Science. Springer International Publishing; 2014. p. 818–833.
28 Jimenez-Perez G, Alcaine A, Camara O. U-Net Architecture for the Automatic Detection and Delineation of the Electrocardiogram. In: 2019 Computing in Cardiology (CinC); 2019. p. Page 1–Page 4.
29 Sereda I, Alekseev S, Koneva A, Kataev R, Osipov G. ECG Segmentation by Neural Networks: Errors and Correction. In: 2019 International Joint Conference on Neural Networks (IJCNN); 2019. p. 1–7.
30 Nurmaini S , Darmawahyuni A , Rachmatullah MN , Firdaus F , Sapitri AI , Tutuko B , et al . Robust electrocardiogram delineation model for automatic morphological abnormality interpretation. Scientific Reports. 2023;13 (1 ):13736. doi: 10.1038/s41598-023-40965-1 37612382
31 Li X , Cai W , Xu B , Jiang Y , Qi M , Wang M . SEResUTer: a deep learning approach for accurate ECG signal delineation and atrial fibrillation detection. Physiological Measurement. 2023;44 (12 ):125005. doi: 10.1088/1361-6579/ad02da 37827168
32 Huang H, Lin L, Tong R, Hu H, Zhang Q, Iwamoto Y, et al. UNet 3+: A Full-Scale Connected UNet for Medical Image Segmentation. In: ICASSP 2020—2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP). IEEE; 2020. p. 1055–1059.
33 Shuvo MB , Ahommed R , Reza S , Hashem MMA . CNL-UNet: A novel lightweight deep learning architecture for multimodal biomedical image segmentation with false output suppression. Biomedical Signal Processing and Control. 2021;70 :102959. doi: 10.1016/j.bspc.2021.102959
34 Ribeiro AH , Ribeiro MH , Paixão GMM , Oliveira DM , Gomes PR , Canazart JA , et al . Automatic diagnosis of the 12-lead ECG using a deep neural network. Nature Communications. 2020;11 (1 ):1760. doi: 10.1038/s41467-020-15432-4 32273514
35 He K, Zhang X, Ren S, Sun J. Deep Residual Learning for Image Recognition. In: 2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR). IEEE; 2016. p. 770–778.
36 Xiao Q , Lee K , Mokhtar SA , Ismail I , Pauzi ALBM , Zhang Q , et al . Deep Learning-Based ECG Arrhythmia Classification: A Systematic Review. Applied Sciences. 2023;13 (8 ):4964. doi: 10.3390/app13084964
37 Ansari Y , Mourad O , Qaraqe K , Serpedin E . Deep learning for ECG Arrhythmia detection and classification: an overview of progress for period 2017–2023. Frontiers in Physiology. 2023;14 :1246746. doi: 10.3389/fphys.2023.1246746 37791347
38 Moody GB , Mark RG . The impact of the MIT-BIH arrhythmia database. IEEE engineering in medicine and biology magazine: the quarterly magazine of the Engineering in Medicine & Biology Society. 2001;20 (3 ):45–50. doi: 10.1109/51.932724 11446209
39 Taddei A , Distante G , Emdin M , Pisani P , Moody GB , Zeelenberg C , et al . The European ST-T database: standard for evaluating systems for the analysis of ST-T changes in ambulatory electrocardiography. European heart journal. 1992;13 (9 ). doi: 10.1093/oxfordjournals.eurheartj.a060332 1396824
40 Di Marco LY , Chiari L . A wavelet-based ECG delineation algorithm for 32-bit integer online processing. BioMedical Engineering OnLine. 2011;10 (1 ):23. doi: 10.1186/1475-925X-10-23 21457580
41 Zhou Z , Siddiquee MMR , Tajbakhsh N , Liang J . UNet++: Redesigning Skip Connections to Exploit Multiscale Features in Image Segmentation. IEEE Transactions on Medical Imaging. 2020;39 (6 ):1856–1867. doi: 10.1109/TMI.2019.2959609 31841402
42 He K, Zhang X, Ren S, Sun J. Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification. In: 2015 IEEE International Conference on Computer Vision (ICCV). IEEE; 2015. p. 1026–1034.
43 Kingma DP, Ba J. Adam: A Method for Stochastic Optimization. arXiv. 2017; p. 1412.6980.
44 Mehari T , Strodthoff N . Self-supervised representation learning from 12-lead ECG data. Computers in Biology and Medicine. 2022;141 :105114. doi: 10.1016/j.compbiomed.2021.105114 34973584
45 Lin TY, Goyal P, Girshick R, He K, Dollar P. Focal Loss for Dense Object Detection. In: Proceedings of the IEEE International Conference on Computer Vision (ICCV); 2017.
46 Fan X , Yao Q , Cai Y , Miao F , Sun F , Li Y . Multiscaled Fusion of Deep Convolutional Neural Networks for Screening Atrial Fibrillation From Single Lead Short ECG Recordings. IEEE Journal of Biomedical and Health Informatics. 2018;22 (6 ):1744–1753. doi: 10.1109/JBHI.2018.2858789 30106699
47 Association for the Advancement of Medical Instrumentation. Testing and reporting performance results of cardiac rhythm and ST segment measurement algorithms. ANSI/AAMI EC38. 1998;1998.
48 Wagner P , Strodthoff N , Bousseljot RD , Kreiseler D , Lunze FI , Samek W , et al . PTB-XL, a large publicly available electrocardiography dataset. Sci Data. 2020;7 (1 ):154. doi: 10.1038/s41597-020-0495-6 32451379
