
==== Front
Sci Rep
Sci Rep
Scientific Reports
2045-2322
Nature Publishing Group UK London

38862565
63873
10.1038/s41598-024-63873-4
Article
Low complexity beamforming design in reconfigurable intelligent surface-assisted communication systems
Jiang Jun 123
Huang Huan hh6668881004@163.com

12
Zhang Junxin 12
1 https://ror.org/05petvd47 grid.440680.e 0000 0004 1808 3254 College of Information Science and Technology, Tibet University, Lhasa, 850000 China
2 https://ror.org/05petvd47 grid.440680.e 0000 0004 1808 3254 Information Technology National Experimental Teaching Demonstration Center of Tibet University, Lhasa, 850000 China
3 https://ror.org/05petvd47 grid.440680.e 0000 0004 1808 3254 Tibet University Tibetan Information Technology Engineering Research Center of the Ministry of Education, Lhasa, 850000 China
11 6 2024
11 6 2024
2024
14 1343915 12 2023
3 6 2024
© The Author(s) 2024
https://creativecommons.org/licenses/by/4.0/ Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/.
Due to the possibility of blockage during communication, the communication quality may be poor. Therefore, Reconfigurable Intelligent Surface (RIS) technology can effectively solve this problem. In order to increase the capacity of RIS-assisted wireless communication systems, joint optimization of beamforming design is crucial. However, the complexity of the optimization algorithm increases with the increase in the number of base station antennas and RIS elements deployed. Therefore, we propose a joint low-complexity optimization beamforming design based on fractional programming (FP) to address this issue. Specifically, we first use perfect channel state information to maximize the system's sum rate, as this problem is non-convex, we decompose the original problem into three sub-problems, and then introduce appropriate auxiliary variables. We derive optimal closed-form solutions for active and passive beamforming types, respectively. As the optimal solution obtained leads to higher computational complexity with an increase in the number of base station antennas and RIS elements, we reduce the computational complexity of obtaining the optimal solution based on the Woodbury transformation and scalar transformation. The proposed algorithm is also extended to the case where there is channel state information error. Finally, simulation results show that the proposed algorithm has certain advantages over other algorithms.

Subject terms

Electrical and electronic engineering
Information technology
National Natural Science Foundation funded project62261051 Jiang Jun issue-copyright-statement© Springer Nature Limited 2024
==== Body
pmcIntroduction

In fact, RIS consists of many elements that can manipulate incident signals through passive beamforming. Reconfigurable Intelligent Surface (RIS) is considered a promising technology for future 6G wireless communication systems1–3. RIS is a surface with numerous passive reflecting elements that can induce phase shifts in the transmitted signals4–8. By adjusting the phase shifts of these elements, the signal paths can be dynamically controlled, thus avoiding weak signal conditions in the presence of communication obstacles. Since RIS does not require signal processing or RF chains9, it does not introduce additional noise during communication, thereby enhancing system capacity and energy efficiency10–12. Therefore, due to these reasons, RIS has attracted increasing research interest in areas such as sensing integration13,14 physical layer security15, and terahertz communications16,17. Among them, achieving high system capacity and rate to improve user service quality is crucial for RIS-assisted wireless communication systems18–20.

For RIS-assisted wireless communication systems, the design and low-cost deployment present new challenges. Maximizing the communication system gain by jointly optimizing the active beamforming matrix of the base station (BS) and the reflection coefficients of RIS is an important problem21,22. Furthermore, traditional joint beamforming optimization algorithms6,18 become computationally complex and time-consuming when the number of BS antennas and RIS elements increases. Therefore, to address these issues, this paper proposes a low-complexity design for active beamforming at the transmitter and passive beamforming at RIS in RIS-assisted wireless communication systems. Additionally, the more practical scenario of channel estimation errors is considered since perfect channel state information is difficult to obtain in practical communication scenarios. Thus, the low-complexity joint beamforming algorithm is extended to incorporate realistic channel state information.

Recently, a significant amount of work has been done on joint beamforming optimization in RIS-assisted communication systems. For instance, in Ref.23, the optimization problem is characterized by limiting the transmit power of a single base station and RIS, followed by the adoption of a semi-definite relaxation algorithm to optimize the reflection coefficients with high complexity. In Ref.24, in a multi-RIS-assisted downlink communication system, the authors formulate an optimization problem for minimizing mean square error (MSE) and employ a maximum-minimum alternating optimization algorithm. By considering the communication interference caused by different bandwidths in multiple sub-intervals and the frequency-selective characteristics of RIS, the joint optimization problem is transformed into several sub-problems using fractional programming (FP)25 and block coordinate descent, respectively solved by maximum-minimum (MM) algorithm and alternating direction method of multipliers (ADMM)26. In the scenario of RIS-assisted communication with multiple base stations and users, the problem of determining which base station and user the RIS should serve is addressed using a deep reinforcement learning (DRL) algorithm27, which not only solves this problem effectively but also jointly optimizes beamforming.Considering that channel state information is generally not accurate in practical communication scenarios,28 investigates the optimization of RIS-assisted communication with imperfect channel state information (CSI) by maximizing the sum rate. In Ref.29, the authors consider the presence of noise in the reflection coefficients of RIS and transform the problem into minimizing the mean square error of data streams, which is solved using the MM algorithm. Furthermore, based on the constraint of constant modulus of RIS reflection coefficients, a modified Riemannian gradient ascent (RGA) algorithm is proposed. In Ref.19, a RIS-assisted non-orthogonal multiple access system is studied, aiming to maximize the system sum rate. By decomposing the optimization problem into three sub-problems, an alternating flow optimization algorithm and a continuous convex approximation algorithm are employed to jointly optimize the BS beamforming and RIS phase shifting. Based on the RIS-assisted massive MIMO downlink system without cellular coverage in Ref.30, the authors propose an FP-based approach to decompose the joint beamforming problem into two sub-problems and optimize them using the primal–dual subgradient (PDS) algorithm. In Ref.31, a RIS-assisted non-cellular IoT network is proposed, considering the large number of devices in the IoT architecture. To address the energy consumption issue associated with the traditional fully connected user-base station approach, a user-centric non-cellular network is designed, and a low-complexity RIS passive beamforming optimization algorithm is developed using the FP method. However, the active beamforming design still incurs high computational complexity. Therefore, in Ref.32, two time-scale channel state information is introduced for RIS passive beamforming optimization using statistical CSI and transmitter active beamforming optimization using instantaneous CSI, aiming to reduce overhead and improve communication efficiency in RIS-assisted non-cellular massive MIMO systems. In Ref.33, the authors exploited the duality between Gaussian MIMO broadcast channels and multiple access channels. They utilized alternating optimization algorithms to jointly optimize the user's covariance matrix and RIS phase shifts, deriving closed-form solutions for optimal performance and maximum system rates. In Refs.34,35, the authors investigated the non-linear coupling between elements of RIS in practical physical channel models. Subsequently, Ref.36 also confirmed that the assumed linear RIS cascaded channel model is inadequate for describing physical reality, thereby verifying the nonlinearity of RIS cascaded channels. Therefore, in this article, we assume that the cascaded channel is linear, which may lead to performance degradation in practical communication systems. Future work could explore more realistic RIS cascaded channel modeling and algorithm design to optimize system performance and rates.In this paper, we propose a low-complexity joint beamforming optimization algorithm for RIS-assisted communication systems. The main contributions are as follows:We propose a low-complexity joint beamforming optimization algorithm for RIS-assisted communication systems. Specifically, we formulate an optimization problem for maximizing the system sum rate based on perfect CSI in a multi-user RIS-assisted communication system. Since this problem is non-convex, we decompose the objective function into several sub-problems using the FP method and derive closed-form solutions for optimization.

To address the high computational complexity issue of obtaining closed-form solutions as the number of base station antennas and RIS elements increases, we design a low-complexity joint optimization algorithm based on the "Woodbury transformation"37 and "scalarization transformation"31. The proposed low-complexity algorithm demonstrates significantly lower computational complexity compared to traditional optimization methods, even though multiple iterations are still required for convergence.

In practical communication scenarios, perfect CSI is difficult to obtain. Therefore, we also consider the variation of maximizing the system sum rate under non-perfect CSI conditions. We extend the proposed low-complexity algorithm to the joint beamforming design under imperfect CSI. Simulation results show that the proposed low-complexity algorithm exhibits superior performance in large-scale MIMO systems and RIS with multiple elements compared to existing optimization algorithms.

The effectiveness of the proposed algorithm for joint beamforming design in RIS-assisted communication systems was tested through simulation results. In this article, the following notations were employed: italic denotes scalars, bold italic represents matrices or vectors, if · denotes a matrix, then diag(·) denotes a vector; if · denotes a vector, then diag(·) denotes a diagonal matrix. ·T denotes the transpose operation, ·H represents the conjugate transpose operation, ‖·‖2 denotes the 2-norm, · denotes the magnitude, and ·∗ denotes the optimal solution.

System model and problem formulation

In this section, we first describe the channel model, followed by the characterization of the signal model of the system. Finally, based on the given signal model, we design the formulation of the optimization problem.

As shown in Fig. 1, we consider a RIS-assisted multi-user downlink communication system, where the base station is equipped with M antennas, there are K K<M single-antenna users, and the RIS has N reflecting elements. The channels from user K to the base station, from the RIS to the base station, and from user K to the RIS are denoted as hBS,k∈CM×1, hBS,r∈CM×Nandhr,k∈CN×1, where k=1,⋯,K. The phase shift matrix of the RIS is denoted as θ~=diagθ~1,⋯,θ~n,⋯θ~N, where θ~n=ρnejϕn denotes the reflection coefficient of the nth element on the RIS, while ϕn∈[0,2π) and ρn∈[0,1] represent the phase shift and the on/off state of the nth element on the RIS, respectively. In the following, we determine the values of ρn=1 in order to achieve maximum system gain.Figure 1 RIS-assisted multi-user communication system.

We assume that the direct link channel from the base station to the user in this paper follows Rayleigh fading, and the segmented channels from the base station to the RIS and from the RIS to the user follow Rician fading. The spacing configuration between the RIS elements and the base station antennas is a half-wavelength uniform linear array (ULA). Therefore, the channels hBS,rH and hr,kH are modeled as:1 hBS,rH=dhϖhϖh+1h¯H+1ϖh+1h~H,

2 hr,kH=dr,kϖr,kϖr,k+1h¯r,kH+1ϖr,k+1h~r,kH,

where dh and dr,k represent the path loss between the base station and the RIS, and between the RIS and user k, respectively. ϖh and ϖr,k represent the Rician factors. h¯H and h¯r,kH represent the line-of-sight (LoS) components of the channel paths. The response h¯H can be expressed using the ULA response of the N elements of the base station antennas as:3 cMϑBS=1,ej2πdλsinϑ⋯,ej2πdλM-1sinϑ,

where ϑBS represents the azimuth angle of the base station transmitted signal. Then,h¯H can be expressed as:4 h¯H=cNH(ϑr)cMϑBS,

where ϑr represents the angle at which the signal reaches the RIS. Based on the above derivation, h¯r,kH can be expressed as:5 h¯r,kH=cMϑk,

where ϑk represents the angle at which the signal reaches user k. h~Handh~r,kH represent the NLoS components of the channel, where the elements follow complex Gaussian distribution with zero mean and unit variance (CN∼0,1). When modeling the signal, let sk represent the data symbol transmitted to the K-th user, where E[skskH]=1. Therefore, for all users, the signal f transmitted from the base station can be expressed as:6 f=∑k=1Kwksk,

where wk∈CM×1 represents the beamforming vector transmitted from the base station to the K-th user. Let Hk=hBS,kH+hr,kHθ~hBS,rH represent all the channels that the signal received by user k passes through. Therefore, the signal received by user k can be expressed as:7 yk=Hkf+nk=Hk∑k=1Kwksk+nk,

where nk∼CN0,σ02 represents the Gaussian white noise received by the k-th user. For the subsequent algorithm processing, let θ¯=θ~1,⋯,θ~n,⋯θ~N. Then, we have:8 hr,kHθ¯HhBS,rH=θ¯Hdiaghr,kHhBS,rH.

To express the equation more concisely, let ha=diaghr,kHhBS,rH∈CN×M. Then, Eq. (7) can be rewritten as:9 yk=hBS,kH+θ¯Hha∑k=1Kwksk+nk.

Therefore, The Signal-to-Interference-plus-Noise Ratio (SINR) of the user can be expressed as:10 γk=hBS,kH+θ¯Hhawk2∑j=1,j≠kKhBS,kH+θ¯Hhawj2+σ02=HkHwk2∑j=1,j≠kKHkHwj2+σ02,

where HkH=hBS,kH+θ¯Hha. Therefore, the sum rate of the system can be expressed as:11 Rsum=∑k=1KRk=∑k=1Klog1+γk.

The purpose of this paper is to design optimization algorithms to maximize the sum rate of the system. The next step is to formulate the optimization problem. Based on the previous discussion, the objective function of the optimization problem has been determined. Now, let's discuss the constraints. Among them, the beamforming vector wk is related to the transmit power of the base station. Therefore, we have:12 ∑k=1K‖wk‖2≤P,

where P represents the total power transmitted by the base station. In addition, in order to achieve the maximum system gain, the constraints of the RIS elements may be expressed as:13 θ¯n=1,∀n=1,⋯,N.

Let W=w1,⋯,wK∈CM×K. This optimization problem P1 can be formulated as:14a P1:maxW,θ¯RsumW,θ¯=∑k=1Klog1+γk

14b s.t.∑k=1K‖wk‖2≤P,

14c θ¯n=1,∀n=1,⋯,N.

Based on the formulation of the optimization problem in P1, both the objective function and constraints are non-convex, making it challenging to deal with such non-convex optimization problems. However, the proposed Fixed-Point (FP) algorithm can effectively handle the optimization problem presented in this paper. Additionally, we have also designed a low-complexity version of the FP method. The next section will provide a detailed description of the joint beamforming optimization algorithm using FP and low-complexity FP.

Design of traditional beamforming optimization algorithms

In this section, we aim to optimize W and θ¯ to maximize the system sum rate. Upon observation, the objective function in P1 represents a typical fixed-point (FP) problem. First, we introduce an auxiliary variable to transform the objective function into a more manageable polynomial sum form in P2. Secondly, by employing quadratic transformation, we convert the polynomial into a form (P3 and P4) that allows optimization of the variables. Finally, we employ the methods of Lagrange multipliers and ADMM to respectively obtain closed-form solutions for optimizing W and θ¯. The closed-form solutions obtained using these two approaches result in higher computational complexity. Therefore, we propose a low-complexity algorithm design as well.

First, introduce the auxiliary variable ηk6,30.Then, seeking the maximum value of log1+ηk-ηk+1+ηkγk1+γklog1+γk with respect to ηk, log1+γk can be expressed as:15 log1+γk=maxηk≥0log1+ηk-ηk+1+ηkγk1+γk.

Then, substituting γk=HkHwk2∑j=1,j≠kKHkHwj2+σ02 into Eq. (15), we obtain:16 log1+γk=maxηk≥0log1+ηk-ηk+1+ηkHkHwk2∑j=1,j≠kKHkHwj2+σ021+HkHwk2∑j=1,j≠kKHkHwj2+σ02=maxηk≥0log1+ηk-ηk+1+ηkHkHwk2∑j=1,j≠kKHkHwj2+σ02∑j=1,j≠kKHkHwj2+σ02∑j=1,j≠kKHkHwj2+σ02+HkHwk2∑j=1,j≠kKHkHwj2+σ02=maxηk≥0log1+ηk-ηk+1+ηkHkHwk2∑j=1,j≠kKHkHwj2+σ02∑j=1KHkHwj2+σ02∑j=1,j≠kKHkHwj2+σ02=maxηk≥0log1+ηk-ηk+1+ηkHkHwk2∑j=1,j≠kKHkHwj2+σ02×∑j=1,j≠kKHkHwj2+σ02∑j=1KHkHwj2+σ02=maxηk≥0log1+ηk-ηk+1+ηkHkHwk2∑j=1KHkHwj2+σ02.

Thus, substituting Eq. (16) into the objective function, the transformation into optimization problem P2 can be expressed as follows:17a P2:maxW,θ¯,ηF1W,θ¯,η

17b s.t.∑k=1K‖wk‖2≤P,

17c θ¯n=1,∀n=1,⋯,N.

17d ηk≥0,k=1,⋯,K,

where F1W,θ¯,η=∑k=1Klog1+ηk-ηk+1+ηkHkHwk2∑j=1KHkHwj2+σ02, η=η1,⋯,ηKT.Fixing W,θ¯, solving for η

To obtain the optimized W, we first need to calculate the optimal value of the introduced auxiliary variable ηk. Upon observing the objective function, it is apparent that η represents a logarithmic linear function. Therefore, we need to take the first-order partial derivative of the objective function F1W,θ¯,η with respect to ηk and set the derivative equal to zero, leading to:18 ∂F1W,θ¯,ηηk=11+ηk-1+HkHwk2∑j=1KHkHwj2+σ02=-ηk1+ηk+HkHwk2∑j=1KHkHwj2+σ02.

By setting -ηk1+ηk+HkHwk2∑j=1KHkHwj2+σ02 equal to 0, we obtain: 19 HkHwk2∑j=1KHkHwj2+σ02=ηk1+ηkHkHwk21+ηk=∑j=1KHkHwj2+σ02ηkHkHwk2=∑j=1KHkHwj2+σ02ηk-HkHwk2ηkηk=HkHwk2∑j=1KHkHwj2+σ02-HkHwk2ηk∗=γk,

where ηk∗ represents the optimal solution for ηk. Substituting ηk∗ into F1W,θ¯,η, we can obtain:20 F1W,θ¯,η∗=∑k=1Klog1+ηk∗-ηk∗+1+ηk∗HkHwk2∑j=1KHkHwj2+σ02=F2W,θ¯,

where η∗=η1∗,⋯,ηK∗T. Therefore, from Eq. (20), it can be observed that there are only two optimization variables remaining: W and θ¯.

Fixing θ¯andη∗, solving for W

Since the first two terms in F2W,θ¯ are not related to W, and the third term with a fractional form is also non-convex, we need to perform quadratic transformation on 1+ηk∗HkHwk2∑j=1KHkHwj2+σ02 to express it as a sum of polynomials. Introducing an auxiliary variable μk, we can transform it into:21 ∑k=1K1+ηk∗HkHwk2∑j=1KHkHwj2+σ02=∑k=1K2η~k∗RμkHHkHwk-∑k=1Kμk2∑j=1KHkHwj2+σ02=F3W,μ.

Since θ¯ and η∗ can be treated as constants when optimizing the variable W, the optimization problem of P2 can be transformed into P3:22a P3:maxW,θ¯,ηF3W,μ

22b s.t.∑k=1K‖wk‖2≤P,

where μ=μ1,⋯,μKT. In order to solve the optimization problem for P3, we can utilize the method of Lagrange multipliers to transform this optimization problem into:23 P3L(W,λ,μ)=∑k=1K2η~k∗RμkHHkHwk-∑k=1Kμk2∑j=1KHkHwj2+σ02+λ∑k=1KwkHwk-P,

where P3L(W,λ,μ) represents the augmented Lagrangian function for the optimization problem P3, and λ represents the dual variable. Employing the train of thought of alternating optimization, we sequentially differentiate the three variables W,λ and μ from Eq. (23), ultimately yielding their respective optimal values. First, we differentiate μk to obtain the first-order partial derivative:24 ∂P3L(μ,W,λ)μk=2η~k∗HkHwk-2μk∑j=1KHkHwj2+σ02.

Setting the first-order derivative of Eq. (24) equal to 0, we have:25 μk∗=η~k∗HkHwk∑j=1KHkHwj2+σ02,

where μk∗ represents the optimal solution for the auxiliary variable μk. Substituting μk∗ into P3L(μ,W,λ), we obtain P3L(μ∗,W,λ), where μ∗=μ1∗,⋯,μK∗T. Then, the first derivative function of λ is solved for P3L(μ∗,W,λ), and we can get:26 ∂P3L(μ∗,W,λ)λ=∑k=1KwkHwk-P.

As λ>0 and wkHwk-P≤0, the function P3L(μ∗,W,λ) with respect to λ is a monotonically decreasing function. Therefore, when wkHwk=P, the function P3L(μ∗,W,λ) attains its maximum value. If the value of wk∗Hwk∗<P, where wk∗ represents the optimal beamforming vector, then the minimum value of λ should be taken to achieve the maximum value of the function P3L(μ∗,W,λ). Thus, the optimal solution of λ, denoted as λ∗, can be expressed as:27 λ∗=minλ∗≥0:∑k=1K‖wk∗‖2≤P.

Substituting the optimal solution λ∗ for λ into the function P3L(μ∗,W,λ) to obtain P3L(μ∗,W,λ∗), then differentiating wk, we get:28 ∂P3L(μ∗,W,λ∗)wk=2η~k∗μk∗Hk-2∑j=1Kμj∗2∑k=1KHjHjHwk-2λ∗IMwk.

Setting the first-order derivative equal to zero, we have:29 wk∗=η~k∗μk∗∑j=1Kμj∗2HjHjH+λ∗IN-1Hk.

Therefore, W∗=w1∗,⋯,wK∗T yields the optimized beamforming matrix.In addition, the calculation of wk∗ involves matrix inversion, which leads to a high computational complexity.

As HkH=hBS,kH+θ¯Hha, F2W,θ¯ can be written as:30 F2W,θ¯=∑k=1Klog1+ηk∗-ηk∗+1+ηk∗hBS,kH+θ¯Hhawk2∑j=1KhBS,kH+θ¯Hhawj2+σ02.

Observing formula (30), θ¯ is only related to 1+ηk∗hBS,kH+θ¯Hhawk2∑j=1KhBS,kH+θ¯Hhawj2+σ02, so it is only necessary to transform this term and then optimize to obtain the optimal solution. By introducing an auxiliary variable ξk and using quadratic transformation, we can obtain:31 ∑k=1K1+ηk∗hBS,kH+θ¯Hhawk2∑j=1KhBS,kH+θ¯Hhawj2+σ02=∑k=1K2η~k∗RξkHhBS,kH+θ¯Hhawk-∑k=1Kξk2∑j=1KhBS,kH+θ¯Hhawj2+σ02=F4θ¯,ξ,

where ξ=ξ1,⋯,ξKT, differentiating ξk with respect to the relevant variables yields the first-order partial derivative:32 ∂F4θ¯,ξξk=2η~k∗hBS,kH+θ¯Hhawk-2ξk∑j=1KhBS,kH+θ¯Hhawj2+σ02.

here, setting Eq. (32) equal to zero, we have:33 ξk∗=η~k∗hBS,kH+θ¯Hhawk∑j=1KhBS,kH+θ¯Hhawj2+σ02.

Therefore, ξ∗=ξ1∗,⋯,ξK∗T. By substituting ξ∗ into F4θ¯,ξ, we obtain F4θ¯,ξ∗, and the optimization only needs to be performed on θ¯. Furthermore, F4θ¯,ξ∗ can be rewritten as:34 F4θ¯,ξ∗=∑k=1K2η~k∗Rξk∗hBS,kH+θ¯Hhawk-∑k=1Kξk∗2∑j=1KhBS,kH+θ¯Hhawj2+σ02=∑k=1K2η~k∗Rξk∗HhBS,kH+θ¯Hhawk-∑k=1Kξk∗H∑j=1KhBS,kH+θ¯HhawjhBS,kH+θ¯HhawjH+σ02ξk∗.

here, expanding ξk∗HhBS,kH+θ¯Hhawj can be expressed as:35 ξk∗HhBS,kH+θ¯Hhawj=ξk∗HhBS,kHwj+ξk∗Hθ¯Hhawj=Ck,j+θ¯HGk,j,

where Ck,j and Gk,j are expressed as:36a Ck,j=ξk∗HhBS,kHwj.

36b Gk,j=ξk∗Hhawj.

Substituting Eq. (35) into Eq. (34), we obtain:37 F4θ¯,ξ∗=∑k=1K2η~k∗RCk,k+θ¯HGk,k-∑k=1K∑j=1KCk,j+θ¯HGk,jCk,j∗+Gk,jHθ¯+ξk∗Hσ02ξk∗=∑k=1K2η~k∗Rθ¯HGk,k+∑k=1K2η~k∗RCk,k-∑k=1K∑j=1KCk,jCk,j∗+Ck,jGk,jHθ¯+θ¯HGk,jCk,j∗+θ¯HGk,jGk,jHθ¯+ξk∗1Hσ02ξk∗1=-∑k=1K∑j=1Kθ¯HGk,jGk,jHθ¯+2∑k=1Kη~k∗Rθ¯HGk,k-2∑k=1K∑j=1KRθ¯HCk,j∗Gk,j+∑k=1K2η~k∗RCk,k-∑k=1K∑j=1KCk,jCk,j∗-∑k=1Kξk∗1Hσ02ξk∗1,

here, 2Rθ¯HCk,j∗Gk,j=θ¯HGk,jCk,j∗+Ck,jGk,jHθ¯. Therefore, F4θ¯,ξ∗ can be rewritten as:38 F4θ¯,ξ∗=-θ¯HUθ¯+2Rθ¯HV+κ,

among them:39a U=∑k=1K∑j=1KGk,jGk,jH.

39b V=∑k=1Kη~k∗Gk,k-∑k=1K∑j=1KCk,j∗Gk,j.

39c κ=∑k=1K2η~k∗RCk,k-∑k=1K∑j=1KCk,jCk,j∗-∑k=1Kξk∗Hσ02ξk∗.

Therefore, the problem of optimizing θ¯ can be formulated as P4:40a P4:maxθ¯F4θ¯,ξ∗

40b s.t.θ¯n=1,∀n=1,⋯,N.

It can be observed that P4 is a Quadratically Constrained Quadratic Programming (QCQP) problem. Therefore, we can solve it using the Alternating Direction Method of Multipliers (ADMM) approach. First, we introduce an auxiliary vector ϱ, and then the problem P4 can be transformed into P5:41a P5:maxϱ,θ¯F4ϱ,ξ∗-ϖ2‖ϱ-θ¯‖2

41b s.t.ϱ=θ¯,

41c θ¯n=1,∀n=1,⋯,N.

where ϖ>0 is a penalty parameter. Then, introducing an auxiliary variable λ~, the Lagrangian transformation of P5 can be expressed as:42 L(θ¯,ϱ,λ~)=-ϱHUϱ+2RϱHV+κ-ϖ2‖ϱ-θ¯‖2+Rλ~Hϱ-θ¯=-ϱHUϱ-ϖ2‖ϱ-θ¯‖2+R2ϱHV+λ~Hϱ-θ¯.

Then, based on the ADMM method to solve Eq. (42), we obtain:43 θ¯t+1=argmaxθ¯L(θ¯,ϱt,λ~t),

44 ϱt+1=argmaxϱL(θ¯t+1,ϱ,λ~t),

45 λ~t+1=λ~t-ϖϱt+1-θ¯t+1,

where λ~ is a complex vector. t is the number of iterations. Differentiating L(θ¯,ϱt,λ~t) with respect to θ¯ yields the first-order partial derivative:46 δL(θ¯,ϱt,λ~t)θ¯=ϖϱt-θ¯-λ~t.

Let Eq. (46) be equal to 0, then:47 θ¯t+1=ϱt-1ϖλ~t.

Due to the constraints on the RIS reflection coefficients, θ~n=1, where ∀n=1,⋯,Nr, the optimal solution obtained from Eq. (47) can be expressed as the calculated angle:48 ∠θ¯n∗=∠θ¯~n∗,

where θ¯~n∗ represents the n-th element obtained from the optimized closed-form solution of θ¯∗. Next, differentiating L(θ¯t+1,ϱ,λ~t) with respect to ϱ yields the first-order partial derivative:49 δL(θ¯t+1,ϱ,λ~t)ϱ=-2Uϱ-ϖϱ-θ¯t+1+2V+λ~t.

Let Eq. (49) be equal to 0, then :50 ϱt+1=2U+ϖIN-12V+λ~t+ϖθ¯t+1,

where, parameter ϖ=τ‖U‖2, τ≥1. Finally, the optimal solution of λ~t+1 is obtained based on Formula (45) until the algorithm converges.Furthermore, it can be observed that the matrix inversion operation in ϱ leads to a high computational complexity. Additionally, we can see that in Eq. (47), the optimized closed-form solution θ¯t+1 is obtained through linear operations, resulting in lower computational complexity. However, the ADMM algorithm requires iterative calculations of ϱt+1 and λ~t+1 to obtain θ¯t+1, and there is a matrix inversion process involved in obtaining ϱt+1. Therefore, employing the ADMM algorithm to obtain the final closed-form solution for RIS passive beamforming optimization would introduce a higher computational complexity.

Proposed low complexity algorithm design

In this section, Based on the drawbacks of traditional beamforming optimization algorithms discussed in the previous section, we propose a low-complexity optimization algorithm design based on the "Woodbury transformation" and "scalar transformation".Closed-form solution based on the "Woodbury transformation" for W

The closed-form solution for W obtained from Eq. (29) involves matrix inversion, which results in high computational complexity OM3. Therefore, using the "Woodbury transformation" can reduce the computational complexity of calculating OM2. First, we transform Eq. (29) into the form of the "Woodbury transformation". Let B=∑j=1Kμj∗2HjHjH, xj=μj∗2, then B can be written as:51 B=x1H1⋯xjHj⋯xKHKx1H1H⋮xjHjH⋮xKHKH,

where, let D=x1H1⋯xjHj⋯xKHK∈CM×K. Therefore, B=DDH. Let E=DH∈CK×M, then B can be written as:52 B=EHE.

Substituting B=EHE into formula (29), we have:53 wk∗=η~k∗μk∗EHE+λ∗IN-1Hk.

Therefore, Eq. (53) is transformed into the form based on the "Woodbury transformation". Hence, EHE+λ∗IN-1 based on the "Woodbury transformation" can be written as:54 EHE+λ∗IN-1=1λ∗IM-EHλ∗IK+EEH-1E.

Based on the derivation in Eq. (54), formula (29) can be rewritten as:55 wk∗=η~k∗μk∗1λ∗IM-EHλ∗IK+EEH-1EHk,

In the obtained optimized closed-form solution wk∗, there is also a matrix inversion operation, denoted as λ∗IK+EEH-1, but the computational complexity at this stage is K3.where the number of base station antennas M>K, or when M>>K, after the transformation, the computational complexity of K3 can be ignored, leaving only the computational complexity of matrix EH multiplied by E, denoted as OM2.

Closed-form solution based on the "Scalar transformation" for θ¯

From the objective function F4θ¯,ξ∗=-θ¯HUθ¯+2Rθ¯HV+κ in P4, we can observe that it is a quadratic function with respect to an element θ¯ in θ¯n. It can be expressed as:56 F4(θ¯n)=-unnθ¯n2+2Rθ¯nHVn-θ¯n∑l=1,l≠nNrθ¯l(uln+unl)+C,

where unn, Vn, uln, and unl represent the j-th diagonal element of matrix U, the n-th element of vector Vn, the element in the l-th row and n-th column of matrix U, and the element in the n-th row and l-th column of matrix U, respectively. C represents a term independent of θ¯n. Therefore, Eq. (61) represents the scalar quadratic function of the n-th element of the RIS reflection that we want to optimize. Taking the derivative of θ¯n, we can obtain:57 ∂F4(θ¯n)θ¯n=-2unnθ¯n+2Vn-∑l=1,l≠nNrθ¯l(uln+unl).

Then let the formula (57) be equal to 0, we obtain:58 θ¯n=2Vn-∑l=1,l≠nNθ¯l(uln+unl)2unn.

As the reflection coefficients of RIS need to satisfy the constraint in formula (13), we introduce an auxiliary vector δ. Substituting it into Eq. (58), we have:59 θ¯n∗=2Vn-∑l=1,l≠nNθ¯l(uln+unl)2δnunn.

It can be observed that in Eq. (59), we divide by a scalar value each time, eliminating the need for matrix inversion and greatly reducing the complexity. δn represents the n-th element of δ. δn can be expressed as:60 δn=12unn2Vn-∑l=1,l≠nNθ¯l(uln+unl),

Based on Eq. (60), it can be seen that the obtained closed-form solution for RIS passive beamforming optimization no longer involves a matrix inversion process, and the division by unn results in a scalar value. The remaining calculation steps involve scalar addition and subtraction. Computing the optimal closed-form solution for one element requires N calculations, where RIS has N elements, and the multiplication is performed N×N times, resulting in a computational complexity of ON2.Therefore, based on the above derivation, the detailed steps of the low-complexity alternating optimization algorithm proposed are shown in Algorithm 1:Algorithm 1 Proposed joint beamforming design.

Complexity analysis

The computational complexity of calculating wk∗ before transformation is OM3, while the computational complexity of calculating wk∗ after the "Woodbury transformation" is still OM2. The computational complexity of calculating the optimized θ¯n using the ADMM algorithm is ON3, and the computational complexity after scalar transformation is ON2.Finally, the computational complexity of the traditional and proposed beamforming optimization algorithms is OM3+ON3 and OM2+ON2, respectively. In general, in communication systems, receivers are subject to noise, making it challenging to obtain accurate channel state information. Therefore, the estimated channel state information will inevitably have some errors. We can represent the simulated estimated channel H~kH as:61 H~kH=HkH+e,

where HkH represents the true channel, and e∼CN0,σe2 represents the channel estimation error following a Gaussian distribution with zero mean. We assume that the variance of σe2 satisfies σe2≜ιHkH2, where ι represents the ratio of channel estimation error power to channel gain HkH2, reflecting the level of channel estimation error. We then apply the proposed algorithm to the H~kH obtained through channel estimation errors. Due to limited space, we will not provide a detailed description of the algorithm here. Instead, we will replace HkH in the derived algorithm from the previous section with H~kH. Therefore, the next section will present simulation results demonstrating the performance of the proposed algorithm.

Results and discussion

In this section, we first present the simulation parameters. Then, based on the simulation results, we provide a detailed comparison of the performance between the proposed algorithm and existing algorithms under different conditions. As shown in Fig. 2, without loss of generality, we consider a base station with an average linear array (ULA) of M = 5 antennas and N = 80 reflective elements on the reconfigurable intelligent surface (RIS).The base station is located at coordinates (0 m, 0 m), and the RIS is located at (200 m, 0 m). There are K = 4 users randomly distributed within a radius of approximately 10 m around the coordinates (200 m, 30 m). The variance of the noise is defined as σ02=1, and the communication system has a bandwidth of 180 kHz. Additionally, the initially active beamforming vector W satisfies trace(WWH)=P, and the base station's transmit power P is defined as 10SNR10, where SNR represents the signal-to-noise ratio. The initial RIS coefficients satisfy the constraints in Eq. (13). We propose three schemes for comparison:Scheme 1: No optimization of RIS phase shifts, using random phase-shift reflection coefficients.

Scheme 2: No assistance from RIS, only communication links between the base station and users.

Scheme 3: ADMM algorithm with optimized phase shifts.

Figure 2 RIS assisted K user communication environment simulation.

In this section, the performance of the proposed algorithm is comprehensively analyzed through simulation results. Figure 3 illustrates the convergence performance of the proposed algorithm compared to the other schemes. The simulation environment in Fig. 3 includes a base station with a transmit power of 1 dBm, 4 users, 5 base station antennas, and 80 elements deployed on the RIS. It can be observed from the figure that the proposed method has some loss in performance compared to Scheme 3, which may be due to suboptimal solutions during the "scalar" conversion process. However, the proposed algorithm greatly reduces the complexity of the optimization algorithm. Scheme 3 proposes a joint optimization of beamforming design and involves communication links between the base station and users. Scheme 1 optimizes the active beamforming design of the base station using the proposed method, and Scheme 2 optimizes the proposed method. Through analysis, it can be concluded that even without optimizing the phase shifts, the system can achieve good performance with RIS-assisted communication. It can also be observed that the proposed method achieves good convergence and relatively good performance under different communication conditions.Figure 3 The convergence comparison between the proposed algorithm and other algorithms.

Figure 4 illustrates the comparison of system and rate performance of the proposed method under different numbers of RIS elements. The base station has a transmit power in -5 dBm, 5 base station antennas, 4 users, and the RIS has 80 reflect elements. It can be observed that as the number of RIS elements increases, both the system and rate performance improve. Additionally, it can be seen that the proposed method demonstrates good convergence performance.Figure 4 The convergence performance of the proposed scheme under different number of RIS elements is compared.

To further demonstrate the performance of the proposed method, convergence analysis was conducted under different numbers of base station antennas. Figure 5 shows the results when the transmit power is set to 0 dBm, the RIS has 80 elements, and there are 4 users. It can be observed that as the number of base station antennas increases, both the system performance and rate continuously improve. Moreover, the proposed algorithm exhibits good convergence performance at different numbers of base station antennas.Figure 5 The convergence performance comparison of the proposed scheme under different number of base station antennas.

To validate the convergence performance of the proposed algorithm in the presence of CSI errors, convergence experiments were conducted. The simulation environment considered a transmit power of 0 dBm, 4 users, 5 base station antennas, 80 RIS elements, and a channel error parameter of 0.01. Figure 6 demonstrates that both the proposed algorithm and the baseline algorithms exhibit good convergence performance under the presence of CSI errors.Figure 6 The convergence performance of the proposed scheme is compared with other schemes.

As shown in Fig. 7, as the channel parameter error increases, both system and rate exhibit a decreasing trend. However, since small error parameters were used in this experiment, the decreasing trend is not very significant. This also highlights the importance of obtaining accurate CSI in achieving high system performance and rate.Figure 7 The comparison of system sum rate under different channel error parameters.

As shown in Fig. 8, we further investigate the impact of increasing RIS elements on system and rate performance. We set the system parameters as P=0 dBm, 5 antennas, 4 users, and there is no channel error. It can be observed that as the number of RIS elements increases, both the system and rate continuously improve. Without RIS-assisted communication, the system and rate remain unchanged with the variation of RIS elements. The random phase shift optimization only focuses on optimizing the beamforming design at the active base station without optimizing the RIS phase shift design, which explains the relatively small variations in system and rate performance.Figure 8 The comparison of system sum rate under different RIS elements.

Figure 9 validates the system and rate performance of the proposed method and other methods under different base station transmit power conditions. We set the number of antennas at the base station to be 5 and the number of RIS elements to be 80. It can be observed that the proposed ADMM-based method achieves better system gain. In the case of random phase shift optimization, both system and rate are improved compared to systems without RIS-assisted communication.Figure 9 Comparison of system sum rate performance under different base station transmission power.

Conclusions

In this article, we considered a downlink communication system aided by RIS and formulated a non-convex optimization problem to maximize the system throughput. However, as the number of base station antennas and RIS elements grows, traditional algorithms become computationally complex. To address these issues, we first transformed the original problem using fractional programming into three sub-problems. Then, we introduced auxiliary variables in each sub-problem and derived low-complexity, closed-form solutions based on the Woodbury and scalar transformations. Simulation results show that the proposed method outperforms traditional algorithms.

Acknowledgements

This work was supported by the National Nature Science Foundation of China (62261051).

Author contributions

H.H.: conceptualization, methodology, sofware, formal analysis, investigation, and writing—original draf preparation. J.J.: methodology, sofware, formal analysis, validation, investigation, and writing—review and editing.J.Z.: sofware, investigation, validation, visualization, and writing—review and editing.

Data availability

The data used during the current study available from the corresponding author on reasonable request.

Competing interests

The authors declare no competing interests.

Publisher's note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

These authors contributed equally: Jun Jiang and Huan Huang.
==== Refs
References

1. Liu Y Reconfigurable intelligent surfaces: Principles and opportunities IEEE Commun. Surveys Tutorials. 2021 23 3 1546 1577 10.1109/COMST.2021.3077737
2. Pan C Reconfigurable intelligent surfaces for 6G systems: Principles, applications, and research directions IEEE Commun. Mag. 2021 59 6 14 20 10.1109/MCOM.001.2001076
3. Basharat S Hassan SA Pervaiz H Mahmood A Ding Z Gidlund M Reconfigurable intelligent surfaces: Potentials, applications, and challenges for 6G wireless networks IEEE Wirel. Commun. 2021 28 6 184 191 10.1109/MWC.011.2100016
4. Liang YC Long R Zhang Q Large intelligent surface/antennas (LISA): Making reflective radios smart[J] J. Commun. Inform. Netw. 2019 4 2 40 50 10.23919/JCIN.2019.8917871
5. Li L Jun Cui T Ji W Electromagnetic reprogrammable coding-metasurface holograms[J] Nat. Commun. 2017 8 1 197 10.1038/s41467-017-00164-9 28775295
6. Ma X Guo S Zhang H Fang Y Yuan D Joint beamforming and reflecting design in reconfigurable intelligent surface-aided multi-user communication systems IEEE Trans. Wireless Commun. 2021 20 5 3269 3283 10.1109/TWC.2020.3048780
7. Liu F Tsilipakos O Pitilakis A Intelligent metasurfaces with continuously tunable local surface impedance for multiple reconfigurable functions[J] Phys. Rev. Appl. 2019 11 4 044024 10.1103/PhysRevApplied.11.044024
8. Wu Q Zhang R Towards smart and reconfigurable environment: Intelligent reflecting surface aided wireless network[J] IEEE Commun. Mag. 2019 58 1 106 112 10.1109/MCOM.001.1900107
9. Wu Q Zhang S Zheng B You C Zhang R Intelligent reflecting surface-aided wireless communications: A tutorial IEEE Trans. Commun. 2021 69 5 3313 3351 10.1109/TCOMM.2021.3051897
10. Basar E Di Renzo M De Rosny J Debbah M Alouini M-S Zhang R Wireless communications through reconfigurable intelligent surfaces IEEE Access 2019 7 116753 116773 10.1109/ACCESS.2019.2935192
11. Dai L Reconfigurable intelligent surface-based wireless communications: Antenna design, prototyping, and experimental results IEEE Access 2020 8 45913 45923 10.1109/ACCESS.2020.2977772
12. R. Su, L. Dai, J. Tan, M. Hao & R. MacKenzie. Capacity enhancement for irregular reconfigurable intelligent surface-aided wireless communications. in GLOBECOM 2020—2020 IEEE Global Communications Conference, Taipei, Taiwan, 2020, pp. 1–6. 10.1109/GLOBECOM42002.2020.9348273.
13. Wang X Fei Z Huang J Yu H Joint waveform and discrete phase shift design for RIS-assisted integrated sensing and communication system under cramer-rao bound constraint IEEE Trans. Veh. Technol. 2022 71 1 1004 1009 10.1109/TVT.2021.3122889
14. Xing Z Wang R Yuan X Joint active and passive beamforming design for reconfigurable intelligent surface enabled integrated sensing and communication IEEE Trans. Commun. 2023 71 4 2457 2474 10.1109/TCOMM.2023.3244246
15. Cui M Zhang G Zhang R Secure wireless communication via intelligent reflecting surface IEEE Wireless Commun. Lett. 2019 8 5 1410 1414 10.1109/LWC.2019.2919685
16. Pan Y Wang K Pan C Zhu H Wang J Sum-rate maximization for intelligent reflecting surface assisted terahertz communications IEEE Trans. Veh. Technol. 2022 71 3 3320 3325 10.1109/TVT.2022.3140869
17. Du H Performance and optimization of reconfigurable intelligent surface aided THz communications IEEE Trans. Commun. 2022 70 5 3575 3593 10.1109/TCOMM.2022.3162645
18. Guo H Liang Y-C Chen J Larsson EG Weighted sum-rate maximization for reconfigurable intelligent surface aided wireless networks IEEE Trans. Wireless Commun. 2020 19 5 3064 3076 10.1109/TWC.2020.2970061
19. Xiu Y Reconfigurable intelligent surfaces aided mmWave NOMA: Joint power allocation, phase shifts, and hybrid beamforming optimization IEEE Trans. Wireless Commun. 2021 20 12 8393 8409 10.1109/TWC.2021.3092597
20. Di Renzo M Reconfigurable intelligent surfaces vs. relaying: Differences, similarities, and performance comparison IEEE Open J. Commun. Society 2020 1 798 807 10.1109/OJCOMS.2020.3002955
21. Xu K Zhang J Yang X Ma S Yang G On the sum-rate of RIS-assisted MIMO multiple-access channels over spatially correlated rician fading IEEE Trans. Commun. 2021 69 12 8228 8241 10.1109/TCOMM.2021.3111022
22. Zhang Y Di B Zhang H Lin J Li Y Song L Reconfigurable intelligent surface aided cell-free MIMO communications IEEE Wireless Commun. Lett. 2021 10 4 775 779 10.1109/LWC.2020.3043132
23. Wu Q Zhang R Intelligent reflecting surface enhanced wireless network via joint active and passive beamforming IEEE Trans. Wireless Commun. 2019 18 11 5394 5409 10.1109/TWC.2019.2936025
24. P. Zhang, S. Gong & S. Ma. Double-RIS aided multi-user MIMO communications: Common reflection pattern and joint beamforming design. in IEEE Transactions on Vehicular Technology. 10.1109/TVT.2023.3324504.
25. Shen K Yu W Fractional programming for communication systems—Part I: Power control and beamforming IEEE Trans. Signal Process. 2018 66 10 2616 2630 10.1109/TSP.2018.2812733
26. Liu S Liu R Li M Liu Y Liu Q Joint BS-RIS-user association and beamforming design for RIS-assisted cellular networks IEEE Trans. Veh. Technol. 2023 72 5 6113 6128 10.1109/TVT.2022.3231347
27. Y. Zhu, M. Li, Y. Liu, Q. Liu, Z. Chang and Y. Hu (2022) DRL-based Joint Beamforming and BS-RIS-UE Association Design for RIS-Assisted mmWave Networks. in 2022 IEEE Wireless Communications and Networking Conference (WCNC), Austin, TX, USA, 345–350. 10.1109/WCNC51071.2022.9771607.
28. Chen Z Tang J Zhang XY Wu Q Chen G Wong K-K Robust hybrid beamforming design for multi-RIS assisted MIMO system with imperfect CSI IEEE Trans. Wireless Commun. 2023 22 6 3913 3926 10.1109/TWC.2022.3222218
29. Wang J Gong S Wu Q Ma S RIS-aided MIMO systems with hardware impairments: Robust beamforming design and analysis IEEE Trans. Wireless Commun. 2023 22 10 6914 6929 10.1109/TWC.2023.3246990
30. Zhang Z Dai L A joint precoding framework for wideband reconfigurable intelligent surface-aided cell-free network IEEE Trans. Signal Process. 2021 69 4085 4101 10.1109/TSP.2021.3088755
31. M. Lan, Y. Hei, M. Huo, H. Li & W. Li. A new framework of RIS-aided user-centric cell-free massive MIMO system for IoT networks. in IEEE Internet of Things Journal. 10.1109/JIOT.2023.3288477.
32. Gan X Zhong C Huang C Yang Z Zhang Z Multiple RISs assisted cell-free networks with two-timescale CSI: Performance analysis and system design IEEE Trans. Commun. 2022 70 11 7696 7710 10.1109/TCOMM.2022.3208629
33. N. S. Perović, L.-N. Tran, M. Di Renzo & M. F. Flanagan. On the achievable sum-rate of the RIS-aided MIMO broadcast channel: Invited paper. in 2021 IEEE 22nd International Workshop on Signal Processing Advances in Wireless Communications (SPAWC), Lucca, Italy, 2021, 571–575. 10.1109/SPAWC51858.2021.9593206.
34. R. J. Williams, E. de Carvalho & T. L. Marzetta. A communication model for large intelligent surfaces. in 2020 IEEE International Conference on Communications Workshops (ICC Workshops), Dublin, Ireland, 2020, pp. 1–6. 10.1109/ICCWorkshops49005.2020.9145091.
35. Shen S Clerckx B Murch R Modeling and architecture design of reconfigurable intelligent surfaces using scattering parameter network analysis IEEE Trans. Wireless Commun. 2022 21 2 1229 1243 10.1109/TWC.2021.3103256
36. A. Rabault et al. On the tacit linearity assumption in common cascaded models of RIS-parametrized wireless channels. in IEEE Transactions on Wireless Communications. 10.1109/TWC.2024.3367953.
37. Hager WW Updating the inverse of a matrix[J] SIAM Rev. 1989 31 2 221 239 10.1137/1031049
