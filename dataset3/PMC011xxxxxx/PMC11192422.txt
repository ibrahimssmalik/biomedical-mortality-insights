
==== Front
PLoS Comput Biol
PLoS Comput Biol
plos
PLOS Computational Biology
1553-734X
1553-7358
Public Library of Science San Francisco, CA USA

38857304
PCOMPBIOL-D-24-00232
10.1371/journal.pcbi.1012183
Research Article
Computer and Information Sciences
Information Theory
Channel Capacity
Biology and life sciences
Cell biology
Signal transduction
Cell signaling
Signaling cascades
TCR signaling cascade
Biology and life sciences
Genetics
DNA
DNA replication
Biology and life sciences
Biochemistry
Nucleic acids
DNA
DNA replication
Biology and Life Sciences
Cell Biology
Cellular Types
Animal Cells
Immune Cells
Antigen-Presenting Cells
Biology and Life Sciences
Immunology
Immune Cells
Antigen-Presenting Cells
Medicine and Health Sciences
Immunology
Immune Cells
Antigen-Presenting Cells
Biology and Life Sciences
Immunology
Immune System Proteins
Immune Receptors
T Cell Receptors
Medicine and Health Sciences
Immunology
Immune System Proteins
Immune Receptors
T Cell Receptors
Biology and Life Sciences
Biochemistry
Proteins
Immune System Proteins
Immune Receptors
T Cell Receptors
Biology and Life Sciences
Cell Biology
Signal Transduction
Immune Receptors
T Cell Receptors
Biology and Life Sciences
Biochemistry
Proteins
T Cell Receptors
Biology and Life Sciences
Cell Biology
Signal Transduction
Cell Signaling
Membrane Receptor Signaling
Immune Receptor Signaling
Biology and Life Sciences
Biochemistry
Proteins
Post-Translational Modification
Phosphorylation
Engineering and Technology
Signal Processing
Signal to Noise Ratio
Reliable ligand discrimination in stochastic multistep kinetic proofreading: First passage time vs. product counting strategies
Reliable ligand discrimination in multistep kinetic proofreading
https://orcid.org/0000-0001-5238-7364
Li Xiangting Conceptualization Formal analysis Investigation Methodology Software Visualization Writing – original draft Writing – review & editing 1
https://orcid.org/0000-0003-0785-6349
Chou Tom Conceptualization Formal analysis Investigation Visualization Writing – original draft Writing – review & editing 1 2 *
1 Department of Computational Medicine, University of California, Los Angeles, California, United States of America
2 Department of Mathematics, University of California, Los Angeles, California, United States of America
Morozov Alexandre V. Editor
Rutgers University, UNITED STATES
The authors have declared that no competing interests exist.

* E-mail: tomchou@ucla.edu
6 2024
10 6 2024
20 6 e10121836 2 2024
20 5 2024
© 2024 Li, Chou
2024
Li, Chou
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.

Cellular signaling, crucial for biological processes like immune response and homeostasis, relies on specificity and fidelity in signal transduction to accurately respond to stimuli amidst biological noise. Kinetic proofreading (KPR) is a key mechanism enhancing signaling specificity through time-delayed steps, although its effectiveness is debated due to intrinsic noise potentially reducing signal fidelity. In this study, we reformulate the theory of kinetic proofreading (KPR) by convolving multiple intermediate states into a single state and then define an overall “processing” time required to traverse these states. This simplification allows us to succinctly describe kinetic proofreading in terms of a single waiting time parameter, facilitating a more direct evaluation and comparison of KPR performance across different biological contexts such as DNA replication and T cell receptor (TCR) signaling. We find that loss of fidelity for longer proofreading steps relies on the specific strategy of information extraction and show that in the first-passage time (FPT) discrimination strategy, longer proofreading steps can exponentially improve the accuracy of KPR at the cost of speed. Thus, KPR can still be an effective discrimination mechanism in the high noise regime. However, in a product concentration-based discrimination strategy, longer proofreading steps do not necessarily lead to an increase in performance. However, by introducing activation thresholds on product concentrations, can we decompose the product-based strategy into a series of FPT-based strategies to better resolve the subtleties of KPR-mediated product discrimination. Our findings underscore the importance of understanding KPR in the context of how information is extracted and processed in the cell.

Author summary

Kinetic proofreading (KPR) is mechanism often employed by cells to enhance specificity of ligand-receptor. However, the performance of kinetic proofreading may be hampered by noise and a low signal-to-noise ratio. By consolidating multiple kinetic proofreading steps into a single state and assigning an associated waiting, or “processing time,” we developed an analytic approach to quantify the performance of KPR in different biological contexts. Despite a trade-off between speed and accuracy inherent to a first-passage time KPR strategy, we show that a signaling molecule-based discrimination strategy can enhance the performance benefits of KPR. We further decompose the product-based discrimination strategy into a set of first-passage times to different thresholds of signaling molecules produced. Through this decomposition, we find that a threshold that adjusts dynamically throughout the recognition process depends on the duration of the process. We propose that this more nuanced product-based KPR-mediated recognition process can be realized biologically. The precise structural basis for a dynamic threshold merits further experimental exploration, as it may hold significant implications for understanding biological mechanisms of information transmission at a molecular level.

The author(s) received no specific funding for this work. PLOS Publication Stagevor-update-to-uncorrected-proof
Publication Update2024-06-21
Data AvailabilityAll data and code used for running experiments, model fitting, and plotting is available on a GitHub repository at https://github.com/hsianktin/KPR.
Data Availability

All data and code used for running experiments, model fitting, and plotting is available on a GitHub repository at https://github.com/hsianktin/KPR.
==== Body
pmcIntroduction

Various cellular processes require a high degree of specificity in order to function properly, including DNA replication, gene expression, and cellular signaling. The degree of specificity observed is often hard to justify by a simple binding-affinity argument, the specificity of which is proportional to exp(−ΔΔG/RT), where ΔΔG is the difference in free energy between the correct and incorrect ligands [1]. For example, the estimated error probability per nucleotide in DNA replication is estimated to be 10−9 [2], but the net free energy difference between mismatched and matched base pairs is only 0.5 kcal/mol [3], suggesting the theoretical error rate would be ∼ 10−3. Similarly, T cells need to specifically distinguish self-antigens from mutant self-antigens, also known as neoantigens, which can differ by only one or a few amino-acids [4].

Kinetic proofreading (KPR) [1, 5, 6] typically denotes a chemical reaction mechanism that can significantly increase the specificity towards a desired ligand against competing ligands. In the KPR context, “proofreading” is accomplished by introducing additional irreversible, energy-consuming kinetic steps which individually may not distinguish desired ligands from undesired ones. However, these steps impart a delay to final product release allowing for “resetting” of the process and an overall lower final error rate (a multistep KPR mechanism is illustrated in Fig 1A below and mathematical details are discussed in the Materials and methods).

10.1371/journal.pcbi.1012183.g001 Fig 1 Schematic of the KPR process and different strategies of interpreting the output.

(A) The complex of enzyme and substrate ES alone cannot produce the final product P. It has to undergo a number of proofreading steps, represented here by phosphorylation (Pi), before the activated state E*S can produce the final product. (B) The FPT-based discrimination strategy, simply reaching the activated state E*S is interpreted as the output. Xa(t) = 0 if the system has not reached the activated state by time t, and Xa(t) = 1 otherwise. At t = 0, the reaction starts with the enzyme in the free state E. The dashed vertical line represents the termination of entire process, e.g., the time T at which the T cell and antigen presenting cell (APC) separate. Xa(t) = 1 for some t < T is interpreted as a positive response. (C) The product-based discrimination strategy. In this strategy, the number of product molecules P(T) produced within a given time T is interpreted as the output. Due to the intrinsic noise, the number of product molecules is a random variable and their distribution is shown for correct and incorrect ligands.

First proposed by Hopfield to explain the high specificity of DNA/protein synthesis [1], the KPR mechanisms have been invoked to explain other biological processes such as T cell receptor (TCR) signaling [6] and microtubule growth [7]. These first treatments of KPR described it within the steady-state limit of deterministic mass-action models, comparing the steady-state fluxes of the correct and incorrect product formation. Reactions inside the cell, however, are often between small numbers of molecules and are thus stochastic. Stochastic aspects of KPR have also been considered, emphasizing the statistics of first passage times (FPT) to product formation [8–10].

Recently, Kirby and Zilman reported that adding more kinetic proofreading steps almost always decreases the signal-to-noise ratio (SNR) defined by the ratio of the mean to the standard deviation of the output signal (the number of signaling molecules produced within a time period), suggesting that KPR is not an optimal strategy for information processing due to noise [11]. However, TCR signaling and T cell activation, the context that Kirby and Zilman describe, is a highly specific process that does involve multiple kinetic proofreading steps, but with adaptive variants of KPR used to model TCR signaling [12–16].

In this paper, we reconcile the apparent contradiction between the high specificity of TCR signaling and the low SNR of a longer-chain KPR process. The key theoretical insight involves convolving the multiple intermediate irreversible steps into a single equivalent state in which the system stays for time τ. Instead of explicitly treating a series of sequential states, we define a single, equivalent waiting time or “processing” time τ which may be a random variable. In this work, we will primarily take τ to be sharply peaked around its mean value, i.e., a δ-function distribution, resulting in a “deterministic” processing time τ. A similar quantity was proposed in the context of kinetic segregation in TCR signaling [17]. In our subsequent analyses, we also need to define a contact time T that represents the duration in which the overall process can occur, e.g., a cell-cell contact time. Values of T may also follow a modeled distribution. This simple reduction reveals intriguing insights, allows us to analytically and systematically explore different biological contexts of KPR, and provides an easier framework on which to test different metrics of KPR performance. We will primarily focus on the TCR recognition process, but we will also provide a short discussion on the simpler DNA replication problem, to illustrate that our deterministic processing time approach precisely captures the essence of KPR.

We show that the apparent contradiction arises from different strategies of determining whether a final output is correct. In the FPT-based scenario for both DNA replication and TCR signaling, arriving at an activated state or a “product” state within a given time is interpreted as the output, as illustrated in Fig 1B. A longer processing time τ can exponentially improve the accuracy of KPR at the cost of speed. The trade-off between speed and accuracy has been reported in experimental studies [18–20] recently emphasized in Xiao and Galstyan [21].

In an alternative strategy for TCR signaling implicitly used by Kirby and Zilman [11], the maximum SNR, or mutual information between the input and output occurs at just two proofreading steps, with additional processing steps decreasing the performance of KPR. Here, the implicit discrimination strategy detects the number of products (e.g., signaling molecules that lead to downstream processes) generated within a finite time T without explicitly resolving the final response of the cell, as is illustrated in Fig 1C. While Kirby and Zilman also considered a FPT-based strategy to support use of their metric and their conclusions, a recent communication by Xiao and Galstyan [21] suggested that the previous simulation of the FPT-based strategy was not correctly implemented.

Mutual information has been used in recent studies to quantify the information flow in cellular decision-making processes [22–24]. Here, we introduce mutual information and channel capacity in order to compare the performance of the two strategies (FPT to a target state and product counting) on equal footing. We also construct a decomposition of the product-based strategy into a series of FPT-based strategies with different product molecule thresholds and conclude that the product detection strategy is equivalent to a strategy that dynamically adjusts the threshold according to the duration of the process. This dynamic thresholding strategy can be shown to be more robust to fluctuations over the duration of the reaction. The effectiveness of this strategy can be attributed to an additional layer of proofreading.

Our analysis and findings present a unified framework for analyzing KPR under different biological scenarios. We also highlight the importance of understanding how different strategies of information extraction can affect the performance and parameter tuning of KPR.

Materials and methods

In this section, we first describe the general model of KPR and then apply it to two specific biological contexts, DNA replication and TCR signaling.

Model settings

In the conventional setting of KPR, the complex E(0)S composed of receptor E and a “correct” substrate (or ligand) S forms and dissociates with binding and unbinding rates k±1. A complex with the “incorrect” ligand forms and dissociates with rates k±1′. In all of our subsequent analyses and approximations, we will assume constant availability of substrate and define k1 as a first-order reaction rate. Since an incorrect ligand unbinds faster than the correct, stronger binding one, we will take k-1′>k-1. Both types of complexes can undergo multiple nonequilibrium transitions or proofreading steps (e.g., sequential phosphorylation) traversing internal states (E(0)S, …, E(m−1)S) before the final product P can be released or produced by the fully activated state E*S.

Each internal state of the complex can dissociate with rate koff or proceed to the next step with rate kf, as shown in Fig 2A. To simplify our subsequent analysis, we set koff = k−1 as in [1, 6, 10, 11], effectively assuming that the phosphorylation of the enzyme does not allosterically alter the binding affinity between the enzyme and substrate. Additionally, for an m-step proofreading process, we set kf = m/τ. Under this scaling, the waiting time to reach the final activated state is a sum of m independent exponential random variables with rate m/τ. In other words, the waiting time to reach the final activated state follows an Erlang distribution with shape parameter m and rate m/τ. The mean waiting time is kept fixed at τ as m increases, while the variance τ2/m decreases as m increases. In the many-step limit (m → ∞), the waiting time to reach the final activated state converges to a deterministic value τ due to the strong law of large numbers. A general situation in which the activation steps are partially reversible is discussed in [9]. We can thus simplify the reaction diagram in Fig 2A by lumping the internal states (E(0)S, …, E(m−1)S) into a single state ES as shown in Fig 2B. Because activation and disassembly of each stage are independent, the transition of the aggregated state ES to the dissociated state E + S is still Markovian with the same rate k−1. The master equation of the simplified model and its relation to the original multi-step model are discussed in Appendix A1 of S1 Text.

10.1371/journal.pcbi.1012183.g002 Fig 2 Reaction schemes of different descriptions of the simple kinetic proofreading process.

(A) The conventional description of KPR explicitly incorporating multiple proofreading steps. (B) A reduced representation of KPR in which multiple driven steps are lumped in a single proofreading step. Additionally, the state E*S can be taken to be a final “product” state E + P, in which case, there is no disassembly (marked by dashed lines) and k-1*≡0. However, one may be interested in products P that are constitutively produced (at rate kp) by the E*S state (gray). This latter scenario can describe, e.g., TCR-mediated T cell activation. (C) For comparison, we show the classical Michaelis-Menten reaction scheme in which the “product” state E + P can be identified as an activated complex E*S. The Michaelis-Menten kinetics implicitly assumes values of τ are exponentially distributed. An internal proofreading process leads to a nonexponentially distributed τ and equivalence to the scheme in (B) and describes the FPT-based DNA replication setting (without any additional constitutive product formation). In our setting, substrate concentrations are held fixed, and k1 will be defined as a first-order reaction rate with physical units of 1/time.

As shown in Fig 2C, our simplified model has a similar structure to the classical Michaelis-Menten reaction scheme but implicitly captures a crucial ingredient of kinetic proofreading. In the Michaelis-Menten scheme, the waiting time τ in the complex state ES before converting to product is exponentially distributed. In the KPR scheme, the waiting time τ in the state ES before converting to the activated state E*S is assumed to be non-exponentially distributed. An exponentially distributed waiting time reflects a memoryless process in which the evolution of the system depends only on the current state. This memoryless property is the defining feature of a Markov process. By contrast, memory in the KPR reaction process results in a non-exponential distribution of the processing time τ, such as the Erlang distribution associated with an m-step processing chain described above. In the simplification of the KPR we are considering, the processing time is fixed to the value τ, i.e., its distribution is a Dirac-delta function at τ (the m → ∞ limit of an Erlang distribution). In this case, the waiting time of activation does not depend only on the current state, but also on the time elapsed since the initial formation of the complex, which happened in the past. This non-Markovian step acts as a memory of the system or a clock that keeps track of the time elapsed since the initial formation of the complex, and can be achieved by, e.g., tracking the phosphorylation state of the complex ES. The biological context in which KPR operates will determine the most informative and realistic KPR model structure and the most appropriate performance metric.

Extensions to dynamic KPR schemes, including adaptive KPR models [12–16], force-dependent signaling through catch bonds [25, 26], and KPR in the presence of a spatial gradient [27], have been introduced in the literature. While canonical KPR models [1, 6, 10, 11] assume a homogeneous state independent activation rate kf and disassembly rate k−1 = koff, more general models can incorporate heterogeneity in the activation or unbinding rates across the processing steps. In such scenarios, we can still gain quantitative insight by using a mean-field approximation in which our deterministic processing time is taken to be the mean unbinding time. For example, in the multistep KPR model, the unbinding rate k−1 of the initial complex may differ from the unbinding rate koff of the intermediate complexes. But since the complex spends most of the time in the intermediate states when the number of steps m is large, the contribution of the initial complex unbinding rate k−1 to the overall disassembly rate is negligible. As a result, the assumption k−1 = koff can be interpreted as a mean-field approximation in which we substitute the disassembly rate of the intermediate complexes for the unbinding rate of the initial complex. Additionally, depending on the specific pattern of the activation rate and the disassembly rate, our approach can be extended by lumping together connected states with similar activation or disassembly rates. Within each lumped state, the internal “microstates” carry similar activation and disassembly rates. Thus, our overall approach can also provide analytical and quantitative understanding of these more general KPR models. Lastly, the key idea of our method is to convolve multiple waiting times into a single, non-exponential waiting time, which carries “memory” of the past states. This idea can also be applied to the unbinding process when the assumption k−1 = koff fails, although in that case, analytical results may be more difficult to obtain. However, our method can still provide a systematic way to quantitatively and numerically understand how the “memory” of the past states affects the overall performance of KPR.

DNA replication setting

For completeness and to define a reference case, we consider the DNA replication scenario, specifically a single nucleotide incorporation step catalyzed by DNA polymerase (E). We track the system starting from an initial state where the enzyme is free. A correct substrate S refers to the complementary nucleotide to the template strand, while an incorrect substrate S′ refers to the other three nucleotides. The enzyme can bind to either substrate with rates k1 and k1′, respectively. The enzyme can also unbind from either substrate with rates k−1 and k-1′. This two-branch reaction scheme is given by E+S⇌k1k-1ES⇝1/τE+P,E+S′⇌k1′k-1′ES′⇝1/τE+P′, (1)

where P and P′ denote the correct and incorrect products. We track the system until either one of the products is produced, allowing repeated binding and unbinding of the enzyme to the substrates. While there can be multiple replication forks in a cell, we focus on a single DNA polymerase in this study. Thus, we can represent the stochastic system by a simplified stochastic process with described by three transient states indicating the status of the DNA polymerase; namely, unbound polymerase (E), polymerase bound to correct substrate (ES), and polymerase bound to incorrect substrate (ES′). There are also two absorbing states, namely, correct product (E + P) and incorrect product (E + P′). This simplified stochastic scheme is shown in Fig 3 which is a two-branch version of Fig 2B in which we identify the activated state E*S of E*S′ with final products E + P or E + P′, referring to incorporation of the correct or incorrect nucleotide, respectively. Alternatively, Scheme 1 and Fig 3 can be though of as a two-branch version of Fig 2C but with a nonexponentially distributed τ.

10.1371/journal.pcbi.1012183.g003 Fig 3 The simplified model of KPR in DNA replication with only one enzyme.

Here, the enzyme (e.g., DNA polymerase) has three states, namely, free (E), bound to correct substrate (ES), and bound to incorrect substrate (ES′). The transition rates between these states are specified in the model. When the enzyme is bound to substrate, it produces the product (P or P′) after a waiting time τ.

The performance of the KPR process in this setting is quantified by the probability P(tp<tp′) that the FPT tp to the correct product state (E + P) is less than the FPT tp′ to the wrong product (E + P′).

Assuming that τ is a fixed value (a δ-function distribution) and using a standard approach of conditioning on the next state, as detailed in Appendix A2 of S1 Text and [28], we find P(tp<tp′)=k1k1+k1′e(k-1-k-1′)τ=k1e-k-1τk1e-k-1τ+k1′e-k-1′τ. (2)

The probability P(tp<tp′) represents the probability that the correct nucleotide is incorporated, i.e., the accuracy of the DNA replication process.

A critical feature of KPR is the sensitivity of accuracies to the unbinding rates k−1 and k-1′. In the DNA replication setting, the accuracy P(tp<tp′) has a similar form to the Hill function xnxn+an, except that the monomials are replaced by exponentials. Since the exponential function changes more rapidly than the power function, the accuracy P(tp<tp′) has a sharp sigmoidal dependence on the difference k-1-k-1′, as shown by the black curve in S1 Fig. Using the same conditioning approach, we can also calculate (see Appendix A2 in S1 Text) the mean first passage time (MFPT) E[t] to either product starting from the free state E: E[t]=k1k-1(1-e-k-1τ)+k1′k-1′(1-e-k-1′τ)+1k1e-k-1τ+k1′e-k-1′τ≈ek-1τk1(k1k-1+k1′k-1′+1), (3)

where the approximation holds if k1e-k-1τ≫k1′e-k-1′τ, which is typically the case in DNA replication, as P(tp<tp′)<1.

T cell receptor signaling context

Next, we consider proofreading in the TCR signaling context. T cells form contacts with an antigen presenting cells (APC) and scan the surface of the APC for the presence of a foreign antigen (or epitope) (S). The TCR on the T cell membrane can bind to the epitope on the APC membrane, initiating a signaling cascade that leads to T cell activation. The activated T cell can then produce signaling molecules that trigger the immune response. If the APC does not present an antigen that corresponds to the TCR, the T cell should not be activated within the contact time T and disengages from the APC. There are three features of TCR signaling that are distinct from the DNA replication process. First, the APC is likely not to carry a foreign antigen (the correct or “cognate” substrate (S)). Consequently, cognate and incorrect (“noncognate”) peptide-MHC complexes (pMHC), defined as S and S′, are not present at the same time during an encounter and do not compete with each other for TCR binding. Second, the APC and the T cell have a finite contact duration T. The recognition process can only occur within this time window. Lastly, the activated states produce identical products, i.e., downstream signals, regardless of whether the substrate (epitope) is the correct one or not. Therefore, the cell needs a strategy to discriminate the correct (cognate) and incorrect (noncognate) substrates based on the number of products generated within the contact time T.

First, assume that T is fixed as in previous literature [10] (we will relax this assumption later on). Within the time window T, the reaction diagram is represented by Eq (4). E+S⇌k1k-1ES⇝1/τE*S→kpE*S+P,E*S→k-1*E+S. (4)

Typically, TCR recognition is fairly sensitive since a few correct substrates (or epitopes) S on the APC membrane are able to activate the T cell. In the following, we will assume that each APC contains only one type of epitope, S or S′, while there are multiple TCRs that can bind to the substrate. Mathematically, the roles of substrate and TCR are equivalent. Tracking the state of the single substrate gives a similar simple stochastic process as in the DNA replication setting. This assumption allows us to reduce the number of possible states in the corresponding stochastic process.

We first consider two possible discrimination strategies, the FPT-based strategy and the product-based strategy, to quantify the output of the TCR recognition process.

FPT-based scenario

In this strategy, reaching the activated state E*S within time T is interpreted as T cell activation. The output of this strategy can be represented using the FPT to E*S state (ta) as Xa=1ta<T. The state Xa = 1 denotes an activated T cell while Xa = 0 indicates no response by the T cell. In general, we can define Xa(t)=1ta<t, and visualize the output as a binary signal changing over time, as shown in Fig 1B. To justify the FPT strategy biologically, we note that upon reaching the activated state, cofactors such as CD4 and CD8 stabilize the TCR-pMHC interaction, significantly reducing the unbinding rate k-1*. Therefore, the activated complex can then steadily produce downstream signals (products) and trigger T cell response.

Product-based scenario

This strategy, which is implicitly analyzed in [11], estimates the pMHC-TCR “affinity” by counting the number of product or signaling molecules produced within a given time. The output of this strategy is the number of products P(T) at time T, which takes on values in N, as is shown in Fig 1C. Consequently, in this more graded strategy, whether a T cell is activated is not described by a single, specific criterion.

Different strategies of interpreting the output requires us to define performance metrics that can compare different strategies on a common mathematical footing. We now define the performance metric that can be used to compare our two discrimination scenarios.

Performance metrics

In the case of FPT-based discrimination, it is natural to formulate the recognition problem as a hypothesis testing problem. We denote the binary input ξ = 1 if S is present and ξ = 0 if S′ is present. The competing hypotheses are then H0: ξ = 0 and Ha: ξ = 1. The cell accepts H0 if Xa = 0. There is a canonical definition of sensitivity and specificity, i.e., the true positive probability (TPP) and true negative probability (TNP). Given a fixed duration T, varying the processing time τ gives a family of binary classifiers (solutions to the hypothesis testing problem) corresponding to the KPR process. The receiver-operating characteristic curve (ROC) and the area under the curve (AUC) can be used to evaluate the overall performance of this family of classifiers. For a single classifier, we define the accuracy A as an average of specificity and sensitivity: sensitivity≡P(X=1∣ξ=1), (5a)

specificity≡P(X=0∣ξ=0), (5b)

A≡accuracy=12sensitivity+12specificity. (5c)

However, such metric only applies to strategies with binary output, but not the product-based strategy, as the output P(T) is non-binary. Kirby and Zilman propose a Fisher linear discriminant metric (ηFLD) based on signal-to-noise ratios [11]. However, ηFLD takes on values in (0, ∞) and does not directly quantify the fidelity of transmission from the input ξ to the output P(T).

In order to compare both strategies on a common footing and represent the fidelity of discrimination directly, we propose using the mutual information I between the input and output, and the associated channel capacity C. The mutual information between two random variables ξ and X can be defined as [29] I(ξ;X)=S(ξ⊗X)-S(ξ,X), (6)

where ξ ⊗ X is the joint random variable of ξ and X, assuming that ξ and X are independent, while S(ξ, X) is the joint Shannon entropy of ξ and X. The mutual information I(ξ;X) relies on the input distribution of ξ. Hence, one can define the channel capacity C as the supremum of the mutual information over all possible input distributions of ξ which only depends on the conditional probability distribution of X given ξ, C(X|ξ)=supξI(ξ;X). (7)

There are two advantages of using mutual information and channel capacity over the Fisher linear discriminant metric ηFLD. First, the mutual information is defined for both binary variables, as in the case of the first-passage time problem, and continuous variables, as in the case of the product-based discrimination problem. Second, in the specific scenario of binary input variables (cognate and noncognate substrates), the mutual information always takes values between 0 and 1 when measured in bits (log 2). A mutual information of 0 means that the output distribution is independent of the input, thus information of the output does not inform anything about the input. In other words, the distributions of outputs corresponding to different inputs are identical. By contrast, a value of 1 bit means that the output distributions corresponding to two different but equally probable inputs do not overlap. Consequently, the channel capacity provides a natural way to compare the product-based discrimination problem with the FPT problem and to quantify how well the system can distinguish correct substrates from incorrect ones.

In the limit in which the accuracy A→1 with binary input ξ and output X, we note that the mutual information I is approximately A (measured in bits) when P(ξ=0)=P(ξ=1)=12: I(Xa;ξ)≈A(bits). (8)

In this high accuracy limit, the channel capacity C is also close to the accuracy.

Stochastic simulations

In cases where we need to rely on stochastic simulations of the KPR processes to evaluate performance metrics, we implement the Gillespie algorithm [30] in julia [31]. The Gillespie algorithm tracks the state transitions of a Markov chain with exponential waiting times. In order to simulate the KPR process with a deterministic waiting time τ, we explicitly track all waiting times at each step and the time elapsed, updating the state by the smallest waiting time. After the state update, we re-evaluate all the waiting times and the time elapsed. The implementation is available at github.com/hsianktin/KPR.

In order to obtain the mutual information and channel capacity, we record the FPTs during the simulation, as well as the number of products produced by each simulation trajectory after a given time T. We simulated 104 trajectories and use the empirical distributions of the FPTs and the number of products as surrogates for the true distributions. This allows us to compute the conditional probability distribution of output X given input ξ. Then, mutual information is computed using Eq (6). The channel capacity is obtained by a numerical optimization procedure with respect to the probability of ξ = 1, P(ξ=1) in the interval (0, 1).

The exact parameters used in each simulation will be specified in the corresponding figures. In general, we set k−1 = 1, k-1′=2, indicating that the unbinding rate of an incorrect substrate is only twice as fast as that of a correct substrate.

Notation

We summarize the mathematical symbols and notation used in this study in Table 1. To distinguish similar symbols used in different contexts, we use context-specific subscripts. For example, the subscript a denotes the quantity relevant for FPTs to the activated state, while the subscript p refers to quantities relevant for FPTs to the product state and subscript th denotes a threshold-based FPT strategy. We also use superscript o to denote the optimal value of a quantity, e.g., Ao denotes the maximal accuracy and τo denotes the optimal processing time that achieves the maximal accuracy. Additionally, x^ denotes an estimate of the quantity x.

10.1371/journal.pcbi.1012183.t001 Table 1 Notation and mathematical symbols.

Symbol	Description	
ξ	binary input variable, correct (ξ = 1) or incorrect (ξ = 0) substrate	
X	binary output variable; activated (X = 1) or non-activated (X = 0)	
T	contact duration between T cell and APC	
k1/k−1	binding/unbinding rates of correct substrate to enzyme	
k1′/k-1′	binding/unbinding rates of incorrect substrate	
k f	activation rate of the multistep KPR process	
k p	production rate of product	
k off	unbinding rate of the intermediate complex (assumed to be k−1)	
m	number of proofreading steps in the multistep KPR process	
τ	processing time of the KPR process	
t a	first-passage time to the activated state	
N	number of binding-unbinding events in the KPR process	
A	accuracy of the KPR process	
I	mutual information between input and output	
C	channel capacity of the KPR process	
Here, the KPR process refers to the kinetic proofreading process with a deterministic processing time τ. The multistep KPR process refers to the original KPR process with multiple proofreading steps.

Results

Application of our approach to the DNA replication scenario is straightforward and characterized by the accuracy in Eq (2) and the MFPT in Eq (3). In particular, we show that our approach exhibits the expected sensitivity of the accuracy to the unbinding rates k−1 and k-1′, as shown in S1 Fig. This sensitivity is a key feature of KPR in DNA replication. In this section, we focus on analysis of the TCR signaling scenario using our deterministic waiting time approach, with an emphasis on the comparison between the FPT-based and product-based strategies.

Long processing time improves maximal accuracy in FPT-based strategy

For convenience, in FPT-based scenarios, we assume parameters k1=k1′<k-1<k-1′, T ≫ 1/k1 and let N = Tk1, which allows us to treat the recognition process as N cycles of a one-shot process. For each shot, an initial complex ES either unbinds with a probability of 1-e-k-1′τ or 1−e−k−1τ, or activates. Then, N independent cycles of the process yields the geometric failure (non-activation) probability (1−e−k−1τ)N and success (activation) probability (1−e−k−1τ)N when the substrate is correct. Similarly, we have the non-activation probability (1-e-k-1′τ)N and activation probability 1-(1-e-k-1′τ)N when the substrate is incorrect. The specificity, i.e., true negative probability, is given by (1-e-k-1′τ)N, the non-activation probability when the substrate is incorrect. The sensitivity, i.e., the true positive probability, is given by 1−(1−e−k−1τ)N, the activation probability when the substrate is correct.

In the one-shot process (N = 1), the sensitivity and specificity are controlled by the processing time τ, with a larger τ leading to a higher specificity and a lower sensitivity, as illustrated in panel A in S2 Fig. The trade-off between sensitivity and specificity can be summarized by the area under the ROC curve calculated to be AUC=k-1′/(k-1+k-1′) using Eq (9). sensitivity=e-k-1τ, (9a)

specificity=1-e-k-1′τ, (9b)

AUC=∫01sensitivityd(specificity)=k-1′k-1+k-1′. (9c)

The AUC is not sensitive to the unbinding rates k−1 and k-1′, having a “Hill coefficient” of 1. In the case where k-1′/k-1=2, the AUC is only 0.67, indicating a failure to accurately discriminate between the correct and incorrect substrates. This inability of one-shot process can be overcome by increasing the number of cycles N in the process, illustrated by plot B in S2 Fig.

In a multi-shot process, the sensitivity and specificity are explicitly given by Eqs (10a) and (10b) according to the prior discussion. However, no simple closed-form expression of the AUC is available. Instead, we consider the accuracy A defined by Eq (5), where we assume equal prior probabilities of the correct and incorrect substrates. sensitivity=1-(1-e-k-1τ)N (10a)

specificity=(1-e-k-1′τ)N (10b)

A(τ,N)=12-(1-e-k-1τ)N2+(1-e-k-1′τ)N2 (10c)

The accuracy depends on both the number of binding events N (hence T) and processing time τ, as illustrated in Fig 4A. For fixed contact duration T, the accuracy first increases with τ, then decreases. In the long processing time limit τ → ∞, the T cell does not respond to any signal, corresponding to A=12.

10.1371/journal.pcbi.1012183.g004 Fig 4 Statistics of the FPT-based strategy in the TCR recognition scenario.

(A) Accuracy A as a function of processing time τ and contact duration T, evaluated using Eq (10). (B) The maximal accuracy Ao (squares) as a function of processing time τ, evaluated using Eq (12). The asymptotic behavior of Ao in the τ → ∞ limit, evaluated using Eq (13), is shown by the dashed curve. In (A,B), we set k1=k1′=0.1, k−1 = 1, and k-1′=2.

For fixed processing time τ, there is a maximal accuracy Ao(τ)=supNA(τ,N) and a corresponding No(τ) such that A(τ,No)=Ao(τ). A straightforward calculation yields No≈(k-1′-k-1)τek-1τ1-e-(k-1′-k-1)τ,k-1′>k-1 (11)

and Ao(τ)≈12+12(1-e-k-1′τ)(k-1′-k-1)τe-k-1τ-e-k-1′τ(1-e-(k-1′-k-1)τ),k-1′>k-1. (12)

The asymptotic behavior of Ao in the τ → ∞ limit is 1-Aasympo(τ)≈12(k-1′-k-1)τe-(k-1′-k-1)τ,k-1′>k-1. (13)

As indicated in Eq (13) and Fig 4, for the TCR recognition scenario, the inaccuracy or error probability scales with e-(k-1′-k-1)τ. The improvement in the accuracy comes at a cost of the increased total times spent in the proofreading process. The optimal contact duration To required for a specific τ is given by No/k1, with No given by Eq (12). There is a common ek−1τ factor in both the inaccuracy and the optimal contact duration, indicating a trade-off between the accuracy and the total time τ spent in the proofreading process [see Fig 4B]. This observation is consistent with the accuracy-speed trade-off emphasized by Xiao and Galstyan [21]. The trade-off arises from an inability to perfectly discriminate between cognate and noncognate ligands in a one-shot process, which is constrained by the AUC of k-1′/(k-1+k-1′). Under a fixed contact time T, maximization of the accuracy corresponds to maximizing the average of the sensitivity and specificity by adjusting the processing time τ. The sensitivity and specificity under the optimal processing time should be balanced, as pushing one to the extreme will reduce the other to zero. For example, specificity in Eq (10b) approaches 1 when τ → ∞, while sensitivity in Eq (10a) approaches 0 in the same limit. Thus, by Eq (10c), the accuracy A(τ→∞,N)→1/2. Similarly, A(τ→0,N)→1/2.

Channel capacity and Fisher linear discriminant agree qualitatively

We first show that the channel capacity metric and the Fisher linear discriminant metric show qualitatively similar behavior. To obtain statistically accurate results, we simulate the TCR recognition process using the Gillespie algorithm and evaluate the channel capacity and the Fisher linear discriminant metric from 104 realizations. The results shown in S3 and S4 Figs indicate that both quantities increase with respect to cell-cell contact time T and are maximal at waiting time τ ∼ 0.6/k−1, regardless of T. We now establish the channel capacity as an appropriate metric for comparing different discrimination strategies.

Invariant optimal processing time of product-based strategy for different contact times

We now compare the channel capacity of FPT-based discrimination to that associated with product-based discrimination. In Fig 5 we plot the channel capacity between the input ξ and the outputs Xa=1ta≤T (in the FPT-based discrimination) and P(T) (in the product-based discrimination) as a function of cell contact time T when τ = 3 is fixed.

10.1371/journal.pcbi.1012183.g005 Fig 5 The channel capacity as a function of cell-cell contact time T for first-passage-time-based (FPT-based) signaling and product-based signaling.

The channel capacity is evaluated between the input ξ indicating correct (1) or incorrect (0) substrate and the output Xa or P(T). We assumed k1=k1′=0.1, k-1=k-1*=1, k-1′=[k-1′]*=2, τ = 3, and kp=0.01 for a slow product formation rate.

In Fig 6, we plot the channel capacity as a function of processing time τ for various contact times T. As in Fig 5, we channel capacities associated with both FPT-based and product-based discrimination. The channel capacity of the product-based strategy increases monotonically with respect to cell contact time T while exhibiting a peak at τPo∼0.6/k-1, as is shown previously. By contrast, the channel capacity under FPT-based discrimination has an optimal processing time τao that increases with respect to cell contact time T. The optimal contact time Tao also increases with respect to the processing time τ. The channel capacity-optimizing contact times Tao,TPo, and processing times τPo,τao shown in panels A and B of S5 Fig.

10.1371/journal.pcbi.1012183.g006 Fig 6 The channel capacities in product-based (blue squares) and first activation time-based (red dots) discrimination as a function of processing time τ for various cell contact times T.

We evaluate the channel capacity using stochastic simulations (Gillespie algorithm) of the model in Eq (4) with parameters k1=k1′=0.1, k-1=k-1*=1, k-1′=[k-1′]*=2, and kp = 1. The production rate was set higher for easier simulation of the product concentration.

There are two noteworthy observations from Fig 6. First, in the product-based scenario, the channel capacity for τ = 0 (no kinetic proofreading limit) does not differ significantly from the optimal channel capacity at τPo. This observation together with the T-independent optimal processing time τPo reflects the conclusion by Kirby and Zilman that KPR is ineffective due to noise [11]. Second, under the same total contact duration T, the maximal channel capacity of the product-based strategy is higher than that of the FPT-based strategy provided that the production rate kp is sufficiently large. These two observations suggest that the product-based discrimination is a superior strategy compared to the FPT-based one. In order to provide mechanistic insight into the difference between these two strategies, we now introduce a method to analytically characterize the product-based strategy.

Decomposition of the product-based strategy

We propose decomposing the product-based strategy into a series of first-passage-time-based strategies using the FPT of the number of products P to different thresholds Pth. Let tk represent the first time the product P(t) exceeds the threshold k. Xth = 1 (triggering immune response) if tPth≤T and Xth = 0 otherwise. Being a FPT-based strategy, C(ξ; Xth) has a similar dependence on T and τ to that of C(ξ; Xa), the channel capacity in FPT-discrimination we discussed earlier. In order to illustrate this point, we perform Gillespie simulations of the model in Eq (4) with the same parameters as in Fig 6. The results are shown in Figs 7 and 8.

10.1371/journal.pcbi.1012183.g007 Fig 7 The channel capacity between the input ξ and the output P(T) or Xth as a function of cell-cell contact time T.

Here, k1=k1′=0.1, k-1=k-1*=1, k-1′=[k-1′]*=2, τ = 3, and kp = 1.

10.1371/journal.pcbi.1012183.g008 Fig 8 The channel capacity between the input ξ and the output Xa, P(T) or Xth as a function of processing time τ.

We assumed k1=k1′=0.1, k-1=k-1*=1, k-1′=[k-1′]*=2, T = 1000, and kp = 1. 10,000 independent Gillespie simulations are conducted for each τ.

Since Xth is derived from P(T), C(ξ; P(T)) serves as an upper bound of C(ξ; Xth) for various thresholds Pth, as is illustrated in Figs 7 and 8. No single threshold can reach the information upper bound C(ξ; P(T)) at any T. A small threshold Pth can approach C(ξ; P(T)) for small T and large τ, while a large threshold Pth can approach the information upper bound C(ξ; P(T)) for large T and small τ. We thus introduce the approximation C^(ξ;P(T))≔maxPthC(ξ;Xth)≈C(ξ;P(T)) (14)

for C(ξ; P(T)).

Mathematical analysis of the effects of τ in the product-counting strategy

Having established the approximation to the channel capacity of the product-based strategy in Eq (14), we further analyze its dependence on the processing time τ under a fixed cell-cell contact time T. We use the equivalence between channel capacity and accuracy in the high accuracy limit, as shown in Eq (8) to evaluate C(ξ; P(T)). We first introduce a Gaussian distribution approximation to the original distribution of P(T) with matched mean and variance E[P(T)|ξ=1]≈var[P(T)|ξ=1]≈kpTKe-k-1τ,K≡k1k1+k-1. (15)

The ξ = 0 case is similar. The above steady-state approximation is justified in Appendix A1 of S1 Text.

Generating Pth in time tPth<T is equivalent to P(T) ≥ Pth. Thus, by approximating the distribution of P(T) by a normal distribution with mean E[P(T)] and variance var[P(T)], we can estimate the conditional probabilities of Xth=1P(T)>Pth given ξ by the integral sensitivity=P(Xth=1|ξ=1)≈∫Pth-kpTKe-k-1τkpTKe-k-1τ∞e-x2/2dx2π,specificity=P(Xth=0|ξ=0)≈∫-∞Pth-kpTK′e-k-1′τkpTK′e-k-1′τe-x2/2dx2π, (16)

where K′≡k1′/(k1′+k-1′). Under the assumption that E[P(T)|ξ=1]>Pth and E[P(T)|ξ=0]<Pth, we can rewrite Eq (16) as P(Xth=1|ξ=1)≈12+12erf(kpTKe-k-1τ-Pth2kpTKe-k-1τ),P(Xth=0|ξ=0)≈12+12erf(Pth-kpTK′e-k-1′τ2kpTK′e-k-1′τ). (17)

In the high accuracy limit, the mutual information C(ξ; Xth) between binary uniform input and binary output is approximated by the accuracy A as in Eq (8). We can then obtain the optimal threshold Ptho that maximizes the accuracy Ath=P(Xth=1|ξ=1)+P(Xth=0|ξ=0) for given T and τ to be Ptho≈kpTKe-k-1τK′e-k-1′τ[1+O(T-1)]. (18)

The exact optimal threshold Ptho can be analytically solved, but we keep the above asymptotic form for simplicity when T → ∞. The maximal accuracy Ath(τ,Pth=Ptho) is then used to approximate the maximal channel capacity maxPthC(ξ;Xth|Pth), which is an approximation of the channel capacity C(ξ; P(T)) of the product-based discrimination. Upon substituting the zero-th order term of Eqs (18) into (17), we find C^(ξ;P(T)|τ)≔Ath(τ,Pth=Ptho)≈12+12erf(kpTKe-k-1τ2-kpTK′e-k-1′τ2),k-1′>k-1. (19)

In Fig 9, note that Eq (19) generally matches the simulation results well. Slightly higher values of Eq (19) arise from the Gaussian approximation used to map discrete output to continuous output.

10.1371/journal.pcbi.1012183.g009 Fig 9 Comparison between the simulated channel capacity C(ξ; P(T)) and the corresponding estimate using Eq (19).

(A) C(ξ; P(T)) as a function of cell-cell contact time T; (B) C(ξ; P(T)) as a function of processing time τ. Here, we took k1=k1′=0.1, k-1=k-1*=1, k-1′=[k-1′]*=2, and kp = 1. τ = 3 in (A) and T = 1000 in (B).

The choice of optimal processing time τ^Po that maximizes the accuracy in Eq (19) is independent of T and is given by τ^Po≈2k-1′-k-1log(K′Kk-1′k-1). (20)

Note that the optimal processing time τ^Po is obtained by taking Pth=Ptho(T) and is independent of the cell-cell contact time T. Under the parameter settings where k1=k1′=0.1, k−1 = 1, and k-1′=2, we find that τ^Po is approximately 0.6/k−1, which is consistent with the optimal processing time τPo obtained from the simulation results, as illustrated in S5 Fig.

As we have discussed and illustrated in Fig 6, the product-based discrimination strategy seems to be superior to the FPT-based strategy in the sense that the optimal processing time τPo is independent of the cell-cell contact time T and the optimal channel capacity at a given T is higher than that of the FPT-based strategy. Through the decomposition of the product-based strategy by different thresholds, the first advantage of the product-based strategy, i.e., invariant optimal τ, can be explained by the implicit assumption of the variability of the threshold Pth. When T is small, a small threshold Pth is optimal, while a large threshold Pth is optimal when T is large. Changes in the threshold Pth allow the product-based strategy to adapt to different cell-cell contact times T without changing the processing time τ. By contrast, if the threshold Pth is fixed, then the dependence of the channel capacity on T and τ is similar to that of the FPT-based strategy, illustrated by the red curves in Figs 7 and 8. The importance of variability on the threshold Pth is even more pronounced when the total contact time T is random, as discussed in the next subsection.

Dynamic thresholds under random cell-cell contact times

In the previous sections, we have assumed that the cell-cell contact time T is deterministic. In reality, the cell-cell contact time T is random and vary from cell to cell [32–34]. To evaluate the effects of a random cell-cell contact time, we consider a simple model where the cell-cell contact time T is uniformly distributed in the interval [0, Tmax], where Tmax is the maximal cell-cell contact time.

In the previous section, we conclude that the T-independent optimal processing time τPo is a result of fixing the threshold Pth to Ptho(T) given by Eq (18). In the case of a random cell-cell contact time T, choosing a universally optimal threshold Ptho is difficult. We can, however, choose a dynamic threshold Ptho(t) that increases with the time t passed since the initial contact to maximize the channel capacity, where Ptho is still given by Eq (18), with T replaced by t. A comparison of a dynamic threshold Ptho(t) and a static threshold Pth is shown in Fig 10A. The numerical results of the maximal mutual information between the input and output Xth under different contact times T and different thresholds Pth are shown in Fig 10B. In the case of a fixed contact time T, the maximal mutual information of both static and dynamic thresholds is close to 1, indicating perfect discrimination. In the case of a uniformly distributed contact time T between 0 and Tmax, the maximal mutual information of the dynamic threshold is close to 1, while that of the static threshold is close to 0.4, indicating poor discrimination.

10.1371/journal.pcbi.1012183.g010 Fig 10 (A) Illustration of discrimination using a dynamic threshold Ptho as a function of time T since initial contact. The blue trajectories represent the number of products P with correct substrates. The red trajectories represent that of incorrect substrates. (B) A dynamic-threshold-based discrimination strategy maintains a high channel capacity when the total contact time T is uniformly distributed between 0 and Tmax. Filled bars represent the mutual information between input ξ and output Xth with a fixed contact time T and patterned bars represent the mutual information with a uniformly distributed contact time T between 0 and Tmax. The green bars indicate the maximal mutual information over all possible contact times T ≤ Tmax and all possible static thresholds Pth. The input ξ is assumed to be uniformly distributed on {0, 1}. We assumed k1=k1′=0.1, k-1=k-1*=1, k-1′=[k-1′]*=2, τ = 3, and kp = 1. Tmax is set to 106. To filter out noisy transients, we additionally mandate that when the dynamic threshold Ptho(t) is smaller than 10 products, no response is initiated.

The experiments in Fig 10 suggest that the dynamic threshold Ptho(t) maintains a high channel capacity when the total contact time T is random.

A nested single-binding KPR scheme

We have provided a mechanistic explanation for the different qualitative behavior between the channel capacities of first-passage-time-based and product-based strategies, in particular, why the optimal processing time τPo is independent of the cell-cell contact time T in the product-based discrimination.

It is also of interest to understand the high channel capacity in the product-based discrimination problem that arises even in the τ → 0 limit, as shown by the blue curve of C(ξ; P) in Fig 8. Specifically, why does the product-based strategy carry a higher maximal channel capacity than the FPT-based strategy for a given T (as shown in Fig 6)? To provide simple mechanistic intuition, we can describe the production and accumulation of product by a sequence of events (e.g., phosphorylation) within an effective KPR scheme: APC+T→k˜+1APC-T(0)→k˜fAPC-T(1)→⋯→APC-T(Pth),APC-T(k)⇝1/TAPC+T,k∈{0,1,⋯,Pth}. (21)

Here, “APC” represents the antigen-presenting cell and “T” denotes a T cell. The superscript (i) represents the number of products generated by the T cell. The T cell initiates responses when the number of products exceeds a threshold Pth.

Although there are processing steps within each successive product state APC-T(i), the overall nested scheme is structurally similar to the traditional KPR scheme shown in Fig 2A provided effective rates that incorporate the “internal” proofreading states are appropriately defined. The waiting times in state APC-T(i) before transitioning to state APC-T(i+1) can be approximated by effective, correct and incorrect “phosphorylation” rates k˜f≈kpKe-k-1τ and k˜f′≈kpK′e-k-1′τ. This assignment of k˜f,k˜f′ are appropriate in the quasi-steady state limit within each group of KPR processing steps, leading to an approximately exponentially distributed waiting time 1/k˜f between successive phosphorylations or synthesis of products. In addition, disassembly of each state occurs over a cell-cell contact time T, which is typically sharply (not exponentially) distributed since the APC-T cell unbinding process involves multiple steps and collective effects of adhesion membrane proteins. Finally, also note that the activation time of the TCR signaling process, given by the FPT τPth to generate a number of products Pbeyond the threshold Pth is also approximately a constant when Pth is sufficiently large. Consequently, the competition between two processes with almost fixed timescales allows highly informative outputs compared to the traditional KPR scheme and Michaelis-Menten kinetics, as indicated in Eq (22), where ⇝ and ⇜ represent a (near) deterministic waiting time τ. Michaelis-Menten:E+S←ES→E*S,KPR:E+S←ES⇝E*S,nestedKPR:E+S⇜ES⇝E*S. (22)

To further illustrate the role of a deterministic waiting time in the accuracy of the above process, we compare it with an exponential waiting time, i.e., standard Michaelis-Menten (MM) kinetics in Appendix A3 of S1 Text. As for a comparison between the traditional KPR scheme and the nested KPR scheme, we note that in the limit of deterministic processing time, the nested KPR can achieve exact discrimination In other words, the product-based discrimination strategy introduces an additional layer of kinetic proofreading illustrated in Eq (21). Distinct from conventional kinetic proofreading, the unbinding and activation of this extra layer of kinetic proofreading are both nonexponential, carrying more information or “memory” of the previous events. This allows the product-based discrimination strategy to achieve higher channel capacity than the FPT-based strategy.

Discussion and conclusions

In this paper, we have considered kinetic proofreading schemes for two classes of biological processes, DNA replication process and T cell signaling. Through a deterministic processing time assumption, we are able to analytically characterize the accuracy and speed of the kinetic proofreading process in both cases. This simplification captures the essential features of the kinetic proofreading process, i.e., the accuracy of the process depends critically on the unbinding rates (k-1,k-1′) of the correct and incorrect substrates, exemplified by Eqs (2), (13) and (19). In all cases, k−1 and k-1′ impacts the accuracy of the process exponentially through terms like e−k−1τ and e-k-1′τ. The curves plotting accuracy versus incorrect substrate degradation rate are shown in S1 Fig and exhibit switch-like behavior. Overall, our analysis indicates that how the output of a kinetic proofreading process is used to make a decision is crucial to the performance of KPR. We have shown that in the case of DNA replication, the specificity of the process is always exponentially dependent on the processing time τ and increasing specificity comes at the cost of replication speed.

In the case of TCR signaling, the trade-off between specificity and sensitivity shown in panel A of S2 Fig can be mitigated by increasing the number of allowed failed attempts N which is proportional to the cell-cell contact time T. The overall accuracy A of the signaling process is still exponentially dependent on the processing time τ, as illustrated by Eq (13). For longer processing time τ, the higher accuracy can only be achieved at the cost of the signaling speed by exponentially increasing the cell-cell contact time T, or equivalently, the number of allowed failed attempts N to the optimal value No indicated by Eq (11). Since the DNA replication process also compares one first-passage time to another, the trade-off between speed and accuracy shares very similar characteristics with the FPT strategy in the TCR signaling process, despite their different biological contexts (see S6 Fig).

A variant of the FPT-based strategy, extracting the extreme FPT in the presence of multiple substrates (antigens), has also been proposed [10]. The main goal in [10] is to determine sensitivity and specificity of TCR recognition of foreign antigens when also exposed to a sea of self-antigens. The self-antigens in [10] are assumed to bind much more weakly to the TCR than the foreign antigens. While we are primarily interested in discrimination between correct and incorrect substrates with similar binding affinities. This is a typical situation as T cells need to identify cancer cells that present mutated self antigens on their surface. In this case, the affinity of the corresponding TCR to the self antigen is expected to be similar to the affinity to the foreign antigen. The densities of the self and foreign antigens are also expected to be similarly low.

The amount of product produced can also be used to distinguish correct and incorrect substrates. To compare the performance of product-based discrimination to that of FPT-based discrimination, we introduced a channel capacity between the input ξ ∈ {0, 1} (incorrect, correct substrate) and the output X, which can be either Xa=1ta≤T or the number of products generated P(T). We established the connection between the channel capacity and the accuracy of the discrimination problem in the high accuracy limit in Eq (8). Thus, the dependence of the first-passage-time-based discrimination on the processing time and the cell-cell contact time both exhibit a single peak associated with the optimal processing time τao and the optimal cell-cell contact time Tao, respectively, as illustrated in Figs 5 and 6. The optimal values are obtained by maximizing the channel capacity, which implicitly assumes equal prior probabilities of correct and incorrect substrates. To maximize the channel capacity, the sensitivity and specificity can be neither too high nor too low, as pushing either to the extreme will reduce the channel capacity.

By contrast, the product-counting discrimination problem has a distinct monotonic increase of the channel capacity with respect to the cell-cell contact time T and the optimal processing time τPo is independent of T. We find analytic approximations of the channel capacity by decomposing the product-based discrimination problem into a series of first-passage-time-based discrimination problems with different thresholds. This observation allows us to analytically approximate τPo by Eq (20). The higher maximum channel capacity (under fixed T) of product-based discrimination compared to FPT-based discrimination shown in Fig 6 can be understood by an extra layer of single-shot kinetic proofreading, in which the disassembly and activation of the extra layers of kinetic proofreading are both nonexponential and carry more information or “memory” of previous events.

The channel capacity of the product-based discrimination strategy in our work shows qualitatively similar behavior as the Fisher linear discriminant (FLD) used by Kirby and Zilman [11], which is defined by the ratio of squared difference between the means of the products with correct and incorrect substrates to the sum of their variances. In this case, the channel capacity is peaked at a short processing time, then decreases with increasing processing time. This observation led Kirby and Zilman to conclude that more proofreading steps decreases the specificity of the TCR signaling process. However, Kirby and Zilman also investigated an alternative metric, the ratio of false positive rate to total activation rate, where the activation is defined by the number of products exceeding a threshold, i.e., our FPT-based discrimination with a threshold Pth. In our work, the ratio of false activation to total activation decreases with increasing processing time τ, while Kirby and Zilman’s result suggested that the ratio increases with more processing steps [see their Fig 4c in [11]], which is a contradiction. Recently, Xiao and Galstyan [21] suggested a mistake in Kirby and Zilman’s computation of the false activation/total activation ratio. Correcting this mistake, Xiao and Galstyan found that the ratio of false activation to total activation decreases with increasing processing time, consistent with our results. However, a mistake in the ratio of false positive rate to total activation does not negate the FLD, which remains a useful metric for the product-based discrimination strategy. As discussed in our work, the discrepancy between the FLD and the false activation rate to total activation rate ratio arises from different strategies of discriminating between correct and incorrect substrates.

Our TCR signaling model is a simplified scenario that assumes a deterministic cell-cell contact time T and a deterministic processing time τ. However, we conducted additional simulations that relaxed the deterministic processing time assumption by explicit modeling of the irreversible phosphorylation process in Appendix A4 of S1 Text. The results show qualitatively similar behavior as the simplified model. Additionally, we fixed the mean processing time and varied the number of processing steps m to explore the effect of the number of processing steps in KPR on the channel capacity. The results suggest that larger m increases the channel capacity of the FPT-based discrimination scheme, while the channel capacity of the product-based discrimination remains effectively unchanged, as shown in S7 Fig.

A random cell-cell contact time T may also impair the performance of the T cell in distinguishing correct ligands from incorrect ones. The dynamic threshold Pth may rescue this impaired performance by allowing the T cell to effectively adjust the threshold in time. This rescue is illustrated in Fig 10. However, implementing a dynamic threshold requires the T-cell to keep track of the duration since the initial contact with the APC to adjust the threshold Pth accordingly. The duration may be tracked by another series of similar mechanical or biochemical reactions on the membrane-membrane interface that are triggered by the membrane-membrane contact, as discussed in [35]. Experimentally, the presence of such a dynamic threshold can be detected by simultaneously measuring the number of products P(T), the total contact time T until full activation, and other markers indicating whether the T-cell is activated or not.

From a historical perspective, the Hopfield strategy was originally proposed to explain the high fidelity in DNA replication [1]. The strategy is similar to the product strategy but considers only the mean value of the product (production rate) under the steady state. The ratios of the mean production rates of the incorrect product to the correct product are used to estimate the probability of making an error in the DNA replication. In other words, Hopfield implicitly used the steady-state rate to compare the first passage times of the correct and incorrect substrates. The original treatments claim that the error probability can be at most the squared ratios of the dissociation rates of the correct to incorrect substrates, in steady state with one proofreading step. In our model for DNA proofreading, we need not reference the nonequilibrium steady state since the dynamics are described entirely by first passage times. This allows us to extract arbitrarily high accuracy by increasing the processing time τ, at an expense of the replication rate.

McKeithan [6] also described the TCR recognition process as a steady-state strategy. While the ratio of the mean production rates of the incorrect product to the correct product can be used as a performance metric, in the TCR recognition setting, it is not explicitly related to an error probability. McKeithan noted that larger ratios of mean production rates are associated with lower signal strength, but did not specify how their relationship determines T cell response. This was only recently addressed by Kirby and Zilman [11] through their signal-to-noise ratio. Our work provides a comprehensive set of metrics, including mutual information and accuracy, to assess how reaction rates determine signal strength and how different discrimination strategies contribute to antigen recognition. The setting and results presented by Kirby and Zilman represent a specific case of our theory, i.e., the scenario of the product-based discrimination strategy.

The main observation that motivated our introduction of different strategies for discrimination is that TCR signaling is not an isolated process but is an integral component of a cellular reaction network. An analysis using ideas of information theory and transport could provide insight into a long-standing but often overlooked question: what type of information is transferred from the signaling process to the downstream pathways? Our work assumes that information is primarily transmitted as a binary signal that decides whether a T cell response is triggered, while Kirby and Zilman [11] assumed that the information is a continuous signal that reflects the strength of binding affinity between ligands and receptors. Further work is needed to identify the most appropriate information-theoretic framework for TCR signaling.

On a theoretical level, kinetic signaling schemes represent stochastic, biological implementations of the classical Maxwell’s demon [36], where the receptor is the demon that measures the affinity of the ligand to the receptor and sorts the ligands accordingly. The canonical Maxwell demon needs memory to measure both the position and time of a particle. In the case of a stochastic demon and the measurement of binding affinity, a memoryless exponential processing time seems to be able to provide a nonzero channel capacity to distinguish the correct and incorrect ligands. However, additional memory as provided by the nonequilibrium kinetic proofreading process (and non-exponentially distributed waiting time τ) enhances the channel capacity significantly. While previous literature has explored the idea of a Maxwell’s demon [37, 38] and energy-accuracy bounds in generalized KPR processes [39], the quantitative interplay between energy cost, memory, and information processing still lacks a suitable language and awaits future elucidation. In particular, we have not considered energy cost which may influence the preference in cells for different strategies of discriminating correct substrates from incorrect substrates.

Supporting information

S1 Text Mathematical appendices.

Appendix A1: Master equation for the stochastic KPR model. Appendix A2: Derivation of accuracy in the DNA replication scenario Appendix A3: Information transmitted by KPR and Michaelis-Menten schemes. Appendix A4: Multistep binding model.

(PDF)

S1 Fig Accuracy as a function of k-1′.

The variation in accuracy as the dissociation rate k-1′ of the incorrect product changes for both the DNA and TCR settings, with k−1 = 1. The accuracies are calculated using Eqs (2), (10) and (19) of the manuscript. The value of N in Eq (10) is determined by the optimal value given in Eq (11). We set k1=k1′=0.1, τ = 5, kp=0.01, and T = 106.

(EPS)

S2 Fig Performance characteristics of one-shot and multi-shot KPR.

(A) The receiver operating characteristic (ROC) curve for the one-shot and multishot KPR model with k−1 = 1, k-1′=2, k1=k1′=0.1. (B) The area under the curve (AUC) as a function of the number of KPR rounds N.

(EPS)

S3 Fig Dependence of the ξ-P channel capacity C and the Fisher linear discriminant ηFLD on the processing time τ for different values of T.

Both C (open squares) and ηFLD (filled circles) are evaluated via numerical simulations from 104 trajectories. We assumed k1=k1′=0.1, k-1=k-1*=1, k-1′=[k-1′]*=2, τ = 3, and kp = 1 for a fast product formation rate.

(EPS)

S4 Fig Dependence of the ξ-P channel capacity C and the Fisher linear discriminant ηFLD on the cell-cell contact time T.

Both the channel capacity (circles) and the Fisher linear discriminant (squares) are evaluated via numerical simulations from 104 trajectories. We assumed k1=k1′=0.1, k-1=k-1*=1, k-1′=[k-1′]*=2, τ = 3, and kp = 1 for a fast product formation rate. For ηFLD, when T > 103, their values are too high to be shown in the figure. We cropped the values of ηFLD to (0, 1) for better visualization.

(EPS)

S5 Fig Relationship between optimal contact and processing times.

Symbols represent results from simulations over a total time horizon of 106, while the dashed curves represent analytic approximations. (A) Dependence of optimal cell contact times TPo and Tao on processing time τ under product-based and FPT-based strategies. Since C(ξ; P) is nondecreasing with respect to T, the maximizing TPo value is given as the upper limit of the simulation period. The approximation for Tao, T^ao=No/K1, is given by Eq (11). (B) Dependence of optimal processing times τPo and τao on cell contact time T. The analytic approximation τ^Po is given by Eq (20). The parameters used are the same as those in Fig 6.

(EPS)

S6 Fig Mean total system lifetime as a function of inaccuracy P(tp≥tp′).

The total duration (MFPT to any absorbing state) of the DNA replication process as a function of inaccuracy is evaluated using Eq (3) and is shown by the blue circles. The optimal contact duration To in the TCR recognition scenario as a function of inaccuracy 1-Ao (red squares) is evaluated using Eq (12) and the definition N = k1T. Here k1=k1′=0.1, k−1 = 1, and k-1′=2.

(EPS)

S7 Fig Dependence of the channel capacity between input ξ and different outputs on the number of proofreading steps m.

Channel capacities are obtained from numerical simulations of the multistep binding model with 105 trajectories for each set of parameters. We assumed k1=k1′=0.1, k-1=k-1*=1, k-1′=[k-1′]*=2, τ = 3, and kp = 1. T is fixed at 1000. Dashed lines represent the channel capacities in the deterministic processing time (m → ∞) limit.

(EPS)

The authors thank X. Guo for helpful comments on the manuscript and Anton Zilman for insightful discussions which inspired this work.
==== Refs
References

1 Hopfield JJ . Kinetic Proofreading: A New Mechanism for Reducing Errors in Biosynthetic Processes Requiring High Specificity. Proceedings of the National Academy of Sciences. 1974;71 (10 ):4135–4139. doi: 10.1073/pnas.71.10.4135 4530290
2 Kimura M , Ohta T . On Some Principles Governing Molecular Evolution. Proceedings of the National Academy of Sciences. 1974;71 (7 ):2848–2852. doi: 10.1073/pnas.71.7.2848 4527913
3 Petruska J , Goodman MF , Boosalis MS , Sowers LC , Cheong C , Tinoco I . Comparison between DNA melting thermodynamics and DNA polymerase fidelity. Proceedings of the National Academy of Sciences. 1988;85 (17 ):6252–6256. doi: 10.1073/pnas.85.17.6252 3413095
4 Davis L , Tarduno A , Lu YC . Neoantigen-Reactive T Cells: The Driving Force behind Successful Melanoma Immunotherapy. Cancers. 2021;13 (23 ):6061. doi: 10.3390/cancers13236061 34885172
5 Ninio J . Kinetic amplification of enzyme discrimination. Biochimie. 1975;57 (5 ):587–595. doi: 10.1016/S0300-9084(75)80139-8 1182215
6 McKeithan TW . Kinetic proofreading in T-cell receptor signal transduction. Proceedings of the National Academy of Sciences. 1995;92 (11 ):5042–5046. doi: 10.1073/pnas.92.11.5042 7761445
7 Murugan A , Huse DA , Leibler S . Speed, dissipation, and error in kinetic proofreading. Proceedings of the National Academy of Sciences. 2012;109 (30 ):12034–12039. doi: 10.1073/pnas.1119911109 22786930
8 Lipniacki T , Hat B , Faeder JR , Hlavacek WS . Stochastic effects and bistability in T cell receptor signaling. Journal of Theoretical Biology. 2008;254 (1 ):110–122. doi: 10.1016/j.jtbi.2008.05.001 18556025
9 Bel G , Munsky B , Nemenman I . The simplicity of completion time distributions for common complex biochemical processes. Physical Biology. 2009;7 (1 ):016003. doi: 10.1088/1478-3975/7/1/016003 20026876
10 Morgan J , Lindsay AE . Modulation of antigen discrimination by duration of immune contacts in a kinetic proofreading model of T cell activation with extreme statistics. PLOS Computational Biology. 2023;19 (8 ):e1011216. doi: 10.1371/journal.pcbi.1011216 37647345
11 Kirby D , Zilman A . Proofreading does not result in more reliable ligand discrimination in receptor signaling due to its inherent stochasticity. Proceedings of the National Academy of Sciences. 2023;120 (21 ):e2212795120. doi: 10.1073/pnas.2212795120
12 Altan-Bonnet G , Germain RN . Modeling T Cell Antigen Discrimination Based on Feedback Control of Digital ERK Responses. PLoS Biology. 2005;3 (11 ):e356. doi: 10.1371/journal.pbio.0030356 16231973
13 Lalanne JB , François P . Principles of Adaptive Sorting Revealed by in Silico Evolution. Physical Review Letters. 2013;110 (21 ):218102. doi: 10.1103/PhysRevLett.110.218102 23745939
14 Tischer DK , Weiner OD . Light-based tuning of ligand half-life supports kinetic proofreading model of T cell signaling. eLife. 2019;8 :e42498. doi: 10.7554/eLife.42498 30947808
15 Pettmann J , Huhn A , Shah EA , Kutuzov MA , Wilson DB , Dustin ML , et al . The discriminatory power of the T cell receptor. eLife. 2021;10 :e67092. doi: 10.7554/eLife.67092 34030769
16 Voisinne G , Locard-Paulet M , Froment C , Maturin E , Menoita MG , Girard L , et al . Kinetic proofreading through the multi-step activation of the ZAP70 kinase underlies early T cell ligand discrimination. Nature Immunology. 2022;23 (9 ):1355–1364. doi: 10.1038/s41590-022-01288-x 36045187
17 Fernandes RA , Ganzinger KA , Tzou JC , Jönsson P , Lee SF , Palayret M , et al . A cell topography-based mechanism for ligand discrimination by the T cell receptor. Proceedings of the National Academy of Sciences. 2019;116 (28 ):14002–14010. doi: 10.1073/pnas.1817255116 31221762
18 Johansson M , Zhang J , Ehrenberg M . Genetic code translation displays a linear trade-off between efficiency and accuracy of tRNA selection. Proceedings of the National Academy of Sciences. 2011;109 (1 ):131–136. doi: 10.1073/pnas.1116480109 22190491
19 Savir Y , Tlusty T . The Ribosome as an Optimal Decoder: A Lesson in Molecular Recognition. Cell. 2013;153 (2 ):471–479. doi: 10.1016/j.cell.2013.03.032 23582332
20 Banerjee K , Kolomeisky AB , Igoshin OA . Elucidating interplay of speed and accuracy in biological error correction. Proceedings of the National Academy of Sciences. 2017;114 (20 ):5183–5188. doi: 10.1073/pnas.1614838114 28465435
21 Xiao F , Galstyan V . With the leisure of time, kinetic proofreading does reliable ligand discrimination after all. bioRxiv. 2024. doi: 10.1101/2024.01.11.575129
22 Cheong R , Rhee A , Wang CJ , Nemenman I , Levchenko A . Information Transduction Capacity of Noisy Biochemical Signaling Networks. Science. 2011;334 (6054 ):354–358. doi: 10.1126/science.1204553 21921160
23 Selimkhanov J , Taylor B , Yao J , Pilko A , Albeck J , Hoffmann A , et al . Accurate information transmission through dynamic biochemical signaling networks. Science. 2014;346 (6215 ):1370–1373. doi: 10.1126/science.1254933 25504722
24 Tang Y , Adelaja A , Ye FXF , Deeds E , Wollman R , Hoffmann A . Quantifying information accumulation encoded in the dynamics of biochemical signaling. Nature Communications. 2021;12 (1 ):1272. doi: 10.1038/s41467-021-21562-0 33627672
25 Liu B , Chen W , Evavold BD , Zhu C . Accumulation of Dynamic Catch Bonds between TCR and Agonist Peptide-MHC Triggers T Cell Signaling. Cell. 2014;157 (2 ):357–368. doi: 10.1016/j.cell.2014.02.053 24725404
26 Sibener LV , Fernandes RA , Kolawole EM , Carbone CB , Liu F , McAffee D , et al . Isolation of a Structural Mechanism for Uncoupling T Cell Receptor Signaling from Peptide-MHC Binding. Cell. 2018;174 (3 ):672–687.e27. doi: 10.1016/j.cell.2018.06.017 30053426
27 Galstyan V , Husain K , Xiao F , Murugan A , Phillips R . Proofreading through spatial gradients. eLife. 2020;9 :e60415. doi: 10.7554/eLife.60415 33357378
28 Suhov YM , Kelbert M . Probability and Statistics by Example: Volume 2, Markov Chains: A Primer in Random Processes and Their Applications. Probability and Statistics by Example. Cambridge University Press; 2008.
29 Cover TM . Elements of information theory. 2nd ed. John Wiley & Sons; 1999.
30 Gillespie DT . Exact stochastic simulation of coupled chemical reactions. The Journal of Physical Chemistry. 1977;81 (25 ):2340–2361. doi: 10.1021/j100540a008
31 Bezanson J , Edelman A , Karpinski S , Shah VB . Julia: A fresh approach to numerical computing. SIAM Review. 2017;59 (1 ):65–98. doi: 10.1137/141000671
32 Miller MJ , Hejazi AS , Wei SH , Cahalan MD , Parker I . T cell repertoire scanning is promoted by dynamic dendritic cell behavior and random T cell motility in the lymph node. Proceedings of the National Academy of Sciences. 2004;101 (4 ):998–1003. doi: 10.1073/pnas.0306407101 14722354
33 Bousso P , Robey E . Dynamics of CD8+ T cell priming by dendritic cells in intact lymph nodes. Nature Immunology. 2003;4 (6 ):579–585. doi: 10.1038/ni928 12730692
34 Henrickson SE , Mempel TR , Mazo IB , Liu B , Artyomov MN , Zheng H , et al . T cell sensing of antigen dose governs interactive behavior with dendritic cells and sets a threshold for T cell activation. Nature Immunology. 2008;9 (3 ):282–291. doi: 10.1038/ni1559 18204450
35 Fu H , Xiao F , Jun S . Bacterial Replication Initiation as Precision Control by Protein Counting. PRX Life. 2023;1 (1 ):013011. doi: 10.1103/prxlife.1.013011 38550259
36 Rex A , Leff HS . Maxwell’s demon 2: entropy, classical and quantum information, computing. Taylor & Francis; 2003.
37 Manzano G , Subero D , Maillet O , Fazio R , Pekola JP , Roldán E . Thermodynamics of Gambling Demons. Physical Review Letters. 2021;126 (8 ):080603. doi: 10.1103/PhysRevLett.126.080603 33709732
38 Cao FJ , Feito M . Thermodynamics of feedback controlled systems. Physical Review E. 2009;79 (4 ). doi: 10.1103/PhysRevE.79.041118 19518184
39 Yu Q , Kolomeisky AB , Igoshin OA . The energy cost and optimal design of networks for biological discrimination. Journal of The Royal Society Interface. 2022;19 (188 ). doi: 10.1098/rsif.2021.0883 35259959
