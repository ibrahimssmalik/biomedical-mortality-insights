
==== Front
Sensors (Basel)
Sensors (Basel)
sensors
Sensors (Basel, Switzerland)
1424-8220
MDPI

10.3390/s24113698
sensors-24-03698
Article
Self-Calibration for Star Sensors
https://orcid.org/0000-0001-6374-1373
Fu Jingneng 1234*
Lin Ling 123
Li Qiang 123
Zhu Xin Academic Editor
Ma Zhenhe Academic Editor
1 Institute of Optics and Electronics, Chinese Academy of Sciences, Chengdu 610042, China; linling_yj@163.com (L.L.); liqiang@ioe.ac.cn (Q.L.)
2 Key Laboratory of Science and Technology on Space Optoelectronic Precision Measurement, Chinese Academy of Sciences, Chengdu 610042, China
3 University of Chinese Academy of Sciences, Beijing 100049, China
4 Youth Innovation Promotion Association, Chinese Academy of Sciences, Beijing 100049, China
* Correspondence: fujingneng@ioe.ac.cn
06 6 2024
6 2024
24 11 369810 4 2024
31 5 2024
03 6 2024
© 2024 by the authors.
2024
https://creativecommons.org/licenses/by/4.0/ Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https://creativecommons.org/licenses/by/4.0/).
Aiming to address the chicken-and-egg problem in star identification and the intrinsic parameter determination processes of on-orbit star sensors, this study proposes an on-orbit self-calibration method for star sensors that does not depend on star identification. First, the self-calibration equations of a star sensor are derived based on the invariance of the interstar angle of a star pair between image frames, without any requirements for the true value of the interstar angle of the star pair. Then, a constant constraint of the optical path from the star spot to the center of the star sensor optical system is defined to reduce the biased estimation in self-calibration. Finally, a scaled nonlinear least square method is developed to solve the self-calibration equations, thus accelerating iteration convergence. Our simulation and analysis results show that the bias of the focal length estimation in on-orbit self-calibration with a constraint is two orders of magnitude smaller than that in on-orbit self-calibration without a constraint. In addition, it is shown that convergence can be achieved in 10 iterations when the scaled nonlinear least square method is used to solve the self-calibration equations. The calibrated intrinsic parameters obtained by the proposed method can be directly used in traditional star map identification methods.

star sensor
camera calibration
self-calibration
on-orbit calibration
interstar angle invariance
constant optical path constraint
Youth Innovation Promotion Association of Chinese Academy of Sciences2022381 This research was funded by the Youth Innovation Promotion Association of Chinese Academy of Sciences (Grant No. 2022381).
==== Body
pmc1. Introduction

A star sensor represents an important component of high-precision satellite attitude calculations and control systems. To determine an attitude value through star identification, it is necessary to calibrate each star sensor in a laboratory first. However, the harsh launching process of spacecraft and the complex physical environment in space will inevitably affect a calibrated star sensor and make it deviate from its laboratory-calibrated state. When the intrinsic parameters of a star sensor deviate obviously from its laboratory-calibrated values, it is necessary to perform on-orbit calibration to prevent a decrease in the attitude measurement accuracy of the star sensor. Therefore, on-orbit calibration is very important for high-precision star sensors.

At present, the on-orbit calibration methods for star sensors can be roughly divided into two types: attitude-independent methods and attitude-dependent methods [1,2]. Attitude-dependent on-orbit calibration methods require prior information on a star sensor’s attitude, which is typically obtained by gyros [1] or landmarks [3]. However, the coupling of the extrinsic and intrinsic parameters of a star sensor inevitably causes these parameters to affect each other. In contrast, attitude-independent on-orbit calibration methods only make use of the invariance of the interstar angle of a star pair between the object space and the image space of a star sensor and thus do not require information on the star sensor’s attitude. This approach avoids the coupling between the extrinsic and intrinsic parameters of a star sensor. Accordingly, most studies on the on-orbit calibration algorithms of star sensors have focused on attitude-independent methods. These attitude-independent methods can be further divided into batch processing algorithms [4,5] and sequential processing algorithms [6,7] according to the characteristics of the data used for processing. Batch processing algorithms extract the star spot information from multiple image frames at the same time and, therefore, require a relatively large database to store the image plane coordinates of multiple frames and celestial coordinate information. However, these algorithms are unlikely to overfit their parameters due to the comprehensiveness of the information used in the calculation process. Sequential processing algorithms employ the Kalman filter and use one frame of data at once to update the star sensors’ intrinsic parameters and, thus, have a low requirement for data storage but are very sensitive to the setting of filter parameters and tend to overfit the current star pattern. The implementation of attitude-independent calibration methods is based on the premise that the relationship between star spots and guide stars has been established, that is, star identification is completed before the intrinsic parameters of the star sensor are determined; these methods are also called dimensionless (or non-calibration) star map identification algorithms [8,9]. Unlike traditional star map identification algorithms, where the minimum identifiable star map is a star pair [10], dimensionless star map identification algorithms take a star triangle as the minimum identifiable star map. A disadvantage of these algorithms is the requirement for a large database and complex data retrieval algorithm. For instance, the spherical triangle star map identification algorithm proposed in [9] requires a database of nearly 100 MB, as well as a high-dimensional k-vector retrieval algorithm [11].

Since a star sensor is a special type of camera, theoretically, the calibration methods for common cameras can be used for star sensor calibration. Camera calibration methods can be roughly divided into two types: traditional calibration methods [12] and self-calibration methods [13,14,15,16,17,18]. Traditional calibration methods rely on the high geometric precision of one-, two-, or three-dimensional objects to establish object–image equations and then solve the intrinsic parameters of the camera. These methods include the traditional on-orbit calibration method of star sensors. Self-calibration methods only make use of the corresponding relationship between multiple images, namely, they rely only on the information in an image space. When a camera self-calibration method is applied to the on-orbit calibration of the intrinsic parameters of a star sensor, the chicken-and-egg problem of star identification and intrinsic parameter determination can be avoided, which means that star sensor calibration can be accomplished before the star identification process. However, due to the irregular and uncorrelated distribution of vanishing points (i.e., star spots formed by parallel starlight) on the focal plane, regardless of whether a camera self-calibration method is based on the Kruppa equation [13,14], dual absolute quadric surface [15], a hierarchical step-by-step method [16,17], or Pollefeys’ modulus constraint [18], it cannot be directly used for the on-orbit calibration of star sensors.

To address the chicken-and-egg problem in the star identification and intrinsic parameter determination processes of on-orbit star sensors, this study proposes a self-calibration method that differs from previously proposed methods for star sensors. First, the intrinsic parameter equations of a star sensor are derived based on the invariance of the interstar angle of a star pair between image frames. Then, the constant constraint of an optical path from the star spot to the center of the star sensor optical system is defined to reduce the biased estimation in self-calibration. Finally, a scaled nonlinear least square method is developed to solve the derived equations to accelerate iteration convergence. Our simulation and analysis results show that convergence can be achieved in 10 iterations when the scaled nonlinear least square method is used to solve the self-calibration equations.

The remainder of this paper is organized as follows. Section 2 presents the classical model of star sensor on-orbit calibration based on the pinhole imaging model. Section 3 introduces an on-orbit self-calibration model with an optical path constraint. Section 4 describes the process of solving on-orbit self-calibration equations using the scaled nonlinear least square method. Section 5 describes the simulation and experimental results. Finally, Section 6 concludes this study.

2. The Classical On-Orbit Calibration Model

This study simplifies the calibration of the intrinsic parameters of a star sensor. If the pinhole presented in Figure 1 is used as an imaging model of a star sensor, its intrinsic parameters include only the principal point and focal length, and the calibration of the principal point is equivalent to compensation of zero-order distortion [19]. For the compensation of higher-order distortion, please refer to the research presented in [4,20].

Assume that the right ascension and declination of the ith (1≤i≤N) star extracted from the observed image are (αi,δi), respectively; then, its unit direction in the celestial sphere coordinate system is expressed as follows:(1) vi=(cosαicosδi,sinαicosδi,sinδi)T.

The image coordinates of the star in the corresponding star sensor coordinate system are (xi,yi), and the unit direction of the star in the star sensor coordinate system, under the assumption of ideal pinhole imaging, is defined by (2) wi=1(xi−xo)2+(yi−yo)2+f2[−(xi−xo)−(yi−yo)f].

Generally, the calibration methods for the intrinsic parameters of star sensors include two calibration algorithms: an algorithm relying on the information of a star sensor’s attitude and an algorithm not relying on this information, as shown in Figure 2a. These two algorithms are defined as follows:(3) MISwi−vi=0,  1≤i≤N,

and (4) wiTwj−viTvj=0,  1≤i<j≤N,

where MIS is the attitude matrix of a star sensor.

Being independent of the attitude information of a star sensor means that the problem of coupling between the extrinsic and intrinsic parameters is avoided. For this reason, most studies on the on-orbit calibration algorithms of star sensors have focused on attitude-independent methods.

3. On-Orbit Self-Calibration Model

When a star sensor rotates, it tracks all the star spots (i.e., a total of NS star spots) in an image sequence with a length of NF and denotes the stars as 1,2,…,NS. Considering the invariance of the interstar angle of a star pair (i,j)(1≤i<j≤NS) in different image frames (m,n)(1≤m<n≤NF), the interstar angle of the ith and jth star spots in the star sensor coordinate system extracted from the image frame m equals the interstar angle of the ith and jth star spots in the star sensor coordinate system extracted from the image frame n; thus, the following equation can be derived (see Figure 2b):(5) wmiTwmj−wniTwnj=0, 1≤m<n≤NF, 1≤i<j≤NS.

According to the pinhole imaging model, the unit direction of a star in a star sensor coordinate system is given by (6) wmi=1(xmi−xo)2+(ymi−yo)2+f2[−(xmi−xo)−(ymi−yo)f],

where (xmi,ymi) are the image coordinates of the ith star spot extracted from the mth image frame.

The motion of a star spot on the image plane can be decomposed into its rotation around the optical axis (refer to Figure 3a) and its radial motion (refer to Figure 3b) [21]. If star spots rotate only around the optical axis of the image plane, Equation (5) can be simplified to (7) xo(xmi+xmj−xni−xnj)+yo(ymi+ymj−yni−ynj)=xmixmj+ymiymj−xnixnj−yniynj.

Equation (7) is a linear equation of the principal point, which does not include the focal length. However, this equation is valid regardless of the focal length’s value. Therefore, the angular velocity of the radial motion of star spots on the image plane cannot be zero if the aim is to estimate their focal length.

Assume that the star spot extraction error obeys the Gaussian distribution of δxmi,δymi~N(0,σS22); then, when the star spot extraction error satisfies the condition of σS>0, the focal length estimation is larger than the true value of the focal length, regardless of whether the traditional on-orbit calibration model of Equation (4) or the on-orbit self-calibration model of Equation (5) is adopted. Further, considering the on-orbit self-calibration model of Equation (5), the following bias and variance tradeoff analysis can be made. When the focal length deviates from its true value, the direct contribution of the focal length bias to the total error of (wmiTwmj−wniTwnj) increases. The direction error σSf, converted from the star spot extraction error of σS>0, decreases with the focal length, which decreases the indirect contribution of the random error of star spot extraction to the total error of (wmiTwmj−wniTwnj); this decrease exhibits a downward trend. When the total error of (wmiTwmj−wniTwnj) reaches its minimum value, the corresponding estimated focal length is larger than the true focal length. A similar analysis could be made for the traditional on-orbit calibration model of Equation (4). However, since the on-orbit self-calibration model of Equation (5) is not constrained by the true value of the interstar angle of a star pair, it has a larger bias in its focal length estimation compared to the traditional on-orbit calibration model of Equation (4).

To reduce the bias of the focal length estimation, it is necessary to define a focal length constraint. The simplest constraint is to assume that the focal length is a constant, but this is not conducive to solving Equations (4) and (5), so it is necessary to define a higher-order constraint on the focal length. Simulations have shown that when the optical path rmi=(xmi−xo)2+(ymi−yo)2+f2 between the star spot on the image plane and the lens center of an optical system is a constant Cmi, the problem of the biased estimation in Equations (4) and (5) can be mitigated by establishing a mutual constraint between the coordinates of the star spot and the focal length.

The final form of the proposed on-orbit self-calibration model, independent of star identification, is defined as follows:(8) wmiTwmj−wniTwnj=0,  1≤m<n≤NF,  1≤i<j≤NS,

(9) s.t. rmi=Cmi,  1≤m≤NF,  1≤i≤NS.

4. Solving Self-Calibration Equations

After defining the optical path constraint rmi=Cmi, the derivative of wmi, with respect to the intrinsic parameters, becomes more concise. However, the convergence speed of the nonlinear least square method [22] is slow, and the solution process requires numerous iterations. In view of that, this study introduces the convergence scale parameter λ to increase the convergence speed.

Denote the intrinsic parameter vector of a star sensor as X=(xo,yo,f)T and solve Equations (8) and (9) iteratively using the scaled nonlinear least square method. Then, it holds that (10) X(t+1)=X(t)+λ(ATA)−1ATB

where t is the iteration number; λ is the convergence scale parameter, and λ>1; and the Jacobi matrix A and vector B are, respectively, defined as follows:(11) A=∂(w11Tw12−w21Tw22,…,wK−1,NF−1TwK−1,NF−wK,NF−1TwK,NF)T∂X|X=X(t),

and (12) B=(w11Tw12−w21Tw22,…,wK−1,NF−1TwK−1,NF−wK,NF−1TwK,NF)T|X=X(t).

Under the optical path constraint of rmi=Cmi, the derivative of wmi, with respect to the intrinsic parameter vector X, is expressed by (13) {∂wmi∂xo=(1,0,0)Trmi∂wmi∂yo=(0,1,0)Trmi∂wmi∂f=(0,0,1)Trmi.

According to Equation (13) and rmi=Cmi, wmi represents a linear function of the intrinsic parameters. However, it is a very interesting phenomenon that Cmi, which is not present explicitly in the equation to be solved, can indirectly change the convergence process and results of the self-calibration solution algorithm.

5. Simulation and Analysis Results

The proposed algorithm and several comparison algorithms were used in a simulation experiment conducted on a computer with two Intel Xeon Gold 5218R CPUs @2.1 GHz (with 40 cores in total) and 32 GB of memory. To improve the efficiency of the simulations, Matlab/C mixed programming was used for the test, and the parallel computing toolbox of Matlab was used for multi-core operations (two programs were opened at the same time, each program called for 16 cores). Compared to the scenario of using a single-core CPU and pure Matlab programming, the time needed to accomplish the simulation experiment was shortened by two orders of magnitude. The entire simulation experiment required the computer to run the test programs continuously for 17 days.

The basic parameters of the star sensor used in the simulation experiment, originating from a real star sensor, were as follows: field of view (FOV): Φ=20°; pixel array: 1536 × 1536; position (xo,yo) of the theoretical principal point of the optical system: (768, 768); pixel size: 5.5 um × 5.5 um; focal length f: 24.4455 mm.

The star spots in the zeroth image frame NS were randomly distributed in a cone with a diameter of 10°. The first NF frames of the star sensor images were obtained by randomly rotating the star sensor, and NS star spots in each image frame were guaranteed to be present in the field of view of the star sensor.

The following four models were tested and compared in the simulation experiments:A traditional calibration method without constraint (TCOC), as shown in Equation (4);

Traditional calibration methods with constraint (TCWC), as shown in Equations (4) and (9);

A self-calibration method without constraint (SCOC), as shown in Equation (8);

A self-calibration method with constraint (SCWC), as shown in Equations (8) and (9).

In the simulation experiments, different combinations of the values of the star spot extraction error σS, the number of image frames involved in the image frame number NF, and the number of star spots per image NS were used. Particularly, star sensors used the centroid to determine the coordinates of the star spots on the focal plane, and the star point extraction error was generally σS=0.01 pixel−0.50 pixel [23]. A star sensor with an FOV value of Φ = 20° operated normally at 5.5 Mv; the average and maximum star numbers were 25 and 80 in the FOV, respectively. Meanwhile, the average star number NS in a cone with a diameter of 10° was eight, which is too small for self-calibration, so it was necessary to increase the detection magnitude by increasing the exposure time or the gain in the self-calibration mode of the star sensor. When the detection magnitude increased by 1.0 Mv, the average and maximum star numbers in a cone with a diameter of 10° were 20 and 77, respectively. Based on the above analysis, the number of stars in each image of NS was set to a value in the range of 20–100. Furthermore, the labels of the stars (i,j)(1≤i<j≤NS) and the labels of the frames (m,n)(1≤m<n≤NF) obeyed the law of exchange in Equations (8) and (9); thus, the image frame number NF and the star spot number NS contributed equally to the performance of the self-calibration. Therefore, the image frame number NF should be set similarly to the star spot number NS in the simulation experiment. After careful consideration, the number of image frames involved in the calculation was set to NF=10–100. Finally, NC=100,000 rounds of repeated simulations were conducted for each combination of parameters (σS,NS,NF).

Considering the estimation results of the intrinsic parameters in the kth simulation (x^o,k,y^o,k,f^k) and their true values (xo,yo,f), the bias evaluation parameters of the intrinsic parameters were defined as follows:(14) {xo,bias=1NC∑kx^o,k−xoyo,bias=1NC∑ky^o,k−yofbias=1NC∑kf^k−f ,

and the total error evaluation parameters of the intrinsic parameters were defined by (15) {xo,error=1NC−1∑k(x^o,k−xo)2yo,error=1NC−1∑k(y^o,k−yo)2ferror=1NC−1∑k(f^k−f)2 .

In Equation (15), the total error of the intrinsic parameters includes bias and random errors.

First, the convergence processes of different on-orbit calibration algorithms were analyzed using different values of the parameter λ, and the other parameters were set as follows: the number of image frames involved in the calculation was set to NF=100, the star spot extraction error was set to σS=0.10 pixel, and the number of star spots was set to NS=20.

The initial values of the intrinsic parameters of the star sensor were set as follows: the position of the principal point of the optical system was the (1000, 1000) pixel, the focal length was 20 mm due to the a priori focus estimated from the ground laboratory calibration, and the general prior accuracy of the focus was higher than 10%.

The convergence results of the intrinsic parameters were obtained by setting different iteration numbers and values for the scale parameter λ, as shown in Figure 4. After the optical path constraint was introduced (refer to Equation (9)), the convergence speed of the nonlinear least square method decreased, and the solution process required more iterations. When all four algorithms used the default value of λ (which was one), the SCOC and TCOC required five iterations to achieve convergence, whereas the SCWC and TCWC required approximately 1000 iterations. As the Jacobi matrix of wmi rather than the scale parameter λ determined the final convergence result of the nonlinear least square method, as long as the iteration process of the four methods did not diverge, the final convergence result was independent of the λ value. In addition, the number of iterations required by the SCWC and TCWC to achieve convergence gradually decreased with the increase in the λ value. Under the condition of convergence without oscillation, the number of iterations required for convergence was inversely proportional to the value of λ. However, when the λ value was too large (e.g., λ=300), the convergence speed could not be accelerated further, and fluctuation and even divergence could occur. If the λ value was further increased (e.g., λ=500), iteration divergence could be observed in almost every simulation. In this study, the value range of λ was 100–200, which was appropriate for the SCWC and TCWC, allowing the SCWC and TCWC algorithms to converge in 5–10 iterations. For the convenience of comparing the four algorithms, in the following simulation experiments, the scale parameter was set to λ=200 and the maximum number of iterations was set to 10.

The calculation results shown in Figure 5 and Figure 6 were obtained with the following settings: the number of image frames used in the calculation was NF=100, the star spot extraction error was σS=0.01 pixel–0.50 pixel, and the number of star spots was NS=20–100. Finally, to determine the influence of the number of image frames on intrinsic parameter estimation errors, the calculation results were obtained under the typical settings of a star spot extraction error of σS=0.10 pixel, a number of image frames of NF=10–100, and a number of star spots of NS=20–100, as shown in Figure 7 and Figure 8.

The results of the simulation experiments showed that there was no bias in the estimation results of the principal point (xo,yo) obtained by the four methods. However, there were biases in the estimation results of the focal length calculated by the four methods. Compared to the calibration methods with constraint, the calibration methods without constraint could significantly reduce the bias of the focal length estimation results. In particular, the self-calibration methods could reduce the focal length bias by two orders of magnitude. In the simulation experiment conducted under the settings of a star spot extraction error of σS=0.50 pixel, a number of image frames of NF=100, and a number of star spots of NS=20 (refer to Figure 5), the SCOC obtained fbias>500 μm, the SCWC achieved fbias=−8.6 μm, the TCOC had fbias=0.07 μm, and the TCWC yielded fbias=0.04 μm. As for the self-calibration methods, when the star spot extraction error of σS≥0.20 pixel was not subjected to constraint, the estimated values of the intrinsic parameters did not converge. For instance, at σS=0.5 pixel, the bias of the focal length value calculated by the SCOC was larger than 500 μm. Even when the star spot extraction error decreased to σS=0.2 pixel, the bias fbias of the focal length value calculated by the SCOC was still larger than 400 μm, and the total focal length error ferror was close to 500 μm, as shown in Figure 6; this indicated that the bias of the calculated focal length accounted for more than 80% of the total focal length error. In comparison, when the star spot extraction error was σS=0.2 pixel, the bias of the focal length value calculated by the SCWC was fbias=−1.2 μm, and the total focal length error was ferror=55 μm; this indicated that the bias of the calculated focal length accounted for less than 3% of the total focal length error. Therefore, it could be concluded that it is necessary to add a constraint to the estimation process of the intrinsic parameters of a star sensor conducted by a self-calibration method (refer to Equation (9)).

Compared with the self-calibration methods that use only information in an image space, traditional calibration methods, due to the availability of the coordinate information of the stars on the celestial sphere, can use the information in both the object space and image space and, thus, can achieve higher estimation accuracy (two to three orders of magnitude higher) for the focal length of the star sensor. However, the two types of calibration methods show no significant difference in their estimation of the principal point. In the simulation experiment conducted under the settings of a star spot extraction error of σS=0.10 pixel, a number of image frames of NF=100, and a number of star spots of NS=20 (refer to Figure 8), the SCOC obtained ferror=103 μm, x0,error=y0,error=0.37 pixel; the SCWC achieved ferror=28 μm, x0,error=y0,error=0.37 pixel; the TCOC had ferror=0.15 μm, x0,error=y0,error=0.37 pixel; and, finally, the TCWC yielded ferror=0.15 μm, x0,error=y0,error=0.37 pixel. A comparison of the results presented in Figure 7 and Figure 8 reveals that, among the intrinsic parameter estimation errors of the traditional calibration methods, the bias was about two orders of magnitude smaller than the random error. Since the bias was not the main part of the intrinsic parameter estimation error, it could be ignored. Therefore, the bias of intrinsic parameter estimation is not an issue to be considered in research on traditional on-orbit calibration methods.

For traditional on-orbit calibration methods, it is natural to extend the pinhole imaging model of a star sensor to a high-order distortion model [4,20], but this is not the case for self-calibration methods. Since the estimation accuracy of the intrinsic parameters obtained by self-calibration methods is far lower than that of traditional on-orbit calibration methods, it is a great challenge for self-calibration methods to extend the pinhole imaging model of a star sensor to a high-order distortion model. Therefore, improving the accuracy of self-calibration algorithms and extending the pinhole imaging model to a high-order distortion model are still challenges that should be addressed in future research.

A further algorithm complexity analysis showed that, due to the use of interframe information in self-calibration, the number of measurement equation sets was O(NF2NS2), which was much higher than the number for traditional calibration, O(NFNS2). When the calibration was deployed on the hardware of a satellite, the limitations of storage, reliability, and power consumption posed additional challenges to the operation of the self-calibration algorithm.

Compared to existing calibration methods, the proposed self-calibration demonstrated no advantages in terms of estimation accuracy and algorithm complexity. Thus, there arises a question of whether research on this type of algorithm is still meaningful. The answer is yes because, in traditional on-orbit calibration based on star coordinates in the celestial sphere (i.e., star identification), when star identification cannot be performed before the intrinsic parameter determination of a star sensor, the only choice is to determine intrinsic parameters based on image-space information (i.e., self-calibration) before star identification.

The primary factor to consider in star map identification for the pinhole imaging model is the focal length or the nominal pixel scale in the sky. In our experiments, when the parameters were set to their typical values (i.e., the typical star spot extraction error was σS=0.10 pixel, the number of image frames was NF=100, and the number of star spots was NS=20), the SCWC achieved ferror=28 μm, its relative error was 0.11%, and its direction error corresponding to the edge of the field of view was approximately 40″. For a typical star sensor with a sensitive magnitude error of less than 0.5 Mv, the full-sky star identification probability of the traditional star map identification algorithm [10] was still better than 98%. Thus, for a star sensor with typical parameters, the intrinsic parameters determined by on-orbit calibration could be directly used in a traditional star map identification algorithm. After star map identification, the traditional on-orbit calibration method for star sensors could be used to improve the intrinsic parameter estimation accuracy of star sensors further for high-precision attitude determination.

Furthermore, the extraction error of star spots is an important factor affecting the estimation accuracy of self-calibration algorithms. Star sensors use the centroid of star spots as their image coordinates, making it challenging to achieve a positional accuracy of 0.01 pixel. For instance, AST-301 [24] has a centroid extraction error of 0.02 pixels, which is a representative of extremely high-precision star sensors. In recent years, there have been certain developments, such as interferometric imaging [25] and point spread function (PSF) reconstruction [26], where pixel subdivision accuracy exceeds 0.001 pixels. Finally, the intrinsic parameters determined by on-orbit calibration with high-accuracy pixel subdivision can be directly used in the high-precision attitude determination of star sensors.

6. Conclusions

This paper proposes an on-orbit self-calibration method for star sensors with the aim of addressing the chicken-and-egg problem of the star identification and intrinsic parameter determination of star sensors during their on-orbit operation. Unlike traditional on-orbit calibration methods, which perform dimensionless star map identification before determining intrinsic parameters, the proposed method does not require star identification. First, a set of equations for the intrinsic parameters of a star sensor are established based on the invariance of the interstar angle of a star pair between image frames; these equations do not require the true value of the interstar angle of the star pair. Then, the constant constraint of the optical path from the star spot to the center of the star sensor optical system is defined to reduce the biased estimation in self-calibration. Finally, a scaled nonlinear least square method is developed to solve the self-calibration equations to accelerate iteration convergence. The simulation and analysis results show that the bias of the focal length estimation in on-orbit self-calibration with constraint is two orders of magnitude smaller than that in on-orbit self-calibration without constraint. In addition, convergence can be achieved in 10 iterations when the scaled nonlinear least square method is used to solve the self-calibration equations. Further, on-orbit calibration can be accomplished using a star sensor directly, without prior star identification, which addresses certain problems in the dimensionless star map identification method, such as high computational complexity and the need for a large database.

In this study, the key points of distant static objects in multiple image frames are obtained by rotating a camera, which can be approximated as the continuous imaging of stars using a star sensor. Theoretically, the proposed calibration model and numerical solution method can be used to calibrate common cameras by observing distant static objects with unknown geometric dimensions. Also, the accuracy of self-calibration algorithms is much lower than that of traditional camera calibration methods, so it is of great importance to improve the accuracy of self-calibration algorithms. Therefore, in the future, self-calibration methods could be further analyzed while paying special attention to the above two issues.

Acknowledgments

The authors would like to thank their colleagues working with them in the Institute of Optics and Electronics at the Chinese Academy of Sciences. The authors also would like to thank the anonymous reviewers of this article for their very constructive comments and suggestions.

Author Contributions

The authors’ contributions are as follows: J.F. proposed the idea, programmed the method, and wrote the manuscript. L.L. provided part of code for the method. Q.L. performed an in-depth discussion of the related literature. All authors have read and agreed to the published version of the manuscript.

Data Availability Statement

All code, data, and materials included in this research are available upon request from the corresponding author.

Conflicts of Interest

The authors declare no conflicts of interest.

Figure 1 The pinhole imaging model of a star sensor.

Figure 2 (a) Invariance of the interstar angle of a star pair in the object and image spaces, which represent the basis for traditional on-orbit calibration; (b) invariance of the interstar angle of a star pair in the image space at different times, which is the basis for on-orbit self-calibration.

Figure 3 Illustration of the motion decomposition process of a star spot on the image plane: (a) rotation around the optical axis; (b) motion in the radial direction.

Figure 4 The convergence curves obtained by different calculation methods; the number of iterations and the value of scale parameter λ were used to calculate intrinsic parameters using a typical set of simulation data (the parameter settings were as follows: the number of image frames was NF=100, the star spot extraction error was σS=0.10 pixel, the number of star spots was NS=20, the initial position of the principal point of the optical system was (1000, 1000) pixel, and the focal length was 20 mm): (a–c) TCOC and TCWC; (d–f) SCOC and SCWC.

Figure 5 The intrinsic parameter biases calculated by different calibration methods under the conditions of a number of image frames of NF=100, a star spot extraction error of σS=0.01 pixel–0.50 pixel, and a number of star spots of NS=20–100: (a–c) TCOC; (d–f) TCWC; (g–i) SCOC; (j–l) SCWC.

Figure 6 The intrinsic parameter total errors of different calibration methods under the conditions of a number of image frames of NF=100, a star spot extraction error of σS=0.01pixel–0.50 pixel, and a number of star spots of NS=20–100: (a–c) TCOC; (d–f) TCWC; (g–i) SCOC; (j–l) SCWC.

Figure 7 The intrinsic parameter biases obtained by different calibration methods under the conditions of a star spot extraction error of σS=0.10 pixel, a number of image frames of NF=10–100, and a number of star spots of NS=20–100: (a–c) TCOC; (d–f) TCWC; (g–i) SCOC; (j–l) SCWC.

Figure 8 The results of the intrinsic parameter biases calculated by different calibration methods under the conditions of a star spot extraction error of σS=0.10 pixel, a number of image frames of NF=10–100, and a number of star spots of NS=20–100: (a–c) TCOC; (d–f) TCWC; (g–i) SCOC; (j–l) SCWC.

Disclaimer/Publisher’s Note: The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.
==== Refs
References

1. Singla P. Griffith D.T. Crassidis J.L. Junkins J.L. Attitude determination and autonomous on-orbit calibration of star tracker for the gifts mission Adv. Astronaut. Sci. 2002 112 19 38
2. Pal M. Bhat M.S. Autonomous star camera calibration and spacecraft attitude determination J. Intell. Robot. Syst. 2015 79 323 343 10.1007/s10846-014-0068-z
3. Yuan Y.H. Geng Y.H. Chen C.X.Q. On orbit calibration of star sensor with landmark J. Harbin Univ. Commer. 2008 2008 448 453
4. Zhou F. Ye T. Chai X. Wang X. Chen L. Novel autonomous on-orbit calibration method for star sensors Opt. Lasers Eng. 2015 67 135 144 10.1016/j.optlaseng.2014.11.009
5. Xie J. Tang H. Dou X. Long J. On-orbit calibration of domestic APS star tracker Proceedings of the Third International Workshop on Earth Observation and Remote Sensing Applications Changsha, China 11–14 June 2014 239 242
6. Shen J. Zhang G. Wei X. Star sensor on-orbit calibration using extended kalman filter Proceedings of the Third International Symposium on Systems and Control in Aeronautics and Astronautics Harbin, China 8–10 June 2010 958 962
7. Liu H.-B. Tan J.-C. Jia H. Li X.-J. Wang J.-Q. Yang J.-K. Autonomous on-orbit calibration of a star tracker camera Opt. Eng. 2011 50 023604
8. Samaan M.A. Mortari D. Junkins J.L. Non-dimensional star identification for uncalibrated star cameras J. Astronaut. Sci. 2006 54 95 111 10.1007/BF03256478
9. Leake C. Arnas D. Mortari D. Non-dimensional star-identification Sensors 2020 20 2697 10.3390/s20092697 32397401
10. Wei Y. Wei X. Liu H. Li J. A star identification graph algorithm based on angular distance matching score transfer IEEE Sens. J. 2024 24 6539 6547 10.1109/JSEN.2024.3350089
11. Arnas D. Leake C. Mortari D. The n-dimensional k-vector and its application to orthogonal range searching Appl. Math. Comput. 2020 372 125010 10.1016/j.amc.2019.125010
12. Zhang Z. A flexible new technique for camera calibration IEEE Trans. Pattern Anal. Mach. Intell. 2000 22 1330 1334 10.1109/34.888718
13. Faugeras O.D. What can be seen in three dimensions with an uncalibrated stereo rig? Proceedings of the ECCV’92, Second European Conference on Computer Vision Santa Margherita Ligure, Italy 19–22 May 1992 Lecture Notes in Computer Science Springer Berlin/Heidelberg, Germany 1992 Volume 588
14. Faugeras O.D. Luong Q.T. Maybank S.J. Camera self-calibration: Theory and experiments Proceedings of the ECCV’92, Second European Conference on Computer Vision Santa Margherita Ligure, Italy 19–22 May 1992 Lecture Notes in Computer Science Springer Berlin/Heidelberg, Germany 1992 Volume 588
15. Triggs B. Autocalibration and the absolute quadric Proceedings of the IEEE Computer Society Conference on Computer Vision and Pattern Recognition San Juan, PR, USA 17–19 June 1997 609 614
16. Hartley R.I. Projective reconstruction and invariants from multiple images IEEE Trans. Pattern Anal. Mach. Intell. 1994 16 1036 1041 10.1109/34.329005
17. Heyden A. Astrom K. Euclidean reconstruction from constant intrinsic parameters Proceedings of the 13th International Conference on Pattern Recognition Vienna, Austria 25–29 August 1996 Volume 1 339 343
18. Pollefeys M. Koch R. Van Gool L. Self-calibration and metric reconstruction in spite of varying and unknown internal camera parameters Proceedings of the 6th International Conference on Computer Vision Bombay, India 7 January 1998 90 95
19. Medaglia E. Autonomous on-orbit calibration of a star tracker Proceedings of the IEEE Metrology for Aerospace Florence, Italy 22–23 June 2016 456 461
20. Weng J. Cohen P. Herniou M. Camera calibration with distortion models and accuracy evaluation IEEE Trans. Pattern Anal. Mach. Intell. 1992 14 965 980 10.1109/34.159901
21. Yan J. Jiang J. Zhang G. Dynamic imaging model and parameter optimization for a star tracker Opt. Express 2017 25 927 948 10.1364/OE.25.000927 28157981
22. Dennis J.E. Schnabel R.B. Numerical Methods for Unconstrained Optimization and Nonlinear Equations 1st ed. Society for Industrial and Applied Mathematics Philadelphia, PA, USA 1983
23. Jia H. Yang J. Li X. Minimum variance unbiased subpixel centroid estimation of point image limited by photon shot noise J. Opt. Soc. Am. A 2010 27 2038 2045 10.1364/JOSAA.27.002038 20808414
24. van Bezooijen R.W. SIRTF autonomous star tracker Proceedings of the IR Space Telescopes and Instruments Waikoloa, HI, USA 22–28 August 2002
25. Hutchin R.A. Interferometric Tracking Device U.S. Patent 8045178 25 October 2011
26. Zhai C. Shao M. Goullioud R. Nemati B. Micro-pixel accuracy centroid displacement estimation and detector calibration Proc. R. Soc. A Math. Phys. Eng. Sci. 2011 467 3550 3569 10.1098/rspa.2011.0255
