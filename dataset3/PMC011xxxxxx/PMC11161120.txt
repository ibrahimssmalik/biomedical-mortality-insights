
==== Front
PLoS Comput Biol
PLoS Comput Biol
plos
PLOS Computational Biology
1553-734X
1553-7358
Public Library of Science San Francisco, CA USA

38805569
PCOMPBIOL-D-23-01661
10.1371/journal.pcbi.1011605
Research Article
Biology and Life Sciences
Cell Biology
Cellular Types
Animal Cells
Neurons
Biology and Life Sciences
Neuroscience
Cellular Neuroscience
Neurons
Biology and Life Sciences
Physiology
Electrophysiology
Membrane Potential
Action Potentials
Biology and Life Sciences
Physiology
Electrophysiology
Neurophysiology
Action Potentials
Biology and Life Sciences
Neuroscience
Neurophysiology
Action Potentials
Biology and Life Sciences
Physiology
Physiological Processes
Sleep
Research and Analysis Methods
Mathematical and Statistical Techniques
Statistical Methods
Statistical Inference
Physical Sciences
Mathematics
Statistics
Statistical Methods
Statistical Inference
Physical Sciences
Mathematics
Applied Mathematics
Algorithms
Research and Analysis Methods
Simulation and Modeling
Algorithms
Physical Sciences
Mathematics
Statistics
Statistical Data
Medicine and Health Sciences
Anesthesiology
Anesthesia
Medicine and Health Sciences
Pharmaceutics
Drug Therapy
Anesthesia
Research and Analysis Methods
Simulation and Modeling
Adaptive modeling and inference of higher-order coordination in neuronal assemblies: A dynamic greedy estimation approach
Adaptive modeling and inference of higher-order coordination in neuronal assemblies
https://orcid.org/0000-0001-9032-5738
Mukherjee Shoutik Conceptualization Data curation Formal analysis Investigation Methodology Software Validation Visualization Writing – original draft Writing – review & editing 1 2
https://orcid.org/0000-0002-9856-006X
Babadi Behtash Conceptualization Funding acquisition Project administration Supervision Writing – original draft Writing – review & editing 1 2 *
1 Department of Electrical and Computer Engineering, University of Maryland, College Park, Maryland, United States of America
2 Institute for Systems Research, University of Maryland, College Park, Maryland, United States of America
Marinazzo Daniele Editor
Ghent University, BELGIUM
The authors have declared that no competing interests exist.

* E-mail: behtash@umd.edu
5 2024
28 5 2024
20 5 e101160516 10 2023
20 5 2024
© 2024 Mukherjee, Babadi
2024
Mukherjee, Babadi
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.

Central in the study of population codes, coordinated ensemble spiking activity is widely observable in neural recordings with hypothesized roles in robust stimulus representation, interareal communication, and learning and memory formation. Model-free measures of synchrony characterize coherent pairwise activity but not higher-order interactions, a limitation transcended by statistical models of ensemble spiking activity. However, existing model-based analyses often impose assumptions about the relevance of higher-order interactions and require repeated trials to characterize dynamics in the correlational structure of ensemble activity. To address these shortcomings, we propose an adaptive greedy filtering algorithm based on a discretized mark point-process model of ensemble spiking and a corresponding statistical inference framework to identify significant higher-order coordination. In the course of developing a precise statistical test, we show that confidence intervals can be constructed for greedily estimated parameters. We demonstrate the utility of our proposed methods on simulated neuronal assemblies. Applied to multi-electrode recordings from human and rat cortical assemblies, our proposed methods provide new insights into the dynamics underlying localized population activity during transitions between brain states.

Author summary

Simultaneous ensemble spiking is hypothesized to have important roles in neural encoding; however, neurons can also spike simultaneously by chance. In order to characterize the potentially time-varying higher-order correlational structure of ensemble spiking, we propose an adaptive greedy filtering algorithm that estimates the rate of all reliably-occurring simultaneous ensemble spiking events. Moreover, we propose an accompanying statistical inference framework to distinguish the chance occurrence of simultaneous spiking events from coordinated higher-order spiking. We demonstrate the proposed methods accurately differentiate coordinated simultaneous spiking from chance occurrences in simulated data. In application to human and rat cortical data, the proposed methods reveal time-varying dynamics in higher-order coordination that coincide with changing brain states.

http://dx.doi.org/10.13039/100000001 National Science Foundation CCF1552946 https://orcid.org/0000-0002-9856-006X
Babadi Behtash http://dx.doi.org/10.13039/100000001 National Science Foundation ECCS2032649 https://orcid.org/0000-0002-9856-006X
Babadi Behtash http://dx.doi.org/10.13039/100000002 National Institutes of Health 1U19NS107464 https://orcid.org/0000-0002-9856-006X
Babadi Behtash This work is supported in part by the National Science Foundation (nsf.gov) Awards No. CCF1552946 and ECCS2032649 (to BB) and the National Institutes of Health (nih.gov) Award No. 1U19NS107464 (to BB). The funders did not play any role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript. PLOS Publication Stagevor-update-to-uncorrected-proof
Publication Update2024-06-07
Data AvailabilityThere are no primary data in the paper. Software implementations in MATLAB v2017b of the algorithms discussed are available at https://github.com/ShoutikM/AdaptiveHigherOrderCoordination and https://www.doi.org/10.5281/zenodo.10009981.
Data Availability

There are no primary data in the paper. Software implementations in MATLAB v2017b of the algorithms discussed are available at https://github.com/ShoutikM/AdaptiveHigherOrderCoordination and https://www.doi.org/10.5281/zenodo.10009981.
==== Body
pmcIntroduction

Synchronous neuronal ensemble activity is central in the study of neural population codes. Coordinated ensemble spiking has been observed in a variety of brain areas, prompting a variety of hypotheses about its role in cognitive function. For instance, studies have documented synchronous spiking at all levels of the mammalian visual pathway [1–3]. Synchronized thalamic population activity has also been widely observed, a phenomenon to which visual cortical neurons have been found sensitive, suggesting the importance of synchronized neuronal activity in thalamocortical communication [4, 5]. Synchronized spiking has, more broadly, been hypothesized to influence inter-areal communication and the flow of neural information [6–10]. The study of coordinated neural activity is also closely tied to oscillatory activity and memory. Synchronized hippocampal and hippocampal-cortical activity are thought to have significant roles in memory formation, working memory tasks, and encoding information for spatial navigation [11–13]. Coordinated ensemble spiking has additionally been postulated to be mediated by oscillations in local field potentials [14–16].

The prevalence of coordinated spiking and its functional implications for a range of neural processes have motivated both model-free and model-based approaches to quantifying spiking synchrony. Perhaps the most intuitive model-free metric is the pairwise correlations of spike trains smoothed by a Gaussian (or exponential) kernel [17, 18]. Other model-free measures include a range of spike train distance metrics that also perform pairwise comparisons [19]. Though the coherence of pairwise activity can be described, such measures do not capture higher-order coordination, and are limited in the ability to model dynamics in or determine the significance of pairwise coherence without repeated trials. More recently, model-free approaches based on continuous-time transfer entropy formulations have been introduced that avoid smoothing or binning spike trains [20–23]; however these are still limited to pairwise measures of synchrony.

Statistical models of neuronal ensemble activity transcend the limitation of model-free metrics to pairwise comparisons. Two widely used approaches are the maximum entropy models and point process generalized linear models (GLM) [24, 25]. Maximum entropy models describe the state of the neural population only in terms of its instantaneous correlational structure [26, 27]. Models are estimated to match observed firing rates and all pairwise (and potentially higher order) correlations simultaneously. The suitability of the maximum entropy model formulation for analyzing coordinated spiking has motivated several extensions. For instance, Bayesian state-space filtering algorithms have been developed to capture dynamics in the strength of higher-order spiking interactions [28, 29]. A stimulus-dependent maximum entropy model has also been proposed to address potential synchrony-modulating factors [30]. Extensions also include efforts to address the computational complexity associated with analyzing higher-order interactions amongst large neuronal assemblies [31, 32].

Point process GLMs are a common alternative to maximum entropy models for ensemble spiking [33, 34] that can characterize the influence of past population activity and other relevant covariates. Though useful in estimating functional connectivity [35, 36], each neuron must be assumed conditional independent due to regularity conditions that prohibit simultaneous spiking events [37–39]. This can be circumvented by using an equivalent marked point processes (MkPP) representation that explicitly models each disjoint simultaneous spiking event [38]. MkPP representations of ensemble activity have also been utilized to analyze neuronal population coding in unsorted spiking data [40, 41]. A related approach models disjoint simultaneous spiking events as log-linear combinations of point process models that permits an intuitive representation of excess or suppressed synchrony [15, 39].

The aforementioned statistical models enable the analysis of higher-order coordination in ensemble spiking, though each with their respective limitations. Dynamics in the correlational structure of maximum entropy models may be tracked with state-space filtering algorithms and credible intervals can be constructed to assess the statistical significance of correlations; however, the influence of past population activity on the ensemble state is neglected, and assumptions on the relevance of higher-order interactions are typically imposed for tractability of model estimation. Log-linear point process models can track dynamics in coherent spiking while incorporating the effects of temporal dynamics of population activity, and confidence intervals may be approximated for statistical inference; the necessity of a priori assumptions on the relevance of higher-order interactions still, however, remains. Additionally, both approaches require multiple repeated trials to capture dynamics in correlational structure with statistical confidence, thus limiting their applicability to spiking data without trial structure. A discretized MkPP model is capable of capturing greater detail in the effects of past population activity on coordinated spiking, though these effects are assumed to be static. To our knowledge, the tractability of the MkPP model for ensemble spiking has not been addressed, and a corresponding statistical inference framework is lacking.

We address these gaps by proposing an adaptive greedy filtering algorithm based on the discretized MkPP formulation in [38] to model dynamics in higher-order spiking coordination in single-trial recordings while capturing the influence of past ensemble activity. Incorporating similar data-driven restrictions on modeled interactions as in [31], we also address the question of tractability of the discretized MkPP formulation. Furthermore, we build on recent theoretical results related to Adaptive Granger Causality (AGC) analysis [35] to provide a precise statistical framework to detect significant coordinated spiking activity of arbitrary order. We demonstrate our proposed method’s utility in tracking dynamics in synchronous activity with statistical confidence on simulated ensemble spiking. Applying our method to continuous multi-electrode recordings of human cortical assemblies during anesthesia and to rat cortical assemblies during sleep provides novel insights into coordinated spiking dynamics that underlie transitions between brain states.

Materials and methods

In the following, we first highlight the limitations of existing approaches in application to neuronal spiking data without trial structure in order to motivate and highlight the contributions of this work, namely a framework for the dynamic and statistically precise inference of latent coordinated spiking in neuronal assemblies using their simultaneous spiking representation (Fig 1, bottom panel). We summarize essential components of the proposed methods subsequently. Key notation used throughout the remainder of the paper is summarized in Table 1. Problem formulation, algorithm development, and theoretical results are comprehensively addressed in supporting information (S1 Appendix). Software implementations in MATLAB v2017b of the algorithms discussed here are available at https://github.com/ShoutikM/AdaptiveHigherOrderCoordination and https://www.doi.org/10.5281/zenodo.10009981.

10.1371/journal.pcbi.1011605.g001 Fig 1 Summary of methods.

In order to characterize latent higher-order spiking coordination in a group of C neurons, the observed spiking event at every time frame t, denoted nt, is mapped to a categorical vector nt* that indicates which of 2C − 1 possible simultaneous spiking events occurred. The mapping of one spiking outcome to its categorical representation is circled in green. The disjointness of the categorical representation means that the spiking activity of a neuron can be recovered as the sum of outcomes in which that neuron spiked (as indicated in teal for neuron 5). In the proposed methods (grey box), this disjoint representation of spiking outcomes is modeled as a marked point process (MkPP). A time-varying categorical distribution describing the probability of each category (simultaneous spiking event) is fit by adaptively estimating each’s base-rate parameter (μt(m)), and possibly the influence of the recent ensemble spiking history (θt(m)). To determine if rth-order events (simultaneous spiking of exactly r neurons) occur at rates differing significantly from the rate of chance rth-order events, the estimated base-rate parameters of all rth-order events are compared to values of base-rate parameters expected if the neurons were independent. Significant rth-order coordination is indicated by rejecting a null hypothesis that such events occur by chance in favor of the alternative that they occur at a significantly different rate using a statistical test with precisely characterized distributions for the test statistic under both hypotheses. This framework enables the statistical confidence of rth-order coordination detected at a false discovery rate, α, to be summarized in terms of type I and type II errors using Youden’s J-statistic, Jα.

10.1371/journal.pcbi.1011605.t001 Table 1 Summary of key notation.

Notation	Definition	
nt=[nt(1),…,nt(C)]⊤	Ensemble spiking observation at time bin t of C neurons	
λt(c)Δ=P[nt(c)=1|Ht]	Conditional Intensity Function (CIF) of cth neuron	
nt*=[n*t(1),…,n*t(C*)]⊤	Marked observations at time bin t of C* = 2C − 1 marks	
λt*(m)Δ=P[nt*(m)=1|Ht]	CIF of mth mark	
nt(g)	Ground process, ∑m=1C*n*t(m)	
λ*t(g)Δ	CIF of the ground process, ∑m=1C*λ*t(m)Δ	
ωt=[ωt(1)⊤,ωt(2)⊤,…,ωt(C*)⊤]⊤	Model parameters of history-dependent model	
μt=[μt(1),…,μt(C*)]⊤	Base rate parameters of marks	
θt(m)	History-dependence coefficients of the mth mark	
ut(m)	Log-odds of mth mark vs. no spiking	
u0,t(m)	Log-odds of mth mark vs. no spiking (reduced model)	
γt(m)=ut(m)−u0,t(m)	Exogenous factor for mth mark	
β	Forgetting factor, 0 < β < 1	
W	Window length	

Related work

In the context of existing approaches to the analysis of correlational structure underlying ensemble spiking activity, the methods proposed in this work address two key limitations. The first is the consideration of simultaneous spiking between more than 2 neurons. Existing model-free approaches are largely restricted to pairwise evaluations of synchrony. Intuitive metrics like correlations or other similarity measures compare pairs of smoothed spike trains [17–19]. Recently, model-free analyses based on continuous-time formulations of transfer entropy have been proposed to evaluate causal history-dependent interactions and synchronization [20–23]. While not reliant on binning or smoothing spiking data, the tests of conditional independence in [20, 21] examine the relationship between the history of one point process and the updates of another, thus resembling Granger causality analysis [35, 36] more closely than a measure of synchrony. Alternatively, the transfer entropy-based approach in [22, 23] computes the mutual information rate as the sum of transfer entropy rates between two point process in both direction. Though this symmetric notion of connectivity quantifies synchronization, it remains limited to pairwise interactions.

Principal component analysis (PCA) and independent component analysis (ICA) have also been used to identify groups of synchronously spiking neurons [42–45], using multiple trials to form empirical covariance matrices and thereby discover a low-dimensional set of activity sources. Noting that PCA uses the covariance matrix to identify the low-dimensional components, it shares the same limitations with other pairwise measures, when the latent correlational structure is of higher order. While ICA can identify sources that account for higher-order correlations [43, 45], neither of these methods is well-suited to single-trial spike trains or when the underlying data structure is not low-dimensional or stationary.

While model-based approaches can circumvent the limitation to pairwise synchronization, in the same fashion as ICA, they are ill-suited to capturing dynamics in spiking data absent trial structure with statistical confidence. In the cases of two approaches closely related to the proposed methods, we examine this limitation more closely. We first consider the approach in [28], which utilizes a maximum entropy model of ensemble spiking whose dynamics are captured using Bayesian state-space filtering. The method, tailored for multi-trial data, assumes stationarity across trials but non-stationarity within so that the likelihood of the spiking observations nt is expressed as p(nt=1:T,l=1:L)=∏t,lexp(∑iθt(i)nt,l(i)+∑i<jθt(i,j)nt,l(i)nt,l(j)+⋯+θt(1,⋯,C)nt,l(1)⋯nt,l(C)-ψ(θt)),

with T time bins and L trials, and parameters evolving according to the linear-Gaussian state transition θt = Fθt−1 + ϕt. The Bayesian state-space filter utilizes an expectation-maximization algorithm that requires evaluating the posterior density p(θt=1:T|nt=1:T,l=1:L). Assuming non-stationarity in the trial-free case, the posterior, which is also used to construct credible intervals, is poorly estimated.

Next, we examine the log-linear point process model approach in [39]. Here, the log-probability of a simultaneous spiking event is modeled as the sum of log-probabilities of conditionally independent neurons and an additional term that captures excess synchrony. As an example, the joint probability for a pair of neurons modeled as logP[nt(1),nt(2)]=nt(1)logλt(1)+nt(2)logλt(2)+nt(1)nt(2)ξt(1,2).

Significant synchronization is detected if the null hypothesis that ξt(1,2)=0 can be rejected. However, doing so requires a bootstrap distribution for ξt(1,2), an ill-posed proposition in the trial-free case if the term is allowed to be time-varying.

The proposed method uses a discretized marked point process model (MkPP) of ensemble spiking activity [38] to capture higher-order interactions. The contributions of this work are the development of a greedy approach to adaptively fit the MkPP model to capture dynamics in spiking data without trial structure and a statistical inference framework with precisely characterized distributions for the test statistic, thus circumventing the need for bootstrapping or estimating a posterior distribution, both of which are better suited to multi-trial data when time-varying higher-order coordination is considered.

Discretized marked point process likelihood model

To characterize coordinated spiking, it is necessary to use an appropriate representation of neuronal ensemble spiking. Because multivariate point processes as defined in literature [37] do not permit simultaneous events at arbitrarily small time scales, point process models of ensemble spiking treat neurons as conditionally independent elements of a multivariate process. Instead, we use a discrete-time marked point process (MkPP) model to avoid assuming conditional independence, disjointly representing all simultaneous spiking outcomes [38, 39, 46].

For an assembly of C neurons, the C-variate spiking process, binned with small bin size Δ, at time bin index t is denoted by nt. Rather than treating its components as conditionally independent, nt is viewed as a multivariate observation that we map to a C*-variate process, a MkPP whose marks count exactly on of C* ≔ 2C − 1 possible non-zero spiking events. That is, at each time tj such that ntj≠0, the sole non-zero element of ntj* indicates which mark (ensemble spiking outcome) has occurred. We also define the binned ground process nt(g)≔∑m=1C*nt*(m) that indicates the occurrence of any spiking event [37]. The mark space K≔{1,…,C*} indexes the non-zero spiking outcomes [37]. For example, Fig 1 shows the activity of C = 5 neurons mapped to a marked process with C* = 31 marks; the event that neurons 1–3 spike together while 4 and 5 do not maps to the mark index 7 (circled in green). Because the marked representation is disjoint, the spiking observations of neuron c can be recovered by adding the observations of all marks corresponding to events including neuron c spiking. For instance, in Fig 1, the spiking activity of neuron 5 is the sum of simultaneous spiking events indexed 16–31 (both indicated in teal).

The conditional intensity functions (CIFs) of nt and nt* are approximated by the probabilities of observing an event at time bin t given ensemble spiking history; they are denoted λt(c)Δ and λt*(m)Δ for c = 1, …, C and m = 1, …, C*, respectively. We can relate λt(c)Δ to λt*(m)Δ in the same manner as nt(c) to nt*(m), and obtain the CIF of the ground process λt*(g)Δ=∑m=1C*λt*(m)Δ.

The joint distribution of the MkPP is expressed as a multinomial generalized linear model (mGLM) with multinomial logistic link function, two versions of which are considered here. The first, more general version utilizes the ensemble history as covariates in the mGLM. Here, the log-odds of the mth mark occurring, i.e. the probability of observing the mth simultaneous spiking outcome λt*(m)Δ, versus no spiking event occurring are: xt⊤ωt(m)=log(λt*(m)Δ1-λt*(g)Δ). (1)

The log-odds of the mth mark are parameterized by ωt(m)≔[μt(m),θt(m)⊤]⊤, consisting of an ensemble history-modulation vector θt(m) and the baseline firing parameter, μt(m); xt denotes the recent ensemble spiking history.

The second version of the mGLM makes the simplifying assumption that there is no history dependence. Consequently, the history-independent model is parameterized only by the baseline firing parameters μt=[μt(1),μt(2),…,μt(C*)]⊤. Here, the log-odds of the mth mark occurring versus no spiking event occurring are: μt(m)=log(λt*(m)Δ1-λt*(g)Δ). (2)

Summarily, the discretized MkPP model represents ensemble spiking activity explicitly in terms of all possible outcomes to model their likelihoods jointly. Hence, the MkPP model is essentially a time-varying categorical distribution where the categories are the simultaneous spiking outcomes; the instantaneous odds of these outcomes are non-stationary and possibly dependent on recent ensemble activity history.

Adaptive estimation of marked point process models

Since the parameters of the MkPP mGLM are assumed to be time-varying, we use adaptive algorithms to capture the dynamics of the history-dependent and history-independent models. However, analyzing large neuronal assemblies raises the issue of tractability since the number of parameters to be estimated scales exponentially with C. Since it is likely that some marks will not contain any events, we employ a thresholding rule similar to [31], considering only “reliable interactions”, i.e. the subset of the mark space K‾={m∈K:∑tnt*(m)>Nthr} for some pre-defined constant Nthr > 0, and treating the rates of the remaining marked processes as negligible due to their infrequency. That is, the time-varying categorical distribution assumes the probabilities of categories that occur with negligible frequency are zero so that we only fit parameters for the non-negligible categories. For generality and clarity in notation, subsequent discussions are in terms of the full mark space K.

The history-dependent discretized MkPP model is fit by solving a sequence of maximum likelihood problems. We assume that its parameters ωt admit piece-wise constant dynamics and are constant over consecutive windows of length W, where the log-likelihood of the ith window is denoted ℓi(ωi). To encourage smoothly adapting parameter estimates, we use a forgetting factor mechanism [47] to adaptively weight the window log-likelihoods up to the kth window. For a forgetting factor 0 ≤ β < 1, the adaptively-weighted log-likelihood at window k is thus defined as: ℓkβ(ωk)≔(1-β)∑i=1kβk-iℓi(ωk). (3)

Parameter estimation is hence performed by solving the sequence of maximum likelihood problems: ω^k≔argmaxωkℓkβ(ωk),k=1,2,⋯,K. (4)

To efficiently solve the sequence of problems in Eq (4) in an online fashion, we use the Adaptive Orthogonal Matching Pursuit (AdOMP) [48], an adaptive version of the Orthogonal Matching Pursuit (OMP) [49] [50]. The AdOMP, which fits an iteratively selected subset of model parameters, captures inherent sparsity of network interactions based on past ensemble activity [51–53] while also mitigating complexity. The implementation of AdOMP is addressed in detail in supporting information (S1 Appendix).

The sequence of maximum likelihood problems that must be solved to obtain the history-independent model takes a similar form as in Eq (4) under the same assumption of piece-wise constant dynamics of μt. The sequence of maximum likelihood estimates μ^k=argmaxμkℓkβ(μk),k=1,2,⋯,K (5)

are obtained by gradient descent, where the gradient of the history-independent log-likelihood can be computed directly. The procedure for computing the maximum-likelihood estimates of the history-independent model is detailed in supporting information (S1 Appendix).

Statistical inference of higher-order coordination

Coordinated spiking can indicate relationships between components of a neuronal assembly and, potentially, effects of unobserved processes. However, independent neurons can also spike concurrently by chance, necessitating statistical inference to distinguish between excessive (or suppressed) and chance simultaneous spiking. To this end, we quantify the two alternatives as nested hypotheses and prove that an adaptive de-biased deviance test used for identifying significant Granger-causal influences [35] is applicable to our setting, thus establishing a precise statistical inference framework.

Here, we focused on characterizing the significance of rth-order simultaneous spiking and have formulated the hypothesis test accordingly; however, similarly constructed null hypotheses can be used to test the significance of any set of simultaneous spiking events using the same inference procedure (see supporting information in S1 Appendix). For cogency, we focus on the statistical inference procedure for history-dependent MkPP models; differences for the history-independent model are addressed in supporting information (S1 Appendix). However, the complementary nature of the two models is summarized here. Theoretical results pertaining to the precise inference framework are summarized here, and comprehensively described in supporting information (S1 Appendix).

Formulating nested hypotheses to test for rth-order coordination

The significance of r-wise simultaneous spiking for r ≥ 2 is tested by considering the two alternatives: H0:rth-ordersimultaneousspikesoccurasfrequentlyastheywouldbetweenindependentunits,givenensemblespikinghistoryH1:rth-ordersimultaneousspikesoccuratasignificantlydifferentratethantheywouldbetweenindependentunits,givenensemblespikinghistory (6)

A similar formulation was used in [39] to determine whether one mark occurs at a significantly different rate than expected. The likelihood of the mark was modeled as the product of marginal likelihoods and an additional multiplicative factor. Noting that the additional factor takes value 1 if the neurons are truly independent, the null hypothesis was quantified accordingly. Instead, we estimate a reduced model that assumes rth-order interactions are chance occurrences by constraining the base rate parameters for each rth-order mark.

The base rate parameter is decomposed as μk(m)=μ0,k(m)+γk(m), (7)

where μ0,k(m) is the base rate under the null hypothesis and γk(m) is analogous to the additional multiplicative factor in [39] that captures potential exogenous effects after conditioning on ensemble spiking history. The reduced model thus constrains μ0,k(m)=μ^k(m)−γ^k(m) for all rth-order marks, denoted Kr, and solves the sequence of maximum likelihood problems ω^k(R)≔argmaxωk(R)ℓkβ(ωk(R)).

The estimated exogenous factor at the kth window, γ^k(m), is obtained as the average difference of the log-odds of the mth event under the null hypothesis, u0,t(m), and under the alternative, ut(m). That is, γ^k(m)=1W∑t=(k-1)W+1kW(ut(m)-u0,t(m)). (8)

Precise statistical inference using deviance differences

The use of the deviance difference test statistic has been established in classical statistical methodology [54, 55] as a common procedure for likelihood ratio tests between two nested hypotheses. However, such a test is ill-suited to our setting due to the highly-dependent covariates and forgetting-factor mechanism in the data log-likelihood. These issues were addressed in a related context [35] for the inference of Granger-causal links by defining the adaptive de-biased deviance difference and characterizing its limiting distribution under presence and absence of Granger-causal links. We similarly utilize the adaptive de-biased deviance difference, Dk,β(r)(ω^k(F),ω^k(R))≔(1+β1-β)[2(ℓkβ(ω^k(F))-ℓkβ(ω^k(R)))-(Bk(F)-Bk(R))], (9)

as the test statistic, where Bk(F) and Bk(R) are the respective biases of the full and reduced models. The full and reduced model log-likelihoods can be efficiently computed online (see supporting information in S1 Appendix).

We precisely characterize the limiting behavior of the deviance difference in Eq (9) under both the null and alternative hypotheses, showing that as β → 1:

i) if rth -order coordination matches independent rth-order interactions given ensemble spiking history, then Dk,β(r)(ω^k(F),ω^k(R))→dχ2(M(r)), i.e. chi-square, and

ii) if rth -order coordination diverges from independent rth-order interactions given ensemble spiking history, and assuming the base rate parameters of rth-order interactions scale at least as O(1−β1+β), then Dk,β(r)(ω^k(F),ω^k(R))→dχ2(M(r),νk(r)), i.e. non-central chi-square,

where νk(r) is the non-centrality parameter at time k that depends only on the true parameters, and M(r)=|Kr| is the difference in the cardinalities of the full and reduced support sets. Our theoretical results are comprehensively discussed in supporting information (S1 Appendix).

In order to fully characterize the limiting distribution of Dk,β(r) under H1, we must estimate the non-centrality parameter for each window. Assuming it evolves smoothly in time, we use a state-space smoothing algorithm [35] to estimate νk(r) from the observed Dk,β(r) values. Thus, in addition to identifying significant coordination, we also quantify the degree of significance using Youden’s J-statistic Jk(r)≔1-α-Fχ2(M(d),ν^k(r))(Fχ2(M(d))-1(1-α)) (10)

for significance level α, where F(⋅) denotes the CDF. Values of Jk(r) close to 1 imply that the rejection of the null is a stronger indication of coordination than for smaller values of Jk(r). Thus, the J-statistic characterizes the test in terms of both type I and type II errors. By convention, we take Jk(r)=0 when H0 is not rejected at the kth window. Under the alternative, it is possible to observe either significant excess or suppressed coordination; this can be reflected in the J-statistic by incorporating the net exogenous effect on rth-order coordination and using a signed J-statistic Jk(r)⋅sgn(∑m∈Krγ^k(m)). The full procedure for identifying significant rth-order coordinated spiking is summarized by Algorithm 1.

Algorithm 1 Dynamic inference of rth-order spiking coordination

Input: {nk*}k=1K, r, β, α

Output: {Jk(r)}k=1K, {ν^k(r)}k=1K, {Dk,β(r)}k=1K

1: Kr={m∈K:∑c=1Cmc=r} and M(r)=|Kr|

2: for k = 1 to K do

3:  hk = 0

4:  Estimate ω^k(F) using AdOMP; evaluate ℓkβ(ω^k(F)) and Bk(F)

5:  for m∈Kr do

6:   Evaluate {ut(m)}t=(k−1)W+1kW and {u0,t(m)}t=(k−1)W+1kW

7:   Set γ^k(m)=1W∑t=(k−1)W+1kW(ut(m)−u0,t(m)) and μ0,k(m)=μ^k(m)−γ^k(m)

8:  end for

9:  Estimate ω^k(R) using AdOMP with constraint μk(m)=μ0,k(m) for m∈Kr

10:  Evaluate ℓkβ(ω^k(R)), Bk(R), and Dk,β(r)(ω^k(F),ω^k(R))

11:  if Fχ2(M(r))−1(1−α)<Dk,β(r)(ω^k(F),ω^k(R)) then

12:   hk=sgn(∑m∈Krγ^k(m))

13:  end if

14: end for

15: Estimate {ν^k(r)}k=1K via non-central χ2 filtering/smoothing

16: Jk(r)=hk×(1−α−Fχ2(M(r),ν^k)(Fχ2(M(r))−1(1−α)))

17: return {Jk(r)}k=1K, {ν^k(r)}k=1K, {Dk,β(r)}k=1K

In establishing the limiting behavior of Dk,β(r), we also proved a result of independent interest; namely, we generalized asymptotic properties of de-sparsified ℓ1-regularized estimates [56] to de-sparsified greedy estimates by showing that the de-sparsified AdOMP estimate behaves asymptotically like the maximum likelihood estimate. Crucially, this allows for the construction of confidence intervals around greedily estimated parameters, thus enabling precise statistical inference.

Complementary characterizations of higher-order coordination by history-independent and history-dependent models

The history-independent model is a special case of the history-dependent model; hence, the statistical inference procedure summarized by Algorithm 1 can be appropriately modified. This specialization is expounded in supporting information (S1 Appendix). However, the interpretation of statistically significant results obtained using history-independent analysis is distinct from but complementary to the interpretation of statistically significant results obtained using history-dependent model. Let the base rate parameter and exogenous effect for the history-independent model be denoted by μk and γk, respectively; and the same for the history-dependent model by μk,H and γk,H, with history-modulation parameter θk. Then, the reduced model constraints imply γk=γk,H+x‾t⊤θk. If the observed rate of higher-order events is equal to that of independent neurons, γk = 0; however, higher-order interactions may still be coordinated, i.e. γk,H=−x‾t⊤θk≠0. Conversely, the observed rate of higher-order events may differ from that of independent neurons, i.e., γk ≠ 0. If γk,H=0, observed coordination can be attributed to the effects of ensemble history; otherwise, observed coordination was driven by an unobserved process. Thus, history-independent analysis reveals if the observed rate of simultaneous spiking events deviates from the expected rate in a group in independent neurons, while history-dependent analysis reveals if the observed rate of simultaneous events cannot be attributed to endogenous network effects.

Results

The proposed methods for analyzing higher-order spiking coordination were validated through simulations. First, we empirically verified our theoretical results, characterizing the limiting behavior of the adaptive debiased deviance difference on simulated spiking. Next, we demonstrated the utility of the analyses on simulated ensemble spiking data, showing that the ground-truth latent dynamics in higher-order coordinated spiking can be recovered with statistical confidence and with greater accuracy than existing single-trial metrics. Then, the proposed methods were applied to continuous multi-electrode recordings of human cortical assemblies during anesthesia and to rat cortical assemblies during sleep in order to infer latent dynamics in coordinated spiking during transitions between brain states.

Crucial hyperparameters that affect the estimation of MkPP models are the choice of bin size Δ (in physiological data); the window size W over which parameters are assumed constant and the forgetting factor β, which define the effective integration window Neff=O(W1−β) [57]; and the ensemble history integration window, i.e. the number of past samples spanned by the history coefficients θk. Justifications for hyperparameter selection are summarized in the following, while a detailed examination of their effects on MkPP model estimation is provided in supporting information (S2 Appendix).

Empirical validation of the limiting behavior of deviance differences

We first validated the proposed statistical test for rth-order coordinated spiking by empirically verifying the limiting distributions of the adaptive debiased deviance difference derived under the null and alternative hypotheses. We simulated and analyzed 50 realizations of a 5-neuron ensemble spiking process. Each realization was 4000 samples long with dynamics in 3rd-order spiking coordination. Namely, a step function was used to exogenously facilitate 3rd-order spiking during the second half of each realization.

The simulated spiking data were analyzed by applying Algorithm 1 to each realization; restricted models were only computed for 3rd-order spiking coordination. A threshold of Nthr = 1 was used to pruned marked events that occurred no more than once per realization; this excluded 5th order events from the estimated model. The window size over which parameters were assumed constant was set to W = 10 in order to enable stable estimation at each window while still allowing for fast changes. The forgetting factor was set to β = 0.99. For the purpose of validating the limiting distributions, a forgetting factor close to 1 was desirable; however, β = 0.99 is also a practical choice for the forgetting factor that serves to illustrate the utility of the limiting distributions when analyzing physiological data. Indeed, the hyperparameter choices (W, β) = (10, 0.99) were used in the applications to physiological data presented later. Hyperparameter choices for analysis are discussed in the context of two additional simulations.

The limiting distribution under the null hypothesis was validated by compiling adaptive de-biased deviance differences that were computed during the first half of each realization and corresponded to small estimated non-centrality parameter values. Their distribution, depicted by the blue histogram in Fig 2, closely matched the theoretical distribution of deviance differences under the null hypothesis, i.e. a χ2 distribution with M = 10 degrees of freedom.

10.1371/journal.pcbi.1011605.g002 Fig 2 Theoretical versus empirical distributions of the adaptive de-biased deviance difference under the null (blue) and alternative (red) hypotheses.

Empirical distributions of adaptive de-biased deviance differences were compiled from history-dependent analyses of 50 realizations of a discretized marked point process simulating the ensemble spiking of 5 neurons with exogenously induced 3rd-order spiking dynamics. The distributions were compared to the probability distribution functions (PDF) of a χ2 distribution with M = 10 degrees of freedom (left), and a non-central χ2 distribution with M = 10 degrees of freedom and non-centrality parameter ν = 327 (right), corresponding respectively to the limiting distribution under the null and alternative hypotheses.

The limiting distribution under the alternative hypothesis was validated by compiling adaptive de-biased deviance differences that were computed during the second half of one particular realization and hence corresponded to similar estimated non-centrality parameter values. Their distribution, depicted by the red histogram in Fig 2, closely matched the theoretical distribution of deviance differences under the alternative hypothesis, a non-central χ2 distribution with M = 10 degrees of freedom and non-centrality parameter ν = 327. The non-centrality parameter of the theoretical distribution was determined by computing the median of the aforementioned estimates.

Simulated ensemble spiking: Example 1

We next demonstrated the utility of the proposed methods in application to two sets of simulated ensemble spiking data with dynamic latent higher-order coordination. An additional simulation addressing the utility of the proposed methods in analyzing large neuronal assemblies is included in supporting information (S2 Appendix). In the first example, spiking activity of 5 neurons was simulated for 16000 samples. Spiking activity (Fig 3A) included 3rd-order events exogenously facilitated and suppressed in alternation by a square wave and 4th-order events induced through endogenous effects of ensemble spiking history throughout the simulated duration. The latent spiking coordination was evident when visualizing the sums of all rth-order events in Fig 3B. Four epochs of the simulation were defined by the periods of 3rd-order facilitation and suppression, shown in Fig 3C, and are indicated by vertical dashed lines common across all panels.

10.1371/journal.pcbi.1011605.g003 Fig 3 Analysis of ensemble spiking with 3rd-order coordination induced exogenously by a square wave.

A. Simulated ensemble spiking of five neurons. B. Sum of the rth-order simultaneous spiking events for r = 2, 3, 4, 5. C. Spiking coordination varies across 4 epochs defined by the exogenous process that alternatingly facilitated and suppressed 3rd-order events. These are demarcated by vertical dashed lines. D. Significant rth-order coordination neglecting ensemble history. E. Significant rth-order coordination based on history-dependent ensemble spiking model. Statistical testing in D–E performed at level α = 0.01. F. Average Pearson correlation with 95% confidence interval. G. Average spiking regularity: coefficient of variation ±2 SEM. H. Average mark CIF differences of 3rd-order (green) spiking interactions ±2 SEM.

History-independent and history-dependent analyses of higher-order coordination were applied to the simulated spiking data using the same set of hyperparameters. A conservative threshold of Nthr = 1 was chosen to prune marked events that occurred unreliably over the simulated duration. The window size over which parameters were assumed constant was set to W = 10 in order to enable stable estimation at each window while still allowing for fast changes. Fixing W, several candidate values for the forgetting factor were considered to obtain the most appropriate effective integration window, Neff=O(W1−β) [57], and was set to β = 0.975. For simulations the best choice of β corresponded to Neff≈τ10, where τ denotes the duration of the shortest latent state; this heuristic is validated in supporting information (S2 Appendix). For the present simulation, τ = 4000, the half-period of the square wave that defined alternating states of 3rd-order facilitation and suppression; hence, Neff = 400. Statistical tests were performed at level α = 0.01.

History-independent inference of higher-order synchrony (Fig 3D) accurately characterized the periods of facilitated 3rd-order coordinated spiking and correctly assessed the rates of 4th-order spiking events to be significantly higher than expected amongst independent neurons, indicated by J-statistic values close to +1. However, 3rd-order suppression was not detected as a statistically significant, likely reflecting that the expected rate of 3rd-order was low to begin with and therefore difficult to distinguish. In complement, history-dependent inference of higher-order coordination (Fig 3E) correctly attributed 4th-order spiking, which occurred at a statistically significantly high rate, to endogenous network effects captured by ensemble spiking history regressors while detecting that 3rd-order spiking was exogenously facilitated.

For comparison, three single-trial measures of coordinated spiking were utilized. The first is the average Pearson correlation between smoothed spiking responses. The second is the spiking regularity, quantified by the average coefficient of variation (ratio of the standard deviation to the mean inter-spike interval) [58]. A ratio close to 1 indicates Poisson spiking statistics; larger ratios indicate greater variability due to self-exciting dynamics while smaller ratios indicate regularity in spiking (i.e. globally coordinated spiking). Both measures were computed over non-overlapping windows of 200 samples to track dynamics, which while not identical are of a similar order of magnitude as Neff. The third measure is the average difference between rth-order mark CIFs and probabilities of rth-order independent interactions, generalizing the measure employed in [38] to higher-order simultaneous spiking. Other existing model-based analyses require multiple trial repetitions and were thus unsuited to the single-trial simulation setting.

In application to simulated ensemble spiking data, the three control measures were unable to capture the latent dynamics in spiking coordination. Significant pairwise correlations (Fig 3F) were detected throughout the simulated duration, indicating only that several pairs of neurons were spiking concurrently, but were insensitive to the changes between facilitative and suppressive states of the exogenous process. Similarly, the spiking variability measure (Fig 3G) indicated Poisson-like spiking statistics throughout the simulation without reflecting any latent dynamics. The average mark CIF differences of 3rd-order events (Fig 3H) weakly reflected the dynamics of the exogenous process, but closer inspection (Fig 3H inset) reveals the oscillatory nature and wide confidence intervals of this sample-by-sample measure which pose challenges in interpreting the analysis.

Simulated ensemble spiking: Example 2

The second simulated example utilized an autoregressive process instead of a square wave to induce exogenous 3rd-order coordinated spiking in a 5-neuron assembly. Ensemble spiking was simulated for 12000 samples (Fig 4A) with 3rd-order events exogenously induced by one realization of an autoregressive process. Additionally, 4th-order events were induced through endogenous effects for the first and last 4000-samples periods of the simulated duration, but occurred with chance-level probability otherwise. The sums of all rth-order events (Fig 4B) reflected the latent spiking coordination. Coordinated 3rd-order spiking was most evidently facilitated during an interval when the exogenous variable had value greater than 2 (Fig 4C); the interval is indicated by vertical dashed lines common across all panels.

10.1371/journal.pcbi.1011605.g004 Fig 4 Analysis of ensemble spiking with 3rd-order coordination induced exogenously by an autoregressive process.

A. Simulated ensemble spiking of five neurons. B. Sum of the rth-order simultaneous spiking events for r = 2, 3, 4, 5. C. An autoregressive process was used to exogenously induce 3rd-order spiking coordination. The effect was most evident when the exogenous variable had value larger than 2 over an interval is demarcated by vertical dashed lines. D. Significant rth-order coordination neglecting ensemble history. E. Significant rth-order coordination based on history-dependent ensemble spiking model. Statistical testing in D–E performed at level α = 0.01. F. Average Pearson correlation with 95% confidence interval. G. Average spiking regularity: coefficient of variation ±2 SEM. H. Average mark CIF differences of 3rd- (green) and 4th-order (teal) spiking interactions ±2 SEM.

Both history-independent and history-dependent analyses were applied to the second simulated spiking data set using the same hyperparameters. The mark space was again pruned to include only events that occurred more than Nthr = 1 times; parameters were assumed constant over windows of W = 10 samples; and statistical tests were performed at level α = 0.01. The forgetting factor was set to β = 0.95, which corresponded to an effective integration window Neff = 200. We noted that the exogenous autoregressive process most persistently facilitated 3rd-order coordinated spiking for a duration of ∼ 4000 samples; and within that duration, two subintervals of ∼2000 samples separated at time index ∼ 8000 can be discerned upon visual inspection (Fig 4C). Hence, taking τ = 2000, the choice of β = 0.95 satisfies the criterion that Neff≈τ10.

The history-independent analysis of higher-order coordination correctly detected statistically significant 3rd-order coordination during the interval in which the exogenous variable was greater than 2 and 4th-order coordination when they were induced by ensemble spiking history (Fig 4D). The history-dependent analysis also correctly identified the exogenous facilitation of 3rd-order events while attributing 4th-order coordination to endogenous effects (Fig 4E). For comparison, the average Pearson correlation, average spiking regularity, and average mark CIF differences were computed in identical fashion as for the first simulation. The average Pearson correlation exhibited indicated significant pairwise correlations concurrently with both exogenously induced 3rd-order events and endogenously induced 4th-order events (Fig 4F); however, these two facets of latent higher-order coordination could not be disambiguated. In contrast, the average spiking regularity did not exhibit any dynamics; Poisson-like spiking statistics were indicated throughout the simulated duration (Fig 4G). The average mark CIF differences for 3rd- and 4th-order marks both weakly indicated the latent higher-order coordination (Fig 4H). In addition to previously issues concerning large confidence intervals and oscillatory nature, deviant average mark CIF differences for 3rd- and 4th-order events appear identical despite being induced in different manners. This illustrates that the average mark CIF differences only indicate when rates of rth-order events deviate from the expected rate and cannot further address latent structure.

Ensemble spiking in anesthetized humans

In the first application to recorded spiking data, we analyzed microelectrode recordings of human cortical neurons during the transition into propofol-induced general anesthesia. Commonly used in surgical procedures, general anesthesia is a drug-induced neurophysiological state of sedation and unconsciousness. In a study of the transition into unconsciousness, simultaneous recordings of single-neurons, LFP, and electrocorticograms were acquired to analyze changes to neural activity and functional connectivity over multiple spatial scales (full details of the experimental procedure are described in [59]). To complement previous analysis of pairwise spiking correlations, we employed the proposed methods for characterizing higher-order coordinated spiking.

Spiking data from the microelectrode recordings of one subject were analyzed, focusing specifically on the 8 neurons with the highest average firing rate over the 1000 second recording. Multi-unit spike recordings were originally oversampled at 1kHz, but downsampled by a factor of 50 to reduce computational complexity. Hence, the definition of simultaneous spiking in this analysis was taken to be the occurrence of spiking events across multiple neurons within at most 50ms of each other. This bin size selection was verified to minimize the coassignment of multiple spikes to the same bin in each of the 8 neurons’ spike trains. Ensemble spiking activity is shown in Fig 5A, aligned to the loss of consciousness (LOC) at 0s when propofol was first administered; the effect was evident from the rapid decrease in spiking. Spiking activity recovered and after 250s propofol was administered again. In order to analyze higher-order coordination with the proposed methods, the mark space of C* = 28 − 1 possible simultaneous spiking events, K, was pruned to the set of reliable interactions K‾ that occurred more than Nthr = 15 times; that is, simultaneous spiking events with average rates less than 0.015Hz were treated as negligible. The cardinality of the set of reliable interactions, defined with a conservative threshold, was |K‾|≈0.16⋅C*. The sums of all rth-order events (Fig 5B) show that up to 4th-order coordinated spiking occurred reliably, though less frequently after LOC.

10.1371/journal.pcbi.1011605.g005 Fig 5 Higher-order spiking coordination analysis of human cortical neurons during anesthesia.

A. Ensemble spiking of 8 neurons aligned to loss of consciousness (LOC) at 0s induced by administering propofol. A second administration of propofol occurred at ∼ 250s. B. Sum of the rth-order simultaneous spiking events for r = 2, …, 8. C. Significant rth-order coordination neglecting ensemble history. D. Significant rth-order coordination based on history-dependent ensemble spiking model. Statistical testing in C–D performed at level α = 0.01. E. Average Pearson correlation with 95% confidence interval. F. Average spiking regularity: coefficient of variation ±2 SEM.

History-independent and history-dependent analyses were performed using the same hyperparameters. The window over which parameters were assumed constant was set to W = 10. The forgetting factor, β = 0.99, was selected so that Neff≈τ5; here, we used τ = 5000, the approximate number of samples between the two administrations of propofol. For applications to recorded data, choosing β such that Neff≈τ10 (as was done for simulated data) yielded inferred higher-order coordination that was statistically weak (as quantified by J-statistics) and transient, resembling simulated examples where Neff was mismatched to the duration of latent states (supporting information in S1 Appendix). We speculate that a shorter effective integration was appropriate in simulations because the assemblies were comprised of 5 neurons with similar firing rates, which facilitated tracking latent dynamics. This contrasts with the variability in firing rates that can be observed in Fig 5A. Finally, statistical inference was performed at level α = 0.01.

Applying history-independent higher-order coordination analysis revealed sustained significantly high rates of 2nd-, 3rd-, and 4th-order events prior to LOC (Fig 5C). Moreover, conditioning on ensemble spiking history indicated that 3rd- and 4th-order events were exogenously facilitated, while 2nd-order events were exogenously suppressed (Fig 5D). This latent structure was disrupted immediately following LOC; as spiking activity diminished, no higher-order coordination was detected. However, as spiking activity recovered, 3rd- and 4th-order events (but not 2nd-order events) occurred at significantly high rates. As the second administration of propofol again diminished spiking activity, the rate of 4th-order events became insignificantly different from the expect rate amongst independent neurons and did not recover. However, transient 3rd-order spiking after the second administration continued that the history-independent analysis detected as statistically significant. Third-order spiking was sustained at a significantly high rate once ensemble spiking activity recovered. Notably, none of the higher-order coordinated spiking after LOC was exogenously induced.

The dynamics in higher-order spiking coordination described by the proposed methods were poorly reflected by the average Pearson correlation and average spiking regularity. Both measures were computed over windows of 200 samples in order to track changes during the transition into anesthesia. Average correlations seemed to be significantly greater than zero for longer intervals after LOC than during consciousness, but trends in the average correlation were difficult to distinguish (Fig 5E). The average spiking regularity measure indicated Poisson-like spiking statistics throughout, contrasting the dynamics of higher-order coordination described by the proposed analyses. Average spiking regularity was ill-suited to analyzing dynamics after LOC due to the reduced spiking activity; this was reflected by abrupt changes and wide confidence intervals (Fig 5E).

In summary, history-independent and history-dependent analyses of ensemble spiking during the transition into anesthesia revealed the rapid onset of differences in latent higher-order coordination that distinguished consciousness from anesthesia. Specifically, comparisons between the history-independent and history-dependent results suggest that exogenous influences on the higher-order interactions of small neuronal assemblies during consciousness are disrupted during anesthesia. These results are corroborated by previous analyses of these data [59] that indicated a rapid state change in which local network interactions were preserve but spatially distant network interactions were disrupted during anesthesia. Previous studies have shown that propofol acts by enhancing GABAergic circuits whose recurrent dynamics contribute to inducing synchronized slow-wave oscillatory activity [59–63]. Ensemble spiking history regressors likely accounted for these recurrent dynamics in the history-dependent model so that no exogenous effects were detected.

Ensemble spiking in sleeping rats

We additionally analyzed ensemble spiking data recorded from rat cortical neurons during sleep. Sleep consists of cyclical transitions between brain states that maintain homeostatic neural activity distinct from waking states; however, both the purpose and mechanisms of these transitions remain unclear. We analyzed large-scale spike recordings from frontal and motor cortices during sleep obtained to study the effects of different sleep stages on the firing rate dynamics of putatively excitatory (pE) pyramidal neurons and putatively inhibitory (pI) interneurons [64, 65]. By examining neuronal activity recorded during several instances of rapid eye movement (REM), non-REM (nREM), and microarousal states over multiple sleep cycles, the study sought to address homeostatic effects of sleep. Instead, we sought to use the proposed analyses of higher-order spiking coordination to study the dynamics during transitions into sleep and between REM and nREM states in one sleep cycle.

We analyzed spiking data during one 182s long sleep cycle from one animal in which at least 10 pE and pI neurons were identified, selecting the 10 neurons of each class with the highest average firing rate. Recordings were originally oversampled at 20kHz, but downsampled to 200Hz to reduce computational complexity. Simultaneous spiking in this analysis hence equated to the occurrence of spiking events across multiple neurons within at most 5ms of each other. This bin size selection was verified to minimize the coassignment of multiple spikes to the same bin in each of the 10 neurons’ spike trains in both populations. Ensemble spiking activity of pE and pI neurons were analyzed separately; the activity of each population during the sleep cycle is shown in Fig 6A and 6G, respectively, annotated by arousal states. The cycle analyzed consisted of a 66s wake-period, a transient 1s nREM period, a 46s REM period, a 29s nREM period, and finally a 40s wake-period.

10.1371/journal.pcbi.1011605.g006 Fig 6 Higher-order spiking coordination analysis of excitatory (pE) and inhibitory (pI) rat cortical neurons during one sleep cycle.

Left and right columns show analyses of pE and pI neurons, respectively. A. Ensemble spiking of 10 pE neurons. B. Sum of the rth-order simultaneous spiking events for r = 2, 3. C. Significant rth-order coordination neglecting ensemble history. D. Significant rth-order coordination based on history-dependent ensemble spiking model. E. Average Pearson correlation with 95% confidence interval. F. Average spiking regularity: coefficient of variation ±2 SEM. G. Ensemble spiking of 10 pI neurons. H. Sum of the rth-order simultaneous spiking events for r = 2, 3. I. Significant rth-order coordination neglecting ensemble history. J. Significant rth-order coordination based on history-dependent ensemble spiking model. K. Average Pearson correlation with 95% confidence interval. L. Average spiking regularity: coefficient of variation ±2 SEM. Statistical testing in C–D, I–J performed at level α = 0.01.

For tractable analysis, the mark spaces of C* = 210 − 1 possible simultaneous spiking events, K, of both populations were pruned to the set of reliable interactions K‾ that occurred more than Nthr = 10 times; that is, simultaneous spiking events with average rates less than 0.055Hz were treated as negligible. The cardinality of the set of reliable interactions amongst pE neurons was |K‾pE|≈0.017⋅C* and amongst pI neurons was |K‾pI|≈0.058⋅C*. The sums of all rth-order events (Fig 6B and 6H) show that up to 3rd-order coordinated spiking occurred reliably amongst pI neurons while only up to 2nd-order interactions occurred reliably amongst pE neurons. The same effective integration windows were used for history-independent and history-dependent analyses of both neuronal populations; with W = 10, the forgetting factor β = 0.99 so that Neff=τ5, where τ ≈ 5000 was the duration of the second nREM interval. Statistical inference was performed at level α = 0.01.

Applying the history-independent and history-dependent analyses of higher-order coordination to the ensemble spiking of pE neurons in concert identified intervals of significantly higher rates of 2nd-order events that could be attributed to effects of ensemble spiking history (Fig 6C and 6D). Most of the detected intervals were not sustained during either REM or nREM sleep; rather, they were aligned to the transitions between states. However, pI neurons exhibited more structured higher-order coordination. History-independent analysis of pI neurons revealed that 2nd-order events had significantly higher rates during two intervals; the first was during the wake-period, and the second started at the end of the first wake-period and ending at the transition from REM to nREM sleep (Fig 6I). While during the first of these intervals the facilitation of 2nd-order events could largely be attributed to ensemble history effects, there was a shift in the exogenous effects on 2nd-order during the second interval (Fig 6J). That is, after the transition from the wake state to REM sleep, the exogenous suppression of 2nd-order events gradually shifted to exogenous facilitation by the middle of the REM period that persisted into the nREM period. Exogenous 2nd-order coordination was no longer detected strongly after the first half of the nREM period, but exogenous suppression emerged again in the second wake-period.

In addition to dynamics in 2nd-order coordination, pI neurons also exhibited significant 3rd-order coordination. The rate of 3rd-order events was significantly high during the first wake period and REM sleep; though significantly higher at the start of nREM sleep, only statistically weak and transiently high rates were detected during the middle and end of nREM sleep. However, in the second wake period, the rate of 3rd-order coordinated events again became significantly high (Fig 6I). Notably, the high rate of 3rd-order events during REM was distinctive because it was exogenously facilitated, whereas 3rd-order events during other periods occurred at significantly high rates because of endogenous effects (Fig 6J).

In contrast to the proposed analyses, neither the average Pearson correlation nor average spiking regularity, computed over windows of 200 samples, reflected similar latent dynamics of higher-order coordination amongst pE or pI neurons. For pE neurons, pairwise correlations were close to 0 for much of the sleep cycle with the exception of a few windows (Fig 6E). However, the spiking regularity was significantly less than 1 for much of the sleep cycle (Fig 6F); the implication of globally coordinated ensemble spiking is at odds with the absence of reliably occurring higher-order spiking events amongst pE neurons. For pI neurons, the average correlation was significantly higher than 0 during the first and second wake periods, mirroring the significantly high rates of higher-order events during these intervals; however, excepting a few windows, the average correlation did not significantly differ from 0 during REM sleep (Fig 6K), presenting an inconsistency with the rates of higher-order events. Meanwhile, the average spiking regularity did not differ significantly from 1 for most of the sleep cycle, indicating Poisson-like spiking activity (Fig 6L); this contrasts sharply from the reliable occurrence of higher-order events.

Summarily, applying the history-independent and history-dependent analyses of higher-order spiking coordination revealed distinctive latent dynamics amongst pE and pI neurons during the same sleep cycle. Intervals of significant 2nd-order spiking coordination amongst pE neurons were attributable to the effects of ensemble spiking history and occurred around the transitions between arousal states rather than being sustained during the arousal states, possibly relating to a hypothesis that transition periods are themselves distinct states [66]. In contrast, 2nd- and 3rd-order spiking events amongst pI neurons were detected to be exogenously coordinated, especially during sleep states. The observed changes in higher-order coordination of pI neurons during REM sleep are consistent with previous results that have shown excitation of pI neuronal activity and coordination during REM sleep [67, 68]. Additionally, the detected exogenous influences on pI neurons may be explained by studies that have indicated signatures of REM sleep can be found in hippocampal neurons prior to cortical neurons [69, 70].

Discussion and concluding remarks

Relations to other models of coordinated spiking activity

The proposed algorithms integrate some notable functionalities of existing maximum entropy model variations with the GLM framework, and are tailored for the analysis of continuously acquired neuronal data. As Truccolo’s comparisons in [24] suggest, GLMs account for temporal dynamics explicitly in modeling ensemble spiking, and thus are arguably more predictive than maximum entropy models. Within the context of the MkPP mGLM we utilized, temporal dynamics of neuronal spiking were modeled as relevant covariates in the estimation of ensemble spiking events. Such a model can be simplified to exclude spiking history, as demonstrated by the history-independent model; and can be expanded to model the influence of stimuli, as previously addressed for maximum entropy models [30].

Due to the large number of possible interactions, challenges in the tractability of synchrony analyses are inherent, particularly when modeling the effects of relevant covariates. Incorporating the emphasis on reliable interactions, as proposed in [31], model complexity may be managed in a data-driven fashion. The proposed adaptive greedy filtering algorithm for sparse model estimation ensures only the salient effects of covariates are captured. The adaptive filtering algorithm also characterizes dynamics in network correlational structure, analogous to Bayesian state space filtering algorithms [28, 29], and is thus applicable in the analysis of non-stationary neuronal processes. In lieu of constructing credible intervals around the aforementioned Bayesian estimates, we utilize a statistical test for which the test statistic’s limiting distribution is precisely characterized. Unlike existing analyses, the proposed statistical tests do not require repeated trials of data to detect coordinated spiking activity, and are thus suitable for the analysis of continuous recordings of ensemble neuronal spiking.

Extending previous results in high-dimensional statistics, we have shown in Theorem 1 that the elegant procedure of [56] for LASSO estimation may be adapted to de-sparsify OMP estimates, and that de-sparsified estimates are asymptotically normal. In reviewing the existing literature, we noted a paucity in work on variable selection algorithms concerning the construction of confidence intervals. The OMP has been shown to have similar consistency properties as LASSO regression under appropriate conditions [49, 50]; however, in settings with large quantities of data, the latter becomes intractable. The result established by Theorem 1 enables the construction of confidence intervals around OMP-estimated parameters in order to provide analogous methods of statistical inference as LASSO for an algorithm suitable in settings with large data sets, addressing this gap in the high-dimensional statistics literature.

Novel insights into coordinated network activity

The proposed modeling and statistical inference framework constitute a novel approach to studying coordinated neuronal spiking by enabling the adaptive analysis of continuously acquired or single-trial data. The ability to track dynamics and detect exogenous influences on ensemble spiking with statistical confidence provides a new approach to probing the neural mechanisms underlying transitions between and characteristics of arousal states.

Simulated data examples verified the recovery of underlying correlational structure in ensemble spiking. In particular, the simulation results emphasized the distinction that the proposed method makes between synchrony and coordination based on comparisons of the history-independent and history-dependent version of the analysis, respectively.

In applications to physiological data, we first analyzed ensemble spiking of human cortical neurons during the transition into anesthesia. Directly comparing our results to previous insights gained from the same data in [59], the proposed method was consistent in indicating the rapid onset of disrupted global connectivity but the preservation of local connectivity during anesthesia. Absent a ground truth, this comparison substantiated insights gained from applying the proposed methods to physiological data.

Next, we analyzed the ensemble spiking activity of rat cortical neurons during one sleep cycle. State transitions during sleep have typically been characterized in terms of multiband analysis of electrophysiological recordings [66, 67, 69, 70]; meanwhile, to the best of our knowledge, properties of neuronal spiking in different sleep states have been characterized non-parametrically (e.g. with correlations, mean activity, Fano Factor, etc.) [64, 67, 68]. Hence, spiking dynamics over a single sleep cycle appear not to be well-explored. The novel insights into spiking coordination during fast state transitions over the course of a single sleep cycle provided by the proposed methods serve to motivate future studies of the correlates of state transitions at a fine spatiotemporal resolution.

Extensions

The proposed statistical inference framework was developed to test for significant coordination of rth-order spiking events, and the presented results demonstrated its efficacy. Specifically, Theorem 2 characterized the limiting distributions for the adaptive de-biased deviance difference test statistic under both outcomes of a nested hypothesis test in which the null hypothesis restricted parameters to impose conditionally independent rth-order spiking. However, a nested null hypothesis can, in principle, be constructed to impose different assumptions. An immediate extension of the proposed analysis could include spatial information, for example, so that a null hypothesis assumes rth-order spiking amongst a spatially localized subset of a recorded neuronal assembly is conditionally independent. The proposed inference framework was hence established to readily extend to any nested hypothesis test in Corollary 2.2.

An important consequence of this corollary result is that it provides a theoretical foundation for adaptive Granger causality using greedy algorithms. Since the proposed methods utilize a multinomial extension of generalized linear models, Corollary 2.2 establishes the asymptotic result in [35] for greedy parameter estimates in the limiting case of a single-neuron model. Notably though, Corollary 2.2 also implies that a nested hypothesis test can be formulated to determine if exogenous signals, such as sensory stimuli or concurrent activity in other brain regions, have Granger-causal effects on a neuronal network or its subsets. Thus, the methods proposed in the present study can be extended to investigate the local network effects of global neural dynamics.

Supporting information

S1 Appendix Algorithms, derivations, and theoretical results.

In this appendix, we present supporting information regarding algorithm development and our theoretical results supporting the proposed statistical inference framework.

(PDF)

S2 Appendix Supporting simulations.

In this appendix, we present supporting simulations that address hyperparameter selection and the scalability of the proposed method to large neuronal assemblies.

(PDF)

We thank Emery N. Brown and Patrick L. Purdon for providing neural data (published in [59]) recorded from human cortical assemblies during anesthesia.

10.1371/journal.pcbi.1011605.r001
Decision Letter 0
Bush Daniel Academic Editor
Marinazzo Daniele Section Editor
© 2024 Bush, Marinazzo
2024
Bush, Marinazzo
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.
Submission Version0
2 Jan 2024

Dear Prof. Babadi,

Thank you very much for submitting your manuscript "Adaptive modeling and inference of higher-order coordination in neuronal assemblies: a dynamic greedy estimation approach" for consideration at PLOS Computational Biology.

As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.

In particular, the authors should ensure that the relationship between their method and previous, related algorithms is well described, to provide better context for the novel contribution made here; and that the mathematical details are complemented by a more intuitive description of their approach which will increase the impact of this manuscript by making it more accessible, particularly to experimental neuroscientists. To that end, it may even be worth moving some mathematical details to the supplementary information, if they feel that this could improve the readability of the paper.

We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.

When you are ready to resubmit, please upload the following:

[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.

[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).

Important additional instructions are given below your reviewer comments.

Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.

Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.

Sincerely,

Daniel Bush

Academic Editor

PLOS Computational Biology

Daniele Marinazzo

Section Editor

PLOS Computational Biology

***********************

In particular, the authors should ensure that the relationship between their method and previous, related algorithms is well described, to provide better context for the novel contribution made here; and that the mathematical details are complemented by a more intuitive description of their approach which will increase the impact of this manuscript by making it more accessible, particularly to experimental neuroscientists. To that end, it may even be worth moving some mathematical details to the supplementary information, if they feel that this could improve the readability of the paper.

Reviewer's Responses to Questions

Comments to the Authors:

Please note here if the review is uploaded as an attachment.

Reviewer #1: The authors propose a novel method to detect significant high-order correlations in multi-neuron spike trains in the absence of trial structure. The methodology appears rigorous, although the mathematical details are quite dense and not possible for me to exhaustively verify. The scientific significance of these findings is not communicated clearly, and the paper should include more head-to-head comparisons with baseline models.

Below I comment on the elements of the manuscript laid out in the reviewer guidelines.

ORIGINALITY + INNOVATION. The method seems original, but is not directly compared to previous methods on simulated or real data in a head-to-head manner. The authors argue that previous approaches "require multiple repeated trials to capture dynamics in correlational structure." But it isn't immediately clear why this is true, particularly since one of the baseline methods they mention is a state space model -- most state space models can be fit on unstructured time series data. I think at minimum there needs to be a section where the authors write down equations of prior models and explain why those models require multiple trials. It would be even better if the authors formulate some naive extensions of these existing models to the trial-free data and show how those naive extensions fail, whereas their approach succeeds. Currently, the paper is not self-contained, making it difficult for a reader to digest without first reading a long and niche sub-literature.

IMPORTANCE TO RESEARCHERS. The authors cite a number prior works that have developed similar statistical methodologies. The first paragraph of the introduction also mentions some motivations for the analysis from experimental neuroscience, but these are not really developed. Insights derived from experimental analysis could also be communicated more clearly -- for example, the authors observe changes in correlation structure associated with loss of consciousness, but it is not clear whether this could be used for a clinically relevant purpose or if simpler methods would not be sufficient for this application.

SIGNIFICANT BIOLOGICAL OR METHODOLOGICAL INSIGHT. As explained above I think the biological insights are weak and speculative. But there are clearly methodological insights and innovations in this paper.

RIGOROUS METHODOLOGY. The methodology is complex and clearly the authors have put a lot of thought into it. They verify that the method behaves as expected on simulated data. On the other hand, there are elements of the method that appear to be ad hoc or heuristic. For example, the authors threshold a subset of the mark space with a parameter (N_thr) on page 6. It is clear why this is necessary for computational reasons, but it is less clear how users should set this value in practice, particularly since the number of thresholded marks will change as a function of the length of the recording. Does this thresholding introduce bias into the confidence intervals or statistical tests?

Similarly, the window length W and forgetting factor beta seem like very important parameters that need to be tuned. The authors seem to have an intuition for how to pick these parameters, but it isn't spelled out clearly for the reader. For instance, on page 13 say they fix W to an intermediate value to trade off between "stable estimation... while still allow for fast changes." How should one quantify stable estimation? In Figure 3E, there is often flickering between red and blue, which would seem to be unstable predictions?

After fixing W, the authors perform a sweep over the forgetting factor beta to achieve "the most appropriate value." What exactly is being optimized here? It seems like if these parameters are chosen incorrectly it will lead to a loss of statistical power, while on the other hand if they are optimized to create low p-values it would inflate type-I errors. I unfortunately cannot read supporting information S1 Appendix which seems important to these issues. Was it uploaded?

SUBSTANTIAL EVIDENCE FOR CONCLUSIONS. The point of this paper is to develop a statistical methodology and not to develop a scientific theory or test specific hypotheses (as far as I can tell). So this point does not seem particularly applicable. However, as mentioned above under "originality + innovation" I would like to see more clear discussions and comparisons with existing statistical methods. Ideally the authors should show how their method outperforms others head-to-head on simulated datasets.

Reviewer #2: This work proposes a well-substantiated methodology to assess higher-order coordination in neural spiking activity, as well as a framework for accurate statistical inference to rule out occurrences of random simultaneous spiking events. The methodology is validated in simulated settings and applied to neural spike train recordings of human and rat cortical assemblies. The experimental results are interesting, revealing the onset of different higher-order coordination patterns distinguishing consciousness from anesthesia in the human data, and sleep state transitions in the animal data. The paper is accurately written, though resulting rather difficult to follow for non-expert readers especially in the methodological description. A better placing in the context of the existing literature and description of the dependence on crucial parameters are suggested.

Specific comments:

1) The proposed method is based on statistical model representations, which are contrasted to more general model-free approaches only briefly in the introduction. Nevertheless, an emerging line of research for the model-free analysis of multiple spike trains, stemming from the methodological and applicative works listed below [R1-R4], seems overlooked in the present paper. These works, showing the feasibility and usefulness of multivariate model-free analysis of causal (history-dependent) interactions and synchronization in spike trains, should be acknowledged, and compared – at least at the level of discussion – with the statistical models on which the present contribution is grounded.

[R1] Shorten, D. P., et al. (2021). Estimating transfer entropy in continuous time between neural spike trains or other event-based data. PLoS computational biology, 17(4), e1008054.

[R2] Mijatovic, G., et al. (2021). An information-theoretic framework to measure the dynamic interaction between neural spike trains. IEEE Transactions on Biomedical Engineering, 68(12), 3471-3481.

[R3] Shorten, D. P. et al. (2022). Early lock-in of structured and specialised information flows during neural development. Elife, 11, e74651.

[R4] Mijatovic, G. et al. (2022). Measuring the rate of information exchange in point-process data with application to cardiovascular variability. Frontiers in Network Physiology, 1, 765332.

2) Since the mathematics behind the derivations is a bit heavy, it should be complemented by a more intuitive description of the features of the proposed methodology, where its properties are presented in layman terms; from this viewpoint, improving Fig. 1 and accompanying it with descriptive text would be useful.

3) Analysis parameters such as the data length, the bin width, and the length of the past window considered for history-dependent formulation of the method are crucial aspects in approaches to neural synchrony based on binning the temporal axis. To better understand the performance of the proposed methodology, its dependence on these parameters, as well as on their interplay, should be tested and discussed.

**********

Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?

The PLOS Data policy requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.

Reviewer #1: Yes

Reviewer #2: Yes

**********

PLOS authors have the option to publish the peer review history of their article (what does this mean?). If published, this will include your full peer review and any attached files.

If you choose “no”, your identity will remain anonymous but your review may still be made public.

Do you want your identity to be public for this peer review? For information about this choice, including consent withdrawal, please see our Privacy Policy.

Reviewer #1: No

Reviewer #2: No

Figure Files:

While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, https://pacev2.apexcovantage.com. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at figures@plos.org.

Data Requirements:

Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5.

Reproducibility:

To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at https://plos.org/protocols?utm_medium=editorial-email&utm_source=authorletters&utm_campaign=protocols

10.1371/journal.pcbi.1011605.r002
Author response to Decision Letter 0
Submission Version1
5 Mar 2024

Attachment Submitted filename: MukherjeeBabadi_PLoSCompBiol_ReviewerResponses.pdf

10.1371/journal.pcbi.1011605.r003
Decision Letter 1
Bush Daniel Academic Editor
Marinazzo Daniele Section Editor
© 2024 Bush, Marinazzo
2024
Bush, Marinazzo
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.
Submission Version1
19 Mar 2024

Dear Prof. Babadi,

Thank you very much for submitting your manuscript "Adaptive modeling and inference of higher-order coordination in neuronal assemblies: a dynamic greedy estimation approach" for consideration at PLOS Computational Biology. As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. The reviewers appreciated the attention to an important topic. Based on the reviews, we are likely to accept this manuscript for publication, providing that you modify the manuscript according to the review recommendations.

Unfortunately, we have had to recruit an additional reviewer at this stage because one of the original referees was unable to assess the revised manuscript. Both this new reviewer and myself feel that a little more work is needed to demonstrate the practical utility of this new method - first, by making some direct comparisons with established and widely used methods based on PCA or ICA, for example; and second, demonstrating that the method can be applied to larger scale data sets consisting of tens or hundreds of simultaneously recorded neurons, as are increasingly common in contemporary neuroscience.

Please prepare and submit your revised manuscript within 30 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email.

When you are ready to resubmit, please upload the following:

[1] A letter containing a detailed list of your responses to all review comments, and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out

[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).

Important additional instructions are given below your reviewer comments.

Thank you again for your submission to our journal. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.

Sincerely,

Daniel Bush

Academic Editor

PLOS Computational Biology

Daniele Marinazzo

Section Editor

PLOS Computational Biology

***********************

A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact ploscompbiol@plos.org immediately:

Reviewer's Responses to Questions

Comments to the Authors:

Please note here if the review is uploaded as an attachment.

Reviewer #2: The paper has been revised addressing all the concerns raised. In this reviewer opinion the paper deserves acceptance.

Reviewer #3: In this manuscript, the authors introduce a methodological framework that employs a discretized marked point process model with adaptive estimation techniques and statistical inference procedures to analyze coordinate ensemble activity. While the sophistication of the method allows for a nuanced representation of neural interactions, its complexity raises concerns regarding overfitting, generalizability, and statistical power. Furthermore, the mathematical presentation is densely packed and lacks intuitive explanations, which may limit accessibility to a broader audience. The framework demands a significant time investment for comprehension, potentially obscuring statistical limitations and impacting interpretability. Although complexity may be necessary for the proposed goals, the study does not convincingly demonstrate this necessity.

The necessity of such a complex framework is questioned by comparing it to existing, simpler methods known for detecting high-order correlations and co-activity patterns, such as those based on PCA or ICA (Chapin and Nicolelis 1999, Laubach et al. 1999, Peyrache et al. 2009, Lopes-dos-Santos et al. 2013). These approaches offer better interpretability and are widely used despite assumptions of linearity, non-stationarity, and being memoryless. The authors point out that their method does not suffer from these limitations but have not shown through simulations that it would outperform these simpler methods in practice due to these limitations. This comparison is crucial for justifying the new approach's complexity and provides a benchmark for assessing the proposed method's incremental benefits, highlighting the importance of balancing sophistication with accessibility.

Furthermore, the authors present their methodological advancements through the analysis of two simulated datasets, which, while illustrative of the method's potential, limit the demonstration of its versatility and robustness across a broader spectrum of neural coordination patterns. The simulations do not explore variations in coordination dynamics such as differing time scales, the size of neuronal assemblies, or the presence of multiple coordinating assemblies. Moreover, the choice to simulate the activity of only five neurons raises concerns about the method's scalability and its ability to maintain statistical power when faced with the increased dimensionality typical of larger neuronal ensembles. This limitation gives the impression that the method may not be well-suited to handle the complexity of real-world neural data, where the number of neurons can be significantly larger, without succumbing to the curse of dimensionality. Addressing these concerns by incorporating a wider range of simulation scenarios and offering a detailed comparative analysis with established methods would significantly strengthen the manuscript, enhancing the credibility and perceived utility of the proposed methods within the neuroscience research community.

For the real data application, the proposed analytical methods to a brief 182-second sleep cycle, analyzing the activity of only ten neurons from each class (pE and pI), again raises concerns about the method's computational demands and scalability. This limited scope suggests that the method may be computationally intensive, potentially restricting its practicality for studies requiring long-term or large-scale neural recordings. Addressing the computational efficiency and scalability of the method is crucial, especially in neuroscience research where understanding complex neural networks often involves analyzing data from dozens to hundreds of neurons over longer periods. Without addressing these concerns, the method's potential impact and adoption within the neuroscience community could be significantly limited.

**********

Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?

The PLOS Data policy requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.

Reviewer #2: Yes

Reviewer #3: None

**********

PLOS authors have the option to publish the peer review history of their article (what does this mean?). If published, this will include your full peer review and any attached files.

If you choose “no”, your identity will remain anonymous but your review may still be made public.

Do you want your identity to be public for this peer review? For information about this choice, including consent withdrawal, please see our Privacy Policy.

Reviewer #2: No

Reviewer #3: No

Figure Files:

While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, https://pacev2.apexcovantage.com. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at figures@plos.org.

Data Requirements:

Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5.

Reproducibility:

To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at https://plos.org/protocols?utm_medium=editorial-email&utm_source=authorletters&utm_campaign=protocols

References:

Review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript.

If you need to cite a retracted article, indicate the article’s retracted status in the References list and also include a citation and full reference for the retraction notice.

10.1371/journal.pcbi.1011605.r004
Author response to Decision Letter 1
Submission Version2
17 May 2024

Attachment Submitted filename: MukherjeeBabadi_PLoSCompBiolR1_ReviewerResponses.pdf

10.1371/journal.pcbi.1011605.r005
Decision Letter 2
Marinazzo Daniele Section Editor
© 2024 Daniele Marinazzo
2024
Daniele Marinazzo
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.
Submission Version2
20 May 2024

Dear Prof. Babadi,

We are pleased to inform you that your manuscript 'Adaptive modeling and inference of higher-order coordination in neuronal assemblies: a dynamic greedy estimation approach' has been provisionally accepted for publication in PLOS Computational Biology.

Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.

Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.

IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.

Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.

Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. 

Best regards,

Daniele Marinazzo

Section Editor

PLOS Computational Biology

Daniele Marinazzo

Section Editor

PLOS Computational Biology

***********************************************************

10.1371/journal.pcbi.1011605.r006
Acceptance letter
Marinazzo Daniele Section Editor
© 2024 Daniele Marinazzo
2024
Daniele Marinazzo
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.
23 May 2024

PCOMPBIOL-D-23-01661R2

Adaptive modeling and inference of higher-order coordination in neuronal assemblies: a dynamic greedy estimation approach

Dear Dr Babadi,

I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.

The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript.

Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.

Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work!

With kind regards,

Lilla Horvath

PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom ploscompbiol@plos.org | Phone +44 (0) 1223-442824 | ploscompbiol.org | @PLOSCompBiol
==== Refs
References

1 Meister M , Wong RO , Baylor DA , Shatz CJ . Synchronous bursts of action potentials in ganglion cells of the developing mammalian retina. Science. 1991;252 (5008 ):939–943. doi: 10.1126/science.2035024 2035024
2 Schnitzer MJ , Meister M . Multineuronal Firing Patterns in the Signal from Eye to Brain. Neuron. 2003;37 (3 ):499–511. doi: 10.1016/S0896-6273(03)00004-7 12575956
3 Usrey WM , Reid RC . SYNCHRONOUS ACTIVITY IN THE VISUAL SYSTEM. Annual Review of Physiology. 1999;61 (1 ):435–456. doi: 10.1146/annurev.physiol.61.1.435 10099696
4 Wang HP , Spencer D , Fellous JM , Sejnowski TJ . Synchrony of Thalamocortical Inputs Maximizes Cortical Reliability. Science. 2010;328 (5974 ):106–109. doi: 10.1126/science.1183108 20360111
5 Usrey WM . The role of spike timing for thalamocortical processing. Current Opinion in Neurobiology. 2002;12 (4 ):411–417. doi: 10.1016/S0959-4388(02)00339-2 12139989
6 Salinas E , Sejnowski TJ . Correlated neuronal activity and the flow of neural information. Nature Reviews Neuroscience. 2001;2 . doi: 10.1038/35086012 11483997
7 Diesmann M , Gewaltig MO , Aertsen A . Stable propagations of synchronous spiking in cortical neural networks. Nature. 1999;402 . doi: 10.1038/990101 10591212
8 Rossant C , Leijon S , Magnusson AK , Brette R . Sensitivity of Noisy Neurons to Coincident Inputs. Journal of Neuroscience. 2011;31 (47 ):17193–17206. doi: 10.1523/JNEUROSCI.2482-11.2011 22114286
9 Moldakarimov S , Bazhenov M , Sejnowski TJ . Feedback stabilizes propagation of synchronous spiking in cortical neural networks. Proceedings of the National Academy of Sciences. 2015;112 (8 ):2545–2550. doi: 10.1073/pnas.1500643112 25675531
10 Tran MM , Prince LY , Gray D , Saad L , Chasiotis H , Kwag J , et al . Neocortical inhibitory interneuron subtypes display distinct responses to synchrony and rate of inputs. bioRxiv. 2019. doi: 10.1101/671248
11 Zielinski MC , Shin JD , Jadhav SP . Coherent Coding of Spatial Position Mediated by Theta Oscillations in the Hippocampus and Prefrontal Cortex. Journal of Neuroscience. 2019;39 (23 ):4550–4565. doi: 10.1523/JNEUROSCI.0106-19.2019 30940717
12 Boran E , Fedele T , Klaver P , Hilfiker P , Stieglitz L , Grunwald T , et al . Persistent hippocampal neural firing and hippocampal-cortical coupling predict verbal working memory load. Science Advances. 2019;5 (3 ). doi: 10.1126/sciadv.aav3687 30944858
13 Meshulam L , Gauthier JL , Brody CD , Tank DW , Bialek W . Collective Behavior of Place and Non-place Neurons in the Hippocampal Network. Neuron. 2017;96 (5 ):1178–1191.e4. doi: 10.1016/j.neuron.2017.10.027 29154129
14 Jutras MJ , Buffalo EA . Synchronous neural activity and memory formation. Current Opinion in Neurobiology. 2010;20 (2 ):150–155. doi: 10.1016/j.conb.2010.02.006 20303255
15 Zhou P , Burton SD , Snyder AC , Smith MA , Urban NN , Kass RE . Establishing a Statistical Link between Network Oscillations and Neural Synchrony. PLOS Comput Biol. 2015;11 (10 ):e1004549. doi: 10.1371/journal.pcbi.1004549 26465621
16 Denker M , Roux S , Lindén H , Diesmann M , Riehle A , Grün S . The Local Field Potential Reflects Surplus Spike Synchrony. Cerebral Cortex. 2011;21 (12 ):2681–2695. doi: 10.1093/cercor/bhr040 21508303
17 Schreiber S , Fellous JM , Whitmer D , Tiesinga P , Sejnowski TJ . A new correlation-based measure of spike timing reliability. Neurocomputing. 2003;52-54 :925–931. doi: 10.1016/S0925-2312(02)00838-X 20740049
18 Haas JS , White JA . Frequency Selectivity of Layer II Stellate Cells in the Medial Entorhinal Cortex. Journal of Neurophysiology. 2002;88 (5 ):2422–2429. doi: 10.1152/jn.00598.2002 12424283
19 Kreuz T , Haas JS , Morelli A , Abarbanel HDI , Politi A . Measuring spike train synchrony. Journal of Neuroscience Methods. 2007;165 (1 ):151–161. doi: 10.1016/j.jneumeth.2007.05.031 17628690
20 Shorten DP , Spinney RE , Lizier JT . Estimating Transfer Entropy in Continuous Time Between Neural Spike Trains or Other Event-Based Data. PLOS Computational Biology. 2021;17 (4 ):1–45. doi: 10.1371/journal.pcbi.1008054 33872296
21 Shorten DP , Priesemann V , Wibral M , Lizier JT . Early lock-in of structured and specialised information flows during neural development. eLife. 2022;11 :e74651. doi: 10.7554/eLife.74651 35286256
22 Mijatovic G , Antonacci Y , Loncar-Turukalo T , Minati L , Faes L . An Information-Theoretic Framework to Measure the Dynamic Interaction Between Neural Spike Trains. IEEE Transactions on Biomedical Engineering. 2021;68 (12 ):3471–3481. doi: 10.1109/TBME.2021.3073833 33872139
23 Mijatovic G , Pernice R , Perinelli A , Antonacci Y , Busacca A , Javorka M , et al . Measuring the Rate of Information Exchange in Point-Process Data With Application to Cardiovascular Variability. Frontiers in Network Physiology. 2022;1 . doi: 10.3389/fnetp.2021.765332 36925567
24 Truccolo W , Hochberg LR , Donoghue JP . Collective dynamics in human and monkey sensorimotor cortex: predicting single neuron spikes. Nature Neuroscience. 2010;13 :105–111. doi: 10.1038/nn.2455 19966837
25 Roudi Y , Dunn B , Hertz J . Multi-neuronal activity and functional connectivity in cell assemblies. Current Opinion in Neurobiology. 2015;32 :38–44. doi: 10.1016/j.conb.2014.10.011 25463563
26 ichi Amari S . Information geometry on hierarchy of probability distributions. IEEE Transactions on Information Theory. 2001;47 (5 ):1701–1711. doi: 10.1109/18.930911
27 Schneidman E , Berry MJ , Segev R , Bialek W . Weak pairwise correlations imply strongly correlated network states in a neural population. Nature. 2006;440 :1007–1012. doi: 10.1038/nature04701 16625187
28 Shimazaki H , ichi Amari S , Brown EN , Grun S . State-Space Analysis of Time-Varying Higher-Order Spike Correlation for Multiple Neural Spike Train Data. PLoS Comput Biol. 2012;8 (3 ):e1002385. doi: 10.1371/journal.pcbi.1002385 22412358
29 Gaudreault J, Saxena A, Shimazaki H. Online Estimation of Multiple Dynamic Graphs in Pattern Sequences. In: 2019 International Joint Conference on Neural Networks (IJCNN); 2019. p. 1–8.
30 Granot-Atedgi E , Tkačik G , Segev R , Schneidman E . Stimulus-dependent Maximum Entropy Models of Neural Population Codes. PLOS Comput Biol. 2013;9 (3 ):e1002922. doi: 10.1371/journal.pcbi.1002922 23516339
31 Ganmor E , Segev R , Schneidman E . Sparse low-order interaction network underlies a highly correlated and learnable neural population code. Proceedings of the National Academy of Sciences. 2011;108 (23 ):9679–9684. doi: 10.1073/pnas.1019641108 21602497
32 Donner C , Obermayer K , Shimazaki H . Approximate Inference for Time-Varying Interactions and Macroscopic Dynamics of Neural Populations. PLOS Comput Biol. 2017;13 (1 ):e1005309. doi: 10.1371/journal.pcbi.1005309 28095421
33 Pillow JW , Schlens J , Paninski L , Sher A , Litke AM , Chichilnisky EJ , et al . Spatio-temporal correlations and visual signalling in a complete neuronal population. Nature. 2008;454 :995–999. doi: 10.1038/nature07140 18650810
34 Truccolo W . From point process observations to collective neural dynamics: Nonlinear Hawkes process GLMs, low-dimensional dynamics and coarse graining. Journal of Physiology-Paris. 2016;110 (4 ):336–347. doi: 10.1016/j.jphysparis.2017.02.004 28336305
35 Sheikhattar A , Miran S , Liu J , Fritz JB , Shamma SA , Kanold PO , et al . Extracting neuronal functional network dynamics via adaptive Granger causality analysis. Proceedings of the National Academy of Sciences. 2018;115 (17 ):E3869–E3878. doi: 10.1073/pnas.1718154115 29632213
36 Kim S , Putrino D , Ghosh S , Brown EN . A Granger Causality Measure for Point Process Models of Ensemble Neural Spiking Activity. PLOS Computational Biology. 2011;7 (3 ):e1001110. doi: 10.1371/journal.pcbi.1001110 21455283
37 Daley DJ , Vere-Jones D . An Introduction to the Theory of Point Processes. vol. 1 . 2nd ed. New York, NY: Springer; 2003.
38 Ba D , Temereanca S , Brown EN . Algorithms for the analysis of ensemble neural spiking activity using simultaneous-event multivariate point-process models. Frontiers in Computational Neuroscience. 2014;8 (6 ). doi: 10.3389/fncom.2014.00006 24575001
39 Kass RE , Kelly RC , Loh WL . Assessment of synchrony in multiple neural spike trains using loglinear point process models. Ann Appl Stat. 2011;5 (2B ):1262–1292. doi: 10.1214/10-AOAS429 21837263
40 Kloosterman F , Layton SP , Chen Z , Wilson MA . Bayesian decoding using unsorted spikes in the rat hippocampus. Journal of Neurophysiology. 2014;111 (1 ):217–227. doi: 10.1152/jn.01046.2012 24089403
41 Deng X , Liu DF , Kay K , Frank LM , Eden UT . Clusterless Decoding of Position from Multiunit Activity Using a Marked Point Process Filter. Neural Computation. 2015;27 (7 ):1438–1460. doi: 10.1162/NECO_a_00744 25973549
42 Chapin JK , Nicolelis MAL . Principal component analysis of neuronal ensemble activity reveals multidimensional somatosensory representations. Journal of Neuroscience Methods. 1999;94 (1 ):121–140. doi: 10.1016/S0165-0270(99)00130-2 10638820
43 Laubach M , Shuler M , Nicolelis MAL . Independent component analyses for quantifying neuronal ensemble interactions. Journal of Neuroscience Methods. 1999;94 (1 ):141–154. doi: 10.1016/S0165-0270(99)00131-4 10638821
44 Peyrache A , Khamassi M , Benchenane K , Wiener SI , Battaglia FP . Replay of rule-learning related neural patterns in the prefrontal cortex during sleep. Nature Neuroscience. 2009;12 :919–926. doi: 10.1038/nn.2337 19483687
45 dos Santos VL , Ribeiro S , Tort ABL . Detecting cell assemblies in large neuronal populations. Journal of Neuroscience Methods. 2013;220 (2 ):149–166. doi: 10.1016/j.jneumeth.2013.04.010 23639919
46 Solo V. Likelihood functions for multivariate point processes with coincidences. In: Proceedings of IEEE Conference on Decision and Control. vol. 3; 2007. p. 4245—4250.
47 Haykin SS . Adaptive Filter Theory. Upper Saddle River, NJ: Prentice Hall; 1996.
48 Mukherjee S, Babadi B. Dynamic Analysis of Higher-Order Coordination in Neuronal Assemblies via De-Sparsified Orthogonal Matching Pursuit. In: Advances in Neural Information Processing Systems. vol. 34; 2021. p. 4120–4133.
49 Zhang T . Sparse Recovery With Orthogonal Matching Pursuit Under RIP. IEEE Transactions on Information Theory. 2011;57 (9 ):6215–6221. doi: 10.1109/TIT.2011.2162263
50 Kazemipour A , Wu M , Babadi B . Robust Estimation of Self-Exciting Generalized Linear Models With Application to Neuronal Modeling. IEEE Transactions on Signal Processing. 2017;65 (12 ):3733–3748. doi: 10.1109/TSP.2017.2690385
51 Litwin-Kumar A , Harris KD , Axel R , Sompolinsky H , Abbott LF . Optimal Degrees of Synaptic Connectivity. Neuron. 2017;93 (5 ):1153–1164.e7. doi: 10.1016/j.neuron.2017.01.030 28215558
52 Pfau D, Pnevmatikakis EA, Paninski L. Robust learning of low-dimensional dynamics from large neural ensembles. In: Advances in Neural Information Processing Systems. vol. 26. Curran Associates, Inc.; 2013.
53 Thomson AM , Bannister AP . Interlaminar Connections in the Neocortex. Cerebral Cortex. 2003;13 (1 ):5–14. doi: 10.1093/cercor/13.1.5 12466210
54 Wilks SS . The Large-Sample Distribution of the Likelihood Ratio for Testing Composite Hypotheses. Ann Math Statist. 1938;9 (1 ):60–62. doi: 10.1214/aoms/1177732360
55 Wald A . Tests of Statistical Hypotheses Concerning Several Parameters When the Number of Observations is Large. Transactions of the American Mathematical Society. 1943;54 (3 ):426–482. doi: 10.1090/S0002-9947-1943-0012401-3
56 van de Geer S , Buhlmann P , Ritov Y , Dezeure R . On asymptotically optimal confidence regions and tests for high-dimensional models. Ann Statist. 2014;42 (3 ):1166–1202. doi: 10.1214/14-AOS1221
57 Sheikhattar A , Fritz JB , Shamma SA , Babadi B . Recursive Sparse Point Process Regression With Application to Spectrotemporal Receptive Field Plasticity Analysis. IEEE Transactions on Signal Processing. 2016;64 (8 ):2026–2039. doi: 10.1109/TSP.2015.2512560
58 Martínez-Cañada P , Ness TV , Einevoll GT , Fellin T , Panzeri S . Computation of the electroencephalogram (EEG) from network models of point neurons. PLOS Computational Biology. 2021;17 (4 ):1–41. doi: 10.1371/journal.pcbi.1008893 33798190
59 Lewis LD , Weiner VS , Mukamel EA , Donoghue JA , Eskandar EN , Madsen JR , et al . Rapid fragmentation of neuronal networks at the onset of propofol-induced unconsciousness. Proceedings of the National Academy of Sciences. 2012;109 (49 ):E3377–E3386. doi: 10.1073/pnas.1210907109 23129622
60 Brown EN , Lydic R , Schiff ND . General Anesthesia, Sleep, and Coma. New England Journal of Medicine. 2010;363 (27 ):2638–2650. doi: 10.1056/NEJMra0808281 21190458
61 Ching S , Cimenser A , Purdon PL , Brown EN , Kopell NJ . Thalamocortical model for a propofol-induced alpha-rhythm associated with loss of consciousness. Proceedings of the National Academy of Sciences. 2010;107 (52 ):22665–22670. doi: 10.1073/pnas.1017069108 21149695
62 Ching S , Brown EN . Modeling the dynamical effects of anesthesia on brain circuits. Current Opinion in Neurobiology. 2014;25 :116–122. doi: 10.1016/j.conb.2013.12.011 24457211
63 Flores FJ , Hartnack KE , Fath AB , Kim SE , Wilson MA , Brown EN , et al . Thalamocortical synchronization during induction and emergence from propofol-induced unconsciousness. Proceedings of the National Academy of Sciences. 2017;114 (32 ):E6660–E6668. doi: 10.1073/pnas.1700148114 28743752
64 Watson BO , Levenstein D , Greene JP , Gelinas JN , Buzsáki G . Network Homeostasis and State Dynamics of Neocortical Sleep. Neuron. 2016;90 (4 ):839–852. doi: 10.1016/j.neuron.2016.03.036 27133462
65 Watson BO, Levenstein D, Greene JP, Gelinas JN, Buzsáki G. Multi-unit spiking activity recorded from rat frontal cortex (brain regions mPFC, OFC, ACC, and M2) during wake-sleep episode wherein at least 7 minutes of wake are followed by 20 minutes of sleep. CRCNSorg. 2016; 10.6080/K02N506Q.
66 Gervasoni D , Lin SC , Ribeiro S , Soares ES , Pantoja J , Nicolelis MAL . Global Forebrain Dynamics Predict Rat Behavioral States and Their Transitions. Journal of Neuroscience. 2004;24 (49 ):11137–11147. doi: 10.1523/JNEUROSCI.3524-04.2004 15590930
67 Grosmark AD , Mizuseki K , Pastalkova E , Diba K , Buzsáki G . REM Sleep Reorganizes Hippocampal Excitability. Neuron. 2012;75 (6 ):1001–1007. doi: 10.1016/j.neuron.2012.08.015 22998869
68 Niethard N , Hasegawa M , Itokazu T , Oyanedel CN , Born J , Sato TR . Sleep-Stage-Specific Regulation of Cortical Excitation and Inhibition. Current Biology. 2016;26 (20 ):2739–2749. doi: 10.1016/j.cub.2016.08.035 27693142
69 Emrick JJ , Gross BA , Riley BT , Poe GR . Different Simultaneous Sleep States in the Hippocampus and Neocortex. Sleep. 2016;39 (12 ):2201–2209. doi: 10.5665/sleep.6326 27748240
70 Durán E , Oyanedel CN , Niethard N , Inostroza M , Born J . Sleep stage dynamics in neocortex and hippocampus. Sleep. 2018;41 (6 ). 29893972
