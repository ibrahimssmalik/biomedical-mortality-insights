
==== Front
bioRxiv
BIORXIV
bioRxiv
2692-8205
Cold Spring Harbor Laboratory

38895414
10.1101/2024.06.05.597468
preprint
2
Article
Inhibitory circuits generate rhythms for leg movements during Drosophila grooming
http://orcid.org/0000-0002-5729-0382
Syed Durafshan Sakeena 1*
http://orcid.org/0000-0001-7769-8687
Ravbar Primoz 1
http://orcid.org/0000-0002-6793-7100
Simpson Julie H. 12*
1 Neuroscience Research Institute and Department of Molecular, Cellular and Developmental Biology, University of California, Santa Barbara, Santa Barbara, CA, USA
2 Lead Contact
* Correspondence: dsakeena@gmail.com (D.S.S.), jhsimpson@ucsb.edu (J.H.S.)
14 8 2024
2024.06.05.597468https://creativecommons.org/licenses/by-nd/4.0/ This work is licensed under a Creative Commons Attribution-NoDerivatives 4.0 International License, which allows reusers to copy and distribute the material in any medium or format in unadapted form only, and only so long as attribution is given to the creator. The license allows for commercial use.
nihpp-2024.06.05.597468.pdf
Limbs execute diverse actions coordinated by the nervous system through multiple motor programs. The basic architecture of motor neurons that activate muscles that articulate joints for antagonistic flexion and extension movements is conserved from flies to vertebrates. While excitatory premotor circuits are expected to establish sets of leg motor neurons that work together, our study uncovered a new instructive role for inhibitory circuits: their ability to generate rhythmic leg movements. Using electron microscopy data for the Drosophila nerve cord, we categorized ~120 GABAergic inhibitory neurons from the 13A and 13B hemi-lineages into classes based on similarities in morphology and connectivity. By mapping their synaptic partners, we uncovered pathways for inhibiting specific groups of motor neurons, disinhibiting antagonistic counterparts, and inducing alternation between flexion and extension. We tested the function of specific inhibitory neurons through optogenetic activation and silencing, using an in-depth ethological analysis of leg movements during grooming. We combined anatomy and behavior analysis findings to construct a computational model that can reproduce major aspects of the observed behavior, confirming the sufficiency of these premotor inhibitory circuits to generate rhythms.

inhibition
motor control
rhythm
premotor
GABA
muscle synergy
limb coordination
connectome
==== Body
pmcINTRODUCTION

With the limited set of muscles in a limb, a nervous system produces multiple flexible actions to generate behavior. Movements are controlled by a balance of inhibition and excitation, but the exact circuitry remains unknown. Drosophila grooming behavior involves coordinated, rhythmic movements of the legs to sweep the body and rub off debris1. Different cleaning actions occur sequentially in priority order. While sensory, command-like, and motor neurons have been identified as components of the neural circuits controlling grooming behavior2–8, the contribution of GABAergic inhibitory neurons has not been systematically investigated. We hypothesize that these neurons may contribute to limb coordination or the appropriate selection of cleaning subroutines.

Leg movements during grooming require precise coordination of flexors and extensors, controlled by motor neurons and premotor circuits. Flies move their legs using 14 intrinsic muscles and 3–5 body wall muscles9–11, organized into flexors and extensors that typically work as antagonistic pairs. Around 70 excitatory glutamatergic motor neurons innervate those muscles in a largely one-to-one manner11–15. Recent connectomics work has mapped premotor circuits of interneurons in the ventral cord neuromeres associated with each leg16,17. Around 60% of premotor connections originate from local interneurons in the ventral nerve cord (VNC)16, suggesting complex control architecture.

We focus on the potential role of inhibitory neurons in coordinating which leg muscles work together or antagonistically, and how they might produce rhythmic alternations. Neurons originating from a given lineage typically share a common neurotransmitter, with 12 GABAergic hemi-lineages present in the VNC18. We identified GABAergic 13A and 13B hemi-lineages in a behavioral screen for grooming defects. Approximately 67±6 13A neurons and 47±1 13B neurons have been reported per hemisegment18,19. While the activation of all 13B neurons induces leg extensions19, further investigation is required to understand the specific role of different subsets in leg coordination. The behavioral contributions of 13A neurons have been unclear due to the lack of exclusive genetic labeling.

Some shared components are expected between grooming and walking, since both behaviors employ flexion-extension alternation across leg joints. Motor neurons controlling similar muscles within a joint receive similar premotor inputs16. Furthermore, analysis of the descending neuron to motor pathway identified interactions between various premotor GABAergic neurons and between glutamatergic neurons from multiple lineages, which are hypothesized to be involved in limb coordination during walking17. These central circuits also receive sensory feedback from proprioceptors in the leg20–23. Recent connectome mapping and genetic tools to manipulate specific neurons have opened up the possibility to test the role of the central and peripheral signals in limb coordination.

Muscle synergies describe groups of co-activated muscles working together to execute specific movements. Similarly, motor primitives are elemental movement patterns that serve as building blocks of motor behavior24–25. Micro-stimulation of specific spinal cord regions in vertebrate models induced coordinated muscle contractions, suggesting that local circuits control distinct motor outputs26–32. Co-stimulation of two sites resulted in combinations of muscle contractions, indicating how coordinated regulation by premotor circuits can simplify assembly of more complex movements25,32–35. Additional evidence that groups of muscles are co-activated comes from electromyography, kinematic analysis, neural recordings and computational modeling36–50.

Synergistic neural control of groups of muscles that frequently work together has been proposed to simplify the computational burden during repetitive movements such as grooming or walking. In the vertebrate spinal cord, the neural circuits responsible for the coordinated activation of muscles controlling multiple joints within a limb have been primarily described in terms of excitation. In this study, we use the concept of muscle synergies to behaviorally explore how insects coordinate leg movements during grooming and to search anatomically for the neural circuits that can produce co-activation of muscle groups.

We find that inhibitory neurons target different groups of motor neurons, providing an alternative way to construct muscle synergies. We demonstrate that normal activity of these inhibitory neurons is required for the rhythmic, coordinated leg flexion and extension during grooming. This organization mirrors vertebrate spinal cord architecture, including motor pools, specified neural types, and spatial maps for motor control, with distinct populations of excitatory and inhibitory neurons regulating limb coordination during locomotion in a speed-dependent manner13,14,51–63. Disrupting inhibitory receptors on motor neurons in flies reduces locomotion speed64, although the specific inhibitory neurons involved in behavior remain unidentified. Here, by studying the limb kinematics in grooming flies and silencing the activity of specific 13A and 13B neurons, we demonstrate their necessity for various spatial and temporal aspects of limb coordination during grooming. Overall, our findings reveal that inhibitory neurons contribute to premotor circuit motifs governing coordinated limb movement during grooming in Drosophila. We suggest that inhibitory circuits may also play a role in other rhythmic limb movements in flies and that similar connectivity motifs may sculpt alternative groups of co-regulated motor neurons in spinal cord circuits as well.

RESULTS

We describe how inhibitory 13A and 13B neurons affect grooming behavior. Then, we categorize the inhibitory neurons based on similarities in their morphology and map the connectivity patterns of these neurons. This is followed by presenting behavioral evidence for muscle synergies and the role of 13A/B neurons in coordinating rhythmic limb movements. Finally, we generate a computational model to integrate and simulate our findings.

Inhibitory Interneurons in 13A and 13B Hemi-Lineages Affect Grooming Behavior

Global disruption of inhibitory neuron activity leads to death, and few escapers have severe motor defects. Optogenetic silencing or activation of many neurons in the 13A and B hemi-lineages results in reduced grooming behavior and poor leg coordination, while broad acute activation causes freezing. Activating smaller subsets (six 13A and six 13B neurons) produces static over-extension of the front legs in both intact and headless flies (Figures 1D, 1F and 1F’, Video S1). Conversely, silencing these neurons results in front leg being locked in flexion in both clean and dust-covered flies (Figures 1E and 1E’, Video S1). Thus, activation or silencing of inhibitory neurons interferes with the alternation of flexion and extension required for dust removal and reduces grooming.

Anatomical Categorization of 13A and 13B Inhibitory Neurons Into Cell Types

The Drosophila nervous system develops from neural stem cells called neuroblasts, which produce two hemi-lineages. Neurons in a hemi-lineage typically share a common neurotransmitter18. Here, we focus on the 13A and 13B hemi-lineages, as manipulating their activity affects grooming behavior. We identified 62 13A neurons and 64 13B neurons in the right front leg neuromere (T1R) using the serial section electron microscopy (EM) dataset of the VNC15 based on their cell body positions, arborization, and where their axons enter the VNC. VNC lineages are born from the neuroblasts that divide briefly embryonically to produce primary neurons and post-embryonically to produce a large subset of secondary neurons18,19,65–64. The cell bodies of neurons within a hemilineage cluster together and collectively project their innervations as a bundle into the VNC neuropil19,70. We observed that upon entering the neuropil, the 13A bundle divided into three sub-bundles, containing five neurons with the largest cell bodies and extensive arbors within the entire hemilineage (Figures 2A1–2A3, S2I5–S2I8, S2E1). These neurons were predominantly (4/5) located in the ventral most first sub-bundle on the right hemisegment. Based on their size, location, and connections, we hypothesized that these neurons could be early-born neurons within the 13A hemilineage. Therefore, we refer to them as primary 13A neurons. We identified the same five primary neurons in the left hemisegment distributed across the three sub-bundles.

Lineages can contain several types of neurons with different shapes and functions. We used NBLAST71, a computational tool that clusters neurons based on similarities in their morphology, to categorize neurons within the 13A and 13B hemi-lineages into cell types. We subdivided 13A and 13B neurons into 10 distinct clusters based on the similarity scores obtained from Ward’s hierarchical clustering (Figures 2B and S1), we named distinct 13A and 13B neurons according to these anatomical clusters. Our initial clustering analysis used 13A neurons in the right front leg neuromere (T1R). Comparison to a similar set on the left15 show similar numbers of neurons and cluster divisions (Figure S3).

Spatial Mapping and Connectivity Patterns of Premotor 13A Neurons in Leg Motor Control

Neurons can also be clustered based on their connectivity patterns, where neurons that receive or make synapses with common partners are grouped together. Using automatic synapse detection algorithms11, we investigated the connectivity of all 13A neurons. While 13A neurons have many post-synaptic partners, their primary targets are motor neurons (MNs) (Figures S4 and S5). Our connectivity analysis shows that each 13A neuron cluster connects to distinct sets of MNs. When we used MN connections as a basis for clustering 13A neurons, we observed a correlation with the morphological clusters obtained through NBLAST (Figures 3 and S2). We evaluated the goodness of 13A clustering using a cosine similarity matrix representing the pairwise similarities between 13A neurons based on their downstream MN connections and found that 13A clusters based on neuronal morphology and common MN connectivity are similar (Figure 3D). Thus, 13A neurons within the morphological cluster connect to distinct groups of MNs. This indicates that a spatial map of 13A neurons exists that correlates with their premotor function.

Several anatomical features of the 13A cell types stand out and suggest their functional organization. The dendritic branches of neurons within an inhibitory type occupy a limited region of the leg neuropil, indicating that they may receive input from common pre-synaptic neurons. The axons of 13A neurons overlap with the dendrites of downstream leg MNs. MNs also have a spatial segregation of dendrites based on the leg muscles they innervate, forming a myotopic map13,14. Thus, the neurites of inhibitory 13A neurons form a spatial map in the leg neuropil of the VNC that overlaps with that of downstream motor neuron dendrites.

Examining the projections and synaptic connectivity of different 13A neurons shows that some inhibit multiple motor neurons across various leg segments while others target only a few. We classify these as ‘generalists’ and ‘specialists’ based on how we predict they will affect leg movements.

We also propose that the more broadly projecting primary neurons are generalists, born earlier in development, while the specialists are mostly later-born secondary neurons. Four primary 13A neurons (13A-10f-α, −9d-γ, −10g-β, and −10e-δ) are generalists. While all strongly connect to flexor MNs of the medial (femur-tibia) joint, they exert differential effects on proximal (body wall—coxa, coxa—trochanter) and distal (tibia—tarsus) joint. Specifically, three primary 13As inhibit extensor MNs of the proximal joint and flexor MNs of both the medial and distal joints (Figures 3C, S2I5–S2I7 and S2I9). 13A-10g-β inhibits flexor MNs of both proximal and distal joints (Figures 3C, S2I8 and S2I9).

Among secondary 13A neurons, cluster 1, 2, 4, 5, and 7 neurons are specialists, whereas cluster 6, 8 and 10 act as generalists. Cluster 3 and 9 neurons include a combination of specialists and generalists. While morphological and functional clusters generally align, exceptions include cluster 9 neurons and the 13A-3g neuron within cluster 3 that have diverse connections (Figures 3C, 3D and S2B6, S2H1–S2H9).

From our connectivity analysis, we propose that inhibitory neurons that target a set of motor neurons across multiple leg segments create a synergy or group of muscles that will be affected together. We see inhibitory neurons that affect flexor muscles at multiple joints, potentially enabling coordinated movements of the whole leg.

Connectivity Motifs for Coordinated Control

Here, we focused on the connectivity pattern of the 13A/B neurons that control the flexors and extensors of the medial joint (Figure 4). Connections between types of 13A neurons suggest that they work together to generate flexor-extensor antagonism. Specifically, 13A neurons that synapse onto extensor MNs also inhibit 13A neurons that target flexors, and vice versa. Thus, these 13A neurons promote flexion or extension through two different pathways. This form of dual control circuits is widespread.

Grooming actions involve oscillations of antagonistic motion, wherein opposing muscle groups within the leg joints alternate their extension and flexion. Reciprocal inhibitory connections between two groups of 13A neurons that connect to antagonistic MNs (Figures 4A5, 4B) could potentially trigger alternations between flexion and extension of the medial joint. Additionally, reciprocal inhibitory connections between generalist 13A neurons that connect to antagonistic MNs across multiple leg segments could potentially trigger alternations between multiple joints within a leg in synergy (Figure 4C).

13B neurons also inhibit 13A neurons that synapse onto either flexor MNs or extensor MNs (Figures S7B and S6). Two of the 13B neurons that inhibit 13A neurons synapsing onto flexor MNs also directly inhibit extensor MNs. Thus, these specific 13B neurons also have a dual role: inhibiting tibia extensor MNs and disinhibiting flexor MNs. Twentyfour 13B neurons that belong to clusters 1 to 4 inhibit 13A neurons. While we found no correlation between morphology of premotor 13B neurons and motor connections, distinct morphological clusters of 13B neurons contribute to disinhibition pathways (Figures S1 and S7B).

Examining the interconnections between 13A and 13B neurons, we found additional inhibitory motifs that could mediate movement of other joints or multiple joints together. 13B neurons disinhibit MNs by inhibiting premotor 13Bs or 13As. For example, 13B-4h connects to 13B-2i, a generalist premotor neuron that inhibits proximal joint flexor MNs and medial extensor MNs (Figures S7A, S7E, S7F). 13B-2i also disinhibits proximal extensor MNs and medial flexor MNs by connecting to specific 13A neurons (Figures 4B and S7B). Thus, 13B-4h disinhibits proximal joint flexor MNs and medial extensor MNs and prevents the 13B-2i mediated disinhibition of proximal joint extensor MNs and medial flexors MNs.

13A neurons also disinhibit antagonistic MNs by inhibiting premotor 13B neurons. For example, primary 13A-10g-β neuron connects to 16 13B neurons (Figures S7A, S7D). Six of these postsynaptic 13B neurons are premotor neurons inhibiting proximal joint extensor MNs (Figure S7F). 13A-10g-β, a premotor neuron, inhibits proximal and medial flexion, thereby disinhibiting proximal joint extensor MNs while inhibiting proximal and medial flexor MNs.

Together, interconnections among 13A and 13B neurons orchestrate the inhibition of specific muscles, prevent their disinhibition, and facilitate the activation of antagonistic muscles via disinhibition. Reciprocal connections between these neurons could play a crucial role in generating diverse leg movements through alternation.

Proprioceptive Neurons Make Feedback Connections With 13A Neurons

We investigated presynaptic connections to the primary 13A neurons and identified proprioceptive neurons that provide sensory feedback about leg position. Claw neurons sense the leg position during extension or flexion and hook neurons detect movement direction72–74.

We examined the reconstruction of proprioceptive neurons15 and found many connections onto the main neurite of 13A-10f-α neuron. This neuron inhibits the main tibia flexor MNs and receives feedback from claw and hook flexion sensing neurons (Figures 4C and S8). Similar feedback exists from flexor proprioceptors onto other flexor inhibitors (13A-10e-δ and −9d-γ). Thus, flexion position-sensing proprioceptors activate 13As that inhibit medial joint flexion. Recent connectomics analysis showed that flexion sensing proprioceptors send direct excitatory feedback to tibia extensor MNs and indirect inhibitory feedback to tibia flexor MNs23. Together, flexion sensing proprioceptors directly activate the extensor MNs, and inhibit the tibia flexor MNs by activating primary 13A neurons. This connectivity suggests that their function may be to induce a switch from flexion to extension.

Claw extension sensing neurons connect to two 13A neurons that inhibit tibia extensor MNs. These neurons also directly connect to tibia flexor MNs23. Together, extension sensing proprioceptors activate flexor MNs and 13A neurons that inhibit extensor MNs, possibly inducing a switch from extension to flexion. Since these two groups of 13A neurons, which receive feedback from proprioceptive neurons, also reciprocally inhibit each other, their activation could induce flexion-extension alternation.

Behavioral Evidence for Muscle Synergies During Grooming

Flies covered in dust use a pair of legs to perform precise grooming actions, involving repeating patterns of body sweeps and leg rubs1,2. Grooming behavior requires whole leg movements and quantification of these movements using machine vision methods (DeepLabCut)75 allows tracking of joint positions over time. This quantification shows correlated changes in angular velocity across multiple joints within a leg. The proximal and medial joints of a leg predominantly move synchronously during leg rubbing, but occasionally show asynchronous movement during head sweeps (Figure 5A). The leg segments move together during grooming, indicating the existence of muscle synergies, and the connectivity of the generalist premotor interneurons further suggests that they are the neural implementation of these synergies.

Behavioral Contributions of Inhibitory 13A Neurons to Limb Coordination During Grooming

Half of the 13A population expresses a transcriptional factor, Dbx18. Activation of all Dbx-positive neurons resulted in death, or freezing in a few escapers. While it would be ideal to silence single cell types, we are limited by available genetic targeting reagents. We generated split GAL4 combinations, including intersections with a GAD line that labels GABAergic neurons and one based on the expression of the Dbx transcription factor that marks some members of the 13A hemi-lineage, to manipulate a subset of six 13A neurons.

Combined together, these inhibitory 13A neurons presynaptically target various MNs, including proximal extensor MNs (Sternotrochanter extensor, tergotrochanter, tergoplural promotor body wall muscles, and trochanter extensor MNs), medial joint controlling tibia extensor MNs, tibia flexor MNs, auxiliary tibia flexor MN, and a tarsus extensor MN (Figures S9A1–S9A3). Based on the connectivity, we hypothesized that since these 13A neurons inhibit proximal extensor MNs and disinhibit the flexor MNs, activating them might lead to decreased extension, thus altering joint positions and inter-joint distances. Similarly, silencing these neurons could increase extension of the proximal joint and increased flexion.

Silencing or activating six 13A neurons reduced the total grooming time, but the detailed analysis of leg movements revealed defects in joint positions (S9G’, S9H’). Proximal joints enable femur movement, which in turn determines the position of the femur-tibia joint. The distance between femur-tibia joints of the right and the left leg (referred as proximal inter-leg distance here) decreased upon 13A activation and increased upon 13A neuron silencing (Figures 5D and 5E), consistent with predictions.

Flies covered in dust initiate rhythmic leg movements, prompting us to explore the role of 13A neurons in influencing the temporal dynamics. Grooming frequency is the rate of extension/flexion cycles per second (Hz). Higher frequencies indicate a higher rate of alternations between leg movements, while lower frequencies suggest slower alternations. Silencing or activation of these 13A neurons in dust-covered flies resulted in decreased median frequency, indicating a slower or less synchronized pattern of leg movements following the manipulation (Figures 5H, 5I). Moreover, increased variability was observed with the wider interquartile interval, suggesting that the leg movements show greater inconsistency or diversity in their rates of flexion/extension cycles. It could indicate disruptions in the coordination or regulation of grooming behavior due to the 13A activity manipulation, leading to more erratic or unpredictable patterns of movement.

Silencing or continuous activating six 13A neurons decreased the duration of the head sweeping bouts (Figures S9B, S9C), indicating that these neurons are required for maintaining the normal bout duration of grooming actions. Silencing 13A neurons also slightly decreased the maximum angular velocities across all joints during head sweeps, while increasing them during leg rubs. Activating these 13A neurons decreased the maximum angular velocity of the medial joint and increased maximum angular velocity of the medial and distal joints (Figures S9D, S9E, data not shown), indicating a role in modulating the speed and coordination of leg movements during grooming.

For comparison, we examined the effect of continuous activation of six 13A neurons on walking in these flies. While maximum angular velocity of leg joints or frequency remained unaffected during walking in dust-covered flies, walking speed or body velocity reduced (Figure S9K).

Furthermore, we also optogenetically manipulated activity of two Dbx-positive 13A neurons in dusted flies and observed effects on leg coordination during grooming (Figure S10). Defects in joint positions, decreased median frequency and maximum angular velocity were observed upon silencing two 13A neurons. Defects in joint positions and increased maximum angular velocity of the distal joints was observed upon continuous 13A activation. Thus, Dbx-positive 13A neurons regulate both spatial and temporal aspects of leg coordination during grooming.

Behavioral Contributions of Inhibitory 13B Neurons to Limb Coordination During Grooming

Our behavior experiments demonstrated that silencing or activating 13A and/or 13B neurons reduced grooming. Connectome data revealed disinhibition of motor pools via 13B neurons. We selectively inactivated three 13B neurons (Figures 5C and S11), which inhibit a primary 13A neuron (13A-9d-γ) that connects to proximal extensor MNs and medial joint flexor MNs. Thus, 13B neurons will disinhibit these MNs (Figure S11C). One of these 13B neurons is premotor and inhibits a proximal extensor MN and a tibia extensor MN. Together, these 13B neurons disinhibit proximal extensor MNs and medial flexor MNs while inhibiting medial extensor MNs.

Silencing or activating these three 13B neurons resulted in joint position defects (Figure S11D’, S11E’) during grooming in dust-covered flies. Proximal inter-leg distance decreased upon silencing of 13B neurons (Figure 5F), similar to effect of 13A activation (Figure 5D). However, continuous activation of 13B neurons also reduced proximal inter-leg distance. This may be because proximal joint angle in one leg decreased while the other leg remained unaffected upon 13B activation. We noticed a differential effect on left-right coordination upon 13B activation, but this aspect was not explored further in this study.

Moreover, manipulating the activity of 13B neurons also affected temporal features of grooming actions. Optogenetic silencing of 13B neurons resulted in a large decrease in the median frequencies of all joints (Figure 5J), while as activation slightly reduced the median frequency and increased variability (Figure 5K).

Silencing or continuous activation of 13B neurons decreased the duration of bouts of head sweeps and leg rubs in dust-covered flies (Figures S11F, S11G). Silencing 13B neurons also increased maximum angular velocity during head sweeps and decreased it during leg rubs. Continuous activation resulted in a decrease in the maximum angular velocity of the proximal joint and an increase in the medial joints during head sweeps (data not shown).

Together, 13A and 13B neurons contribute to both spatial and temporal aspects of leg coordination during grooming.

Inhibitory Neurons Induce Rhythmic Leg Movements

Connectome analysis of multiple GABAergic 13B and 13A neurons shows that they often synapse onto 13A premotor neurons. Thus, activation of these 13B neurons or presynaptic 13A neurons should inhibit postsynaptic 13A neurons, releasing activity in motor neurons and promoting movement. Indeed, optogenetic activation of some 13A and 13B neurons can induce grooming movements. The timing of optogenetic activation of 13A neurons can influence the frequency of the rhythmic grooming movements. The anterior grooming actions in dust-covered flies are rhythmic where leg rubbing and body sweeps typically occur at a median frequency of around 7–8 Hz. One complete extension and flexion cycle, representing one sweep or leg rub, lasts ~140 ms, with 70ms extension and 70ms flexion phases (Figures 6B and 6B’).

Silencing six 13A neurons in dust-covered flies affected both spatial and temporal features of grooming, indicating the necessity of these neurons in producing grooming actions. Based on the connectivity analysis, there are specific 13A neurons that would be tuned to induce extension and others that induce flexion, and reciprocal inhibition between the two could generate rhythm. We hypothesize that given 13A neurons should be activated for 70ms and silenced for 70ms to produce grooming actions.

To test our hypothesis, we optogenetically activated these six 13A neurons using light pulses with a duration of 70 ms on and 70 ms off, in order to mimic flexion-extension cycle, in clean flies. This indeed induced grooming (anterior and posterior) and walking (Figures 6C–6F, Video S4). We tried other pulse frequencies and could alter the cycle duration timing (data not shown). This experimental evidence supports the hypothesis that 13A neurons are capable of generating rhythmic movements, further reinforcing their role in coordinating grooming behavior.

A Computational Model of Inhibitory Circuits in Coordinating Grooming Actions

The inhibitory circuits connecting to the leg motor neurons are quite complex and the genetic reagents to target individual components for functional perturbation tests are limited, so figuring out how specific inhibitory neurons contribute to leg coordination in grooming experimentally is a challenge. We developed a neural computational model based on the real anatomical connectivity to explore potential functions of circuit components. We modeled groups of functionally related neurons. For example, the 13As that are inhibiting each other represent the two groups modeled as the two nodes – Figure 7A shows such a circuit for a single joint. This approach is loosely inspired by Jovanic et al., 201676. Since we are not modeling individual neurons, the network does not involve spiking neurons but rather “rate based” units. The “synaptic weights” of the model network correspond to the number of synapses obtained empirically from the connectome (Figure 7A).

The neural network controls the movements of two virtual front legs of an agent, where each leg is simplified to a 2D configuration of three segments. A pair of antagonistic “muscles” controls each of the three “joint” angles on each leg. These pairs of muscles determine the angular velocities of each “joint” (proximal, medial, and distal). Thus each leg receives inputs from six virtual motor neurons. These MNs, in turn, receive descending excitatory inputs (discussed below), and inputs from the inhibitory two 13A nodes (one inhibits the MNs of flexors and the other those of extensors). The states of the muscles (amounts of extension or flexion) are sensed by sensory neurons (SNs) that provide feedback to the 13As and to the MNs. As the legs move, the most distal “joint” removes the virtual dust (Figure 7I). The legs must also spend some time in proximity to each other to remove the “dust” from themselves. (This constraint forces the legs to sporadically coordinate with each other – as in “leg rubbing” behavior.)

The excitatory input to the model circuit is a function of the distribution of “dust” remaining on the “body” - the environment (the green areas in Figure 7I). The response to this environment is produced by a linear recurrent neural network (RNN) that transforms the distribution of the “dust” into excitatory inputs for the 13A network. This simple RNN is a “black box” used to provide the 13A circuits with excitatory sensory inputs so that the agent can respond to the changing environment (to the distribution of “dust”). But the 13A circuitry can still produce rhythmic behavior even without those external sensory inputs (when set to a constant value). (See Methods for a more detailed model description, including constraints.)

The exact numbers of synapses, obtained empirically, were used as proxies for the synaptic weights in the model circuit. The model neurons either reach the ceiling values or zero. In order to study the contribution of the 13A circuits to the grooming behavior implemented the model with a Central Pattern Generator (CPG) component to produce a periodic baseline activity. We could have used a periodic excitatory input, for example. However, the 13A circuits could potentially produce periodic behavior by themselves. To explore this possibility of de novo emergent periodic behavior, we varied the model’s parameters around their empirically obtained values. We form these estimates because our empirically derived weights are not exactly represented by the parameters (weights) of the modeled network (a number of actual anatomical synapses projecting to a neuron is abstracted to a single weight of the modeled synapse). We also added 13B nodes, as shown in Figure 7A. The nodes receive inputs from the same ‘black box’ as the 13As.

For this reason, we fine-tune the parameters (the model’s weights), subject to constraints based on the empirical values: the signs of the fine-tuned weights must remain the same as the empirical synapses (i.e. inhibitory neurons must remain inhibitory), and their magnitudes must be at least 80% of the empirical ones. The fine-tuning procedure is accomplished by genetic algorithms library PyGAD (https://pygad.readthedocs.io/en/latest/index.html). The fitness function is defined as the total amount of virtual dust that the model agent removes across several episodes of grooming. The fine-tuned weight matrices and the original ones are shown in Figures 7B–7C. Notice how the ratios between the synaptic weights are largely preserved.

After the fine-tuning, we analyzed the activity of the modeled 13A neural circuits, and the behavior it produced. Figure 7I shows the first, the middle, and the last frame of a movie. The agent succeeded in removing most of the dust (the green pixels). Figures 7D–7F shows the angles and angular velocities of the three “joints” of each front leg, and Figures 7G, 7H show the corresponding neural activity of the left and right 13A neurons. Notice the periodic patterns in both the motor output and the firing rates of the 13A nodes.

Next, we inquired how the model responds to perturbations analogous to the experimental (optogenetic) activations of the 13A neurons. Figure 7J shows the dynamics of six joint angles of both legs in 100 renditions, when no stimulus is applied. Notice the regular periodicity of these dynamics. As we vary the length of the activation pulses (Figure 7K), the grooming behavior, as reflected in angle dynamics, becomes distorted. (Legs also lose coordination and consequently less dust is removed. Only the left leg is shown here.) These distortions also involve higher frequency of movements (see angular velocities in Figure 7K).

We also tried removing individual synaptic connections: either one of the reciprocally inhibiting connections between the 13As of the left leg completely paralyzes the limb. Removing all sensory feedback to the MNs does not stop the execution of the periodic movement, but it rather slows it down (Figure S12A). Obliterating all 13A → MN synapses, not surprisingly, completely paralyzes the leg, but, interestingly, removing just the 13A-to-MN (13Asii-MN) connections to the three MNs (the second row of the 13A → MN matrices in Fig. 7B,C) does not have any effect on the leg (Figure S12B). It seems sufficient for this model to contract only one of the two antagonistic muscles per joint, while keeping the other at a steady state.

Thus, our computational model confirms that rhythmic grooming movements could be produced by inhibitory 13A neurons. By replicating leg movements based on real anatomical connectivity, we investigated the functional roles of specific circuit components. This platform enhances our understanding of role of inhibitory circuits in leg coordination during grooming, providing a foundation for generating informed hypotheses in future experimental studies.

DISCUSSION

Inhibitory Circuit Motifs

Using the VNC EM connectome data, we identified various circuit motifs formed by 13A and 13B inhibitory neurons.

Feed-forward inhibition:

A given generalist 13A neuron synapses onto multiple MNs that control muscles affecting a common movement such as whole leg extension. Meanwhile, specialist 13A synapses onto MNs controlling fewer joints, refining movements at individual joints.

Disinhibition:

13A neurons targeting extensor MNs also inhibit other 13A neurons that target flexor MNs. This enables flexor activation when extensors are inhibited. This setup combines feed-forward inhibition of MNs across multiple joints with disinhibition of antagonistic muscles. Coordinated by premotor 13A neurons, this mechanism facilitates muscle synergy across leg joints, promoting movement in one direction while inhibiting antagonistic movement, adding an additional versatile layer of coordination to limb movements.

Additionally, some 13B neurons inhibit 13A neurons that inhibit MNs, releasing activity in MNs upon 13B activation. Some of these 13B neurons also directly inhibit MNs and disinhibit antagonistic MNs by inhibiting a premotor 13A or 13B neurons, forming additional muscle synergies (Figure 4A).

While some13B (or 13A) neurons have a dual role of direct inhibition and disinhibition, others only disinhibit motor pools. Similar disinhibition motifs have been characterized in other systems, such as for motor sequence selection in vertebrates and fly larvae76–83, and in regulating fly flight bout duration84. One proposed function is to make responses faster by priming the system, holding it ready and waiting to run, but only upon the release of inhibition.

Reciprocal inhibition:

There are reciprocal inhibitory connections between 13A neurons that inhibit flexors and 13A neurons that inhibit extensors within a leg (Figures 4B, 4A5). Similar connections are observed in reciprocal Ia-inhibitory neurons (rIa-INs) in vertebrate spinal cord, which connect to each other and antagonistic MNs. This motif is proposed to lead to flexor-extensor alternation even in the absence of excitatory rhythm-generating circuits85,86. Blocking ipsilateral inhibition converts flexor-extensor firing in alternation in isolated spinal cord into synchrony in mice87–89, suggesting a role in regulating limb alternation. Reciprocally connected excitatory interneurons are involved in locomotor rhythm generation, and the inhibitory and excitatory premotor locomotor networks demonstrate a reciprocal organization90–91. Here we identify similar motifs connecting 13A inhibitory interneurons with the potential to induce flexor-extensor alternation in a single joint or synergistically across multiple leg joints (Figure 4C).

Redundant inhibition:

We often see an inhibitory neuron target both the MNs and its excitatory pre-synaptic partners. We predict the net affect to be thorough silencing of muscle outputs with redundant and synchronized control at several levels in the premotor circuit. For example, 13A-10f-α neuron, which directly inhibits tibial flexor MNs, also inhibits excitatory premotor neurons (20A/3A) responsible for activating flexor MNs, effectively preventing their activation (Figure S1). Similarly, the 13B-4i neuron connects to 13A neurons that inhibit flexor MNs, resulting in their disinhibition (Figure S6). This same neuron also inhibits excitatory neurons that activate these 13A neurons.

Proprioceptive feedback:

Proprioceptor neurons located in the leg muscles sense the position and motion of the leg. Proprioceptors that detect flexion directly activate extensor MNs and indirectly inhibit flexor MNs, while proprioceptors that detect extension activate flexor MNs and inhibit extensor MNs21,23,93. We observe sensory feedback from both position and movement-sensing proprioceptors onto specific 13A neurons (13As-i) or (13As-ii). When the flexion is complete, position-sensing proprioceptors send excitatory feedback to 13As-i neurons to inhibit flexion and disinhibit extension. The same is true for extension position-sensing proprioceptors (Figure 5). Thus, proprioceptor feedback complements reciprocal inhibition to generate alternation.

We also observe sensory feedback from some movement-sensing hook proprioceptors onto 13As-i and 13As-ii. A recent study shows that during walking and grooming, position-sensing proprioceptors are active while movement-sensing proprioceptors are suppressed92. Thus, specifically position sensing proprioceptors could generate alternation. Sherrington’s proposal in 1910, supported by studies on spinal cats, indicates that proprioceptive signals trigger alternation—a mechanism observed across various rhythmic behaviors, including locust flight and mammalian respiration94–99. The connections between position sensors, 13A neurons, and antagonistic MNs support this hypothesis and could trigger extension and flexion alternations required for grooming actions.

These circuits explain the spatial and temporal features of the leg movements during grooming:

Flexors (or extensors) at several joints must work together to fully extend or contract a leg during leg rubbing.

Neurons synapsing onto related MNs facilitate this synchronization. For example, cluster 6 or 8 13A neurons (Figures 3C, S2E2–S2E6 and S2G1–S2G5) primarily target proximal and medial joint extensor MNs, inducing leg flexion upon activation. Moreover, during head sweeps, proximal and medial joints occasionally exhibit antagonistic movement patterns, with one extending while the other flexes. Cluster 10 13A neurons and 13A-9e, −9f, can produce such coordinated motion.

Flexors and extensors should be mutually exclusive.

The leg should not simultaneously co-contract opposing muscle groups, but should alternate cycles of extension and flexion for grooming. Thus, a generalist neuron inhibiting both proximal and medial joints facilitates coordinated leg rubbing actions. For example, 13A-10c synchronously inhibits proximal, medial and distal flexor MNs (Figures 3C and S2I4) and also targets 13A neurons (13A-8a, −8b, and 8c) connected to proximal and medial extensor MNs (Figures 4F and S2G1–S2G3). This ensures the inhibition of MNs and disinhibition of antagonistic MNs across multiple leg joints, preventing coactivation of antagonistic MNs.

Flexors and extensors should alternate.

In this study, we identify two kinds of connections that could generate alternation: reciprocal inhibition between 13A neurons and proprioceptor feedback from sensory neurons in the muscle to 13A neurons. Reciprocal inhibition between generalist neurons of 13As-i (13A-10f-α, −10e-δ) and neurons of 13As-ii group (13A-9e, −9f) would induce alternation between proximal flexion—medial extension and proximal extension—medial flexion during head sweeps (Figure 4D). This could lead to alternating movements in the whole leg. Similar circuits are observed in the conventional half center model that proposes the activity of flexors and extensors is produced by two interconnected flexor and extensor half-centers100–102. Our behavior experiments and modeling further support this connectivity pattern, as we could induce grooming (and walking) in clean flies through pulsed activation of specific inhibitory 13A neurons without manipulating any excitatory drive.

Proprioceptive feedback from position sensing neurons onto reciprocally connected 13A neurons could also trigger alternation. Other central neurons upstream of reciprocally connected 13A neurons could also facilitate alternation.

We observe these circuit motifs in the connectome analysis of inhibitory 13A and 13B neurons. We model and extrapolate their potential functions. Using optogenetics, we test these proposed functions within the limits of the reagents available to target the most informative and specific subsets of neurons. Our experiments demonstrate that normal activity of these inhibitory neurons is critical for grooming. Both silencing and continuous activation of inhibitory neurons reduces the amount of time spent and effectiveness of dust removal. Analysis of limb movements shows forced flexion or abnormal extension, with limbs locked in extreme poses.

Inhibitory Innervation Imbalance Between Flexors and Extensors

There is inequality between flexor and extensor innervation. Around 24 13A neurons inhibit proximal joint extensors, while only 5 directly inhibit the flexors. Similarly, 12 13A neurons inhibit tibia extensors, whereas only 4 inhibit the main tibia flexors, 3 of them being primary 13A neurons. Although, the legs alternate between extension and flexion, the legs always remain lifted off the ground while performing grooming actions as opposed to walking. To maintain this posture, some MNs should be continuously activated and/or their antagonistic counterparts should be continuously inactivated. For instance inhibiting trochanter extensor or activating flexors would keep proximal joint upright. Likewise, continuously inhibiting some of the medial and/or distal joint flexors and activating extensors would also keep legs lifted off the ground. This could be achieved by activating specialist 13As that inhibit proximal extensors or generalists that inhibit proximal extensors and medial/distal flexors. Among the 13A neurons that inhibit antagonistic muscles, those that are reciprocally connected could induce flexion-extension alternation, while those that are not could help in keeping the legs lifted.

Reciprocal inhibition between 13A neurons supports the conventional half center model100–102. However, motor disinhibition mediated by 13B neurons suggests asymmetry. For instance, the majority of 13Bs mostly connect to 13As that inhibit tibia flexor MNs, and very few inhibit extensor MN-inhibiting 13As, suggesting additional control over flexion disinhibition. This asymmetry aligns with the flexor burst generator model, which suggests that the flexor burst generator actively excites flexor MNs while inhibiting the otherwise tonically active extensor MNs103,104. Proprioceptive feedback onto reciprocally connected 13A neurons could induce flexion-extension alternation. However, other local and descending neurons in the central nervous system that are upstream of reciprocally connected 13A neuron could also induce alternation. The balance of internal circuits and external sensory feedback contribute to pattern generation. Future studies will dissect the extent of peripheral verses central control in generating alternation.

Spatial Mapping of premotor neurons in the nerve cord

Our study reveals organized spatial distribution of inhibitory premotor neurons controlling MNs across multiple leg joints. 13A neurons with similar axonal and dendritic morphologies connect to the same sets of MNs, indicating organized mapping of both outputs and inputs. This may align with the wiring economy principle, which states that circuits are organized in a way that minimizes the neurite length and energy cost of connections while maximizing efficiency105–108. This organization is believed to be driven by evolutionary pressures to enhance the organism’s overall fitness by conserving energy and resources. For evolutionarily conserved repetitive movements such as grooming, the spatial proximity of premotor 13A neurons contacting similar MNs could minimize conduction delays and optimize energy usage. This organized spatial mapping of 13A neurons is also reminiscent of spinal modules, spatial regions in the spinal cord orchestrating specific muscle activations for distinct motor outputs32,109.

Computational modeling of inhibitory circuits

Here we use a linear rate-based (non-spiking) neural network to represent the 13A circuitry. Natural behavior and neural activity are of course more complex. However, the objective of our model is to explore how the 13A circuit motifs could contribute to, or produce de novo, behavioral features at the resolution that we observe (i.e. positions of three points per leg in a 2D space). Therefore, our model matches the level of dimensionality of our behavioral data. This level of abstraction is inspired by Jovanic et al, 201676, but we add the agent component to the neural circuitry and apply evolutionary fine-tuning of parameters.

When we perturb the model by activating 13A neurons with pulses of various lengths, we observe decrease in coordination and increase of frequency of movements (compare angular velocities in Figure 7J to those in Figure 7K). Here we did not attempt to simulate the exact experimental procedures. However, in future work the model’s parameters could be fine-tuned (trained) within similar constrained parameter space, but with the fitness function modified: instead of the parameters being optimized to remove “dust”, they should be (also) optimized by the similarity of behavioral features produced by the model to those obtained from real flies, as has been done in wholeanimal modeling110, under various experimental conditions.

Future Directions

Our connectome analyses revealed subsets within a hemilineage serving distinct roles. In future, building genetic tools to targeting specific inhibitory neurons to manipulate activity of specific components of various inhibitory motifs will help in testing their function. Functional imaging in a behaving fly would help in correlating the temporal aspects of their activation with precise limb movements. While this work primarily focuses on the inhibitory control of one leg, defects in left-right coordination are observed upon manipulation of these neurons. It will be interesting to investigate the circuitry involved in left-right coordination, possibly mediated by commissural and/or descending neurons connected to these inhibitory neurons.

Given that pulsed activation of 13A neurons could induce grooming or walking in clean flies, and manipulating their activity in dusted flies affects temporal features of grooming, it raises the possibility that 13A neurons could be the components of central pattern generators. Further studies are needed to identify neurons that control the timing of the rhythms and how those component interact with these inhibitory neurons.

Our anatomical analysis of the different types of inhibitory neurons and the circuits to which they connect reveals that they are expected to be important players in organizing limb muscles for coordinated motor control. They complement excitatory premotor circuits by allowing different sets of muscles to be concurrently regulated. The circuit motif arrangements of these inhibitory neurons suggest how they participate in controlling the spatial and temporal aspects of grooming movements, producing acute antagonism between opposing muscle groups and alternation between whole-leg extension and flexion.

MATERIALS AND METHODS

CONTACT FOR REAGENT AN RESOURCE SHARING

For information and inquiries regarding resources and reagents, please write to the lead contact Julie H. Simpson (jhsimpson@ucsb.edu).

EXPERIMENTAL MODEL AND SUBJECT DETAILS

Drosophila melanogaster were raised on a standard cornmeal medium at 25°C in a 12 hr light/dark cycle. For optogenetic experiments, one day old flies were transferred to food containing 0.4 mM all-trans-retinal and kept in the dark for 3 days. Genotypes of the fly lines are included in the Key Resources Table.

METHOD DETAILS

Identification of fly lines that target inhibitory neurons.

We visually screened the VNC expression of various GAL4 lines on Flylight database111 and compared them to the inhibitory hemi-lineages19. Next we obtained corresponding AD, and DBD flies from BDSC for the candidate lines and crossed them with GAD-GAL4-AD or GAD- DBD (Haluck Lacin) to confirm and restrict their expression in GABAergic neurons. R35G04-GAL4-DBD, GAD-GAL4-AD labeled six 13A and six 13B neurons per hemisegment. We also isolated six 13A neurons from this line by using R35G04-GAL4-DBD, DBX-GAL4-AD combination. R11C07-GAL4-DBD and GAD-GAL4-AD labels 4 inhibitory neurons. We intersected R11C07 DBD with Dbx AD to isolate two 13A neurons. R11B07-GAL4-DBD, GAD-GAL4-AD labeled 3 13B neurons.

Immunofluorescence and confocal microscopy.

Flies were immobilized by anesthetizing them on ice (4°C). Central nervous system (CNS) was carefully dissected in 1X Phosphate-buffered saline (PBS). Subsequently, the wings were removed, and the flies were positioned ventral side up on a sylgard plate. All legs were excised, and fine forceps (No. 5 Dumont from FST, Switzerland) were employed to delicately open the thorax along the midline, taking care to avoid damaging the underlying thoracic ganglia. A small incision near the first abdominal segment ensured preservation of the abdominal ganglion. Surrounding tissues were cleared from the thoracic ganglia, which were then gently extracted by grasping the neck connective. The dissected thoracic ganglia were subsequently fixed in 4% buffered paraformaldehyde for 45 minutes at 4°C.

Post-fixation, the thoracic ganglia underwent three 15-minute washes in 0.1% Triton X-100 (PBT) at room temperature on a shaker at 60 rpm, followed by a 20-minute wash in 0.1% PBT with normal goat serum (blocking solution). Primary antibodies, diluted in 0.1% PBT-NGS, were applied to the samples and incubated overnight at 4°C on a horizontal shaker. Following primary antibody incubation, the samples underwent three 15-minute washes in 0.1% PBT and one 20-minute wash in 0.1% PBT-NGS. Secondary antibodies, diluted in 0.1% PBT-NGS, were added to the samples and incubated for 2–4 hours at room temperature on a shaker at 60 rpm. Secondary antibody removal was achieved through four 15-minute washes with 0.1% PBT at room temperature. Finally, the tissues were mounted on glass slides using Vectashield mounting medium (Vector Labs).

Primary antibodies used were Chicken pAb anti-GFP (Abcam, 1:1000), Rabbit (Rb) anti-GFP (Abcam, 1:1000), mouse (ms) anti-Neuroglian (BP104) (DSHB, 1:40), ms monoclonal anti-Brp antibody (nC82) (DSHB,1:200). For MCFO labeling experiments, Rb mAb anti-HA (Cell Signaling Technologies, 1:300), Rat anti-FLAG (Novus Biologicals, 1:200), DyLight549-conjugated anti-V5 (AbD Serotec; 1:300 dilution).

Secondary antibodies from Invitrogen Molecular Probes conjugated with Alexa-488, Alexa-568 and Alexa-647 raised against chicken, ms and Rb were used in 1:400 dilution.

Zeiss LSM710 confocal microscope was used to obtain images of the CNS. Images were then processed in FIJI.

Recording and analysis of grooming in clean and dust-covered flies.

For open field assay, we dusted the flies and obtained the recording as described in Zhang et al., 20204. Automated behavior analysis (ABRS) was used to quantify the amount of time flies perform individual grooming actions112. Additionally, manual scoring was performed2 in flies showing uncoordinated leg movements. Quantification and statistical analysis describing the percentage of time dusted flies spent doing grooming and uncoordinated leg movements upon 13A and B activity manipulation was performed in Matlab as described in Zhang et al., 20204.

For limb tracking, either clean or dust-covered flies were put in a studio containing 10-mm diameter quartz chamber and 100 Hz videos were recorded from below. An FLDR-i132LA3 red ring light (626 nm) was used for optogenetic activation and green led was used for silencing experiments.

Behavior analysis.

Raw data, consisting of coordinates of the six annotated points on the front legs and two reference points on the body (per one frame of a video), was obtained from DeepLabCut75. From these coordinates we computed: 1) (fly-centric) spatial positions of the body parts, 2) the spatial velocities of the points, 3) the whole-body velocity (the translation, obtained from the reference points in absolute coordinates), 4) the euclidean distances between the leg points (“joints”) and other “joints” or the reference points, and 5) the joint angles.

All behavior analysis was performed using Python, version 3.9.7.

Continuous feature extraction

The euclidean distances between various body parts (the six “joints” and the two reference points) are used as continuous features. The body velocity was computed as a euclidean distance of a point covered across a 50 frame (0.5 second) time window. Three joint angles per leg were computed from the three points on the leg and the two reference points. These angles are: posterior, medial, and distal angles. Angular velocities were computed as derivatives of the raw angles, and were lightly smoothed by a Gaussian filter (filter sigma = 2 frames). The euclidean distances were also smoothed by the same method.

The angular velocity time-series (AV) is used as the basic signal from which other continuous behavioral features are extracted, and also serves as the basis for segmentation. The main continuous features extracted from the AV are the phase and the frequencies.

The phase (between the movement of the front-legs) was computed from crosscorrelation of AV signals of the two legs, using the signal.correlation_lags()function with the window for cross-correlation of five frames. We took the time-position of the maximum cross-correlation (the peak) as the lag (the phase). If the two legs are perfectly in-phase, the peak of the cross-correlation will be at time 0. The phase is a good indicator of a general type of grooming behaviors: front-leg rubbing is usually associated with a non-zero phase (a lag) wheres the head-cleaning more often than not has a zero lag (legs moving in-phase).

Frequencies are computed from the AV signal as well. We use numpy.fft.fft() function with the time window of 25 frames (0.25 seconds) and the input size of 160 frames (the length of the signal with the zero-padding) to compute the spectrum. The frequency at which the spectral power is maximal, is taken as the frequency of the signal.

Segmentation

Our analysis is focused on individual leg movements during grooming. These include contractions and extensions of the front-leg joints. For this purpose we separate the continuous features into segments corresponding to these movements.

The segmentation is performed by applying a stationary threshold to the angular velocity (AV) of the proximal joint angles. These joints determine the whole leg movements (flexions and extensions) so we consider them suitable for the purpose of segmentation. Next, for each segment we compute the averages, minima, and maxima of each continuous feature within that segment. We also compute the duration of each segment as an additional feature. These segmented features are used for behavioral classification and for further analysis, including comparing different groups of flies.

Classification of behavior and dimensionality reduction

We collect segments (segment features) from data-sets of groups of flies and pool them together for the purpose of classification. (So, e.g., experimental and control data-sets are used together.) Altogether we use 63 segment features, including averages of: euclidean distances, AVs, phases between joint pairs, frequencies of all joints, whole-body velocity, segment durations. We also include the maxima of the six AVs, and we can include combined features too (here we only use one combined feature – AV*segment duration).

The feature matrix X of the size f x t , where t is the total number of segments and f is the number of segment features, is the input to the UMAP dimensionality reduction algorithm. We use UMAP from https://pypi.org/project/umap-learn/ with the following parameters:

n_neighbors=350, min_dist=0.1, n_components=2

The X is thus projected onto two dimensions. For the UMAP construction we can remove some of the data from X. Namely, we can remove the data-points (segments) where angular velocity of proximal joints is below a certain value (fly is presumably not moving) or when the quality of data is too low (see quality control).

For the classification we apply the agglomerative clustering onto the 2D UMAP projection. We use AgglomerativeClustering() from sklearn.cluster (https://scikit-learn.org/stable/modules/clustering.html#hierarchical-clustering). We select the number of clusters of 12–14. Thus, we produce 12–14 class labels that can be applied to the 63 features of the segment feature matrix X.

Now we can compare the different behavioral classes, across the 63 features, between various groups of flies.

Comparing groups of flies

With 12–14 behavioral classes and 63 features we can now compare different experimental groups of flies to assess the behavioral effects of the experimental procedures. For each class-feature pair we can determine whether there is a significant difference between the groups.

With 14 classes and 63 features, there are 882 possible hypotheses to be tested. This calls for the multiple hypotheses adjustment. We applied the Bonferroni method, using the statsmodels.stats.multitest.multipletests() function (https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html). The alpha parameter was set to 0.05, and the method parameter was set to bonferroni. The t-test was performed using the scipy.stats.ttest_ind()function.

Model

The 13A circuits

The model of 13A and associated circuits was build from simple linear neuronal networks. We did not model individual neurons but rather abstracted them to nodes, interconnected by synaptic weights corresponding to the numbers of synapses obtained from the connectome analysis. Since, the 13A circuits in the right and left front leg neuropil are mirrored and there are slightly more connections on the left side (Figure S3), the synaptic weights of the same circuits on the left neuropil were used for modeling purposes.

The network is shown in Figure 7A. Below is the description of the 13A circuit model for one leg. The full model consists of two (front) legs, build the same way.

The two 13A nodes connect to each other reciprocally (inhibitory synapses). The adjacency matrix for these nodes is: W13A←→13A=0−559−4880

The activation levels of the 13As are simply: A13At+1=A13At+W13A←→13AT*A13At−Θ13A

A13A is a vector of activation levels of the 13As, and θ13A is a vector of thresholds of 13A neurons.

The 13A nodes inhibit the six motor neurons (MNs). These connections are represented by adjacency matrix: W13A→MN=−1594.0−1525.0−1525.00.00.00.00.00.00.0−1525.0−1594.0−1594.0

The six MNs act on the three pairs of “antagonistic muscles”, which in turn control the changes of joint angles (three per leg). Flexion and extension rates of the antagonistic muscles are directly proportional to the activation levels of the MNs.

The activation levels of the MNs are: AMNt+1=AMNt+W13A→MNT*A13At−ΘMN

AMN is a vector of activation levels of the MNs, A13A is a vector of activation levels of 13As, and θMN is a vector of thresholds of 13A neurons.

The inputs to the six sensory neurons (SNs) are directly proportional to the flexion and extension rates of the joint muscles. So, the activation levels of the SNs are: ASNt+1=ASNt+extension/flexionrate−ΘSN,

where ASN is a vector of activation levels of SNs, and θSN is a vector of thresholds of SNs.

The SNs then feed back onto both, the MNs and the 13As. The adjacency matrix representing the sensory feedback to the MNs is: WSN→MN=0.00.00.0244.0244.0244.00.00.00.0244.0244.0244.00.00.00.0244.0244.0244.0548.0548.0548.00.00.00.0548.0548.0548.00.00.00.0548.0548.0548.00.00.00.0

The activation levels of the MNs are then updated as follows:

AMNt+1=AMNt+WSN→MNT*ASNt−ΘMN

where AMN is a vector of activation levels of MNs, and θMN is a vector of thresholds of MNs.

The adjacency matrix representing the sensory feedback to the 13As is: WSN→13A=526.00.0526.00.0526.00.0153.048.0153.048.0153.048.0

And the A13A activation levels are updated: A13At+1=A13At+WSN→13AT*ASNt

Activation levels are constrained as follows:

max(A13A) = 2500

max(AMN;ASN) = 200

Minimal activation levels for all neurons are set at zero (so, no negative rates).

Two 13B nodes were added to inhibit the two 13A nodes. The initial weights of the 13B --> 13A were −413 and −160.

Normalization of weight matrices

The synaptic weights are normalized so that they range between −1 and 1. This is done by dividing the W matrices by the maximum weight value. We could have used a single weight matrix for the entire 13A network, and divide the weights by the maximum of that “global” matrix. But, this would add an unnecessary constraint to the model, as explained below:

Our objective is to preserve the rations between the synaptic weights projecting from the same type of neurons, e.g. all the weights of the projections from the 13A neurons should have the same ratios across both, the W13A ←→13A and the W13A-->MN matrices. However, weight ratios do not need to be preserved between matrices of different types of projecting neurons, e.g. between the W13A-->MN and WSN-->MN matrices. This is because the empirically obtained weights (defined as the numbers of synapses) of one neural type do not necessarily correspond to the same quantity obtained from a different type of a neuron, e.g. 6 synapses from 13A to MNs (model weight = 6) do not necessarily correspond to 6 synapses from SNs to MNs (model weight = 6), therefore the ratio of 6 to 6 (1:1) does not need to be preserved. This is why we model each type of neurons by a separate set of weight matrices, corresponding to empirically obtained weights (as shown above) rather than by a single matrix. We normalize the matrices accordingly.

The excitatory network

The model network also needs an excitatory input. Because we do not know the upstream excitatory connections from the connectome we created a “black box” network that takes the simulated dust distribution as the input, and it outputs excitatory signal to the 13A, 13B, and MNs. The “black box” excitatory network consists of a recurrent neural network (RNN) as the hidden layer, with linear synapses and initially random wights.

The hidden RNN layer has 40 nodes. The input layer is the dust grid and the pixel values are its the inputs. The output layer has 21 nodes connecting to the two 13B nodes, the two 12A nodes, and the 6 MN nodes, per one leg (so 10 outputs per leg). The same excitatory network also feeds to the other leg’s 13A network, in the same manner. The remaining output node does not project anywhere (it is placed there for future model development where it could output the amplitude of exploratory noise injected into the 13A network).

The agent and the environment

Our model is composed of neuronal circuits embedded in a simple agent that acts on its environment. The agent has two 2D legs, corresponding to the two front legs of a fly, each of which is made of three points (“joints”): proximal, medial, and distal. The distal point (the one farthest from the “body”) can remove the “dust” from the environment. The movement of the “joints” (per leg) is controlled by three pairs of “antagonistic muscles” affecting the three angles formed by the “joints.” Figure 7I shows a frame of a movie where the legs are represented by the three points each.

The environment is composed of a Gaussian distribution of “dust” around the agent (green pixels in Figure 7I). The means of the Gaussian are at the center of the 32 by 32 pixel grid (also the position of the “root” of the front legs), so x=0; y=0. The variance = 5 pixels, in both directions. The maximal amount of dust (at the peak of the Gaussian) is 1.0 (0.99).

The agent can remove the “dust” when the distal “joint” sweeps over the environment with the minimum velocity of 1 pixel/frame. (So, if the “joint” just stays at a given position, the dust is not getting removed. It has to move over it.)

As the grooming behavior is being performed, the “dust” accumulates on the legs, reducing their ability to continue removing it from the grid (the “body”). The “leg cleaning” - removal of the accumulated dust occurs when the two legs are in proximity to each other (Euclidean distance < 5 pixels). The “leg cleaning” rate of dust removal from legs is the same as the body dust removal rate: 0.5/frame.

The three angles (per leg) are constrained. Distal and medial angles: 100° - 180°; proximal angle: 80° −120°.

The fine-tuning of the synaptic weights

When we run the model with the default synaptic weights (see previous sections) nothing happens, i.e. the activation levels either saturate (reach the ceiling values shown above) or fall to zero. The legs of the agent may move once and then the model “freezes.” One way of getting around this problem would be to add a “CPG component” to the model, to drive the periodic excitatory inputs, thereby creating a baseline periodic activity and movements. We could then study the effects of the 13A circuitry on these movements. However, we wanted to see if the model network could generate periodic movements all by itself.

The model weights used are approximate and we do not know the exact ratios between individual modeled weights (the assumption is that the number of biological synapses corresponds to the weights). So, we allow the modeled weights to vary (in value, but not in sign) and yet preserve the approximate ratios obtained from the empirical data. In other words, we are exploring a space of possible models that adhere to approximately the weight ratios obtained empirically. The weights are allowed to vary +/− 20% and cannot change the sign – i.e. inhibitory neurons must remain inhibitory. (In future versions we may decrease this space of exploration to adhere even more closely to the empirical estimates. Conversely, we may increase the exploration space and observe all solutions to see how close our empirical estimates are to the global optimum.)

To explore the space around our empirically estimated weights, we employed a genetic algorithm (GA). We used the PyGAD library (https://pygad.readthedocs.io/en/latest/index.html). follows:

num_generations = 150 (this can vary) num_parents_mating = 20 sol_per_pop = 100 (number of individuals) num_genes = n (n is the total number of parameters, i.e. the number of all synaptic weights in the model, including the RNN excitatory “black box” component. parent_selection_type = “sss” keep_parents = 1 crossover_type = “single_point” mutation_type = “random” mutation_probability = 0.1

After 150 generations (in case of the model described here, but we often vary that) we arrive to a model solution that can efficiently remove the “dust”, but often just with one leg (i.e. from one side). To speed up the evolutionary process, we then copy all the genes of the 13A network side that removed more dust and paste it to the other side (to the other leg). At this point the legs can remove the dust from both sides, but are too uncoordinated to meet each other, in order to remove the dust from the legs too. Therefore, we run the solution through the GA again (same hyper-parameters). The final fine-tuned model can easily coordinate the legs, ensuring that the “leg rubbing” behavior occurs.

The final weights of the fine-tuned model are within the 80% range of the empirically determined weights (all signs are preserved), as described above. Figure 7B and C shows both sets of weights.

Connectome analysis

Neuronal reconstruction, lineage identification and detection of neuronal partners

We used serial-section transmission electron microscopy (TEM) dataset of female adult Drosophila (FANC)15 to reconstruct 13A and 13B hemi-lineages in the ventral nerve cord. These neurons were identified in the EM volume based on their cell body clusters, arborization pattern and nerve bundle entry positions into the ventral neuropil18,19,65 and comparison with light-level images and axonal tracts labeled with anti-Neuroglian. 13A neurons cluster together and enter the VNC neuropil anteriorly through the ventrolateral position18,19,65. 13B neurons have contralateral cell bodies and ipsilateral projections, with their axons entering the neuropil through the extreme ventral bundle18,19,65. Using confocal microscopy images of 13A and 13B neurons marked with GFP and axonal tracts labeled with anti-Neuroglian for reference comparison, we located these neurons in the EM volume. We manually traced the main neural skeletons and later proof-read automatic segmentations. Then neuronal IDs and cell body coordinates of each 13A and 13B neurons is shown in Table S1.

Manual reconstructions of some of the 13A and 13B neurons were initially performed in CATMAID113. Traced skeletons were then imported from CATMAID to Neuroglancer114. We identified other 13A neurons and 13B neurons in the corresponding hemilineage bundles and proofread errors in the automated neuronal reconstructions11. We fully proofread 62 13A neurons (Table S1), 64 13B neurons in the right prothoracic segment (T1) of VNC, and 25/64 13B neurons in the left T1. We used the automated synapse detection to identify the downstream and upstream connections11,16. We used various FANC packages11 generously available to the community to generate upstream and downstream partner summary of all the 13A and 13B neurons in R studio (https://rdrr.io/github/flyconnectome/fanc/man/fanc_partner_summary.html).

Connectivity matrix

To plot connectivity matrices between groups of neurons, we utilized Python libraries including pandas, networkx, and matplotlib. We created a directed graph using networkx to represent the connections, where presynaptic and postsynaptic neurons were added as nodes. The thickness and color of edges between nodes were determined by the strength of the connections, and the type of presynaptic or postsynaptic neurons, respectively. Node colors were assigned based on the type of neurons, with specific colors denoting different subtypes of 13A neurons and motor neurons. Finally, we generated the visualization using matplotlib. 13B to 13A connections were manually added in Figure 4B. Leg schematic and MN to muscle connections were also manually added in Adobe Illustrator.

Cosine similarity matrix

We computed the cosine similarity matrix of 13A neurons based on their downstream motor connections in Python using the cosine_similarity from sklearn.metrics.pairwise for computing cosine similarities. A pivot table was created from the DataFrame, with neurons as rows (index) and their post-synaptic targets (post_id) as columns. The values in this table represented the weights of the connections. Duplicates were aggregated using the sum function, and missing values were filled with zeros. The cosine similarity between each pair of neurons was calculated using the cosine_similarity function. Cosine similarity is a measure that calculates the cosine of the angle between two vectors. In this context, each neuron is represented as a vector of its connectivity weights to downstream MNs. The cosine similarity value ranges from −1 to 1, where: 1 indicates that the vectors are identical. 0 indicates that the vectors are orthogonal (no similarity). −1 indicates that the vectors are diametrically opposed. This calculation resulted in a similarity matrix, where each entry (i, j) represents the cosine similarity between the connectivity profiles of neuron i and neuron j. This calculation resulted in a similarity matrix, where each entry (i, j) represents the cosine similarity between the connectivity profiles of neuron i and neuron j. The resulting cosine similarity matrix was visualized using matplotlib. The matrix was displayed as a heatmap with a color gradient indicating the degree of similarity.

Classification of 13A and 13B neurons based on morphology

We used NBLAST17, a computational method to measure pairwise similarity between neurons based on their position and geometry to identify various subclasses within the 13A and 13B hemi-lineages and for left-right comparison.

Supplementary Material

Supplement 1

ACKNOWLEDGEMENTS

We thank the undergraduate members of the Simpson laboratory, especially Ethan Zhang (EZ), Yarah Meijer (YM), Daniel Perry, and Kaya Minami (KM), for their valuable contributions to experimental assistance and proofreading neurons. Sara Abraham, EZ, YM, and KM assisted with manual labeling for behavior analysis. The UCSB undergraduate team, including Gabe Bello (GB), Katelyn Ross (KR), Kelly McDonald, Kai Thomas, Jada Moore (JM), Yash Shah (YS), Jinyi Dong, Mark Lu, Allene Dang, William Jaber, Charliene Lien, Sofia Easton, Paige Gambetta, Maya Teitz (MT), Dhruvi Dalwadi, Abdallah Samarah, Jonathan Carranza, Chandni Patel, Hana Nguyen, Inzar Khan, Garima Sehgal, Sydney Mauch, Yida Huang, Liz Kaslewicz, Nina Shenoy, Joseph Perliss, and Lindsay Easter (LE) proofread 13A /B neurons and their synaptic partners in the EM dataset. YM, KR, MT, KM, GB, YS, JM, LE led the EM team. David McNeill, Ladann Kiassat, GB, EZ, and YM trained the EM team.

We thank Wei-Chung Allen Lee, John Tuthill, and Jasper Phelps for giving access to the FANC connectome and FANC community for generously sharing their resources. We thank Janelia and Cambridge groups for the MANC data available through BioRxiv.

We thank Akinao Nose and Shingo Yoshikawa for feedback on the manuscript. For fly strains, we thank James Truman, Haluk Lacin, Gerald Rubin, Benjamin White, Adam Claridge-Chang, and the Bloomington Drosophila Stock Center, supported by NIH grant P40OD018537. This work was supported by NSF Career Award IOS-1943276 and NIH grant RF1NS132900.

Figure 1. Behavioral Contributions and Anatomical Distribution of 13A and 13B Hemi-Lineages

(A) Schematic showing cell body positions and segmental distribution of 13A (green) and 13B (cyan) neurons across the pro-, meta-, and meso-thoracic segments (T1, T2, T3) of the ventral nerve cord (VNC).

(B) Confocal image showing six GABAergic 13A neurons (green arrowheads) and six 13B neurons (cyan arrowheads) in each VNC hemisegment, labeled with GFP (green) driven by R35G04-GAL4-DBD, GAD-GAL4-AD combination. Neuropil labeled in magenta (nc82). Panel B’ provides a zoomed-in view of the T1 region (indicated by the yellow dashed rectangle) of the panel B.

(C) We performed EM reconstructions, identifying 62 13A neurons (green) and 64 13B neurons (cyan) in the right T1 region of the VNC. Ventral side up.

(D) Functional outcomes of continuous activation of 13A and 13B neurons labeled by R35G04-GAL4-DBD, GAD-GAL4-AD in intact flies, resulting in reduced anterior grooming (front leg rubbing and head sweeps) and unusual leg extensions. Total time = 4 min. N= 7.

(E, E’) Silencing six 13A and 13B neurons per hemisegment (panel B) (R35G04-GAL4-DBD, GAD-GAL4-AD > UAS TNTe) results in one or both front legs being locked in flexion (blue arrowhead) in both clean (E) (n=5) and dust-covered (E’) (n=13) headless flies. Panel E” provides zoomed in version of front legs from E’ with leg schematic illustrating leg flexion.

(F, F’) Activation of six 13A and six 13B neurons (R35G04-GAL4-DBD, GAD-GAL4-AD > UAS CsChrimson) results in the front leg extension (orange arrowhead) in both clean (F) (n=5) and dust-covered (F’) (n=10) headless flies. Panel F” provides zoomed in version of front legs from F’ with leg schematic illustrating leg extension. Also see video S1.

Figure 2. Classification of Neurons From the 13A Hemilineage

(A) The Electron Microscopy reconstructions showing morphologies of the three primary 13A neurons (A1-A3) and two secondary 13A neurons (A4 and A5) in the right prothoracic (T1) hemisegment of the VNC. Dorsal side up view is shown.

(B) Hierarchical clustering of 13A hemilineage. Clustering of 13A neuron types in the right T1 segment was performed using NBLAST, resulting in the identification of 10 morphological groups or clusters. Neurons are named based on morphological clustering. For example, all neurons in the 13A-3 cluster have similar morphology, with 10 neurons labeled as 13A-3 (a-j) shown in olive.

(C) Morphologies of 13A neuron types in each NBLAST cluster according to color code in B. Note that images of each 13A neuron are shown in Figure S2, Video S2.

Figure 3. Spatial Map of Premotor 13A Neurons Correlates With Their Connections to Motor Neurons (MNs)

(A) Connectivity pattern of a generalist (A1) and a specialist (A2) 13A neuron. An example of a generalist 13A-10f-α neuron that connects to proximal extensor motor neurons (MNs) (orange) and medial flexor MNs (blue). A specialist 13A-1c neuron connects to proximal extensor MNs (orange). Morphology of neurons in the right T1 VNC shown on the left side and connections to MNs and corresponding muscles on right. Dorsal side up view is shown.

(B) Morphologies of 13A cluster and downstream MNs: Examples showing morphologies of 13A neuron types classified into distinct anatomical clusters using NBLAST, alongside their downstream motor neurons (MNs). Neurons within the same cluster have similar anatomy, closely positioned within the VNC, with dendrites and axons occupying similar spatial regions. EM reconstructions of 3 distinct 13A clusters in the right T1 of the VNC are shown. The spatial positions of the axons of the 13A neurons tile the leg neuropil and correspond to the dendrites of the particular types of MNs onto which they synapse. 13A clusters are shown in black. MNs: extensors in red and brown, flexors in blue. MN with the highest number of synapses are highlighted in red. Additionally, A= anterior, P= posterior, D= dorsal, V= ventral. The left side depicts a ventral side up, while the right side shows ventral toward the right. Also see Video S3.

(C) Connectivity matrix of 13A neurons and the MNs: The 13A neurons that belong to the same anatomical cluster connect to same sets of MNs. 13A neurons having similar morphology are shown in the same color. The edge width between 13A neurons and MNs corresponds to the normalized synaptic weight. The leg schematic shows the muscles that these MNs innervate. Extensor muscles: orange, flexors: blue. The spatial arrangement of 13A neurons reflects their connections to the myotopic map. Cluster 1 neurons are shown in purple, 2 in purple/pink, 3 in olive, 4 in cyan, 5 in orange, 6 in red, 7 in yellow, 8 in gold, 9 in green, and 10 (10a-d thistle), with primary neurons in blue. Leg segments: coxa (Cx), trochanter (Tr), femur (Fe), tibia (Ti), and tarsus (Ta).

(D) Cosine similarity graph showing the pairwise similarity between 13A neurons based on their connectivity patterns to the leg MNs. 13A neurons are named based on the anatomical clusters obtained with NBLAST as described above. It depicts a correlation between anatomy of 13A neurons and their connections to MNs. For example, 13A 1a, 1b, 1c, 1d (cluster 1) connect to same set of MNs, therefore have high cosine similarity with each other (as seen across the diagonal). Likewise, 5a, 5b, 5c connect to similar MNs and so on. This graph also gives insights into the groups of 13As that control similar muscles. For example, cluster 1 13A neurons have high cosine similarity with cluster 3 13A neurons (while, 3g neuron is an exception).

Figure 4. Inhibitory Circuitry for Antagonistic Muscle Control

(A) Schematics showing various inhibitory circuit motifs for antagonistic control: (A1) Direct inhibition of motor neurons (MNs) by 13A or 13B neurons. (A2) Flexor inhibition and extensor disinhibition: 13As-i neurons directly inhibit flexor MNs and release inhibition from extensor MNs through disinhibition as these inhibit 13As-ii neurons. (A3) Extensor inhibition and flexor disinhibition: 13As ii neurons directly inhibit extensor MNs and release inhibition from flexor MNs through disinhibition as they inhibit 13As-i. (A4) 13B mediated disinhibition and inhibition of antagonistic MNs: 13Bs disinhibit MNs by inhibiting premotor 13As and some also directly inhibit the antagonistic MNs. (A5) Reciprocal inhibition between groups of 13A neurons that inhibit antagonistic MNs could induce flexor-extensor alternation.

(B) Connectivity matrix showing inhibitory connections regulating antagonistic MNs of the medial joint. The leg schematic shows the tibia extensor (orange) and flexor (blue) muscle in femur, innervated by respective MNs. Flexor inhibiting 13A neurons (13As-i) in blue, and extensor inhibiting 13A neurons (13As-ii) in orange. Various inhibitory motifs present are as follows:

Direct MN inhibition: Three primary neurons (13A-10f-α, 9d-γ, and 10e-δ) and 13A-10c (13As-i) connect to main tibia flexor MNs (blue edges), making a total of 85, 219, 155, 157 synapses, respectively. While 12 secondary neurons (13As ii) inhibit tibia extensor MNs (orange edges) with strong connections from 13A-9f, −9e, and −10d making a total of 188, 275, 155 synapses, respectively.

Reciprocal inhibitory connections between 13A neurons (black edges): 3 neurons from the 13As-i group inhibit six neurons from the 13As ii group. 13A-10e-δ connects to 13A-9f (19 synapses), −9e (31 synapses), and −10d (14 synapses). 13A-R-10c connects to 13A-R-8a (6 synapses), −8b (12 synapses), and −8e (5 synapses).13A-9d-γ connects to 13A-8e (8 synapses). 3 neurons from 13As-ii group inhibit 2 neurons from 13As i group. 13A-9f connects to 13A-10f-α and −9d-γ, making 25 and 6 synapses, respectively. 13A-10d connects to 13A-10f-α (8 synapses), −9d-γ (7 synapses), and −10e-δ (15 synapses).13A-9e inhibits 13A-10f-α (21 synapses) and −10c (47 synapses).

Disinhibition by 13B neurons: 13B’s connecting to two primary 13As-i neurons, 13A-10f-α and −9d-γ (totaling 78 and 50 synapses), thus, disinhibiting flexor MNs. 13B-2g and −2i also directly inhibit tibia extensor MNs. 13B to 13A connections shown in green.

(C) Reciprocal inhibition between generalist 13A neurons for multi-joint coordination: Two primary 13As (10e-δ and 10f-α) inhibit proximal extensors, medial, and distal flexors, while two secondary 13As (9e and 9f) inhibit antagonist muscle groups. Reciprocal inhibitory connections are observed between these two groups of 13A neurons. Thus, generalist 13As could control muscle synergies and induce alternation in antagonistic muscles through reciprocal inhibitory connections.

(D) Proprioceptive feedback: Schematic illustrating sensory feedback and 13A connections highlighting proprioceptor neurons could also induce alternation by activating reciprocally connected 13A neurons, turning off the corresponding MN by 13A activation and activating antagonistic MNs. Flexion sensing proprioceptor neurons connect to extensor MNs and primary 13As (13As-i group) that inhibit tibia flexor MNs. Thus, when the flexion is complete, it will induce extension and inhibit flexion via 13A neurons. Similarly, extension sensing proprioceptors connect to tibia flexor MNs and two 13As (13Asii group) that inhibit tibia extensor MNs. Additionally, claw extension neurons also connect to 13A-δ. Additionally, 13B neurons that disinhibit flexor MNs are also activated by extension sensing proprioceptors. Thus, extensor sensing neurons can turn on flexion by direct activation of MNs, disinhibit flexion by activating 13As-ii and 13B neurons, and inhibit extension by 13As-ii neurons. Also see Figure S8.

Figure 5. 13A and 13B Neurons Are Required for Leg Coordination During Grooming

(A) Intra-joint coordination and muscle synergies: Schematic showing the coordination of proximal (P), medial (M), and distal (D) joint angles during grooming in dust-covered flies. L= left leg. Angular velocities of the PL (blue), ML(cyan), and DL (purple) joints is shown. Proximal and the medial joints mostly move synchronously, while the distal joint can either move in or out of phase with the P/M joints during leg rubbing in dust-covered flies.

(B) Neuronal labeling of 13A neurons: Confocal image showing six Dbx positive 13A neurons per hemisegment labeled by GFP driven by R35G04-GAL4-DBD, Dbx-GAL4-AD in the adult VNC. Neuroglian (magenta) labels axon bundles.

(C) Neuronal labeling of 13B neurons: Confocal image showing 3 13B neurons per hemisegment labeled by GFP driven by R11B07-GAL4-DBD, GAD-GAL4-AD. Nc82 (magenta) labels neuropil.

(D-K) Effects of 13A and 13B neuronal activity manipulation on grooming: Silencing and activation of 13A neurons in dust-covered flies using R35G04-GAL4-DBD, Dbx-GAL4-AD > UAS Kir and UAS CsChrimson, respectively. Control conditions include AD-GAL4-DBD Empty Split with UAS Kir for inactivation and AD-GAL4-DBD Empty Split with UAS CsChrimson for activation. 13A silencing (n=12 experimental flies), activation (n=19). Silencing and activation of 13B neurons using R11B07-GAL4-DBD, GAD-GAL4-AD with UAS GtACR and UAS CsChrimson, respectively. Control conditions for silencing and activation experiments using AD-GAL4-DBD Empty Split with UAS GtAcr and UAS CsChrimson, respectively. 13B silencing (n=7), activation (n=9).

Box plots showing control data in blue and experimental in orange, with the density of the data distribution shown below the box plots on the y-axis and values along the x-axis, control in blue, experimental in red. Significant effects observed in all analyzed cases (p < 0.001).

(D-G) Proximal (P) inter-leg distance: The distance between the femur-tibia joints of the left and right front legs in all control and experimental flies during head grooming is altered, indicating changes in the joint positions. P. Inter-leg distance decreases upon 13A activation (D) and 13B silencing (F), and increases upon 13A silencing (E). A decrease is also observed upon 13B activation in dust-covered flies.

(H-K) Frequency modulation: Silencing or activating 13A or 13B neurons in dust-covered flies results in a reduction of the median frequency of the proximal joints. Increased variability, indicated by a broader interquartile interval, is also observed. Moreover, 13B silencing results in further drastic reduction in median frequency from around 8Hz to 5Hz.

Figure 6. Pulsed Activation of 13A Neurons Triggers Grooming and Walking in Clean Undusted Flies

(A) Schematic showing proximal joint angles of the left (PL) and the right (PR) legs

(B) Left-right coordination and muscle synergies during anterior grooming. Dust-covered flies perform alternating leg rubs and head sweeps. Angular velocity patterns of the proximal joints are shown. PL (blue) and PR (red) joints move anti-phase during leg rubs and in-phase during head sweeps (highlighted in yellow box). Positive values indicate joint extension and negative values indicate flexion. (B’) One extension and flexion cycle lasts around 140ms with each phase lasting around 70ms. (B”) Maximum angular velocity of the proximal joint during head sweeps in dusted flies is shown.

(C-F) Effect of optogenetic activation of 70ms on and 70ms off pulses in specific 13A neurons (R35G04-DBD, Dbx-GAL4-AD >UAS CsChrimson) (mimicking extension and flexion cycle) in undusted flies.

(C) Anterior grooming actions upon pulsed 13A activation in undusted flies. Angular velocity of the proximal joints in the left (PL) and the right leg (PR) is shown depicting anti-phase leg rubs and long bouts of in-phase head sweeps. Light pulses are continuously active from time=0.

(D) Behavior ethogram showing various grooming actions and walking triggered by 70ms on and 70ms off pulsed activation of 13A neurons in undusted flies. Light pulses begin at time=0.

(E) Joint Positions: x, y coordinates of front leg joints in undusted flies during head grooming (E) and walking (E’) upon pulsed 13A activation. The position of leg terminal (tarsus tip) is shown in blue for the left (L) leg in blue, right (R) in red, the distal joint in dark green and light green, and medial joint in dark blue and maroon.

(F) Maximum angular velocity of the proximal joint during head sweeps upon pulsed 13A activation in undusted flies, comparable to that observed in dust-covered flies (B”).

Figure 7: Modeling the 13A Circuits.

(A) Circuit diagram showing inhibitory circuits and synaptic weights based on connectome.

(B) The adjacency matrices of the model circuits (after fine-tuning).

(C) The adjacency matrices from the empirically estimated weights, indicated in the simplified circuit diagram in (A).

(D) The three “joint” angles of the left leg (left) and the right leg (right) as they change over the time of one episode (500 frames). Colors indicate “joint” angles in the same order as in (I).

(E) Same as (D) but zoomed-in to between 100–200 frames.

(F) Same as (E) but showing angular velocities.

(G) Firing rates (activity levels) of the two 13A neurons over one episode (500 frames), for both legs (left, right).

(H) Same as (G) but zoomed-in to between 100–200 frames.

(I) Video frames from the beginning, the middle, and the end of a video of one episode. Left leg is represented by three “joints”: distal (cyan), medial (pink), and proximal (blue). Right leg: distal (purple), medial (orange), and proximal (red). The legs originate from the “base” (yellow). As the legs move over the “body” (the environment – dust is represented as the green Gaussian distribution), the dust (green) is getting removed (black background). The bottom of each movie frame shows the activity of the two left 13A nodes and six left MNs (blue). The right leg nodes are shown in red, on the right side. The brightness of the nodes indicates the activity level. See Video1.

(J) The dynamics of angular velocities of the left leg’s “joints”, and left 13A activation levels, over 100 episodes (500 frames each), when no stimulus is given (indicated by empty matrix on the top). Each row of each matrix is one episode.

(K) Same as in J, but stimulation with pulses of varying durations is given. Top row of each matrix: pulse duration=2 frames; bottom (100th) row of each matrix: pulse duration=100 frames. The pulse stimulation is indicated in the top matrix.

Video 1. Modeling the 13A circuits.

Description in Figure 7I.

KEY RESOURCES TABLE

REAGENT or RESOURCE	SOURCE	IDENTIFIER	
Antibodies	
Chicken polyclonal anti-GFP	Abcam	RRID: AB_300798	
Rabbit (Rb) polyclonal anti-GFP	Invitrogen	Cat #A11122; RRID: AB_221569	
Mouse (ms) monoclonal anti-Bruchpilot	DSHB	RRID: AB_2314866	
ms anti-Neuroglian (BP104)	DSHB	RRID: AB_528402	
Mouse polyclonal anti-V5:DyLight 550	AbD Serotec	RRID: AB_2687576	
Rabbit polyclonal anti-HA	Cell Signaling Technologies	RRID: AB_1549585	
Rat monoclonal anti-FLAG	Novus Bio	RRID: AB_1625982	
Goat anti-Chicken Alexa Fluor 488	Invitrogen	RRID:AB_142924	
Goat anti-rabbit Alexa Fluor 488	Invitrogen	RRID. AB_143165	
Goat anti-mouse Alexa Fluor 568	Invitrogen	RRID: AB_2534072	
Goat anti-mouse Alexa Fluor 633	Invitrogen	RRID:AB_2535719	
Goat anti-rabbit Alexa Fluor 568	Invitrogen	RRID: AB_143157	
Goat anti-rat Alexa Fluor 488	Invitrogen	RRID: AB_2534074	
Donkey anti-rat Alexa 647	Jackson ImmunoResearch	RRID: AB_2340694	
Chemicals, Peptides, and Recombinant Proteins			
Insect-a-slip	Bio Quip Products	Cat#2871A	
Reactive Yellow 86	Organic Dyestuffs Corporation	CAS 61951-86-8	
Experimental Models: Organisms/Strains	
R35G04-GAL4-DBD	Bloomington Stock Center (BDSC)	RRID: BDSC_70351	
GAD-GAL4-AD	Deng et al., 2019		
GAD-GAL4-DBD	Gift from Haluck Lacin and James Truman		
Dbx-GAL4-AD	Gift from Haluck Lacin and James Truman		
Dbx-GAL4-DBD	Gift from Haluck Lacin and James Truman		
R11C07 AD	BDSC	RRID: BDSC_70533	
w[1118]; P{y[+t7.7] w[+mC]=20XUAS-IVS-CsChrimson.mVenus} attP40	BDSC	RRID: BDSC_55135	
P{JFRC7-20XUAS-IVS-mCD8::GFP} attp40	BDSC	RRID: BDSC_32194	
UAS-GTACR1	Gift from Adam Claridge-Chang		
w[*]; P{y[+t7.7] w[+mC]=UAS-GtACR1.d.EYFP}attP2	BDSC	RRID: BDSC_92983	
w[1118] P{y[+t7.7] w[+mC]=R57C10-FLPL} su(Hw)attP8; PBac{y[+mDint2] w[+mC]=10xUAS(FRT.sto p)myr::smGdP-HA} VK00005 P{y[+t7.7] w[+mC]=10xUAS(FRT.sto p)myr::smGdP-V5-THS-10xUAS(FRT.stop)m yr::smGdP-FLAG} su(Hw)attP1(MCFO3)	BDSC	RRID: BDSC_64087	
10XUAS-IVS-eGFP-Kir2.1	von Reyn et al., 2014		
Control-GAL4-AD-GAL4-DBD empty Split: BPp65ADZp(attp40); BPZpGDBD(attp2)	BDSC	RRID: BDSC_79603	
Software and Algorithms	
DeepLabCut	Mathis et al., 2018	RRID:SCR_021391	
Python		RRID:SCR_008394	
MATLAB	MathWorks	RRID: SCR_001622	
FIJI	Schindelin et al., 2012	RRID:SCR_002285	
Adobe illustrator		RRID:SCR_010279	
Braincircuits		https://braincircuits.io/app?p=fruitfly_fanc_public	
Neuroglancer	Maitin-Shepard et al., 2021	RRID:SCR_015631	
fancr	FANC packages	https://github.com/flyconnectome/fancr	
neuPrint	Plaza et al., 2022	https://neuprint.janelia.org/	
CATMAID	Saalfeld et al., 2009	RRID:SCR_006278	
RStudio		RRID:SCR_000432
==== Refs
REFERENCES

1. Ravbar P. , Zhang N. , & Simpson J. H. (2021). Behavioral evidence for nested central pattern generator control of Drosophila grooming. eLife, 10 , e71508. 10.7554/eLife.71508 34936550
2. Seeds A. M. , Ravbar P. , Chung P. , Hampel S. , Midgley F. M. Jr , Mensh B. D. , & Simpson J. H. (2014). A suppression hierarchy among competing motor programs drives sequential grooming in Drosophila. eLife, 3 , e02951. 10.7554/eLife.02951 25139955
3. Hampel S. , McKellar C. E. , Simpson J. H. , & Seeds A. M. (2017). Simultaneous activation of parallel sensory pathways promotes a grooming sequence in Drosophila. eLife, 6 , e28804. 10.7554/eLife.28804 28887878
4. Zhang N. , Guo L. , & Simpson J. H. (2020). Spatial Comparisons of Mechanosensory Information Govern the Grooming Sequence in Drosophila. Current biology : CB, 30 (18 ), 3697–3698. 10.1016/j.cub.2020.08.070 32961146
5. Zhang N. , & Simpson J. H. (2022). A pair of commissural command neurons induces Drosophila wing grooming. iScience, 25 (2 ), 103792. 10.1016/j.isci.2022.103792
6. Guo L. , Zhang N. , & Simpson J. H. (2022). Descending neurons coordinate anterior grooming behavior in Drosophila. Current biology : CB, 32 (4 ), 823–833.e4. 10.1016/j.cub.2021.12.055 35120659
7. Eichler K. , Hampel S. , Alejandro-García A. , Calle-Schuler S. A. , Santana-Cruz A. , Kmecova L. , Blagburn J. M. , Hoopfer E. D. , & Seeds A. M. (2024). Somatotopic organization among parallel sensory pathways that promote a grooming sequence in Drosophila. eLife, 12 , RP87602. 10.7554/eLife.87602
8. Yoshikawa S. , Tang P. , & Simpson J. H. (2024). Mechanosensory and command contributions to the Drosophila grooming sequence. Current biology : CB, 34 (10 ), 2066–2076.e3. 10.1016/j.cub.2024.04.003 38657610
9. Miller A. (1950). The internal anatomy and histology of the imago of Drosophila melanogaster. In Biology of Drosophila (ed. Demerec M. ), pp.420–531. New York, NY: John Wiley &Sons.
10. Soler C. , Daczewska M. , Da Ponte J. P. , Dastugue B. , & Jagla K. (2004). Coordinated development of muscles and tendons of the Drosophila leg. Development, 131 (24 ), 6041–6051. 10.1242/dev.01527 15537687
11. Azevedo A. , Lesser E. , Mark B. , Phelps J. , Elabbady L. , Kuroda S. , Sustar A. , Moussa A. , Kandelwal A. , Dallmann C.J. , (2024). Connectomic reconstruction of a female Drosophila ventral nerve cord. Nature, 10.1038/s41586-024-07389-x.; doi: 10.1038/s41586-024-07389-x
12. Azevedo A.W. , Dickinson E.S. , Gurung P. , Venkatasubramanian L. , Mann R.S. , Tuthill J.C. , 2020. A size principle for recruitment of Drosophila leg motor neurons. eLife 9 , e56754. 10.7554/eLife.56754 32490810
13. Baek M. , & Mann R. S. (2009). Lineage and birth date specify motor neuron targeting and dendritic architecture in adult Drosophila. The Journal of neuroscience 29 (21 ), 6904–6916. 10.1523/JNEUROSCI.1585-09.2009 19474317
14. Brierley D. J. , Rathore K. , VijayRaghavan K. , & Williams D. W. (2012). Developmental origins and architecture of Drosophila leg motoneurons. The Journal of comparative neurology, 520 (8 ), 1629–1649. 10.1002/cne.23003 22120935
15. Phelps J.S. , Hildebrand D.G.C. , Graham B.J. , Kuan A.T. , Thomas L.A. , Nguyen T.M. , Buhmann J. , Azevedo A.W. , Sustar A. , Agrawal S. , (2021). Reconstruction of motor control circuits in adult Drosophila using automated transmission electron microscopy. Cell, 184 (3 ), 759–774.e18. 10.1016/j.cell.2020.12.013 33400916
16. Lesser E. , Azevedo A. W. , Phelps J. S. , Elabbady L. , Cook A. , Syed D. S. , Mark B. , Kuroda S. , Sustar A. , Moussa A. , (2024). Synaptic architecture of leg and wing premotor control networks in Drosophila. Nature, 10.1038/s41586-024-07600-z. 10.1038/s41586-024-07600-z
17. Cheong H.S.J. , Eichler K. , Stürner T. , Asinof S.K. , Champion A.S. , Marin E.C. , Oram T.B. , Sumathipala M. , Venkatasubramanian L. , Namiki S. , (2024). Transforming descending input into behavior: The organization of premotor circuits in the Drosophila Male Adult Nerve Cord connectome eLife 13 :RP96084. 10.7554/eLife.96084.1
18. Lacin H. , Chen H. M. , Long X. , Singer R. H. , Lee T. , & Truman J. W. (2019). Neurotransmitter identity is acquired in a lineage-restricted manner in the Drosophila CNS. eLife, 8 , e43701. 10.7554/eLife.43701 30912745
19. Harris R. M. , Pfeiffer B. D. , Rubin G. M. , & Truman J. W. (2015). Neuron hemi-lineages provide the functional ground plan for the Drosophila ventral nervous system. eLife, 4 , e04493. 10.7554/eLife.04493 26193122
20. Mendes C. S. , Bartos I. , Akay T. , Márka S. , & Mann R. S. (2013). Quantification of gait parameters in freely walking wild type and sensory deprived Drosophila melanogaster. eLife, 2 , e00231. 10.7554/eLife.00231 23326642
21. Tuthill J. C. , & Azim E. (2018). Proprioception. Current biology : CB, 28 (5 ), R194–R203. 10.1016/j.cub.2018.01.064 29510103
22. Chockley A. S. , Dinges G. F. , Di Cristina G. , Ratican S. , Bockemühl T. , & Büschges A. (2022). Subsets of leg proprioceptors influence leg kinematics but not interleg coordination in Drosophila melanogaster walking. The Journal of experimental biology, 225 (20 ), jeb244245. 10.1242/jeb.244245
23. Lee S.J. , Dallmann C.J. , Cook A. , Tuthill J.C. , Agrawal S. (2024). Divergent neural circuits for proprioceptive and exteroceptive sensing of the Drosophila leg. bioRxiv 2024.04.23.590808; doi: 10.1101/2024.04.23.590808
24. Bernstein N. (1967). The co-ordination and regulation of movements. Oxford: Pergamon
25. Bizzi E. , and Cheung V. C. (2013). The neural origin of muscle synergies. Frontiers in computational neuroscience, 7 , 51. 10.3389/fncom.2013.00051 23641212
26. Sherrington C. S. (1892). Notes on the Arrangement of some Motor Fibres in the Lumbo-Sacral Plexus. The Journal of physiology, 13 (6 ), 621–772.17. 10.1113/jphysiol.1892.sp000428
27. Sharrard W. J. (1964). The segmental innervation of the lower limb muscles in man. Annals of the Royal College of Surgeons of England, 35 (2 ), 106–122.14180405
28. Ferrier D. and Yeo G. F. (1881). The functional relations of the motor roots of the brachial and lumbo-sacral plexuses. Proceedings of the Royal Society of London, vol. 32 , no. 212–215 .
29. Bizzi E. , Mussa-Ivaldi F. A. , & Giszter S. (1991). Computations underlying the execution of movement: a biological perspective. Science, 253 (5017 ), 287–291. 10.1126/science.1857964 1857964
30. Giszter S. F. , Mussa-Ivaldi F. A. , & Bizzi E. (1993). Convergent force fields organized in the frog’s spinal cord. The Journal of neuroscience : the official journal of the Society for Neuroscience, 13 (2 ), 467–491. 10.1523/JNEUROSCI.13-02-00467.1993 8426224
31. Lemay M. A. , & Grill W. M. (2004). Modularity of motor output evoked by intraspinal microstimulation in cats. Journal of neurophysiology, 91 (1 ), 502–514. 10.1152/jn.00235.2003 14523079
32. Tresch M. C. , & Bizzi E. (1999). Responses to spinal microstimulation in the chronically spinalized rat and their relationship to spinal systems activated by low threshold cutaneous stimulation. Experimental brain research, 129 (3 ), 401–416. 10.1007/s002210050908 10591912
33. Mussa-Ivaldi F. A. , Giszter S. F. , & Bizzi E. (1994). Linear combinations of primitives in vertebrate motor control. Proceedings of the National Academy of Sciences, 91 (16 ), 7534–7538. 10.1073/pnas.91.16.7534
34. Kargo W. J. , & Giszter S. F. (2000). Rapid correction of aimed movements by summation of force-field primitives. The Journal of neuroscience, 20 (1 ), 409–426. 10.1523/JNEUROSCI.20-01-00409.2000 10627617
35. Lemay M. A. , Galagan J. E. , Hogan N. , & Bizzi E. (2001). Modulation and vectorial summation of the spinalized frog’s hindlimb end-point force produced by intraspinal electrical stimulation of the cord. IEEE transactions on neural systems and rehabilitation engineering 9 (1 ), 12–23. 10.1109/7333.918272 11482358
36. Maier M. A. , & Hepp-Reymond M. C. (1995). EMG activation patterns during force production in precision grip. II. Muscular synergies in the spatial and temporal domain. Experimental brain research, 103 (1 ), 123–136. 10.1007/BF00241970 7615028
37. Huesler E. J. , Maier M. A. , & Hepp-Reymond M. C. (2000). EMG activation patterns during force production in precision grip. III. Synchronisation of single motor units. Experimental brain research, 134 (4 ), 441–455. 10.1007/s002210000484 11081826
38. Ivanenko Y. P. , Grasso R. , Zago M. , Molinari M. , Scivoletto G. , Castellano V. , Macellari V. , & Lacquaniti F. (2003). Temporal components of the motor patterns expressed by the human spinal cord reflect foot kinematics. Journal of neurophysiology, 90 (5 ), 3555–3565. 10.1152/jn.00223.2003 12853436
39. Hart C. B. , & Giszter S. F. (2004). Modular premotor drives and unit bursts as primitives for frog motor behaviors. The Journal of neuroscience, 24 (22 ), 5269–5282. 10.1523/JNEUROSCI.5626-03.2004 15175397
40. Yakovenko S. , Krouchev N. , & Drew T. (2011). Sequential activation of motor cortical neurons contributes to intralimb coordination during reaching in the cat by modulating muscle synergies. Journal of neurophysiology, 105 (1 ), 388–409. 10.1152/jn.00469.2010 21068260
41. Overduin S. A. , d’Avella A. , Carmena J. M. , & Bizzi E. (2012). Microstimulation activates a handful of muscle synergies. Neuron, 76 (6 ), 1071–1077. 10.1016/j.neuron.2012.10.018 23259944
42. Singh R. E. , Iqbal K. , White G. , & Hutchinson T. E. (2018). A Systematic Review on Muscle Synergies: From Building Blocks of Motor Behavior to a Neurorehabilitation Tool. Applied bionics and biomechanics, 2018 , 3615368. 10.1155/2018/3615368
43. Tresch M. C. , Cheung V. C. , & d’Avella A. (2006). Matrix factorization algorithms for the identification of muscle synergies: evaluation on simulated and experimental data sets. Journal of neurophysiology, 95 (4 ), 2199–2212. 10.1152/jn.00222.2005 16394079
44. Kargo W. J. , Ramakrishnan A. , Hart C. B. , Rome L. C. , & Giszter S. F. (2010). A simple experimentally based model using proprioceptive regulation of motor primitives captures adjusted trajectory formation in spinal frogs. Journal of neurophysiology, 103 (1 ), 573–590. 10.1152/jn.01054.2007 19657082
45. Kutch J. J. , & Valero-Cuevas F. J. (2012). Challenges and new approaches to proving the existence of muscle synergies of neural origin. PLoS computational biology, 8 (5 ), e1002434. 10.1371/journal.pcbi.1002434 22570602
46. Alessandro C. , Delis I. , Nori F. , Panzeri S. , & Berret B. (2013). Muscle synergies in neuroscience and robotics: from input-space to task-space perspectives. Frontiers in computational neuroscience, 7 , 43. 10.3389/fncom.2013.00043 23626535
47. Capaday C. , & van Vreeswijk C. (2015). Linear summation of outputs in a balanced network model of motor cortex. Frontiers in computational neuroscience, 9 , 63. 10.3389/fncom.2015.00063 26097452
48. Spüler M. , Irastorza-Landa N. , Sarasola-Sanz A. , & Ramos-Murguialday A. (2016). Extracting muscle synergy patterns from EMG data using autoencoders. In Artificial Neural Networks and Machine Learning–ICANN 2016: 25th International Conference on Artificial Neural Networks, Barcelona, Spain, September 6–9, 2016, Proceedings, Part II 25 (pp. 47–54). Springer International Publishing.
49. Aoi S. , & Funato T. (2016). Neuromusculoskeletal models based on the muscle synergy hypothesis for the investigation of adaptive motor control in locomotion via sensory-motor coordination. Neuroscience research, 104 , 88–95. 10.1016/j.neures.2015.11.005 26616311
50. Afzal T. , Iqbal K. , White G. , & Wright A. B. (2017). A Method for Locomotion Mode Identification Using Muscle Synergies. IEEE transactions on neural systems and rehabilitation engineering, 25 (6 ), 608–617. 10.1109/TNSRE.2016.2585962 27362983
51. Romanes G. J. (1951). The motor cell columns of the lumbo-sacral spinal cord of the cat. The Journal of comparative neurology, 94 (2 ), 313–363. 10.1002/cne.900940209 14832391
52. Cruce W. L. (1974). The anatomical organization of hindlimb motoneurons in the lumbar spinal cord of the frog, Rana catesbiana. The Journal of comparative neurology, 153 (1 ), 59–76. 10.1002/cne.901530106 4544669
53. Tsuchida T. , Ensini M. , Morton S. B. , Baldassare M. , Edlund T. , Jessell T. M. , & Pfaff S. L. (1994). Topographic organization of embryonic motor neurons defined by expression of LIM homeobox genes. Cell, 79 (6 ), 957–970. 10.1016/0092-8674(94)90027-2 7528105
54. Lanuza G. M. , Gosgnach S. , Pierani A. , Jessell T. M. , & Goulding M. (2004). Genetic identification of spinal interneurons that coordinate left-right locomotor activity necessary for walking movements. Neuron, 42 (3 ), 375–386. 10.1016/s0896-6273(04)00249-1 15134635
55. Crone S. A. , Zhong G. , Harris-Warrick R. , & Sharma K. (2009). In mice lacking V2a interneurons, gait depends on speed of locomotion. The Journal of neuroscience, 29 (21 ), 7098–7109. 10.1523/JNEUROSCI.1206-09.2009 19474336
56. Bellardita C. , & Kiehn O. (2015). Phenotypic characterization of speed-associated gait changes in mice reveals modular organization of locomotor networks. Current biology : CB, 25 (11 ), 1426–1436. 10.1016/j.cub.2015.04.005 25959968
57. Lemieux M. , Josset N. , Roussel M. , Couraud S. , & Bretzner F. (2016). Speed-Dependent Modulation of the Locomotor Behavior in Adult Mice Reveals Attractor and Transitional Gaits. Frontiers in neuroscience, 10 , 42. 10.3389/fnins.2016.00042 26941592
58. Callahan R. A. , Roberts R. , Sengupta M. , Kimura Y. , Higashijima S. I. , & Bagnall M. W. (2019). Spinal V2b neurons reveal a role for ipsilateral inhibition in speed control. eLife, 8 , e47837. 10.7554/eLife.47837 31355747
59. Sengupta M. , Daliparthi V. , Roussel Y. , Bui T. V. , & Bagnall M. W. (2021). Spinal V1 neurons inhibit motor targets locally and sensory targets distally. Current biology : CB, 31 (17 ), 3820–3833.e4. 10.1016/j.cub.2021.06.053 34289387
60. Tripodi M. , Stepien A. E. , & Arber S. (2011). Motor antagonism exposed by spatial segregation and timing of neurogenesis. Nature, 479 (7371 ), 61–66. 10.1038/nature10538 22012263
61. Arber S. , & Davis G. (2011). Developmental neuroscience. Current opinion in neurobiology, 21 (1 ), 1–4. 10.1016/j.conb.2010.12.001 21208796
62. Gordon E. M. , Chauvin R. J. , Van A. N. , Rajesh A. , Nielsen A. , Newbold D. J. , Lynch C. J. , Seider N. A. , Krimmel S. R. , Scheidter K. M. , , (2023). A somato-cognitive action network alternates with effector regions in motor cortex. Nature, 617 (7960 ), 351–359. 10.1038/s41586-023-05964-2 37076628
63. Yang W. , Kanodia H. , & Arber S. (2023). Structural and functional map for forelimb movement phases between cortex and medulla. Cell, 186 (1 ), 162–177.e18. 10.1016/j.cell.2022.12.009 36608651
64. Gowda S. B. M. , Paranjpe P. D. , Reddy O. V. , Thiagarajan D. , Palliyil S. , Reichert H. , & VijayRaghavan K. (2018). GABAergic inhibition of leg motoneurons is required for normal walking behavior in freely moving Drosophila. Proceedings of the National Academy of Sciences of the United States of America, 115 (9 ), E2115–E2124. 10.1073/pnas.1713869115 29440493
65. Shepherd D. , Harris R. , Williams D. W. , & Truman J. W. (2016). Postembryonic lineages of the Drosophila ventral nervous system: Neuroglian expression reveals the adult hemilineage associated fiber tracts in the adult thoracic neuromeres. The Journal of comparative neurology, 524 (13 ), 2677–2695. 10.1002/cne.23988 26878258
66. Truman J. W. , Schuppe H. , Shepherd D. , & Williams D. W. (2004). Developmental architecture of adult-specific lineages in the ventral CNS of Drosophila. Development, 131 (20 ), 5167–5184. 10.1242/dev.01371 15459108
67. Birkholz O. , Rickert C. , Nowak J. , Coban I. C. , & Technau G. M. (2015). Bridging the gap between postembryonic cell lineages and identified embryonic neuroblasts in the ventral nerve cord of Drosophila melanogaster. Biology open, 4 (4 ), 420–434. 10.1242/bio.201411072 25819843
68. Lacin H. , & Truman J. W. (2016). Lineage mapping identifies molecular and architectural similarities between the larval and adult Drosophila central nervous system. eLife, 5 , e13399. 10.7554/eLife.13399 26975248
69. Marin E. C. , Morris B. J. , Stürner T. , Champion A.S. , Krzeminski D. , Badalamente G. , Gkantia M. , Dunne C. R. , Eichler K. , Takemura S. , (2023). Systematic annotation of a complete adult male Drosophila nerve cord connectome reveals principles of functional organisation. bioRxiv 2023.06.05.543407 doi:10.1101/2023.06.05.543407.
70. Court R. , Namiki S. , Armstrong J. D. , Börner J. , Card G. , Costa M. , Dickinson M. , Duch C. , Korff W. , Mann R. , Merritt D. , Murphey R. K. , Seeds A. M. , Shirangi T. , Simpson J. H. , Truman J. W. , Tuthill J. C. , Williams D. W. , & Shepherd D. (2020). A Systematic Nomenclature for the Drosophila Ventral Nerve Cord. Neuron, 107 (6 ), 1071–1079.e2. 10.1016/j.neuron.2020.08.005 32931755
71. Costa M. , Manton J. D. , Ostrovsky A. D. , Prohaska S. , & Jefferis G. S. (2016). NBLAST: Rapid, Sensitive Comparison of Neuronal Structure and Construction of Neuron Family Databases. Neuron, 91 (2 ), 293–311. 10.1016/j.neuron.2016.06.012 27373836
72. Mamiya A. , Gurung P. , & Tuthill J. C. (2018). Neural Coding of Leg Proprioception in Drosophila. Neuron, 100 (3 ), 636–650.e6. 10.1016/j.neuron.2018.09.009 30293823
73. Agrawal S. , Dickinson E. S. , Sustar A. , Gurung P. , Shepherd D. , Truman J. W. , & Tuthill J. C. (2020). Central processing of leg proprioception in Drosophila. eLife, 9 , e60299. 10.7554/eLife.60299 33263281
74. Chen C. , Agrawal S. , Mark B. , Mamiya A. , Sustar A. , Phelps J. S. , Lee W. A. , Dickson B. J. , Card G. M. , & Tuthill J. C. (2021). Functional architecture of neural circuits for leg proprioception in Drosophila. Current biology : CB, 31 (23 ), 5163–5175.e7. 10.1016/j.cub.2021.09.035 34637749
75. Mathis A. , Mamidanna P. , Cury K. M. , Abe T. , Murthy V. N. , Mathis M. W. , & Bethge M. (2018). DeepLabCut: markerless pose estimation of user-defined body parts with deep learning. Nature neuroscience, 21 (9 ), 1281–1289. 10.1038/s41593-018-0209-y 30127430
76. Jovanic T. , Schneider-Mizell C. M. , Shao M. , Masson J. B. , Denisov G. , Fetter R. D. , Mensh B. D. , Truman J. W. , Cardona A. , & Zlatic M. (2016). Competitive Disinhibition Mediates Behavioral Choice and Sequences in Drosophila. Cell, 167 (3 ), 858–870.e19. 10.1016/j.cell.2016.09.009 27720450
77. Chevalier G. , & Deniau J. M. (1990). Disinhibition as a basic process in the expression of striatal functions. Trends in neurosciences, 13 (7 ), 277–280. 10.1016/0166-2236(90)90109-n 1695403
78. Mink J. W. (1996). The basal ganglia: focused selection and inhibition of competing motor programs. Progress in neurobiology, 50 (4 ), 381–425. 10.1016/s0301-0082(96)00042-1 9004351
79. Grillner S. , Hellgren J. , Ménard A. , Saitoh K. , & Wikström M. A. (2005). Mechanisms for selection of basic motor programs--roles for the striatum and pallidum. Trends in neurosciences, 28 (7 ), 364–370. 10.1016/j.tins.2005.05.004 15935487
80. Benjamin P. R. , Staras K. , & Kemenes G. (2010). What roles do tonic inhibition and disinhibition play in the control of motor programs?. Frontiers in behavioral neuroscience, 4 , 30. 10.3389/fnbeh.2010.00030 20589095
81. Zhu J. , Boivin J. , Garner A. , Ning J. , Zhao Y. Q. , Ohyama T. (2024) Feedback inhibition by a descending GABAergic neuron regulates timing of escape behavior in Drosophila larvae. eLife 13 :RP93978 10.7554/eLife.93978.1
82. Benjamin P. R. , Staras K. , & Kemenes G. (2010). What roles do tonic inhibition and disinhibition play in the control of motor programs?. Frontiers in behavioral neuroscience, 4 , 30. 10.3389/fnbeh.2010.00030 20589095
83. Zhao W. , Zhou P. , Gong C. , Ouyang Z. , Wang J. , Zheng N. , & Gong Z. (2019). A disinhibitory mechanism biases Drosophila innate light preference. Nature communications, 10 (1 ), 124. 10.1038/s41467-018-07929-w
84. Manjila S. B. , Kuruvilla M. , Ferveur J. F. , Sane S. P. , & Hasan G. (2019). Extended Flight Bouts Require Disinhibition from GABAergic Mushroom Body Neurons. Current biology : CB, 29 (2 ), 283–293.e5. 10.1016/j.cub.2018.11.070 30612904
85. Kiehn O. (2016). Decoding the organization of spinal circuits that control locomotion. Nature reviews. Neuroscience, 17 (4 ), 224–238. 10.1038/nrn.2016.9 26935168
86. Talpalar A. E. , Endo T. , Löw P. , Borgius L. , Hägglund M. , Dougherty K. J. , Ryge J. , Hnasko T. S. , & Kiehn O. (2011). Identification of minimal neuronal networks involved in flexor-extensor alternation in the mammalian spinal cord. Neuron, 71 (6 ), 1071–1084. 10.1016/j.neuron.2011.07.011 21943604
87. Cowley K. C. , & Schmidt B. J. (1995). Effects of inhibitory amino acid antagonists on reciprocal inhibitory interactions during rhythmic motor activity in the in vitro neonatal rat spinal cord. Journal of neurophysiology, 74 (3 ), 1109–1117. 10.1152/jn.1995.74.3.1109 7500136
88. Kjaerulff O. , & Kiehn O. (1997). Crossed rhythmic synaptic input to motoneurons during selective activation of the contralateral spinal locomotor network. The Journal of neuroscience,17 (24 ), 9433–9447. 10.1523/JNEUROSCI.17-24-09433.1997 9390999
89. Whelan P. , Bonnot A. , & O’Donovan M. J. (2000). Properties of rhythmic activity generated by the isolated spinal cord of the neonatal mouse. Journal of neurophysiology, 84 (6 ), 2821–2833. 10.1152/jn.2000.84.6.2821 11110812
90. Endo T. , & Kiehn O. (2008). Asymmetric operation of the locomotor central pattern generator in the neonatal mouse spinal cord. Journal of neurophysiology, 100 (6 ), 3043–3054. 10.1152/jn.90729.2008 18829847
91. Zhang J. , Lanuza G. M. , Britz O. , Wang Z. , Siembab V. C. , Zhang Y. , Velasquez T. , Alvarez F. J. , Frank E. , & Goulding M. (2014). V1 and v2b interneurons secure the alternating flexor-extensor motor activity mice require for limbed locomotion. Neuron, 82 (1 ), 138–150. 10.1016/j.neuron.2014.02.013 24698273
92. Dallmann C. J. , Luo Y. , Agrawal S. , Chou G. M. , Cook A. , Brunton B. W. , & Tuthill J. C. (2024). Presynaptic inhibition selectively suppresses leg proprioception in behaving Drosophila. bioRxiv : the preprint server for biology, 2023.10.20.563322. 10.1101/2023.10.20.563322
93. Field L. H. , Burrows M. (1982). Reflex effects of the femoral chordotonal organ upon leg motor neurones of the Locust. J Exp Biol., 101 (1 ): 265–285. 10.1242/jeb.101.1.265
94. Sherrington C. S. , (1910), Flexion-reflex of the limb, crossed extension-reflex, and reflex stepping and standing. The Journal of Physiology, 40 doi: 10.1113/jphysiol.1910.sp001362
95. Andersson O , Grillner S (1983). Peripheral control of the cat’s step cycle. II Entrainment of the central pattern generators for locomotion by sinusoidal hip movements during “fictive locomotion”. Acta Physiol Sc. 118 :229–239
96. Kriellaars D. J. , Brownstone R. M. , Noga B. R. , & Jordan L. M. (1994). Mechanical entrainment of fictive locomotion in the decerebrate cat. Journal of neurophysiology, 71 (6 ), 2074–2086. 10.1152/jn.1994.71.6.2074 7931503
97. Pearson K. G. (2004). Generating the walking gait: role of sensory feedback. Progress in brain research, 143 , 123–129. 10.1016/S0079-6123(03)43012-4 14653157
98. Marlot D. , Macron J. M. , & Duron B. (1987). Inhibitory and excitatory effects on respiration by phrenic nerve afferent stimulation in cats. Respiration physiology, 69 (3 ), 321–333. 10.1016/0034-5687(87)90086-7 3659601
99. Jammes Y. , Buchler B. , Delpierre S. , Rasidakis A. , Grimaud C. , & Roussos C. (1986). Phrenic afferents and their role in inspiratory control. Journal of applied physiology (Bethesda, Md. : 1985), 60 (3 ), 854–860. 10.1152/jappl.1986.60.3.854 3957836
100. Brown T. G. (1911). The intrinsic factors in the act of progression in the mammal. Proceedings of the Royal Society of London. Series B, containing papers of a biological character, 84 (572 ), 308–319.
101. Brown T. G. (1914). On the nature of the fundamental activity of the nervous centres; together with an analysis of the conditioning of rhythmic activity in progression, and a theory of the evolution of function in the nervous system. The Journal of physiology, 48 (1 ), 18–46. 10.1113/jphysiol.1914.sp001646 16993247
102. Stuart D. G. , & Hultborn H. (2008). Thomas Graham Brown (1882−−1965), Anders Lundberg (1920-), and the neural control of stepping. Brain research reviews, 59 (1 ), 74–95. 10.1016/j.brainresrev.2008.06.001 18582502
103. Duysens J. , De Groote F. , & Jonkers I. (2013). The flexion synergy, mother of all synergies and father of new models of gait. Frontiers in computational neuroscience, 7 , 14. 10.3389/fncom.2013.00014 23494365
104. Zhong G. , Shevtsova N. A. , Rybak I. A. , & Harris-Warrick R. M. (2012). Neuronal activity in the isolated mouse spinal cord during spontaneous deletions in fictive locomotion: insights into locomotor central pattern generator organization. The Journal of physiology, 590 (19 ), 4735–4759. 10.1113/jphysiol.2012.240895 22869012
105. Cowey A. (1979). Cortical maps and visual perception: the Grindley Memorial Lecture. The Quarterly journal of experimental psychology, 31 (1 ), 1–17. 10.1080/14640747908400703 424501
106. Raj A. , & Chen Y. H. (2011). The wiring economy principle: connectivity determines anatomy in the human brain. PloS one, 6 (9 ), e14832. 10.1371/journal.pone.0014832 21915250
107. Pérez-Escudero A. , & de Polavieja G. G. (2007). Optimally wired subnetwork determines neuroanatomy of Caenorhabditis elegans. Proceedings of the National Academy of Sciences of the United States of America, 104 (43 ), 17180–17185. 10.1073/pnas.0703183104 17942697
108. Chklovskii D. B. , Schikorski T. , & Stevens C. F. (2002). Wiring optimization in cortical circuits. Neuron, 34 (3 ), 341–347. 10.1016/s0896-6273(02)00679-7 11988166
109. Lemay M. A. , & Grill W. M. (2004). Modularity of motor output evoked by intraspinal microstimulation in cats. Journal of neurophysiology, 91 (1 ), 502–514. 10.1152/jn.00235.2003 14523079
110. Karashchuk L. , Li J. S. L. , Chou G. M. , Walling-Bell S. , Brunton S. L. , Tuthill J. C. , & Brunton B. W. (2024). Sensorimotor delays constrain robust locomotion in a 3D kinematic model of fly walking. bioRxiv, 2024–04.
111. Jenett A. , Rubin G. M. , Ngo T. T. , Shepherd D. , Murphy C. , Dionne H. , Pfeiffer B. D. , Cavallaro A. , Hall D. , Jeter J. , , (2012). A GAL4-driver line resource for Drosophila neurobiology. Cell reports, 2 (4 ), 991–1001. 10.1016/j.celrep.2012.09.011 23063364
112. Ravbar P. , Branson K. , & Simpson J. H. (2019). An automatic behavior recognition system classifies animal behaviors using movements and their temporal context. Journal of neuroscience methods, 326 , 108352. 10.1016/j.jneumeth.2019.108352
113. Saalfeld S. , Cardona A. , Hartenstein V. , & Tomancak P. (2009). CATMAID: collaborative annotation toolkit for massive amounts of image data. Bioinformatics, 25 (15 ), 1984–1986. 10.1093/bioinformatics/btp266 19376822
114. Maitin-Shepard J. (2021) google/neuroglancer: Zenodo 10.5281/zenodo.5573294
