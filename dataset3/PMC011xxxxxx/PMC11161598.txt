
==== Front
Sci Rep
Sci Rep
Scientific Reports
2045-2322
Nature Publishing Group UK London

63413
10.1038/s41598-024-63413-0
Article
Cell-specific models of hiPSC-CMs developed by the gradient-based parameter optimization method fitting two different action potential waveforms
Zhang Yixin 1
Toyoda Futoshi 23
Himeno Yukiko hime@fc.ritsumei.ac.jp

12
Noma Akinori 1
Amano Akira 1
1 https://ror.org/0197nmd03 grid.262576.2 0000 0000 8863 9909 Graduate School of Life Sciences, Ritsumeikan University, Kusatsu, Japan
2 https://ror.org/00d8gp927 grid.410827.8 0000 0000 9747 6806 Department of Physiology, Shiga University of Medical Science, Otsu, Japan
3 grid.410827.8 0000 0000 9747 6806 Central Research Laboratory, Shiga University of Medical Science, Otsu, Japan
7 6 2024
7 6 2024
2024
14 130864 12 2023
28 5 2024
© The Author(s) 2024
https://creativecommons.org/licenses/by/4.0/ Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/.
Parameter optimization (PO) methods to determine the ionic current composition of experimental cardiac action potential (AP) waveform have been developed using a computer model of cardiac membrane excitation. However, it was suggested that fitting a single AP record in the PO method was not always successful in providing a unique answer because of a shortage of information. We found that the PO method worked perfectly if the PO method was applied to a pair of a control AP and a model output AP in which a single ionic current out of six current species, such as IKr, ICaL, INa, IKs, IKur or IbNSC was partially blocked in silico. When the target was replaced by a pair of experimental control and IKr-blocked records of APs generated spontaneously in human induced pluripotent stem cell-derived cardiomyocytes (hiPSC-CMs), the simultaneous fitting of the two waveforms by the PO method was hampered to some extent by the irregular slow fluctuations in the Vm recording and/or sporadic alteration in AP configurations in the hiPSC-CMs. This technical problem was largely removed by selecting stable segments of the records for the PO method. Moreover, the PO method was made fail-proof by running iteratively in identifying the optimized parameter set to reconstruct both the control and the IKr-blocked AP waveforms. In the lead potential analysis, the quantitative ionic mechanisms deduced from the optimized parameter set were totally consistent with the qualitative view of ionic mechanisms of AP so far described in physiological literature.

Subject terms

Cardiovascular biology
Computational models
http://dx.doi.org/10.13039/501100001691 Japan Society for the Promotion of Science 16K18996 21K06781 Zhang Yixin Himeno Yukiko issue-copyright-statement© Springer Nature Limited 2024
==== Body
pmcIntroduction

The human cardiac action potential (AP) is characterized by the long-lasting plateau phase of the action potential, which lasts for a few hundreds of milliseconds. The AP plateau phase is generated by several ionic currents such as ICaL, INaL, IKr, IKs, IKur, and IbNSC, whose conductances are relatively small to allow subtle adjustment of the AP configuration as well as the force of contraction through a variety of cellular control mechanisms. The property of individual ionic currents has been extensively studied for more than a half century, and findings were integrated into computer models to reconstruct not only the membrane excitation but also the intracellular Ca2+ dynamics and the force of contraction of cardiac myocytes1–6. The models of human cardiac myocytes7–10 are used to examine the physiological mechanisms, pharmacological regulation, and pathophysiological alterations of these cellular functions. Thus, computer models of cardiac myocytes are now becoming an essential facility in the laboratory.

To extend the usage of the computer model in predicting responses of cardiac myocytes to various kinds of experimental interventions, the accuracy of the model should be assessed in an objective manner, as has been done in various biological mechanisms11–19. The validation of the computer model of cardiac myocytes so far described in literature relies upon statistical comparison between the model output and the experimental recordings with respect to the AP metrics, such as the AP duration (APD), the level of the AP plateau as well as the Ca2+ transients at different stimulus frequency. However, quantitative parameter optimization (PO) of the computer model is required in reference to experimental measurements (see Whittaker et al.13 for the recent review article).

Dokos and Lovell11 firstly applied the gradient-based parameter optimization method to the computer model of cardiac membrane excitation20. Model parameters such as the conductance of the four ionic currents and the rate constants of state transition of the four ionic currents (63 parameters in total) were optimized. They examined the accuracy of the PO method by testing if the original AP waveform (model output) can be recovered from the modified AP waveform, both of which were generated by the computer model. (We call this mode of PO method as model vs model (MM) test in comparison to the experimental data vs model (EM) test using the experimental recordings in the present study.) They concluded, however, that it was difficult to recover the original model parameters. They suggested the feasibility of the PO method will be improved if provided with additional experimental data.

Recently, Groenendaal et al.21 applied the MM test to a limited number of conductance parameters of the detailed human cardiac myocyte model8. They used the PO method based on the algorithm of genetic evolution22. In addition to the AP waveform, they used a current response, which was generated by applying voltage clamp pulses to the cardiac cell model. For the error function, the AP metrics were used. Thus, they could obtain a parameter set which well superimposed the model output to the target AP waveform. However, it has been suggested that different combinations of parameters may generate simple outputs that are very similar11,21,23,24. We applied the gradient-based PO method to variable AP configurations of the hiPSC-CMs25. It was found that the model parameters were slightly variable by less than 5% of the mean in each cell model when the mean square error (MSE) was finally minimized by the PO method. However, significant positive or negative correlations were observed between different pairs of parameters which could be attributed to the overlapping of the two currents during the slow diastolic depolarization (SDD) or the AP plateau. Thus, different combinations of two parameters obtained from the correlation curve can generate similar AP waveforms. This complication might be solved by using additional information obtained by different experimental protocols. Namely, a unique parameter set will be determined by the gradient-based PO method at a cross point of correlation lines or curves within a multi-dimensional parameter space.

In the present study, we used two experimental records of spontaneous AP obtained before and during partial blockage of IKr for the PO method. The baseline model of hiPSC-CMs developed by Kohjitani et al.25 was used to obtain individual cell-specific models.

Methods

Preparation of dissociated hiPSC-CMs and recording of spontaneous APs

The preparation of dissociated hiPSC-CMs and the electrophysiological recording of APs were similar to those described in Kohjitani et al.25 The cells were purchased from Myoridge, Kyoto, Japan (CarmyA, H-011106). The frozen single cell stocks were rapidly thawed, suspended in CarmyA seeding medium (ME-12A00241, Myoridge) supplemented with 10 μM Rock inhibitor, Y-27632 (Sigma), and then sparsely plated on glass coverslips precoated with 1.6 µg/ml iMatrix-511 silk (Matrixome, Osaka, Japan). After 10–21 days of culture in CarmyA maintenance medium (ME-01A00241, Myoridge), spontaneously beating single cells were used for the experiments. For the electrophysiological measurements, the cells attached on the glass coverslip were transferred into the recording chamber mounted on the microscope stage and superfused with Tyrode solution containing (in mM): 140 NaCl, 0.33 NaH2PO4, 5.4 KCl, 1.8 CaCl2, 0.5 MgCl2, 5 HEPES, 5.5 glucose; pH7.4 (NaOH) at 37 °C. APs were recorded in the amphotericin-perforated patch-clamp configuration under current-clamp mode using an EPC8 patch-clamp amplifier in combination with PatchMaster acquisition software (HEKA). Pipette solution contained (in mM): 70 KOH, 50 KCl, 10 KH2PO4, 1 MgSO4, 3 Na2-ATP, 5 HEPES, 5 EGTA, 0.1 Li2-GTP; pH 7.2 (aspartate). The AP signal was filtered at 5 kHz and digitized at 20 kHz. A selective IKr blocker, E-4031 (Wako, Japan) was dissolved in distilled water to yield 5 mM stock solution and added to the bath solution at the concentrations of 0.01–1 μM.

The baseline model of hiPSC-CM membrane excitation

The baseline model of hiPSC-CMs is a variant of the human ventricular cell model (hVC model) adapted to experimental measurements in hiPSC-CMs25. The hVC model has been fully described in literature9,10 and shares many comparable characteristics with other human models so far published7,8. The model structure of the hVC model consists of the cell membrane with fifteen ionic channel species and two ion exchangers, the sarcoplasmic reticulum equipped with the refined Ca2+ releasing units coupled with the L-type Ca2+ channels on the cell membrane at the microscopic dyadic space, the contractile fibers, and the cytosolic Ca2+ diffusion spaces containing several Ca2+-binding proteins.

The source code of the present hiPSC-CM model was written in Visual Basic and is available from our e-Heart website (http://www.eheartsim.com/en/downloads/), and the model equations are described in the supplemental materials in the present study.

In the present study, the net membrane ion current (Itot_cell) is calculated as the sum of nine ion channel currents and two ion transporters (INaK and INCX) (Eq. 1).1 Itot_cell=INa+ICaL+Iha+IK1+IKr+IKs+IKur+IKto+IbNSC+INaK+INCX

A few ion channels listed in Eq. (1) or in supplemental materials were not necessarily expressed in every cell to a significant level to affect the AP waveform. In such cases, we removed the current from the initial set of PO parameters through the initial manual fitting process explained in the last part of this section.

The INa is composed of two components; one is the transient type (INaT) and the other shows the very slow inactivation (INaL). INaL plays a significant role in both slow diastolic depolarization as well as in the AP plateau. In the present study, the Na+ mediated sustained inward current, Ist26–28 is included in the ICaL for simplicity. Rationale for this simplification was derived from the references suggesting Cav1.3 as a molecular determinant of Ist29,30. We excluded background currents of much smaller amplitude, such as IKACh, IKATP, I(lCa), and ICab from the parameter optimization and adjusted only the background non-selective cation current (IbNSC) of significant amplitude for the sake of simplicity31–33. The IbNSC was re-defined in the present study as a time-independent net current, which remained after blocking all time-dependent currents.

The parameter optimization in the present study was conducted under the assumption that the variable AP configurations in the hiPSC-CMs were caused by different expression levels of ion channels on the cell surface membrane, while the channel open- and close-state transition kinetics remain the same as described in the hVC cell model. Before starting the PO method, we manually adjusted the model parameters (current magnitude of individual currents in Eq. 1) to fit the model output to the target AP waveform on the graphic display. Usually, the 9 ionic channel currents were all examined for their capability to simulate the experimental AP configuration by the model output, and those without an obvious improvement of the model output were excluded from the PO parameters. This selection of the optimizing parameters contributes to reducing the computational time of the PO method. The computational time increases exponentially when the number of the optimizing parameters increase and also if the parameter which does not affect the AP waveform was included. Note that, the number of the optimizing parameters to perform the PO method in the realistic computational time was around six with the computational resource used in this study.

A brief note on membrane excitation

The membrane excitation of the model is generated through charging and discharging the membrane capacitance (Cm) by the net ionic current (Itot_cell) across the cell membrane (Eq. 2). The driving force for the ionic current is provided by the potential difference between Vm and the equilibrium potential (Ex) (Eq. 3). The net electrical conductance of the channel is changed by the dynamic changes in the open probability (pO) of the channel, which is mostly Vm-dependent through the Vm-dependent rate constants (α,β) of the opening and closing conformation changes of the channel (Eqs. 4, 5).2 dVmdt=-∑Itot_cellCm

3 Ix=G¯x·pO·Vm-Ex

4 dpOdt=α·1-pO-β·pO

5 αβT=fVm

For the parameter optimization, the limiting conductance G¯x of each ionic current (Eq. 3) is represented by a product of Ixmag and Ixsf. The former is a reference magnitude of conductance and the latter is the scaling factor (0 < Ixsf).6 G¯x=Ix,mag·Ixsf

When the constant field (GHK) equation is used, the current density amplitude Ix is given by,7 Ix=P¯xz·F·A·Si-So·B1-B·pO

8 A=z·F·VmR·T

9 B=e-A

where P¯x is the limiting permeability of ion x across the cell membrane and Si and So are the internal and external ion concentrations, respectively. The unit of P¯x is pA/pF/mM across the membrane. The Ixsf is also used for the PO parameter.10 P¯x=Px,mag·Ixsf

Pattern search method; MM test, EM test, and multi-run test

For a system showing a relatively simple gradient of MSE along the parameter axis, gradient-based optimization methods are more efficient in general than stochastic methods. We used one of the basic gradient-based optimization methods, the pattern search (PS) method34–36. The computer program code of the pattern search37 is simple and does not require derivatives of the objective function. We implemented the program code into a homemade program for data analysis.

The parameter optimization is driven by calculating the error function which uses the mean square error (MSE) between the target AP waveform (Vm,t) and the output of the baseline model (Vm,a) (Eq. 11),11 MSE=∑Vm,a-Vm,t2N

where Vm,a represents adaptive Vm (the model output) generated by adjusting the randomized set of Ixsfs in the baseline model. The target Vm,t is the AP waveform of the intact baseline model. The magnitude of MSE was stabilized by obtaining a stable rhythm of spontaneous APs through repetitive numerical integration of the model, usually, 30 ~ 100 spontaneous cycles were repeated for a new set of Ixsfs. The MSE was calculated within a time window which included a single cycle of the spontaneous AP generation. N is the number of digitized Vm points with a time interval of 0.1 ms.

The present study used the weighted sum of MSE. The single cycle of the spontaneous AP was separated into three segments. The first segment starts from − 20 mV during the repolarizing phase to maximum diastolic potential (MDP) and the weight is 5 ~ 6. The second segment covers MDP, SDD, and the foot of AP discharge and the weight is 1, and the third segment covers the AP plateau until to repolarizing phase to − 20 mV with weight = 0.3 or 0.5. In the first segment, the magnitude of IKr dominates to allow its determination by the PO method. The second segment is influenced mostly of IbNSC, Iha in addition to INaL and ICaL, which takes a major role in generating the exponential depolarization in the late half of SDD. The third segment consists of the AP plateau, generated by ICaL, INCX, INaL, IKs, and IKur. By providing large weight to the first time window, IKrsf rapidly gets close to the optimal value independent of other parameters which means that the succeeding optimization process behaves as if the number of the optimizing parameters is one less. According to our experience, the preliminary manual fitting can be carried out smoothly in a sequence of these three segments.

All hiPSC-CMs used in the present study showed spontaneous discharge of AP. Therefore, to calculate MSE, it was essential to start all records from a particular Vm value; − 20 mV was used in this study. We calculated the model until digitized Vm crossed a range of − 20.000 mV > Vm > − 20.004 mV. Thereafter, a record of a single AP cycle of the target or model output was obtained. For the graphic display, we usually connected two cycles of AP for better visualization.

In the PS method, a base point (BP) is determined by the initial parameter set. On both sides of BP, two new points (NP) are set by a ± step to calculate MSE for each NP, and the numerical integration of the hiPSC-CM model was conducted to obtain new AP waveforms. If MSE is improved, the NP is moved by the single step in the direction giving the smaller MSE. This pattern search is repeated for all dimensions of PO parameters one by one until the decrease of MSE saturates. Then all BPs are moved to the last NPs for all PO parameters, and simultaneously the step size is decreased. The movements of BP are repeated until the step size becomes smaller than a critical step size, which was preset by the user.

The intracellular concentrations of Na+, Ca2+, and K+ will change every time when the parameters are varied during the PS method. To minimize the variation of the ion concentration, the activities of both INaK and INCX were regulated. For INaK, Eq. (12) was used.12 INaK=maxINaK·vcycNaK·INaK,mag·crfNaK

To calculate the correcting factor (crfNaK), Eq. (13) was used.13 crfNaK=orgcrfNaK-stdNai-Nai·fbGainNaK

where any deviation of [Na+] (Nai) from a standard [Na+] (stdNai) was corrected by modifying crfNaK used for the negative feedback regulation in reference to a constant (orgcrfNaK). The fbGainNaK was usually set at 0.004 for a stable regulation. The stdNai = 5.8 mM and orgcrfNaK of 0.2606 were used.

The same format of equation was used to regulate the INCX activity to keep the total of ionized and bound form of Ca (Ca content) within the cell, which is a sum of Ca content in the three Ca compartments and the sarcoplasmic reticulum (SR) ([Ca]t). The fbGainNCX was 0.008. The stdtotCai = 68.5 attomole and orgcrfNCX = 2.4732.

Parameter randomization and the multi-run test

The final level of MSE obtained by a single cycle of the PS method fluctuates between different cycles. Therefore, the PS cycle was repeated for 200 ~ 300 cycles (multi-run test). The MSE as well as the model parameters were given as an average of the top 20 results of smaller MSE as described in Kohjitani et al.25. Every run of the PS method started with a randomized set of the PO parameters obtained by Eq. (14).14 Ixsf=1+Rsf-0.5·af

Rsf is given by a random function and is distributed between 0≤Rsf<1. The af is used to vary the amplitude of Ixsf; an af of 0.3 is usually used to randomize Ixsf between 0.85 and 1.15. The time course of optimization was monitored by plotting Ixsf in a two-dimensional parameter space on the graphic display; log(MSE) on the ordinate against Ixsf on the abscissa.

The simultaneous fitting of two AP waveforms in the PS method

In the present PO method, the experimental data obtained under the specific block of IKr using E-4031 in addition to the control AP waveform were used (see Doss et al.38 for the IKr block in hiPSC-CMs). Namely, MSE was calculated for both the control and the IKr-blocked AP waveform with the model output, and the average of these two MSEs was used as the error function to drive the PO method.

The mechanisms underlying the modification of the cardiac AP waveform are implemented in the baseline model. Thus, the maximum diastolic potential, (MDP) as well as the slow diastolic depolarization (SDD) were shifted in the positive direction in most of hiPSC-CMs if G¯K (Eq. 3) was decreased by E-4031. Through these changes in Vm, the Vm-dependent open-close gatings were altered according to the gating kinetics to modify the AP waveform. Furthermore, under the specific IKr block, a new constraint is applied to the PO; i.e. the G¯x of other Ix should remain at the control magnitude. Thus, a common set of Ixsfs except the IKrsf was used for both the control and IKr-blocked AP waveforms. Note that, this constraint was also applied in the initial manual fitting process, thus the magnitude of IKr block was manually estimated as the result in this process.

The lead potential (VL) analysis

The final AP waveforms obtained by the PS method were examined for their validity by calculating the contributions of individual current components (Ixs) to the AP waveform by using the lead potential (VL) analysis9,39. Contributions of individual Ixs are expressed in a unit of mV instead of pA/pF,15 VL=Σ(Gx·Ex)Σ(Gx)

16 dVmdt=-Vm-VLτ

17 τ=CmΣGx

where Gx is the conductance (nS/pF) given by Eq. (3). The Vm closely followed the time course of VL (Eq. 16) with the time constant τ (Eq. 17). Gx is the chord conductance in the case of currents described according to Ohm’s law. In the case of constant field equations, the Gx is obtained by differentiating GHK with respect to Vm (Eqs. 18 ~ 20) as the slope conductance (Eq. 19),18 GHK=A·Si-So·B1-B

19 dGHK=dGHKdVm=(Si-So·A1-B+So-Si·A·B1-B2)/z·FR·T

20 Gx=Px˙·dGHK

21 Ex=Vm-GHKdGHK

The reversal potential (Ex) at a given Vm was determined by Eq. (21).

Results

Accuracy of the simultaneous two AP waveform fitting examined by the MM mode of the PO method

The graphic display of the MM multi-run tests conducted for each case of selective block of IKr (60%), INa (50%), ICaL (50%), IKs (80%), and IbNSC (50%) were demonstrated in Fig. 1, where the movements of BPs in each run of PS method were plotted in the Ixsf vs log(MSE) coordinates for each Ixsf indicated at the top. The cell-specific model developed by the single AP waveform fitting was used as the baseline model. Although the PS parameters of the initial parameter set were randomized for each run of the PS method, the BPs were distributed within an obvious envelope and well converged at a normalized Ixsf = 1 value in the baseline model. The minimum level of log(MSE) was mostly smaller than -2 (MSE < 0.01 mV2), which is in the same range as those obtained in single AP waveform fitting (see Fig. 4 and Table 2 in Kohjitani et al.25).Figure 1 Convergence of Ixsf (BP) as the MSE magnitude was decreased by the simultaneous two-waveform fitting in the MM mode multi-run test. The BPs were plotted in the coordinate of log(MSE) (ordinate) vs Ixsf (abscissa) during the PO process by the PS method. In each line of graphs, IKrsf, INasf, ICaLsf, IKssf, and IbNSCsf log(MSE) were plotted. In the case of the blocked current, the Ixsf was normalized in reference to the blocked level.

In Fig. 2, the target AP waveforms (red) were superimposed by APs of the model output (black traces), which were the outcomes of the MM multi-run test of the PO method in Fig. 1. It is evident that the PO was nearly perfectly conducted when the log(MSE) below − 2 were obtained. All AP waveforms well represent the characteristic effect of the Ix block. Namely, the blockage of the outward currents, IKr and IKs prolonged the APD, while the blockage of the inward currents, ICaL shortened the APD. In the case of INa block, the SDD was markedly prolonged through the partial block of the INaL component. During the prolonged SDD, the inactivation of INaL might be partially removed to recover the APD. A similar prolongation of the APD was also observed by the IbNSC blockage. These findings are totally consistent with those expected from the physiological mechanisms of the AP generation.Figure 2 The recovery of the AP configuration from the artificial modification of AP by the PO method. The red trace was the target AP, which was generated by the intact baseline model, while the black trace was the model output generated at the end of the PO method as the result. The violet horizontal lines indicate three ranges of AP to weight (6, 1, and 0.3 for each step, independent from the ordinate scale) in calculating the weighted sum of MSE. The fitting to the control trace in (A) was obtained by the simultaneous two-AP-waveform fitting using the 60% IKr block. Since the fittings of the control AP in cases of any other Ix block were quite similar to that illustrated in (A), the respective control record for each Ix block was not demonstrated individually. Note that two different percentages of blockage (30% and 60%) were specifically tested for IKr.

Table 1 lists the mean and standard deviation of the magnitude of final Ixsfs in the top 20 runs of PO in the MM tests performed to generate AP waveforms demonstrated in Fig. 2. The magnitudes of Ixsf were normalized in reference to the standard values of the baseline model. In the case of blocked currents, the Ixsf was normalized to the magnitude of blockage defined in each PS method. It is evident that the error of the Ixsf is less than ~ 2% of the control and the SD of the mean was negligibly small, indicating that selective blockage of a given ionic current was correctly resolved by the PS method in the present study.Table 1 List of the final Ixsf and the [Na+]i and [Ca]t obtained by the PS method.

TC12-MMTest	IKrsf	IKssf	IKursf	INasf	ICaLsf	Ihasf	IbNSCsf	[Na+]i	[Ca]t	Log(MSE)	
IKr 30%	0.997	0.998		1.005	0.996	0.995	0.996	7.084	82.050	− 2.223	
S.D	0.054	0.006		0.006	0.005	0.004	0.021	0.015	0.154	0.237	
IKr 60%	1.017	0.995		1.004	0.998	0.985	0.995	7.015	70.430	− 2.467	
S.D	0.051	0.008		0.006	0.003	0.004	0.003	0.009	0.053	0.008	
IKs 80%	0.999	1.006		0.998	1.001	1.078	1.000	5.708	77.728	− 2.970	
S.D	0.000	0.060		0.001	0.004	0.026	0.001	0.004	0.091	0.216	
IKur 50%	1.002	0.954	1.041	0.999	1.000		1.000	6.914	87.483	− 1.916	
S.D	0.003	0.057	0.070	0.012	0.013		0.007	0.030	0.002	0.196	
ICaL 50%	0.977	0.995		1.003	1.001	0.999	0.998	6.596	56.277	− 2.661	
S.D	0.044	0.005		0.005	0.002	0.004	0.001	0.004	0.031	0.155	
INa 50%	0.989	0.999		1.000	0.998	0.988	0.997	6.916	63.736	− 2.500	
S.D	0.061	0.027		0.002	0.020	0.004	0.004	0.007	0.083	0.121	
IbNSC 50%	0.999	0.989	1.002	1.006	0.998		0.996	6.151	62.170	− 2.036	
S.D	0.004	0.067	0.030	0.010	0.010		0.001	0.010	0.139	0.186	
See the text for a more detailed explanation. The unit of [Na+]i is mM, and that of [Ca]t is attomole. [Ca]t stands for the sum of ionized and bound forms of Ca (Catot) in jnc, iz, blk, and SR. Vol indicates the volume of each compartment. These concentrations were measured at the time when Vm crosses − 20 mV during the repolarization phase.

Catot = Catot,jnc · Voljnc + Catot,iz · Voliz + Catot,blk · Volblk + CaSRup · VolSRup + Catot,SRrl · VolSRrl.

The level of [Na+]i and [Ca]t indicate the final concentrations determined in the AP waveform under the selective Ix blockage. The standard deviation (SD) of the mean was also negligibly small to support that the activity of the Na/K pump current and the Na/Ca exchange currents were well controlled to give a stable level of [Na+]i and [Ca]t (Eqs. 12 and 13) in the top 20 runs of the PS method.

Feasibility of applying the simultaneous two AP waveform fitting to experimental recordings of the selective IKr block

According to the MM mode fitting, it is concluded that the algorithm of the PS method is relevant to get the cell-specific model using the two-waveform parameter fitting. However, it is asked if the EM mode is also feasible in analyzing the Ixmag profile of experimental AP waveforms, which include various extra noise, such as the slow fluctuations of Vm in the hiPSC-CMs. Furthermore, the EM fitting might be interfered with if the computer model equations failed to describe the intact mechanisms of the intact cardiac myocytes. This latter problem should be finally solved by performing a new experimental protocol, but the study of the EM mode PO method might suggest inappropriate equations of the model. Here, we examine the feasibility of applying the EM mode of the PS method to the experimental AP recordings.

Time course of the spontaneous APs after the application of E-4031 and results of the conventional PO method of using a single AP waveform

Three representative AP recordings in the hiPSC-CMs after exposure to an IKr blocker E-4031 are demonstrated in Fig. 3A–C. The continuous recordings of Vm in the hiPSC-CMs showed sporadic slow fluctuations of Vm and/or irregular cycle length of the spontaneous rhythm. In the record of a single myocyte (TC11) in Fig. 3A, for example, irregular fluctuations in MDP in addition to sporadic changes in AP configurations were obvious. The myocyte TC13 in Fig. 3B shows a relatively smooth time course of the MDP and OS change before and after the IKr block. In the record of myocyte TC12 in Fig. 3C, the fluctuations in AP amplitude after about 12,000 ms were of unknown origin. These fluctuations were observed in most of the hiPSC-CMs.Figure 3 Continuous recording of the spontaneous AP generation in hiPSC-CM during the IKr block by perfusing E-4031. (A–C) Shows three examples of chart recordings of the AP waveform. The red traces indicate the single AP waveforms used for the two-waveform fitting of the PO method, which will be described in the next chapter. (D) Shows time courses of Ixsf of IKr (light blue), ICaL (orange), INa (steel blue), IKur (yellow) and IbNSC (gray) obtained by the conventional single waveform fitting of the PS method applied to TC12. See the text for a detailed explanation.

Before conducting the new two-waveform fitting, we firstly examined the conventional PO method to apply the baseline model to individual AP waveforms. The baseline model was obtained by applying the PS method to an AP waveform during the control condition in the same myocytes. The E-4031 was applied by switching the perfusate using a cock, which connected the outlet tube to the reservoir of test solutions about 40 cm apart from the inlet of the recording chamber to avoid mechanical vibration. It was difficult to precisely indicate the onset time of the IKr block by the E-4031 solution. However, the progressive positive shift of MDP induced by E-4031 was obvious. Another complication might be caused by the progress of the IKr block during a single AP cycle (t2 − t1). Assuming an exponential development of the IKr block, the progress was calculated using Eq. (22), in which brt2 indicates the block ratio at time t2.22 brt2=br∞-br∞-brt1·e-t2-t1τ

If a rate constant τ is assumed to be 30 s, the difference of br might be ~ 1% during the AP interval of 0.3 s. we assumed that an error due to this transitional effect might be negligibly small in testing the application of the PO method. A representative result of Ixsfs optimized by the single waveform fitting of the PS method applied sequentially was illustrated for individual AP waveforms in TC12 in Fig. 3D. The IKrsf (light blue) was decreased smoothly in an exponential manner. The fluctuations in INasf (steel blue), IKursf (yellow) and IbNSCsf (blue) were less than ~ 20%. However, ICaLsf (orange), largely deviated. This deviation of the ICaLsf might be attributed not only to the extra fluctuations in the continuous recording of the spontaneous activity, but also to the shortage of information provided by the experimental single AP waveform.

Results of applying the simultaneous two-AP-waveform fitting of the EM mode of the PS method.

From the limited length of the continuous AP record, stable AP waveforms of control and IKr-blockage were selected for the EM mode of the simultaneous two-AP waveform fitting. The red traces in Fig. 3A–C indicated individual AP waveforms; c the reference and b1 and b2 the test waveforms used for the simultaneous fitting of pairs; c and b1, and c and b2 waveforms. Results of the PS method are shown in Fig. 4. Differently from the MM test of the PS method (Fig. 2), a slight gap remained after the end of the PO run between the target (red trace) and the model output (black trace), most probably due to the irregular slow fluctuations. Indeed, the final magnitude of log(MSE) is comparable to results obtained in the single AP wave fitting in EM mode in our previous study25. The result of the multi-run test shown in the right half of Fig. 4 showed clear convergence of the IKrsf, ICaLsf, and IbNSCsf, which gave the averages of top 20 results of smaller MSEs (vertical blue lines) mostly within the ± 5% range of each standard value of 1. Note, the IKrsf was normalized in reference to the blocked IKrsf determined in a separate preliminary measurement. However, no obvious convergence was observed in Ihasf and IKursf.Figure 4 Results of the simultaneous fitting of two AP waveforms in the EM mode of the PO method. The data in three hiPSC-CMs (TC11, TC12, and TC13) were examined for the pair of control and the IKr-blocked AP waveforms; the pair of c and b1, and the pair of c and b2 indicated in Fig. 3. In all panels the control APs (red) were superimposed by the model output APs (black). The results of the multi-run test are shown in the right half of figure.

Selective IKr block resolved by the simultaneous fitting of two waveforms of the PS method.

The selective Ix block has been proved in the MM mode of the PO method (Figs. 1, 2, and Table 1). In Table 1, the Ixsf were all very close to 1, supporting the fine resolution of the selective Ix block by the PS method. In the EM mode of the PO method, however, the selective blocker which had a high selectivity to a specific channel was only available for IKr. To prove the selective block of IKr obtained in the EM mode PO, the magnitudes of Ixsfs other than the IKrsf were compared in Fig. 5 at two different degrees of the IKr block. The magnitudes of IKrsf were quite close to 1 in the multi-run test because the IKrmag was adjusted to the degree of the IKr block, which was determined by manual fitting beforehand. For better visibility, the Ixsf obtained with the higher IKr block (green bars) was normalized in reference to that obtained at the lower IKr block (blue bars in Fig. 5). It is evident that the deviation of Ixsf was less than 10% in 16 measurements of IKrsf, and 10–20% in other 5 measurements. The large deviation of Iha in TC11 was partly attributed to the depolarized MDP level at the higher IKr block, which will be discussed further in the next section. Considering the relatively large fluctuations of the experimental Vm recordings (Fig. 3), it might be concluded that the EM mode of the PS method successfully revealed the selective IKr block.Figure 5 Comparison of the Ixsfs other than IKrsf examined in the EM test. The results of the two-waveform fitting using the leftmost and middle red traces shown in Fig. 3 are shown in the blue bars, and the results by using the leftmost and rightmost red traces shown in Fig. 3 are shown in the green bars. Note that the blue bars were normalized to 1.0 to compare with the green bars. See the text for the explanation.

Correlation between two ion currents revealed by the EM test of PS method

When the error function MSE of two parameter sets are decreased to a minimum level in the PS method, the model output is almost perfectly fitted to the target AP waveform, which indicates that the Itot_cell in Eqs. (1) and (2) of two parameter sets are almost the same. If the two parameters IX1sf and IX2sf have ambiguity, these parameters in the final results of the PS method have multiple value combinations, however, they have almost identical Itot_cell. For example, if both IX1sf and IX2sf are the parameters of the inward current, then the increase in IX1sf requires a decrease in IX2sf to satisfy quasi-identical Itot_cell (see Discussion in 25 for detail). To quantify this relationship, correlations were calculated for all 15 pairs of Ixsfs in the top 20 MSE results of the multi-run PO method in TC12 cell where the two waveforms indicated by the leftmost and the middle red traces in Fig. 3C were used in two-waveform fitting (AB), the leftmost red trace only (A), and the middle red trace only (B). The correlation coefficient (R2) was divided in four grades of (a) 1 > R2 > 0.8, (b) 0.8 > R2 > 0.6, and (c) 0.6 > R2 > 0.4 and 0.4 > R2 > 0. From the above consideration, we can expect that if the number of the correlation of grade (a) is small, then the problem has small ambiguities. In Fig. 6, the grade of R2 was represented by the thickness of the line, connecting each pair of Ixsfs. It is evident that the pattern of the 15 correlations obtained by the simultaneous two-waveform fitting (AB in Fig. 6) is distinct from those of the single waveform fittings of the control AP (A) or the IKr blocked AP (B). Thus, it is clear that the PO method based on two-waveform fitting is provided with more information if compared to the single waveform fitting.Figure 6 The patterns of the correlations between different pairs of Ixsfs were compared among three different POs. The correlation of all 15 pairs of Ixsfs using the top 20 results obtained in the multi-run PO method for TC12 by using the leftmost and middle red traces shown in Fig. 3C (AB), by using the leftmost red trace only (A), and by using the middle red trace only (B) are shown with the lines of different thickness. The thicker lines indicate R2 higher than 0.8, 0.6 and 0.4. See text for more details.

The mechanisms underlying the variation of the correlation pattern may be complicated. Only, the disappearance of the correlation between Ihasf and any others in panel B was attributed to Iha = 0. This is because the MDP is depolarized by the IKr block to a voltage range, where Iha is totally deactivated.

Physiological ionic mechanisms underlying the optimized AP waveforms

So far, the application of the simultaneous two-waveform fitting of the PS method was examined at the methodological point if the ionic current profile expressed on the surface membrane was correctly determined by using the error function MSE of the PO method independently of the initial parameter set. It should also be asked if the profile of current expression levels obtained by the PO method well matches the biophysical function of the cell, which is initiated by the membrane excitation relying on the physiological characteristics of individual currents.

As demonstrated in Fig. 7A, the Vm (black trace) closely followed the time course of VL (Eqs. 15 and 16); VL > Vm during the depolarizing phase and vice versa (VL < Vm) during the repolarizing phase. The VL crossed Vm at dVm/dt = 0 at OS and MDP. Since the time course of VL was quite close to that of Vm (Fig. 7A), here the contribution of each current to Vm is described based on the corresponding changes in elements of both VL and dVL/dt in Fig. 8.Figure 7 The profile of the current flow underlying the AP waveform of the cell-specific model of TC12 optimized by the PS method. The upper row (A) indicates Vm (black) and VL (red). A1 indicates the control condition (c in Fig. 3C), and A2, A3 indicate the record obtained at two different degrees of the IKr block (b1 and b2 in Fig. 3C). The lower rows (B) and (C) indicate outward and inward Im, respectively. The individual Im are depicted in different colors. The time scales indicated at the bottom are applied to both Vm and Im panels. The yellow colors are used to highlight the mechanisms mainly for both the foot and plateau phases of AP. The peak of inward ICaL is far beyond the graphic display.

Figure 8 The profile of VL and dVL/dt elements of the cell-specific model of TC12 revealed by the VL analysis. The upper row (A) indicates VL elements. A1 indicates the control condition (c in Fig. 3C), and A2, A3 indicate the record obtained at two different degrees of the IKr block. The lower rows (B) and (C) indicate dVL/dt elements for outward and inward currents, respectively. The individual VL and dVL/dt elements are depicted in different colors. The time scales indicated at the bottom are applied to both VL and dVL/dt records. The yellow colors are used to highlight the mechanisms underlying both the foot and plateau phases of AP. See the text for more explanation.

Figure 7B,C shows the time course of individual membrane currents underlying the AP waveform (Vm). In the control waveform in column 1 of Fig. 7 which corresponds to c in Fig. 3C, the IKr (blue) rapidly showed a large peak at about − 50 mV and then slowly decayed during SDD. The time course of INaK (pink) reflected its Vm-dependency and the amplitude was relatively large if compared with others. IK1 (steel blue) was nearly zero during the plateau but showed a significant amplitude during SDD. The IKur (purple) was activated only during AP and provided the largest current during AP. As to the inward currents, IbNSC (light brown) was the largest current during SDD and its amplitude was proportional to Vm because of the absence of time-dependent gating kinetics in IbNSC. The INCX current (red) transiently peaked in the outward direction at the foot of the AP upstroke, and the time course of the inward component reflected the Ca2+ transient; the inward peak appeared ~ 50 ms after the rising phase of AP, and thereafter it decayed. During the late half of SDD, the amplitude of both INa (purple) and ICaL (black) increased exponentially due to the subthreshold Vm-dependent activation. ICaL was the major inward current during the plateau phase. In columns 2 and 3 of Fig. 7, IKr decreased gradually from control in column 1. Although Ixsfs of all current species other than IKr were the same in three conditions in columns 1–3, the individual amplitude of each current in panels B and C varied according to their own kinetics when Vm changed as the result of IKr block.

The merit of the VL analysis is its quantitative assessment of the contribution of individual membrane currents in mV, or mV/ms unit (in the case of VL, or dVL/dt, respectively) to the AP waveform (Fig. 7). Indeed, the VL (gray) shown in Fig. 8A as well as in Fig. 7A (red) consists of the arithmetic sum of individual VL elements (Eq. 15). Major VL elements were INCX, IKr, IK1, INaK and IbNSC during SDD, and ICaL, INCX, and INaK during AP plateau. It should be noted that the time courses of individual VL elements were all unique and quite different from those of the membrane currents, which provided a vital clue in exploring the direction of the PO by the PS method.

The time courses of individual elements of VL were determined by the changes in the channel open probability as well as by the difference in (Vm − Ex) in the case of the channel current. The time course of INaK and INCX elements are dependent not only on Vm but also largely determined by the [Na+]i and [Ca2+]i. The Ca2+-induced Ca2+-release (CICR) is initiated by the Ca2+ influx through the LCC in the dyadic junction space. Then, the Ca2+-release channel on the SR membrane is activated by the massive increase in Ca2+ in the dyadic junction. The time course of this CICR is clearly visualized in the dVL/dt records (Fig. 8B,C). Namely, the onset of ICaL activation is indicated by the rapid transient deflection of ICaL element of dVL/dt which coincides with the rise of ICaL element of VL. Then the transient upward deflection of the INCX element of dVL/dt indicates that the driving force (reversal potential of INCX − Vm) is reversed during the overshoot of AP. Then the relatively slow downward deflection of the INCX element is driven by the increase of [Ca2+]i within the dyadic space. This sequence of events was evident in the control (column 1 of Fig. 8) as well as in the two cases of IKr-block (columns 2 and 3 of Fig. 8). The duration of SDD was shortened by both the delayed repolarization and the accelerated subthreshold activation of both INa and ICaL because of the positive shift of MDP, both of which were caused by the IKr-block (columns 2 and 3 of Fig. 8). With a more extensive IKr block (column 3 of Fig. 8), the SDD virtually disappeared because of the overlap between the delayed repolarization on the subthreshold activation of ICaL and INa.

These findings are totally consistent with the physiological mechanisms supposed so far through the experimental findings1–4,10,40.

Discussion

Brief summary of results

The parameter optimization method has been developed to determine the ionic current composition underlying the cardiac AP waveform. However, the method has not been established to be used in a wide range of electrophysiological research. It has been suggested that information included in a single AP waveform is still not enough for the PO method. In the present study, the AP record under the selective IKr block was used in addition to the control AP waveform.

The MM test of the simultaneous fitting of two AP waveforms was applied to the AP waveform modified by blocking one of the currents, IKr, ICaL, INa, IKs, IKur, or IbNSC (Figs. 1 and 2, MM mode). In all cases of ion current block, the PS method successfully identified the blocked current, and the MSE was decreased fairly below log(MSE) < − 2.

In the EM test, the experimental record of the spontaneous AP frequently showed intermittent slow Vm fluctuations, which interfered with the gradient-based PO method. However, by using the multi-run test, the distribution of the Ixsf converged to a single point, even though the limit level of MSE decrease was largely enlarged in the EM test of the PS method (Fig. 4). The new method well resolved the IKr-selective block current.

The correlations between two Ixsfs were determined in 15 pairs of Ixsfs. The pattern of 15 correlations was quite different among the three results obtained in the two-waveform fitting, and the single waveform fitting to the control and the IKr block recordings (Fig. 6). This finding supports the view that the simultaneous fitting method is provided with more information than the single AP waveform fitting, and resolves the unique current pattern underlying the membrane excitation in the cell-specific computer model.

The current flows of the major 7 currents in the optimized cell-specific model were analyzed by the VL analysis method (Fig. 8). All these quantitative findings on the contributions of all currents were totally consistent with the qualitative ionic mechanisms of cardiac APs so far described in physiological literature. It is concluded that the parameter sets obtained by the present PS analysis are totally relevant to the physiological mechanisms underlying the AP waveform.

The importance of providing some information is required in addition to the single AP waveform when the PO method was applied to the cardiac AP. This point of improving the PO analysis has been extensively discussed in the literatures (see Kernik et al.41, Paci et al.42, Paci et al.43).

The simultaneous fitting of two AP waveforms in the PS method.

The error function MSE is calculated from the difference between the target and model output AP waveforms to drive the PO. The waveform is determined by both the limiting conductance G¯x and time-dependent changes in pO as described by Eq. (3). The pO is a critical factor in shaping the precise AP waveform according to the detailed Vm-dependent rate constant for the channel gating (Eqs. 4 and 5). Particularly, the Vm-dependency is quite different between different channels, so individual channel species can play distinct roles in different phases of APs. The spontaneous AP discharge provides an additional clue to the PO method in comparison to the fitting of the AP waveform triggered by the electrical stimulus in the conventional AP recordings. Namely, the profile of the multiple current flows during the SDD is totally different from that during the single AP, which is triggered by the electrical stimulation.

According to the above view, we used variable weights to calculate the weighted sum of MSE25. The largest weight (5 or 6) was applied to the MSE in the first segment of the falling phase after the plateau, where the IKr provided the dominant current. Namely, the IKr plays a key role in shaping the SDD as well as the APD in Figs. 7 and 8. The MSE of the second segment, SDD, was calculated using a weight of 1, and the last segment of the AP waveform with a weight of 0.2–0.5 since the current profile was largely determined during phases 1 and 2.

The amplitude of INa/K is largely determined by the [Na+]i. To avoid large fluctuations in [Na+]i, the activity of Na/K pump was regulated by an additional equation (Eqs. 12 and 13). Simultaneously, the [Ca]t was also regulated by using the additional equation to regulate the INCX. Thus, as indicated in Table 1 the final concentrations of these ions were quite stable within individual myocytes. It should be noted that the Ca2+ transient is dependent on the cellular content of Ca, which is composed of a total of free Ca2+ and the bound form Ca to various Ca buffer molecules.

The slow Vm fluctuations in the record of spontaneous AP waveforms in hiPSC-CMs; the complication in the EM mode of the PO method.

The hiPSC-CMs show irregular slow fluctuations, which were difficult to reconstruct using exponential functions of the channel open-close kinetics (Eqs. 4 and 5). The slow fluctuations shifted the lower limit of MSE in the upward direction. Even under the condition of this extra noise, the multi-run test showed an evident peak of Ixsf demarcated by obvious slopes on both sides of the peak (Fig. 4). The minimum level of MSE was ~ 4 mV2, which was comparable to 3.29 ± 1.84 mV2 obtained in the single AP waveform method in our previous study25. This may be true if the MSE caused by slow fluctuations is virtually constant.

On the other hand, the slow Vm fluctuations should interfere with the progress of the PO. In the PS method, the BP is moved by ± step size, and the NP is moved toward smaller MSEs by the step size given by the PS method. By this maneuver, the Ixsf data points are located within a limited space in the multi-dimensional parameter space. The intermittent slow fluctuations in Vm may seriously interfere with the decision of the movement of NP (Ixsf). Thereby, the NP will get out across the demarcation of the parameter space for a given Ixsf distribution to interrupt the PO at a modest MSE level. Although this mechanism may not explain all cases of interruption, the peak search using the multi-run test should largely compensate for the difficulty caused by the sporadic Vm fluctuations.

If the slow fluctuations of Vm are caused by an intervention of attaching the patch pipette to a fragile single hiPSC-CMs, the difficulty will be largely relieved by using a small cluster of a few numbers of hiPSC-CMs, provided that the cells are well coupled through the gap junction. Indeed, Doss et al.38 described that multiple impalements from each beating cluster yielded action potentials with similar morphology, suggesting that each cluster works as a functional syncytium. In the case of using matured cardiac ventricular myocytes, which are much larger compared to hiPSC-CMs, the slow fluctuations are not obvious under the physiological condition.

Limitation of the present study; some discrepancy of the model from the intact myocytes

When the AP waveform was selected much later from the start of the IKr block in the experimental recordings, the fitting of the waveform showed obvious deviation to give larger MSEs (Fig. 3D). This was not observed in the MM fitting (Table 1). Thus, it may be suggested that the slow inactivation kinetics of ICaL and/or INaL does not correctly represent the intact inactivation of these currents.

Alternatively, it may be suggested that model equations in the hVC model might be largely renewed in reference to recent publications in the near future.

The merit of the simultaneous two-AP-waveform fitting in the PS method.

The PO can be conducted if the multiple PO parameters are independent of each other. For example, in the simple case of enzyme reaction, the rate of increase of product concentration, the rate of product concentration (Vp) is a function of the three parameters, Vmax, K0.5, and n in Eq. (23).23 Vp=Vmax1+K0.5Sn

These three parameters are independent of each other. This means that changing the maximum rate of the reaction, Vmax during the application of the PS method alters only the maximum rate of the enzyme reaction, but the half maximum substrate concentration (K0.5) as well as the Hill coefficient n are not affected. The same is true when K0.5 or n were adjusted. However, if K0.5 is replaced by the three rate constants for binding (α) and unbinding (β) of the substrate (S) to the enzyme (E), and production of the product (P) (γ) in the reaction, α and β do not converge in the multi-run test using the dose–response curve.E+n·S⟶α←βESn⟶γn·P+E

But the final distribution of scaling factors of sfα and sfβ at the end of the multi-run test perfectly fit the liner correlation equation (Eq. 24) with the two constants of α and β.24 sfα=a×sfβ+b

Indeed, in the study of Kohjitani et al.25, it was demonstrated that the dispersion of the parameters was much improved by fixing one of the parameters included in the co-relationship. In the simultaneous fitting to two waveforms in the PS method, variable co-relations will be added. If so, the final distribution of parameters might be limited within a smaller space in the multi-dimensional space.

The convergence of Ixsfs in multi-run test

The convergence of Ixsf is a critical index to judge the correctness of the estimation of Ixsf. Also, the gradient of MSE/delta Ixsf could be a critical index of the sensitivity of the model to Ixsf. However, unfortunately, the Ixsf is rather arbitrarily determined in the present study. For comparison of the distribution between different currents, it might be necessary to normalize the magnitude of Ixsf by adjusting Ixmag. Alternatively, the ΔMSE/ΔIxsf which is calculated during the process of the PS method might be used to determine the sensitivity of the model to Ixsf. Also, the uniqueness of Ixsfs is important in the PO method, while it is generally difficult to theoretically prove it. In our previous report25 using single-waveform optimization, the uniqueness was shown in Fig. 1 by the stochastic method, where the results strongly supported the single minimum of the problem. In this two-waveform optimization, S.D. values in Table 1 may support the uniqueness of the minimum, where S.D. values were calculated from the top 20 results of the multi-run test.

Limitation of the parameter optimization method

The PO method used in this work is a gradient based method, which has limitations. The gradient based optimization methods usually require good initial values to obtain accurate results, thus in this work, we first adjusted all parameters manually. The PO methods also have limitations in the number of parameters to be optimized. In this work, we found that the maximum number of the optimization parameters is six, thus in the manual adjustment process, we examined which parameters are effective in forming the target AP waveforms and selected maximum six parameters to be optimized. However, as described in the method, in principle, there is no theoretical limit to the number of parameters that can be optimized, where it can be up to the number of model parameters, as long as the parameters in the model do not interfere with each other or are independent of each other. These limitations may be improved by using a more sophisticated algorithm such as hybrid optimization methods.

Supplementary Information

Supplementary Information.

List of symbols

Parameters (Channel; Gene)

INa (NaV 1.5; SCN5A)

ICaL (CaV1.2; CACNA1)

ICaT (CaV 3.1; CACNA1G)

Iha (HCN4)

Ist (CaV1.3; CACNA1D)

IbNSC (Not identified)

IK1 (Kir2.1; KCNJ2)

IKr (KV11.1; KCNH2)

IKs (KV7.1; KCNQ1/KCNE1)

IKto (KV4.3; KCND3)

IKur (KV1.5; KCNA5)

INCX (NCX1; SLC8A1)

INaK (Na+-K+ ATPase; ATP1A1)

Abbreviations

APD Action potential duration

BP Base point for searching minimum MSE in the PS

EM test/mode An experimental AP waveform is compared with the model output of a computer model in the PO method

hiPSC-CM Human induced pluripotent stem cell-derived cardiomyocytes

hVC model The human ventricular cell model

MDP Maximum diastolic potential

MM test/mode The output of a computer model is compared with the output of the same model after randomization of the parameters in the PO method

MSE Mean square difference in two AP waveforms

NP Searching point in reference to BP in the PS

OS Overshoot potential of AP

PO method Parameter optimization method, which adjusts one or more model parameters to fit with the target data

PS method Pattern search method, which is one of the gradient-based parameter optimization methods

SDD Slow diastolic depolarization

Supplementary Information

The online version contains supplementary material available at 10.1038/s41598-024-63413-0.

Acknowledgements

This work was supported by JSPS KAKENHI (Grant Numbers JP16K18996 for YH, and JP21K06781 for FT and YH). The authors greatly appreciate Dr. H. Kohjitani for his valuable comments and discussion.

Author contributions

Y.Z., Y.H. and A.N. wrote the main manuscript text and Y.Z., Y.H. and A.N. developed the computer program for the analyses, Y.Z., Y.H., A.N. and A.A. performed in silico experiment, Y.Z. and F.T. performed the electrophysiological experiment, F.T. and A.A. validated the result, Y.H. and A.A. supervised the research. All authors reviewed the manuscript.

Data availability

Computer programs used for the two-AP waveform fitting and VL analysis in Results and that for the PS method applied to a simple enzyme reaction model in Discussion are coded in Visual Basic. The computer programs and the datasets used and analyzed during the current study are available from the corresponding author upon reasonable request.

Competing interests

The authors declare no competing interests.

Publisher's note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
==== Refs
References

1. Noble D Garny A Noble PJ How the Hodgki[n-Huxley equations inspired the cardiac physiome project: Hodgkin–Huxley equations and the cardiac Physiome Project J. Physiol. 2012 590 2613 2628 10.1113/jphysiol.2011.224238 22473779
2. Noble D Rudy Y Models of cardiac ventricular action potentials: Iterative interaction between experiment and simulation Philos. Trans. Math. Phys. Eng. Sci. 2001 359 1783 1127 1142 10.1098/rsta.2001.0820
3. Winslow RL Cortassa S O'Rourke B Hashambhoy YL Rice JJ Greenstein JL Integrative modeling of the cardiac ventricular myocyte Wiley Interdiscip. Rev. Syst. Biol. Med. 2011 3 4 392 413 10.1002/wsbm.122 20865780
4. Hinch R Greenstein JL Tanskanen AJ Xu L Winslow RL A simplified local control model of calcium-induced calcium release in cardiac ventricular myocytes Biophys. J. 2004 87 3723 3736 10.1529/biophysj.104.049973 15465866
5. Faber GM Rudy Y Action potential and contractility changes in [Na+]i overloaded cardiac myocytes: A simulation study Biophys. J. 2000 78 2392 2404 10.1016/S0006-3495(00)76783-X 10777735
6. Winslow RL Walker MA Greenstein JL Modeling calcium regulation of contraction, energetics, signaling, and transcription in the cardiac myocyte Rev. Wiley Interdiscip. Rev. Syst. Biol. Med. 2016 8 1 37 67 10.1002/wsbm.1322 26562359
7. Grandi E Pasqualini FS Bers DM A novel computational model of the human ventricular action potential and Ca transient J. Mol. Cell Cardiol. 2010 48 112 121 10.1016/j.yjmcc.2009.09.019 19835882
8. O’Hara T Virág L Varró A Rudy Y Simulation of the undiseased human cardiac ventricular action potential: Model formulation and experimental validation PLoS Comput. Biol. 2011 7 e1002061 e1002129 10.1371/journal.pcbi.1002061 21637795
9. Asakura K EAD and DAD mechanisms analyzed by developing a new human ventricular cell model Prog. Biophys. Mol. Biol. 2014 116 11 24 10.1016/j.pbiomolbio.2014.08.008 25192800
10. Himeno Y A human ventricular myocyte model with a refined representation of excitation-contraction coupling Biophys. J. 2015 109 415 427 10.1016/j.bpj.2015.06.017 26200878
11. Dokos S Lovell NH Parameter estimation in cardiac ionic models Prog. Biophys. Mol. Biol. 2004 85 407 431 10.1016/j.pbiomolbio.2004.02.002 15142755
12. Dutta S Optimization of an in silico cardiac cell model for proarrhythmia risk assessment Front. Physiol. 2017 8 616 10.3389/fphys.2017.00616 28878692
13. Whittaker DG Clerx M Lei CL Christini DJ Mirams GR Calibration of ionic and cellular cardiac electrophysiology models Wiley Interdiscip. Rev. Syst. Biol. Med. 2020 12 4 e1482 10.1002/wsbm.1482 32084308
14. Cairns DI Fenton FH Cherry EM Efficient parameterization of cardiac action potential models using a genetic algorithm Chaos Interdiscip. J. Nonlinear Sci. 2017 27 093922 10.1063/1.5000354
15. Gábor A Banga JR Robust and efficient parameter estimation in dynamic models of biological systems BMC Syst. Biol. 2015 9 74 10.1186/s12918-015-0219-2 26515482
16. Degasperi A Fey D Kholodenko BN Performance of objective functions and optimisation procedures for parameter estimation in system biology models NPJ Syst. Biol. Appl. 2017 3 20 10.1038/s41540-017-0023-2 28804640
17. Penas DR González P Egea JA Parameter estimation in large-scale systems biology models: A parallel and self-adaptive cooperative strategy BMC Bioinform. 2017 18 52 10.1186/s12859-016-1452-4
18. Villaverde AF Fröhlich F Weindl D Hasenauer J Banga JR Benchmarking optimization methods for parameter estimation in large kinetic models Bioinformatics 2019 35 5 830 838 10.1093/bioinformatics/bty736 30816929
19. Sher A Niederer SA Mirams GR A quantitative systems pharmacology perspective on the importance of parameter identifiability Bull. Math. Biol. 2022 84 39 10.1007/s11538-021-00982-5 35132487
20. Beeler GW Reuter H Reconstruction of the action potential of ventricular myocardial fibres J. Physiol. 1977 268 177 210 10.1113/jphysiol.1977.sp011853 874889
21. Groenendaal W Ortega FA Kherlopian AR Zygmunt AC Krogh-Madsen T Christini DJ Cell-specific cardiac electrophysiology models PLoS Comput. Biol. 2015 11 4 e1004242 10.1371/journal.pcbi.1004242 25928268
22. Holland JH Outline for a logical theory of adaptive systems J. ACM. 1962 9 3 297 314 10.1145/321127.321128
23. Sarkar AX Sobie EA Regression analysis for constraining free parameters in electrophysiological models of cardiac cells PLoS Comput. Biol. 2010 6 9 e1000914 10.1371/journal.pcbi.1000914 20824123
24. Zaniboni M Riva I Cacciani F Groppi M How different two almost identical action potentials can be: A model study on cardiac repolarization Math. Biosci. 2010 228 56 70 10.1016/j.mbs.2010.08.007 20801131
25. Kohjitani H Koda S Himeno Y Gradient-based parameter optimization method to determine membrane ionic current composition in human induced pluripotent stem cell-derived cardiomyocytes Sci. Rep. 2022 12 19110 10.1038/s41598-022-23398-0 36351955
26. Guo J Mitsuiye T Noma A The sustained inward current in sino-atrial node cells of guinea-pig heart Pflugers Arch. 1997 433 4 390 396 10.1007/s004240050293 9000417
27. Mitsuiye T Guo J Noma A Nicardipine-sensitive Na+-mediated single channel currents in guinea-pig sinoatrial node pacemaker cells J. Physiol. 1999 521 Pt 1 69 79 10.1111/j.1469-7793.1999.00069.x 10562335
28. Mitsuiye T Shinagawa Y Noma A Sustained inward current during pacemaker depolarization in mammalian sinoatrial node cells Circ. Res. 2000 87 2 88 91 10.1161/01.RES.87.2.88 10903990
29. Toyoda F Mesirca P Dubel S Ding W-G Striessnig J Mangoni ME Matsuura H CaV1.3 L-type Ca2+ channel contributes to the heartbeat by generating a dihydropyridine-sensitive persistent Na+ current Sci. Rep.-UK. 2017 7 7869 10.1038/s41598-017-08191-8
30. Toyoda F Ding W-G Matsuura H Heterogeneous functional expression of the sustained inward Na+ current in guinea pig sinoatrial node cells Pflugers Arch. 2018 470 3 481 490 10.1007/s00424-017-2091-y 29197941
31. Hagiwara N Irisawa H Kasanuki H Hosoda S Background current in sino-atrial node cells of the rabbit heart J. Physiol. 1992 448 53 72 10.1113/jphysiol.1992.sp019029 1317444
32. Kiyosue T Spindler AJ Noble SJ Noble D Background inward current in ventricular and atrial cells of the guinea-pig Proc. Biol. Sci. 1993 252 65 74 10.1098/rspb.1993.0047 7684843
33. Cheng H Characterization and influence of cardiac background sodium current in the atrioventricular node J. Mol. Cell Cardiol. 2016 97 114 124 10.1016/j.yjmcc.2016.04.014 27132017
34. Hooke R Jeeves TA “Direct search’’ solution of numerical and statistical problems J. ACM (JACM) 1961 8 212 229 10.1145/321062.321069
35. Torczon V On the convergence of pattern search algorithms SIAM J. Optim. 1997 7 1 25 10.1137/S1052623493250780
36. Coope ID Price CJ A direct search conjugate directions algorithm for unconstrained minimization ANZIAM J. 2000 42 478 498 10.21914/anziamj.v42i0.609
37. Ashford JR Colquhoun D Lectures on biostatistics: An introduction to statistics with applications in biology and medicine J. R. Stat. Soc. Ser. A Gen. 1972 135 606 606 10.2307/2344687
38. Doss MX Maximum diastolic potential of human induced pluripotent stem cell-derived cardiomyocytes depends critically on I(Kr) PLoS One. 2012 7 e40288 10.1371/journal.pone.0040288 22815737
39. Cha CY Himeno Y Shimayoshi T Amano A Noma A A novel method to quantify contribution of channels and transporters to membrane potential dynamics Biophys. J. 2009 97 3086 3094 10.1016/j.bpj.2009.08.060 20006945
40. Irisawa H Brown HF Giles W Cardiac pacemaking in the sinoatrial node Physiol. Rev. 1993 73 197 227 10.1152/physrev.1993.73.1.197 8380502
41. Kernik DC Morotti S Wu H Garg P Duff HJ Kurokawa J Jalife J Wu JC Grandi E Clancy CE A computational model of induced pluripotent stem-cell derived cardiomyocytes incorporating experimental variability from multiple data sources J. Physiol. 2019 597 17 4533 4564 10.1113/JP277724 31278749
42. Paci M Hyttinen J Aalto-Setälä K Severi S Computational models of ventricular- and atrial-like human induced pluripotent stem cell derived cardiomyocytes Ann. Biomed. Eng. 2013 41 2334 2348 10.1007/s10439-013-0833-3 23722932
43. Paci M Hyttinen J Rodriguez B Severi S Human induced pluripotent stem cell-derived versus adult cardiomyocytes: An in silico electrophysiological study on effects of ionic current block Br. J. Pharmacol. 2015 172 5147 5160 10.1111/bph.13282 26276951
