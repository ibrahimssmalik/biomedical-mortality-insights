
==== Front
Stat Methods Med Res
Stat Methods Med Res
SMM
spsmm
Statistical Methods in Medical Research
0962-2802
1477-0334
SAGE Publications Sage UK: London, England

38573788
10.1177/09622802241239268
10.1177_09622802241239268
Original Research Articles
A Bayesian quasi-likelihood design for identifying the minimum effective dose and maximum utility dose in dose-ranging studies
https://orcid.org/0000-0003-3767-0326
Tian Feng 1
https://orcid.org/0000-0003-2244-131X
Lin Ruitao 1
Wang Li 2
https://orcid.org/0000-0003-3163-480X
Yuan Ying 1
1 Department of Biostatistics, 4002 The University of Texas MD Anderson Cancer Center , Houston, TX, USA
2 Department of Statistics, AbbVie Inc., North Chicago, IL, USA
Ruitao Lin, Department of Biostatistics, The University of Texas MD Anderson Cancer Center, Houston, TX 77030, USA. Email: RLin@mdanderson.org
Ying Yuan, Department of Biostatistics, The University of Texas MD Anderson Cancer Center, Houston, TX 77030, USA. Email: yyuan@mdanderson.org
4 4 2024
6 2024
33 6 931944
© The Author(s) 2024
2024
SAGE Publications
https://creativecommons.org/licenses/by/4.0/ This article is distributed under the terms of the Creative Commons Attribution 4.0 License (https://creativecommons.org/licenses/by/4.0/) which permits any use, reproduction and distribution of the work without further permission provided the original work is attributed as specified on the SAGE and Open Access page (https://us.sagepub.com/en-us/nam/open-access-at-sage).
Most existing dose-ranging study designs focus on assessing the dose–efficacy relationship and identifying the minimum effective dose. There is an increasing interest in optimizing the dose based on the benefit–risk tradeoff. We propose a Bayesian quasi-likelihood dose-ranging design that jointly considers safety and efficacy to simultaneously identify the minimum effective dose and the maximum utility dose to optimize the benefit–risk tradeoff. The binary toxicity endpoint is modeled using a beta-binomial model. The efficacy endpoint is modeled using the quasi-likelihood approach to accommodate various types of data (e.g. binary, ordinal or continuous) without imposing any parametric assumptions on the dose–response curve. Our design utilizes a utility function as a measure of benefit–risk tradeoff and adaptively assign patients to doses based on the doses’ likelihood of being the minimum effective dose and maximum utility dose. The design takes a group-sequential approach. At each interim, the doses that are deemed overly toxic or futile are dropped. At the end of the trial, we use posterior probability criteria to assess the strength of the dose–response relationship for establishing the proof-of-concept. If the proof-of-concept is established, we identify the minimum effective dose and maximum utility dose. Our simulation study shows that compared with some existing designs, the Bayesian quasi-likelihood dose-ranging design is robust and yields competitive performance in establishing proof-of-concept and selecting the minimum effective dose. Moreover, it includes an additional feature for further maximum utility dose selection.

Bayesian adaptive design
dose finding
risk–benefit tradeoff
phase II trials
National Institutes of Health https://doi.org/10.13039/100000002 1R01CA261978 5P30CA016672 5P50CA221703 typesetterts19
==== Body
pmc1. Introduction

Phase II dose-ranging trials play a crucial role in drug development. They serve as the gateways to advancing promising doses of drugs to confirmatory phase III trials. Specifically, for identifying drug doses for treating non-life-threatening diseases, which is the focus of this article, healthy volunteers are enrolled in phase I trials to assess the drug’s safety and identify the maximum tolerated dose (MTD). Based on phase I data, a range of doses is selected for investigation in phase II dose-ranging trials to establish the proof-of-concept (PoC), estimate the therapeutic window, and select target doses for subsequent confirmative trials. 1

Several adaptive designs have been developed for dose-ranging trials.2,3 Compared with conventional one-stage designs, adaptive dose-ranging trial designs are more flexible and efficient, as they allow for prospectively planned modifications of one or more aspects of the design based on interim data from the trial participants. 4 Examples of interim modifications include adding or dropping doses, adaptively randomizing patients to beneficial doses, and selecting the dose–response model while accounting for model uncertainty. Berry et al. 5 proposed an adaptive dose-ranging trial design based on a normal dynamic linear model to sequentially assign doses to new patients. Dragalin et al. 6 proposed an adaptive dose-ranging trial design based on the D -optimality criteria to determine the number of doses and patients allocated to each dose. Bretz et al. 7 proposed using the combined multiple comparison test and modeling process (MCP-Mod) to identify the minimum effective dose (MED) based on a continuous endpoint. Miller et al. 8 introduced the idea of the “interesting part” of dose curves and applied the IL -criterion and c -optimality criterion under a Bayesian framework to detect the dose–response and find target doses, which is an approach that was later extended to dose-ranging trials.3,9 Ivanova et al. 10 proposed a two-stage dose-ranging designs based on isotonic regression. Most existing dose-ranging trial designs focus on a continuous efficacy endpoint but do not consider toxicity for adaptive decisions and dose selection. Pinheiro et al. 3 and Antonijevic et al. 11 considered the use of safety data in simulation studies of dose-ranging trials, but in these designs, the safety data are mainly used to compute the probability of success in phase III trials rather than to determine dose assignment and selection.

There is increasing interest in incorporating benefit–risk consideration into the assessment and selection of doses in dose-ranging trials. In 2009, the U.S. Food and Drug Administration (FDA) released guidelines for performing benefit–risk assessments of new drug and biological products. 12 Recently, the FDA launched Project Optimus to reform the dose optimization and dose selection paradigm in oncology drug development. 13 Although Project Optimus focuses on oncology, its central message, that is, that dose selection should be based on a benefit–risk assessment, is also applicable to other therapeutic areas. Another important reason for considering toxicity in dose-ranging trials is that the doses selected for dose-ranging trials are often based on very limited phase I data (e.g. data from six patients treated at one dose). There is large uncertainty on the safety of the doses: a dose regarded as safe in a phase I trial may be actually toxic. For example, if one of six patients had toxicity at a certain dose, the 95% exact confidence interval for the underlying toxicity probability of that dose ranges from 0.004 to 0.641.

In addition, dose-ranging studies sometimes can have non-continuous efficacy endpoints, such as binary response. With the increasing availability and variety of biomarkers, there is a growing number of trials based on ordinal efficacy endpoints14–19 or semi-continuous bounded endpoints, such as a composite score.20–23 It’s desirable to devise a design that can accommodate diverse types of efficacy endpoints such as binary, ordinal, semi-continuous, and continuous endpoints. For example, Pinheiro et al. 24 extended MCP-Mod to handle binary, count, or time-to-event endpoints.

In this article, we propose a Bayesian quasi-likelihood dose-ranging (BQD) design that can handle various types of efficacy endpoints and explicitly incorporates benefit–risk assessment into the decisions of dose assignment and selection. Our design employs a quasi-likelihood methodology as a unified framework to accommodate binary, ordinal, semi-continuous, and continuous endpoints. We utilize a utility function as a measure of benefit–risk tradeoff and to adaptively assign patients to doses based on the doses’ estimates of utility. The design takes a group-sequential approach. At each interim, the doses that are deemed overly toxic or futile are dropped. At the end of the trial, we use posterior probability criteria to assess the strength of the dose–response relationship (i.e. to establish the PoC). If the PoC is established, we identify both the MED and maximum utility dose (MUD) that maximizes the benefit–risk tradeoff.

Compared to existing methods, BQD has several appealing features. First, it does not make any parametric assumptions about the shapes of dose–toxicity and dose–efficacy curves and thus is robust. For comparison, MCP-Mod considers a set of prespecified candidate dose–efficacy models and uses model selection to improve the robustness of the design. However, as our simulation study showed, when the true dose–efficacy model is not in the candidate model set, the performance of MCP-Mod is subject to the influence of model misspecification. Second, BQD provides a uniformed framework to handle binary, ordinal, semi-continuous, and continuous endpoints. In contrast, most existing methods handle only one type of endpoint. Third, BQD explicitly accounts for benefit–risk assessment using utility and enables the selection of both the MED and MUD, whereas most existing methods focus on only efficacy and the MED. Last, owing to the use of a quasi-likelihood methodology with closed-form posteriors, the computation of BQD is easy and fast, which is important for application.

The remainder of this article is organized as follows. Section 2 introduces the probability model for safety and efficacy, the benefit–risk tradeoff, and the trial design. In Section 3, we use simulation to evaluate the operating characteristics of the BQD design. Section 4 gives a summary with concluding remarks.

2. Method

2.1. Probability model

Consider a dose-ranging trial with J doses, d1<⋯<dJ , with d1 denoting the placebo or control. For the i th patient, let xi denote a binary toxicity endpoint with xi=1 indicating the occurrence of adverse events; yi denote the efficacy endpoint, which can be binary, ordinal, semi-continuous, or continuous; and zi denote the dose that the patient has received. Let D(n)={xi,yi,i=1,…,n} represent the observed outcome data of the first n patients. We model the joint distribution of (xi,yi) by first specifying the marginal distribution of xi and then the conditional distribution of yi|xi as follows.

We assume that xi , given a dose dj , follows a Bernoulli model: xi|πj∼Bernoulli(πj)πj∼Beta(αTj,βTj)

where πj is the toxicity probability of dj , and αTj and βTj are hyperparameters that are often set as small values (e.g. 1) to obtain a vague prior. Let nj denote the number of patients treated at dj , and define mj=∑i=1nxiI(zi=dj) as the number of patients who have experienced toxicity, where I(⋅) is the indicator function. Given D(n) , the posterior of πj arises as (2.1) πj|D(n)∼Beta(mj+αTj,nj−mj+βTj)

To impose the monotonicity of the dose–toxicity relationship, we adopt a modified isotonic regression method. 25 Let {πj(t),t=1,…,T} denote T (unconstrained) posterior draws from equation (2.1). This method applies the pool-adjacent-violators algorithm to {πj(t),t=1,…,T} to obtain isotonically transformed posterior draws under the Bayesian framework that conforms to the monotonicity. When applying the pool-adjacent-violators algorithm, the weights for each dose are the reciprocal of the posterior variances of πj|D(n),j=1,…,J . The estimation and inference of πj are based on the isotonically transformed posterior draws.

We next consider modeling the conditional distribution of yi|xi . Let ηj,min and ηj,max respectively denote the minimum and maximum values of yi observed at dj . For bounded efficacy endpoints (e.g. yi is binary or ordinal), ηj,min and ηj,max are the lower and upper boundaries of yi , respectively. We first standardize yi to a value between [0,1] as follows: yi*=g(yi)=yi−ηj,minηj,max−ηj,min

We model yi|xi using the quasi-Bernoulli likelihood method. 26 According to this method, even though yi does not strictly adhere to a Bernoulli distribution (as it may take values other than 0 and 1), it can still be effectively modeled using a Bernoulli distribution, resulting in a quasi-likelihood, as follows: yi*|xi=k,zi=dj∼Quasi-Bernoulli(θjk)θjk∼Beta(αEjk,βEjk)

where θjk=E(yi*|xi=k,zi=dj) , and αEjk and βEjk are hyperparameters that are often set as small values (e.g. 1) to obtain a vague prior. yi* can be interpreted as the number of pseudo-events. McCullagh and Nelder 26 demonstrated that under certain regulatory conditions, the quasi-Bernoulli likelihood produces consistent estimates while significantly simplifying computation due to its use of common distribution functions. This approach has been previously employed and has demonstrated effectiveness in phase I dose-finding designs.28,27,29

Let sjk=∑i=1nyi*I(zi=dj)I(xi=k) denote the total number of pseudo-events at dj for total njk patients with toxicity outcome xi=k , k=0,1 . Given D(n) , the posterior of θjk is given by (2.2) θjk|D(n)∼Beta(sjk+αEjk,njk−sjk+βEjk)

Equation (2.2) provides the posterior distribution of E(y*|xi,dj ). It is often useful to estimate μj=E(yi|dj) , that is, the marginal efficacy probability of dj at the original scale of yi . This can be obtained as follows. Let {θj0(t),t=1,…,T} and {θj1(t),t=1,…,T} denote the posterior draws from the posterior distribution (2.2), and let {πj(t),t=1,…,T} denote the posterior draws of πj from the posterior distribution (2.1). The posterior draws of μj can be obtained by marginalizing over xi as follows: (2.3) μj(t)=πj(t)g−1(θj1(t))+(1−πj(t))g−1(θj0(t))

where g−1(θjk)=θjk(ηj,max−ηj,min)+ηj,min is the inverse of g(⋅) and transforms the conditional mean of y* back to its original scale. When appropriate, the isotonic regression transformation method described previously can be applied to {μj(t),t=1,…,T} to impose the monotonicity on the dose–efficacy relationship. In our simulation, we focus on the case where the monotonicity assumption is applied, aligning with many dose-ranging designs (e.g. the Emax model) and the consideration that the dose–efficacy relationships are often monotonic in most disease areas. 30 It is important to note that the proposed methodology does not require this assumption.

2.2. Benefit–risk tradeoff

Our design uses a utility function to measure the benefit–risk tradeoff between efficacy and toxicity. One simple and intuitive utility function is given by (2.4) Uj=μj−wπj

where w is a pre-specified weight. According to this utility function, a one-unit increase in the toxicity rate leads to a w -unit penalty in the efficacy rate. For trials in which safety is a great concern, a larger value of w should be used. This utility function was considered previously by Ivanova et al. 31 and Zhou et al., 32 and is a special case of the following more flexible benefit–risk tradeoff proposed by Liu and Johnson 33 : U~j=μj−w1πj−w2πjI(πj>ρ)

where ρ is a pre-specified threshold. Compared to utility (2.4), this utility function imposes an additional penalty of w2 if the toxicity rate of dj is greater than that of the placebo by more than ρ . If w2=0 , this utility function becomes (2.4); and if w2=∞ , we essentially require that the toxicity rate of dj cannot be ρ units higher than that of the placebo.

In addition to defining the benefit–risk tradeoff based on the marginal probability of toxicity and efficacy, such as (2.4), a more general approach involves assigning a utility score to each possible combination of patient-level toxicity and efficacy outcomes. The desirability of dj is then measured as the weighted average of these scores, weighted by their probability of occurrence. To illustrate, consider a binary toxicity and efficacy endpoints xi and yj , where there are four possible outcomes: ( xi=0,yi=1 ), ( xi=1,yi=1 ), ( xi=0,yi=0 ), and ( xi=1,yi=0 ). Let ajk denote the utility scores assigned to these outcomes, and define qxy(dj)=Pr(xi=x,yi=y|dj) . The desirability of dj is calculated as ∑x,y∈{0,1}axyqxy(dj) . For continuous yj , one can construct two utility functions a0(y) and a1(y) for patients with and without toxicity, respectively. Let f(x,y|dj)=Pr(xi=x|dj)p(yj=y|xi=x,dj) be the joint probability function of (xi,yi) derived from our quasi-likelihood model, the desirability can be constructed similarly as ∫ya0(y)f(0,y|dj)dy+∫ya1(y)f(1,y|dj)dy . Lin et al. 29 and Zhou et al. 32 showed that this outcome-based utility approach encompasses the marginal-probability-based tradeoff (2.4) as a special case. Although our simulation focuses on the marginal-probability-based tradeoff, our methodology is directly applicable to this outcome-based tradeoff approach. To facilitate this flexibility, we opt to model the joint distribution of (xi,yi) , rather than their marginal distribution, in Section 2.1.

To safeguard patients from futility and/or a toxic dose, we define that a dose is admissible only if it satisfies the following safety and efficacy criteria: (2.5) (Safety)Pr(πj>π1+π¯|D(n))<CT

(2.6) (Efficacy)Pr(μj⩽μ1|D(n))<CE

where π¯ denotes the highest acceptable toxicity margin, and CE and CT are probability cutoffs that should be calibrated by simulation to obtain desirable operating characteristics. Depending on the tolerance level of safety and efficacy, CE and CT may range from 0.5 to 0.99. We use A to denote the set of admissible doses. Besides d1 , only dj∈A can be used to treat patients during the trial.

2.3. Trial design

The BQD design takes a group sequential approach and consists of S stages. Let c1,…,cS denote the prespecified sample size of the S stages. The design is described as follows: In the first stage, equally randomize c1 patients into J arms.

For k=2,…,S stage, on the basis of the interim data, update the admissible dose set A and adaptively randomize ck patients to dj∈A . If A is empty, early stop the trial; no MED or MUD should be selected.

On the basis of the final data, assess whether a significant dose–response relationship exists to establish the PoC. If the PoC is established, select the MED and MUD; otherwise, claim that there is no significant dose–response relationship.

Below, we first describe the method for establishing the PoC and selecting the MED and MUD and then describe the procedure of adaptive randomization.

At the final analysis, we first assess the dose-response relationship as a PoC based on the following null and alternative hypotheses: H0:∀j∈{1,…,J},μj⩽μ1versusHa:∃j∈{1,…,J},suchthatμj>μ1

The PoC is established if at least one treatment arm meets the following criterion: (2.7) Pr(μj>μ1|D(n))>CPoC

where CPoC is the probability cutoff. The value of CPoC should be calibrated and determined by simulation under the null hypothesis to control the familywise type I error rate at a pre-specified level. If no dose arm meets the criterion (2.7) for establishing the PoC, we claim that there are no significant dose–response relationship; otherwise, we proceed to select the MED and MUD.

Specifically, we select the MED as the dose whose posterior mean of μj (denoted as μj^ ) is the closest to μ1^+Δ among admissible doses, where Δ is the pre-specified clinically relevant difference for efficacy, that is, (2.8) MED=argminj∈A|μj^−(μ1^+Δ)|

The selection of the MUD is based on the benefit–risk tradeoff quantified by utility. Let Uj^ denote the estimate of Uj based on the final trial data. The MUD is selected as (2.9) MUD=argmaxj∈A(Uj^)

The proposed framework is flexible and can accommodate various definitions of the target dose based on toxicity and efficacy. For some applications, when desirable, we could impose an additional condition of MUD≥MED .

We now discuss the adaptive randomization rule in step 2 of the BQD design. Given the interim data D(n) , let p1j=Pr(dMED=dj|D(n)) and p2j=Pr(dMUD=dj|D(n)) denote the posterior probabilities that dose j is the MED and MUD, respectively. We assign patients based on the probabilities of a dose being the MED and MUD as follows: (2.10) pj∝τp1jν+(1−τ)p2jν,j∈A

where τ is the prespecified weight that allows the researchers to prioritize the MED or MUD based on the trial objectives, and ν≥0 controls the adaptiveness of the subsequent randomization with ν=0 indicating equal randomization. For example, if the primary objective of the trial is to identify the MED (or the MUD), we can set τ=1 (or 0). If the primary objective is to identify both the MED and MUD, which is the focus of this article, we can set τ=1/2 . For dose dj∉A , pj=0 . In (2.10), p1j and p2j are calculated as the proportions of posterior draws of toxicity and efficacy model parameters (i.e. πj ’s and θjk ’s) that result in dj as the MED and MUD, respectively. The details are provided in the Supplemental Material (Table S6). We set ν=1 throughout the article.

To ensure reasonable power for establishing the PoC, it is important to assign a sufficient but not excessive number of patients to the control. Let pmax=max{{p1j},{p2j}} . We assign patients to the control based on the following probability: (2.11) p1∝min(pmax,1/(J−1))

That is, the probability of assigning patients to the control equals the maximum randomization probability of the treatment arms or, if that maximum randomization probability is too high, 1/(J−1) . The latter rule is used to avoid allocating too many patients to the control. Accordingly, in (2.10), we adjust the randomization probability to the dose with the maximum p1j and the dose with the maximum value of p2j to pmax so that the expected MED and MUD can both have relatively high randomization probabilities. If identifying the MED (or the MUD) is the primary objective, we set τ=1 (or 0) and adjust pmax=max{p1j} (or max{p2j} ).

When implementing the BQD design, a practical consideration is the determination of the total sample size and interim times. The total sample size (i.e. c1+⋯+cS ) can be selected through simulation to ensure reasonable power (e.g. 80%–90%) for PoC and accuracy in selecting the MED and MUD. An effective approach is to use a simple method, such as the ANOVA method, to establish an initial sample size and subsequently calibrate it through simulation. To ensure reliable interim decisions, it is advisable to choose a reasonably large c1 (i.e. the sample size of the first interim) to ensure a reasonably accurate estimate of toxicity and efficacy. The remaining interims can be equally split for the remaining sample size. The choice of interims should balance logistical complexity and statistical performance and often vary across trials.

3. Simulation

3.1. Setup

We used simulation to evaluate the operating characteristics of the BQD design and compared them with those of a conventional analysis of variance (ANOVA) approach 2 and MCP-Mod. 7 MCP-Mod is based on five dose-efficacy models, including Emax , linear, linear in log-dose, logistic, and exponential models. We considered J=5 arms with {d1,…,d5}={0,1,2,3,4} , where d1 is a placebo. We assumed binary toxicity endpoint xi and considered continuous, ordinal, and binary efficacy endpoint yi . For the continuous endpoint yi specifically, the maximum sample size was N=200 enrolled in S=5 stages with cohort size c1=100 , c2=⋯=c5=25 . We used a latent-variable approach to generate the joint distribution of (xi,yi) . Let x~i denote a latent continuous variable that is related to xi as xi=1 if Φ−1(x~i)>1−πj ; otherwise, let xi=0 , where Φ−1(⋅) is the inverse cumulative distribution function for the standard normal distribution. We generated (x~i,yi) based on the following bivariate normal model: (3.1) (x~iyi)|zi=dj∼i.i.dN((0μj),(1ρσρσσ2))

where σ is the standard deviation of yi , and the correlation coefficient ρ induces correlation between x~i (and thus xi ) and yi . We set ρ=0.3 and σ=1 such that the ANOVA approach has around 70% – 80% power for establishing the PoC in most scenarios considered. The mean efficacy of the placebo arm was μ1=0.2 , the clinically relevant effect was Δ=0.4 , and the maximum acceptable toxicity rate change was π¯=0.3 . We varied the values of μj and πj to construct 10 representative dose–efficacy and dose–toxicity curves with different locations of the MED and MUD (Figure 1 and Table 1). To evaluate the robustness of the designs, we generated scenarios 1–4 based on parametric models, where MCP-Mod is correctly specified, and arbitrarily generated scenarios 5–10, for which the parametric models assumed that MCP-Mod may not hold. The models used to generate scenarios 1–4 which are motivated by Bretz et al. 7 are provided in the Supplemental Material (Table S1).

Figure 1. Simulation scenarios for the continuous endpoint. The solid red line is the dose–efficacy curve. The dash-dotted blue line is the dose–toxicity curve. The dashed black line is the dose–utility curve. The horizontal dashed red line corresponds to the target efficacy, and the horizontal dashed blue line is the maximum acceptable toxicity rate. The minimum effective dose is marked by a square ( ◼ ), and the maximum utility dose is marked by a triangle ( ▴ ).

Table 1. Simulation scenarios for the continuous efficacy endpoint.

	Dose levels	Dose levels	
	0	1	2	3	4	0	1	2	3	4	
	Scenario 1	Scenario 2	
Mean eff.	0.20	0.57	0.70	0.76	0.80	0.20	0.44	0.57	0.67	0.75	
Tox. rate	0.05	0.10	0.11	0.30	0.34	0.05	0.07	0.22	0.34	0.45	
Utility	0.10	0.37	0.48	0.16	0.12	0.10	0.30	0.13	−0.01	−0.15	
	Scenario 3	Scenario 4	
Mean eff.	0.20	0.21	0.58	0.77	0.77	0.20	0.20	0.20	0.22	0.60	
Tox. rate	0.05	0.10	0.18	0.20	0.45	0.05	0.06	0.08	0.10	0.24	
Utility	0.10	0.01	0.22	0.37	−0.13	0.10	0.08	0.04	0.02	0.12	
	Scenario 5	Scenario 6	
Mean eff.	0.20	0.34	0.68	0.76	0.78	0.20	0.21	0.72	0.75	0.80	
Tox. rate	0.05	0.12	0.14	0.35	0.45	0.05	0.06	0.15	0.24	0.28	
Utility	0.10	0.10	0.40	0.06	−0.12	0.10	0.09	0.42	0.27	0.24	
	Scenario 7	Scenario 8	
Mean eff.	0.20	0.24	0.41	0.68	0.78	0.20	0.23	0.32	0.65	0.79	
Tox. rate	0.05	0.06	0.10	0.12	0.32	0.05	0.08	0.10	0.32	0.45	
Utility	0.10	0.12	0.21	0.44	0.14	0.10	0.07	0.12	0.01	−0.11	
	Scenario 9	Scenario 10	
Mean eff.	0.20	0.23	0.25	0.72	0.80	0.20	0.20	0.22	0.54	0.80	
Tox. rate	0.05	0.06	0.08	0.15	0.34	0.05	0.06	0.08	0.18	0.20	
Utility	0.10	0.11	0.09	0.42	0.12	0.10	0.08	0.06	0.18	0.40	
The minimum effective doses are in boldface. The maximum utility doses are underlined.

To facilitate the comparison of the three methods, we calibrated CPoC to control the familywise type I error rate at 0.05 for each method under a null scenario with a flat efficacy curve of μ1=⋯=μ5=0.2 and flat toxicity curve of π1=⋯=π5=0.05 . For BQD, we set τ=0.5 for adaptive randomization, CE=0.7 and CT=0.9 in the admissible rule, and w=2 in the utility function (2.4). We use a slightly lower probability cutoff CE=0.7 to ensure a higher probability of dropping futile doses.

For the ordinal efficacy endpoint, we assumed that yi takes an ordinal value of {0,1,2,3,4} . We generated (xi,yi) using a latent-variable approach. Specifically, we first generated a latent continuous efficacy variable, y~i , and jointly generated a latent continuous toxicity variable, x~i , which was based on a bivariate normal distribution (3.1) generated by replacing yi with y~i in the equation. We then converted y~i to an ordinal value of yi as follows: yi=k if γk<y~i≤γk+1 , k=0,…,4 , where γk,…,γk+1 were cutoffs used to bin y~i to categories with γ0≡−∞ and γ5≡∞ . We converted x~i to binary xi as described above. We considered six scenarios (Table 2), which were constructed by generating (x~i,y~i) based on scenarios 1,3,4,5,7, and 8 in Table 1 for the continuous efficacy endpoint. We chose γ0,…,γ5 to vary pk=Pr(yi=k),k=0,…,4 . Table S2 in the Supplemental Material provides the values of (p1,…,p5) for the six scenarios. The maximum sample size was N=240 , enrolled in S=5 stages with cohort size c1=120 , c2=⋯=c5=30 . We used slightly different sample sizes and cohort sizes from these for the continuous endpoint to ensure reasonable power ( 80%−90% ) to establish the PoC in most scenarios.

Table 2. Simulation scenarios for the ordinal efficacy endpoint.

	Dose levels	Dose levels	
	0	1	2	3	4	0	1	2	3	4	
	Scenario 1	Scenario 2	
Mean eff.	0.80	1.55	1.80	1.92	2.00	0.80	0.83	1.56	1.93	1.94	
Tox. rate	0.05	0.10	0.11	0.30	0.34	0.05	0.10	0.18	0.20	0.45	
Utility	0.60	1.15	1.36	0.72	0.64	0.60	0.43	0.84	1.13	0.14	
	Scenario 3	Scenario 4	
Mean eff.	0.80	0.80	0.80	0.83	1.60	0.80	1.08	1.76	1.92	1.96	
Tox. rate	0.05	0.06	0.08	0.10	0.24	0.05	0.12	0.14	0.35	0.45	
Utility	0.60	0.56	0.48	0.43	0.64	0.60	0.60	1.20	0.52	0.16	
	Scenario 5	Scenario 6	
Mean eff.	0.80	0.87	1.22	1.75	1.95	0.80	0.86	1.04	1.70	1.98	
Tox. rate	0.05	0.06	0.10	0.12	0.32	0.05	0.08	0.10	0.32	0.45	
Utility	0.60	0.63	0.82	1.27	0.67	0.60	0.54	0.64	0.42	0.18	
The minimum effective doses are in boldface. The maximum utility doses are underlined.

For the binary efficacy endpoint, we generated yi using a latent-variable approach similar to that used for the ordinary efficacy endpoint . We first generated latent continuous variables, (x~i,y~i) , based on a bivariate normal distribution, (3.1), and then converted y~i to a binary value, yi , as follows: yi=1 if Φ−1(y~i)>1−πE,j , otherwise yi=0 , where πE,j is the efficacy rate for dj . Again, we considered six scenarios (Table 3), which were constructed by generating (x~j,y~i) based on scenarios 1,3,4,5,7, and 8 of the continuous efficacy endpoint (Table 1). The maximum sample size was N=160 , enrolled in S=5 stages with cohort size c1=80 and c2=⋯=c5=20 to ensure reasonable power ( 80%−90% ) to detect the PoC in most scenarios. Because MCP-Mod and ANOVA cannot handle binary endpoints, we compared BQD with an MCP-Mod extension 24 (denoted as MCP-Mod-B) that was proposed to handle a binary efficacy endpoint. MCP-Mod-B targets the MED and thus was used as a comparator to evaluate MED selection.

Table 3. Simulation scenarios for the binary efficacy endpoint.

	Dose levels	Dose levels	
	0	1	2	3	4	0	1	2	3	4	
	Scenario 1	Scenario 2	
Eff. rate	0.20	0.39	0.45	0.48	0.50	0.20	0.21	0.39	0.48	0.48	
Tox. rate	0.05	0.10	0.11	0.30	0.34	0.05	0.10	0.18	0.20	0.45	
Utility	0.15	0.29	0.34	0.18	0.16	0.15	0.11	0.21	0.28	0.03	
	Scenario 3	Scenario 4	
Eff. rate	0.20	0.20	0.20	0.21	0.40	0.20	0.27	0.44	0.48	0.49	
Tox. rate	0.05	0.06	0.08	0.10	0.24	0.05	0.12	0.14	0.35	0.45	
Utility	0.15	0.14	0.12	0.11	0.16	0.15	0.15	0.30	0.13	0.04	
	Scenario 5	Scenario 6	
Eff. rate	0.20	0.22	0.30	0.44	0.49	0.20	0.22	0.26	0.43	0.50	
Tox. rate	0.05	0.06	0.10	0.12	0.32	0.05	0.08	0.10	0.32	0.45	
Utility	0.15	0.16	0.20	0.32	0.17	0.15	0.14	0.16	0.11	0.05	
The minimum effective doses are in boldface. The maximum utility doses are underlined.

Notice that, both MCP-Mod and ANOVA consider only efficacy and the target MED and were used as comparators to evaluate the performance of BQD in MED selection for continuous, ordinal and binary efficacy endpoint. There is no existing dose-ranging method targeting MUD. We will thus only present the simulation results in MUD selection for our proposed method to demonstrate the advantage of the BQD design to select multiple target doses. We believe that this MUD selection step can have great potential to be further developed in dose-ranging designs.

We performed 10,000 simulations for each scenario. The operating characteristics of the designs were evaluated in three aspects: (1) the power to detect the dose-response (i.e. the power for the PoC); (2) the correct selection of the MED and MUD; and (3) patient allocation to treatment arms. Specifically, for the second aspect, we will evaluate the percentage of correct selection of the MED ( PCSMED ) and the MUD ( PCSMUD ), defined as the percentage of simulated trials that correctly selected the true MED and the true MUD, respectively. To facilitate the application of the proposed method, we have created a Github repository for the R codes to reproduce the results in the article, which can be found in https://github.com/FTBIOS666/Bayesian-quasi-likelihood-dose-ranging-design.

3.2. Results

3.2.1. Results for continuous efficacy endpoint

Figure 2 shows the simulation results for the continuous efficacy endpoint. Figure 2(A) displays the power for establishing the PoC. The power BQD had for establishing the PoC was similar to that of MCP-Mod and up to 24.6% (mean, 12.95% ) greater than that of ANOVA. As described above, the posterior probability cutoff for establishing the PoC (i.e. CPoC ) was calibrated such that each method controlled the familywise type I error rate at 0.05 under the null scenario of a flat efficacy curve.

Figure 2. Simulation results for the continuous efficacy endpoint. (A) The power for establishing the PoC. (B) The percentages of the correct selection of the MED ( % ). (C) The percentages of the correct selection of the MUD ( % ). (D) The percentages of patients allocated to the MED or MUD; the horizontal dotted black line denotes the percentage of patients in each arm in fixed one-stage designs (i.e. 20% ), such as MCP-Mod. BQD: Bayesian quasi-likelihood dose-ranging design; ANOVA: analysis of variance; PoC: proof-of-concept; MED: minimum effective dose; MUD: maximum utility dose; MCP-Mod: multiple comparison test and modeling process.

In terms of the percentage of correct selection of the MED ( PCSMED ), ANOVA generally had the lowest PCSMED values (see Figure 2(B)). This is consistent with previous simulation studies.2,9 BQD had similar performance as MCP-Mod when the dose–efficacy model was correctly specified for the latter. If the dose–efficacy model was not correctly specified, BQD outperformed MCP-Mod because BQD did not impose any parametric assumptions on the dose-efficacy curve. Specifically, in scenarios 1–4, in which the dose–efficacy model was correctly specified for MCP-Mod, MCP-Mod and BQD performed similarly: the two designs had similar PCSMED values in scenarios 1 and 2, and whereas BQD had a higher PCSMED in scenario 3, MCP-Mod had a higher PCSMED in scenario 4. In scenarios 5–10, in which the dose–efficacy model was arbitrarily generated and not necessarily correctly specified, BQD had higher PCSMED values than MCP-Mod did. For example, in scenarios 5 and 6, the PCSMED values of BQD were 9.9% and 11% higher, respectively, than those of MCP-Mod. Figure 2(C) displays the percentage of correct selection of the MUD ( PCSMUD ). Overall, BQD showed robust performance with eight out of 10 scenarios having PCSMUD values around or above 60% .

In terms of patient allocation, BQD generally outperformed MCP-Mod and ANOVA, allocating higher percentages of patients to the MED and MUD arms (Figure 2(D)). Because ANOVA and MCP-Mod utilize equal randomization to five arms, the percentages of patients they allocate to the MED and MUD arms are both fixed at 20% . In contrast, BQD employs adaptive randomization and assigns higher percentages of patients to the MED and MUD arms in most scenarios.

3.2.2. Results for ordinal efficacy endpoint

Figure 3 shows the simulation results for the ordinal efficacy endpoint. Similar to the results for the continuous endpoint, the power BQD had for establishing the PoC was similar to that of MCP-Mod, and both BQD and MCP-Mod outperformed ANOVA (Figure 3(A)). In terms of selecting the MED (see Figure 3(B)), ANOVA had the worst performance with the lowest PCSMED . BQD performed similarly to MCP-Mod when the dose–efficacy model was correctly specified for the latter (e.g. scenarios 1–3) and outperformed MCP-Mod when the dose–efficacy model was not correctly specified for the latter (e.g. scenarios 4–6). For example, in scenarios 4–6, the PCSMED values of BQD were 14.4% , 18.8% , and 22.7% higher, respectively, than those of MCP-Mod. In addition, BQD again showed robust performance in selecting the MUD (Figure 3(C)). In four of six scenarios (i.e. scenarios 1 and 3– 6 ), BQD resulted in PCSMUD values around or above 60% . In terms of patient allocation, BQD generally outperformed MCP-Mod and ANOVA, allocating higher percentages of patients to the MED and MUD arms (Figure 3(D)).

Figure 3. Simulation results for the ordinal efficacy endpoint. (A) The power for establishing the PoC. (B) The percentages of the correct selection of the MED ( % ). (C) The percentages of the correct selection of the MUD ( % ). (D) The percentages of patients allocated to the MED or MUD; the horizontal dotted black line denotes the percentage of patients in each arm in fixed one-stage designs (i.e. 20% ), such as MCP-Mod. BQD: Bayesian quasi-likelihood dose-ranging design; ANOVA: analysis of variance; PoC: proof-of-concept; MED: minimum effective dose; MUD: maximum utility dose; MCP-Mod: multiple comparison test and modeling process.

3.2.3. Results for binary efficacy endpoint

The results for the binary efficacy endpoint are generally similar to those for the continuous and ordinal endpoints, but the advantage of BQD is more pronounced. As shown in Figure 4(A) and (D), compared with MCP-Mod-B, BQD had higher power for establishing the PoC in all six scenarios. In addition, in most scenarios, BQD yielded higher selection percentages of PCSMED values than MCP-Mod-B did and resulted in PCSMED values around or above 60% . Also, BQD generally allocated higher percentages of patients to the MED and MUD arms than MCP-Mod-B.

Figure 4. Simulation results for the binary efficacy endpoint. (A) The power for establishing the PoC. (B) The percentages of the correct selection of the MED ( % ). (C) The percentages of the correct selection of the MUD ( % ). (D) The percentages of patients allocated to the MED or MUD; the horizontal dotted black line denotes the percentage of patients in each arm in fixed one-stage designs (i.e. 20% ), such as MCP-Mod. BQD: Bayesian quasi-likelihood dose-ranging design; ANOVA: analysis of variance; PoC: proof-of-concept; MED: minimum effective dose; MUD: maximum utility dose; MCP-Mod: multiple comparison test and modeling process.

3.3. Sensitivity analysis

We conducted sensitivity analyses for different number of dose levels (i.e. J=4 and J=7 ) as shown in Supplemental Tables S4 and S5 and Figures S1 and S2; different degrees of correlation between efficacy and toxicity endpoints (i.e. ρ=0.1,0.5 , and 0.7 ) as displayed in Supplemental Figure S3; and different adaptive allocation rules (i.e. τ=1 and τ=0 ) as shown in Supplemental Figure S4. The results (see Supplemental Material) are similar to those described above, showing that the BQD design is generally robust to these design parameters.

The performance of BQD is similar to or better than that of MCP-Mod, suggesting that the quasi-Bernoulli likelihood approach is highly efficient. To further investigate its efficiency, we compared BQD (based on the quasi-Bernoulli likelihood) with a version of BQD based on the true likelihood (denoted by BQD-L). The only difference between BQD and BQD-L is that the latter uses the true likelihood; all other decision rules are the same for the two designs. Thus, BQD-L provides the upper bound of the performance. Figure S5 in the Supplemental Material shows that BQD and BQD-L have similar performance, with similar power for establishing the PoC and similar accuracy in identifying the MED and MUD, further confirming the high efficiency of the quasi-Bernoulli likelihood approach.

4. Discussion

We propose a Bayesian quasi-likelihood dose-ranging design that handles various types of efficacy endpoints (e.g. binary, ordinal, and semi-continuous endpoints) and explicitly incorporates benefit–risk assessment into the decision of dose assignment and selection. Our design utilizes a utility function as a measure of benefit–risk tradeoff and adaptively assigns patients to doses based on the doses’ likelihood of being the MED and MUD. The design takes a group-sequential approach. At each interim, the doses that are deemed overly toxic or futile are dropped. The simulation study shows that the BQD design is robust and has competitive performance in selecting the MED. Additionally, it includes an extra feature for further MUD selection.

The BQD design models the toxicity and efficacy at each dose locally without making any parametric assumption on the shape of dose–efficacy or dose–toxicity curves. This makes the design simple (with closed-form posteriors) and more robust than MCP-Mod. Simulation shows that this nonparametric approach does not compromise the efficiency of the BQD design. This is because the isotonic regression utilizes efficacy and toxicity data across dose levels, which improves the efficiency of estimation and decision making. In addition, the design’s adaptive randomization and Bayesian decision rules enable more efficient patient allocation and provide extra flexibility to calibrate the design to improve the operating characteristics.

To accommodate various types of efficacy endpoints and streamline posterior calculations, we adopt a hybrid approach, where we model toxicity using its true likelihood while modeling efficacy using quasi-Bernoulli likelihood. It’s crucial to emphasize that our design does not mandate the use of the hybrid approach; the true likelihood of the efficacy endpoint can be employed. However, this alternative necessitates distinct models for different types of endpoints (e.g. the Bernoulli model for binary endpoints, the normal model for continuous endpoints, and the multinomial model for categorical endpoints) and involves more complex computations. Both our simulation and previous research28,27,29 demonstrate that the quasi-likelihood is highly efficient and yields desirable operating characteristics.

The BQD design can be extended in various ways. In some trials, the efficacy endpoint is the time to the event. In this case, a quasi-Bernoulli or quasi-normal likelihood approach cannot be used. We may use a piecewise exponential model and modify the utility along the lines of Murray et al. 34 In addition, the BQD design assumes that the efficacy endpoint is quickly ascertainable for adaptive randomization and group sequential decisions. If this assumption does not hold, we may use imputation methods32,35 or likelihood approximation methods 36 to facilitate real-time decision making.

Supplemental Material

sj-pdf-1-smm-10.1177_09622802241239268 - Supplemental material for A Bayesian quasi-likelihood design for identifying the minimum effective dose and maximum utility dose in dose-ranging studies

Supplemental material, sj-pdf-1-smm-10.1177_09622802241239268 for A Bayesian quasi-likelihood design for identifying the minimum effective dose and maximum utility dose in dose-ranging studies by Feng Tian, Ruitao Lin, Li Wang and Ying Yuan in Statistical Methods in Medical Research

Acknowledgements

The authors would like to thank the Editor, the Associate Editor, and the two reviewers for their valuable comments and suggestions, which greatly contributed to enhancing the quality of the article.

The author(s) declared no potential conflicts of interest with respect to the research, authorship, and/or publication of this article.

Funding: The author(s) disclosed receipt of the following financial support for the research, authorship, and/or publication of this article. Ying Yuan is partially supported by the grant from the National Cancer Institution (U01DK108328), and Bettyann Asche Murray Professorship. Ruitao Lin is partially supported by grants from the National Cancer Institute (5P30CA016672, 5P50CA221703, and 1R01CA261978).

ORCID iDs: Feng Tian https://orcid.org/0000-0003-3767-0326

Ruitao Lin https://orcid.org/0000-0003-2244-131X

Ying Yuan https://orcid.org/0000-0003-3163-480X

Supplemental material: Supplemental material for this article including additional simulation details and results as well as the posterior calculation are available online.
==== Refs
References

1 Ting N Chen D Ho S et al . Phase II clinical development of new drugs. 1st ed. New York: Springer, 2017. p. 258.
2 Bornkamp B Bretz F Dmitrienko A et al . Innovative approaches for designing and analyzing adaptive dose-ranging trials. J Biopharm Stat 2007; 17 : 965–995.18027208
3 Pinheiro J Sax F Antonijevic Z et al . Adaptive and model-based dose-ranging trials: quantitative evaluation and recommendations. White paper of the PhRMA working group on adaptive dose-ranging studies. Stat Biopharm Res 2010; 2 : 435–454.
4 Wang X Ting N . A proof-of-concept clinical trial design combined with dose-ranging exploration. Pharm Stat 2012; 11 : 403–409.22714951
5 Berry D Mueller P Grieve A et al . Adaptive Bayesian designs for dose-ranging drug trials. Case Stud Bayesian Stat 2002; 5 : 99–181.
6 Dragalin V Hsuan F Padmanabhan S . Adaptive designs for dose-finding studies based on sigmoid emax model. J Biopharm Stat 2007; 17 : 1051–1070.18027216
7 Bretz F Pinheiro J Branson M . Combining multiple comparisons and modeling techniques in dose–response studies. Biometrics 2005; 61 : 738–748.16135025
8 Miller F Guilbaud O Dette H . Optimal designs for estimating the interesting part of a dose–effect curve. J Biopharm Stat 2007; 17 : 1097–1115.18027219
9 Dragalin V Bornkamp B Bretz F et al . A simulation study to compare new adaptive dose-ranging designs. Stat Biopharm Res 2010; 2 : 487–512.
10 Ivanova A Xiao C Tymofyeyev Y . Two-stage designs for phase 2 dose-finding trials. Stat Med 2012; 31 : 2872–2881.22865626
11 Antonijevic Z Pinheiro J Fardipour P et al . Impact of dose selection strategies used in phase II on the probability of success in phase III. Stat Biopharm Res 2010; 2 : 469–486.
12 US Food and Drug Administration. Benefit–risk assessment in drug regulatory decision-making, https://www.fda.gov/files/about%20fda/published/Benefit-Risk-Assessment-in-Drug-Regulatory-Decision-Making.pdf (2018, accessed 10 July 2022).
13 US Food and Drug Administration. Reforming the dose optimization and dose selection paradigm in oncology, https://www.fda.gov/about-fda/oncology-center-excellence/project-optimus (2022, accessed 14 February 2022).
14 Roozenbeek B Lingsma H Perel P et al . The added value of ordinal analysis in clinical trials: an example in traumatic brain injury. Crit Care 2011; 15 : 1–7.
15 Houede N Thall P Nguyen H et al . Utility-based optimization of combination therapy using ordinal toxicity and efficacy in phase I/II trials. Biometrics 2010; 66 : 532–540.19673865
16 Peterson R Vock D Powers J et al . Analysis of an ordinal endpoint for use in evaluating treatments for severe influenza requiring hospitalization. Clin Trials 2017; 14 : 264–276.28397569
17 D’Amico G Abraldes J Rebora P et al . Ordinal outcomes are superior to binary outcomes for designing and evaluating clinical trials in compensated cirrhosis. Hepatology 2020; 72 : 1029–1042.31837238
18 Marconi V Ramanan A Bono S et al . Efficacy and safety of baricitinib for the treatment of hospitalised adults with COVID-19 (COV-BARRIER): a randomised, double-blind, parallel-group, placebo-controlled phase 3 trial. Lancet Respir Med 2021; 9 : 1407–1418.34480861
19 Whegang S Basco L Gwét H et al . Analysis of an ordinal outcome in a multicentric randomized controlled trial: application to a 3-arm anti-malarial drug trial in Cameroon. BMC Med Res Methodol 2010; 10 : 1–10.20053272
20 Sankoh A Huque M Dubey S . Some comments on frequently used multiple endpoint adjustment methods in clinical trials. Stat Med 1997; 16 : 2529–2542.9403954
21 Lin X Allred R Andrews G . A two-stage phase II trial design utilizing both primary and secondary endpoints. Pharm Stat 2008; 7 : 88–92.17252536
22 Evans S . Fundamentals of clinical trial design. J Exp Stroke Transl Med 2010; 3 : 19.21533012
23 Westfall P Krishen A Young S . Using prior information to allocate significance levels for multiple endpoints. Stat Med 1998; 17 : 2107–2119.9789917
24 Pinheiro J Bornkamp B Glimm E et al . Model-based dose finding under model uncertainty using general parametric models. Stat Med 2014; 33 : 1646–1661.24302486
25 Dunson D Neelon B . Bayesian inference on order-constrained parameters in generalized linear models. Biometrics 2003; 59 : 286–295.12926713
26 McCullagh P Nelder J . Generalized linear models. 2nd ed. New York: Chapman and Hall, 1989. p. 511.
27 Chen Z Tighiouart M Kowalski J . Dose escalation with overdose control using a quasi-continuous toxicity score in cancer phase I clinical trials. Contemp Clin Trials 2012; 33 : 949–958.22561391
28 Yuan Z Chappell R Bailey H . The continual reassessment method for multiple toxicity grades: a Bayesian quasi-likelihood approach. Biometrics 2007; 63 : 173–179.17447942
29 Lin R Zhou Y Yan F et al . BOIN12: Bayesian optimal interval phase I/II trial design for utility-based dose finding in immunotherapy and targeted therapies. JCO Precis Oncol 2020; 4 : 1393–1402.
30 US Food and Drug Administration, US Food and Drug Administration Fit-for-Purpose Initiative, Empirically Based Bayesian Emax Models, https://www.fda.gov/drugs/development-approval-process-drugs/drug-development-tools-fit-purpose-initiative (2022, accessed 19 August 2022).
31 Ivanova A Liu K Snyder E et al . An adaptive design for identifying the dose with the best efficacy/tolerability profile with application to a crossover dose-finding study. Stat Med 2009; 28 : 2941–2951.19731265
32 Zhou Y Lee J Yuan Y . A utility-based Bayesian optimal interval (U-BOIN) phase I/II design to identify the optimal biological dose for targeted and immune therapies. Stat Med 2019; 38 : S5299–S5316.
33 Liu S Johnson V . A robust Bayesian dose-finding design for phase I/II clinical trials. Biostatistics 2016; 17 : 249–263.26486139
34 Murray TA Thall PF Yuan Y et al . Robust treatment comparison based on utilities of semi-competing risks in non-small-cell lung cancer. J Am Stat Assoc 2017; 112 : 11–23.28943681
35 Cai C Liu S Yuan Y . A Bayesian design for phase II clinical trials with delayed responses based on multiple imputation. Stat Med 2014; 33 : 4017–4028.24817556
36 Lin R Yuan Y . Time-to-event model-assisted designs for dose-finding trials with delayed toxicity. Biostatistics 2020; 21 : 807–824.30984972
