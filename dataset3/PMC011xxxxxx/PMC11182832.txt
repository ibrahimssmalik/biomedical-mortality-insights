
==== Front
Bull Math Biol
Bull Math Biol
Bulletin of Mathematical Biology
0092-8240
1522-9602
Springer US New York

38886260
1314
10.1007/s11538-024-01314-z
Original Article
Dimensions of Level-1 Group-Based Phylogenetic Networks
Gross Elizabeth 1
Krone Robert 2
http://orcid.org/0000-0002-6298-1014
Martin Samuel samuel.martin99@gmail.com

3
1 https://ror.org/01wspgy28 grid.410445.0 0000 0001 2188 0957 Department of Mathematics, University of Hawai‘i at Mānoa, Mānoa, HI USA
2 https://ror.org/05rrcem69 grid.27860.3b 0000 0004 1936 9684 Department of Mathematics, UC Davis, Davis, CA USA
3 https://ror.org/018cxtf62 grid.421605.4 0000 0004 0447 4123 Earlham Institute, Norwich, UK
17 6 2024
17 6 2024
2024
86 8 9015 11 2023
15 5 2024
© The Author(s) 2024
2024
https://creativecommons.org/licenses/by/4.0/ Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/.
Phylogenetic networks represent evolutionary histories of sets of taxa where horizontal evolution or hybridization has occurred. Placing a Markov model of evolution on a phylogenetic network gives a model that is particularly amenable to algebraic study by representing it as an algebraic variety. In this paper, we give a formula for the dimension of the variety corresponding to a triangle-free level-1 phylogenetic network under a group-based evolutionary model. On our way to this, we give a dimension formula for codimension zero toric fiber products. We conclude by illustrating applications to identifiability.

Keywords

Phylogenetic networks
Markov models of evolution
Group-based models
Dimension
http://dx.doi.org/10.13039/501100000266 Engineering and Physical Sciences Research Council EP/W007134/1 Martin Samuel http://dx.doi.org/10.13039/501100000268 Biotechnology and Biological Sciences Research Council BB/X005186/1 Martin Samuel issue-copyright-statement© The Author(s) under exclusive licence to Society for Mathematical Biology 2024
==== Body
pmcIntroduction

In evolutionary biology, phylogenetic networks are graphs used to represent the evolutionary history of a set of taxa or species. In molecular phylogenetics, these graphs are usually paired with a statistical model where the graph is a combinatorial parameter of the model. In this work, we focus on network-based Markov models. In particular, fixing a directed graph N with n leaves, i.e. a network, the associated network-based Markov model is the image of a polynomial parameterization in the space of probability distributions over the sample space, which commonly in applications is {A,G,C,T}n where A, G, C, T are the four-nucleic bases.

When understanding such models, the overarching goal is to be able to infer phylogenetic networks from molecular sequence data. To be able to do this, we must first determine whether the model is identifiable from the observed data. By representing phylogenetic models as geometric objects called varieties, such questions can be reframed in terms of geometry, that is, we would like to know whether varieties representing distinct phylogenetic network models are themselves distinct. One of the first geometric descriptions we can give of a variety is its dimension. In Theorems 1 and 2, we give dimension results for all level-1, triangle-free phylogenetic networks under a class of Markov models called group-based models, and in Section 6 we give some identifiability results that follow easily from our dimension formula.

As described above, we are interested in the geometry of network-based Markov models, in particular, their dimensions. Such work is along the lines of Sturmfels and Sullivant (2005), Eriksson et al (2005), Allman and Rhodes (2007), Allman and Rhodes (2008), Casanellas and Fernández-Sánchez (2008), Zwiernik and Smith (2011), Casanellas and Fernández-Sánchez (2011), Michałek (2011), Casanellas et al (2017), Michałek and Ventura (2019), and Casanellas et al (2021), which study the geometry of tree-based Markov models. Indeed, by moving to C and taking Zariski closures, images of the parameterization maps correspond to algebraic varieties whose study can aid in model selection (see Pachter and Strumfels (2005), Drton et al (2009), and Sullivant (2018) for discussions). Popular constraints on the parameter space, such as Jukes-Cantor (JC), Kimura 2-parameter (K2P), and Kimura 3-parameter (K3P) constraints, give rise to a class of models referred to as group-based models. Assuming group-based constraints, the varieties associated to tree-based Markov models are toric varieties after a transformation of coordinates first described in Evans and Speed (1993) and Székely et al (1993) (see Sturmfels and Sullivant (2005) for an overview). The dimensions of tree varieties can be understood using tools from toric geometry. While under this same transformation, group-based network varieties have a lower dimensional toric action on them, and thus are T-varieties (see (Cummings et al (2021), Remark 4.1)), these varieties are generally less well understood. In this paper, we expand our understanding of these varieties by giving a formula for the dimension for all level-1 triangle-free group-based network varieties.

As described in Sect. 2, a group-based model of evolution is defined with a finite abelian group G and a subgroup B of the automorphism group of G, denoted Aut(G). In a network-based Markov model, each edge of the network has a transition matrix associated to it, representing the probabilities of each type of nucleotide (usually A, G, C, or T) mutating to another over an evolutionary time interval. The parameters of the model are the entries of these transition matrices along with a mixing parameter for each cycle. In a group-based model, the dimension of the parameter space is cut significantly by placing constraints on the transition matrices. In particular, each nucleotide is identified with an element of G, and the transition probability of a mutation from a to b depends only on b-a, reducing the number of free parameters in each matrix to |G|-1. The parameter space is reduced further by identifying the parameters for all elements of G that are in the same B-orbit. If l+1 is the number of B-orbits in G,  the number of free parameters for each edge is then l.

For a phylogenetic network N with m edges and c cycles, the expected dimension of the group-based network variety dimVNM is l(m-c)+1, and Proposition 12 shows that it is indeed an upper bound. The main theorem of this paper shows that most level-1 group-based network varieties have the expected dimension.

Theorem 1

Let N be a level-1 triangle-free phylogenetic network with n leaves, m edges, and c cycles. Let G be a finite abelian group of order at least 3 and B a subgroup of Aut(G). Let l+1 be the number of B-orbits in G. Then the group-based network variety VN(G,B) has dimension l(m-c)+1.

When G=Z/2Z, certain small phylogenetic networks do not have the expected dimension. In this case, since Aut(G) is the trivial group, there is only a single group-based model. This is the Cavender-Farris-Neyman (CFN) model, and has biological relevance, so we give the result for this group separately. Note that here we are able to give a full result for level-1 phylogenetic networks.

Theorem 2

Let G=Z/2Z and let N be a level-1 phylogenetic network with n leaves, m edges, c≥5 cycles of length at least 5, c4 4-cycles, and c3 3-cycles. Then the group-based network variety VNG has dimension m-(c≥5+2c4+3c3)+1.

Our main tool for proving these theorems is the toric fiber product. This is an operation on ideals that was first introduced in Sullivant (2006) and generalises the Segre product. One of the first applications was to phylogenetic trees under group-based models, where the ideals of the model are toric fiber products, and the operation corresponds to the graph operation of cutting a tree at an internal edge. To some extent this remains true for phylogenetic networks and allows us to focus our attention on a family of phylogenetic networks called sunlet networks (defined in Sect. 2.1). In Sect. 3 we give a general dimension formula for toric fiber products (Theorem 9) and apply this to phylogenetic trees and networks.

Preliminaries

In this section, we lay out the background needed for the paper. In particular, we review group-based models of sequence evolution where the combinatorial parameters are phylogenetic networks, as well as two tools that underlie the proof of our main theorems: tropical geometry for dimension analysis and toric fiber products. The main objects of biological relevance in this paper are phylogenetic networks, and, thus, that is where we begin.

Phylogenetic Networks

The following network notation and terminology is adapted from Francis et al (2018), Francis and Steel (2015), and Semple (2016).

Definition 1

A (binary rooted) phylogenetic network N on a set X is a rooted, acyclic, directed graph with no parallel edges that satisfies:The root vertex has outdegree 2.

All vertices of outdegree 0 have indegree 1. These vertices are called leaves and are labelled by X.

All other vertices have either indegree 1 and outdegree 2 (called tree vertices), or indegree 2 and outdegree 1 (called reticulation vertices). The incoming edges of a reticulation vertex are called reticulation edges.

A level-1 phylogenetic network is a phylogenetic network where each cycle in the underlying undirected graph contains exactly one reticulation vertex. A semi-directed phylogenetic network is a mixed graph obtained from a phylogenetic network by suppressing the root node and undirecting all tree edges while the reticulation edges remain directed. In a semi-directed phylogenetic network, the reticulation vertices are the vertices of indegree two and level-1 is defined the same as for a rooted phylogenetic network. A triangle-free level-1 semi-directed phylogenetic network is a level-1 semi-directed phylogenetic network where every cycle in the unrooted skeleton has length greater than three. For our work, it will be helpful to reduce the number of edges in a semi-directed phylogenetic network that we consider. To this end we introduce contracted semi-directed phylogenetic networks. A contracted semi-directed phylogenetic network is a mixed graph obtained from a semi-directed phylogenetic network by contracting the non-reticulation edge of each reticulation vertex (see for example, Fig. 1). Note that since level-1 networks are tree-child networks, in a contracted level-1 semi-directed phylogenetic network, two distinct reticulation vertices are never identified, and thus each non leaf-adjacent reticulation vertex has indegree 2 and outdegree 2, and each leaf-adjacent reticulation vertex has indegree 2 and outdegree 0. Furthermore, the level-1 condition in a contracted level-1 semi-directed phylogenetic network means that at least one of the outgoing edges of a reticulation vertex is a non-reticulation edge.

Finally, an n-sunlet network is the semi-directed phylogenetic network topology with n leaves and a single cycle of length n, where each vertex in the cycle is adjacent to a leaf vertex and one vertex in the cycle is a reticulation vertex. The 4-sunlet network is depicted in Fig. 1. Since an arbitrary level-1 network can be decomposed into a collection of trees and sunlet networks, sunlet networks will play a key role in our study.Fig. 1 a A leaf-labelled, directed 4-sunlet network, and b its corresponding contracted network (right)

Group-Based Models of Evolution

Fix an abelian group G and a subgroup B⊂Aut(G). Denote by B·G the set of B-orbits in G and let |B·G|=l+1. For a phylogenetic tree or network N, such a choice of G and B defines a model of evolution on N. From this model one can derive an algebraic variety, which we will denote VN(G,B). These varieties are our primary objects of study.

First, let us set up the notation and preliminaries for phylogenetic trees, i.e. phylogenetic networks with no reticulation vertices. For more details on group-based models on trees, see (Sullivant 2018, Section 15.3) and Sturmfels and Sullivant (2005). Let T be an n-leaf phylogenetic tree, with vertex set, edge set, and leaf set denoted by V(T), E(T), and L(T) respectively. Let m=|E(T)| be the number of edges in T. A consistent leaf G-labelling of T is a function ξ:L(T)⟶G that satisfies∑v∈L(T)ξ(v)=0.

Note that the set of consistent leaf G-labellings depends only on n, and not on the edges of T, so all n-leaf phylogenetic trees share the same set of consistent leaf G-labellings, which has size |G|n-1. When G is clear, we will call ξ a consistent leaf labelling.

For a phylogenetic tree T, each edge e∈E(T) is oriented away from the root vertex. Let L(e)⊂L(T) be the set of leaves on the arrow side of e. A consistent leaf labelling ξ of T induces a consistent edge labelling of T (also denoted ξ), which is a map ξ:E(T)⟶G given byξ(e)=∑v∈L(e)ξ(v).

To each edge e in a phylogenetic tree or network we associate l+1 parameters, denoted aeg, where g is a representative of the B-orbit [g]. For a tree T with n leaves, the parameterization in Fourier coordinates (see Sturmfels and Sullivant 2005) of the group-based model on T is1 qg1g2⋯gn=∏e∈E(T)aeξ(e),

where ξ is given by the consistent leaf labelling g1,…,gn. Index the standard basis of Cm(l+1) with upper indices g for some representatives of the orbits in B·G, and lower indices by the edges e∈E(T), and index the standard basis of Cn-1 by the consistent leaf-labellings. The parameterization map is the mapϕT:Cm(l+1)→Cn-1

where(ϕT(w))g1⋯gn=∏e∈E(T)weξ(e),

for w∈Cm(l+1) and consistent leaf labellings ξ with leaf labels g1,…,gn. The Zariski closure of the image of this map is called the phylogenetic variety of T and (G, B) and is denoted by VT(G,B).

Now, denote by R the C-algebra C[qg1⋯gn|g1+⋯+gn=0] and by ST the C-algebra C[aeg|[g]∈B·G,e∈E(T)]. The parameterization map ϕT is a morphism of affine varieties, with comorphism given by the C-algebra homomorphism ψT:R→ST which acts on generators asψT(qg1⋯gn)=∏e∈E(T)aeξ(e).

It follows that the vanishing ideal of VT(G,B), denoted IT(G,B), is the kernel of ψT.

We now move from trees to networks. Let N be a level-1 phylogenetic network with n leaves, m edges, and k reticulation vertices. Since N is a phylogenetic network, if we remove one of the two reticulation edges for each reticulation vertex, we obtain a phylogenetic tree. We encode a choice of reticulation edge for each reticulation vertex with a vector σ∈{0,1}k, and denote the resulting n-leaf phylogenetic tree by Tσ. Then the parameterization of our group based model on N is the map ϕN:Cm(l+1)→Cn-1 given by2 ϕN=∑σ∈{0,1}kϕTσ

As above, we call the Zariski closure of the image of this map the phylogenetic variety of N and (G, B), and denote it VN(G,B). The vanishing ideal IN(G,B) of VN(G,B) is the kernel of the C-algebra homomorphism ψN given by3 ψN:R→SNqg1⋯gn↦∑σ∈{0,1}kψTσ(qg1⋯gn).

where SN=C[aeg|[g]∈B·G,e∈E(N)] and we identify STσ as a subalgebra of SN in the obvious way.

When B={id}, we call the probabilistic model associated to (G, B) the general group-based model for the group G and denote the corresponding variety as VNG=VN(G,B). The K3P model is the general group-based model for the Klein-4 group, and the CFN model is the general group-based model for the group Z/2Z. The pairs (G, B) corresponding to JC and K2P are (Z/2Z×Z/2Z,S3) and (Z/2Z×Z/2Z,S2), respectively, where Aut(Z/2Z×Z/2Z) is identified with the permutation group S3.

In this paper, we are concerned with dimVN(G,B) for a general N and (G, B). In previous work, it is shown that under the CFN, JC, K2P, and K3P models, two phylogenetic network varieties are the same if the two networks have the same underlying semi-directed phylogenetic network (Gross and Long 2018, Gross et al 2021). Here, we extend these results to all group-based models. This allows us to focus our attention on semi-directed phylogenetic networks.

Lemma 3

Let G be a finite abelian group and let B be a subgroup of Aut(G). If N1 and N2 are two phylogenetic networks with the same underlying semi-directed phylogenetic network, then VN1(G,B)=VN2(G,B), where equality here means equality as sets.

Proof

Since phylogenetic networks have no parallel edges, it is clear that two phylogenetic networks N1 and N2 have the same semi-directed phylogenetic network if and only if their corresponding unrooted networks differ only by the directions of their non-reticulation edges. Therefore it is sufficient to show that suppressing vertices of degree 2 and changing the orientation of a single non-reticulation edge do not affect the model.

First notice that if we take a phylogenetic network N1 and reorient any collection of the non-reticulation edges to form a new network N2 (not necessarily a phylogenetic network), the maps described above are still well-defined and so too are the corresponding varieties. Thus, for this proof, we will relax the definition of phylogenetic networks to include such networks, as it will allow us to consider redirecting one edge at a time. Let N1 and N2 be two phylogenetic networks that are equal except for the direction of a single non-reticulation edge e, and let ξ1 and ξ2 be consistent leaf labellings on N1 and N2 respectively, with the property that ξ1(v)=ξ2(v) for each leaf v in the skeleton of N1 and N2. Then it is clear that ξ1(e)=-ξ2(e). This means that ϕN2=ϕN1∘θ, where θ is the automorphism of Cm(l+1) given by swapping the coefficients corresponding to aeg and ae-g whenever g≠-g. Since θ is bijective, composing θ with ϕN1 does not affect the image of ϕN1, so it follows that VN1(G,B)=VN2(G,B).

Next let N be a phylogenetic network with a vertex v of order 2 that has incident edges e1 and e2. Let ξ be a consistent leaf labelling of N with ξ(e1)=g so that either ξ(e2)=g or ξ(e2)=-g. Let us suppose that ξ(e2)=g and note that the proof in the other case is similar. Let N′ be the phylogenetic network got from N by suppressing v. Denote the new edge of N′ by e′ and, without loss of generality, give e′ the same orientation as e1 so that ξ(e′)=g. Let θ:C(m-1)(l+1)→Cm(l+1) be the map from the parameter space of N′ to the parameter space of N that is constant on all parameters for edges shared by N and N′, takes all parameters for edge e′ to the corresponding parameter for edge e1, and sets all parameters corresponding to edge e2 to 1. Then it is clear that we haveϕN′=ϕN∘θ,

and thus ImϕN′⊆ImϕN. On the other hand, consider ϕN(w) for w∈Cm(l+1). Taking u∈C(m-1)(l+1) such that ue′g=we1gwe2g for all [g]∈B·G and udg=wdg for all edges d≠e′ and all [g]∈B·G, we see that ϕN′(u)=ϕN(w). It follows that ImϕN′=ImϕN and thus VN′(G,B)=VN(G,B).

□

Note that since the orientation of the non-reticulation edges does not affect the variety, we may choose any orientation for non-reticulation edges, even if this is not consistent with any placement of a root vertex. Thus when considering a phylogenetic network N, we may take the corresponding semi-directed phylogenetic network and arbitrarily assign orientations to each non-reticulation edge to obtain a parameterization of the model.

Example 1

Let G be a finite abelian group and B={id}. Let N be a 4-sunlet network with leaf labellings, edge orientations, and edge labellings as in Fig. 1. The map ψN is given byqg1g2g3g4⟼a11a22a33a44a51a6g1+g2a74+a11a22a33a44a62a7g1+g4a81,

where to simplify notation we write aig for aeig. Here, the first monomial corresponds to the tree obtained by removing the edge e8, and the second monomial corresponds to the tree obtained by removing the edge e5.

To end this section, we show that sunlet networks and contracted sunlet networks have the same corresponding varieties.

Lemma 4

Let G be a finite abelian group and B a subgroup of Aut(G). Let N be a sunlet network and let N′ be its contraction. Then VN(G,B)=VN′(G,B).

Proof

Let N be an n -sunlet, so that N has 2n edges, denoted e1,...,e2n, with e1 the leaf edge adjacent to the reticulation vertex, and en+1,e2n the two reticulation edges, as in Fig. 1. Let ϕN denote the parameterization map for N, and let ϕN′ denote the parameterization map for its contraction N′. As before, index the parameter spaces C2n(l+1) and C(2n-1)(l+1) by the B-orbits in G and the edges of N and N′ respectively.

It is clear that ϕN′=ϕN∘ι, where ι:C(2n-1)(l+1)→C2n(l+1) is given by ι(w)eg=weg for all g∈B·G and e∈E(N′) (i.e. e≠e1), and ι(w)e1g=1 for all g∈B·G. It follows that ImϕN′⊆ImϕN.

On the other hand, let y=ϕN(w). Let u∈C(2n-1)(l+1) be given by ueg=weg for e≠en+1,e2n, and uen+1g=we1gwen+1g, and ue2ng=we1gwe2ng for all g∈B·G. It follows that ϕN′(u)=y=ϕN(w), so ImϕN⊆ImϕN′. □

In fact, by absorbing the parameters associated to the contracted edge of each reticulation vertex into the corresponding parameters of both reticulation edges, the above lemma can be extended for any level-1 phylogenetic network.

Lemma 5

Let G be a finite abelian group and B a subgroup of Aut(G). Let N be a level-1 semi-directed phylogenetic network and let N′ be its contraction. Then VN(G,B)=VN′(G,B). □

Tropical Geometry

In Sect. 4 we give a lower bound on the dimension of the sunlet varieties by using the tropical geometry results of Draisma (2008). Here we will present the result tailored to our needs.

Let C be a Zariski-closed cone in a complex vector space V of dimension n, and let W be a complex vector space of dimension m such that we have a polynomial map f:W→V mapping W dominantly to C. A classic result is that the rank of the Jacobian matrix of f at any point in x∈W gives a lower bound on dim(C) (and equality holds when x is generic). We similarly obtain a bound from the tropicalization of f.

Fix bases of V and W so that we may write f=(fb)b=1n, where fb∈C[x1,…,xm] for b=1,…n. Writefb=∑α∈Mbcαxα

for the finite subset Mb⊂Z≥0m consisting of those α for which cα≠0. The tropicalization of fb is defined as the piece-wise linear function Trop(fb):Rm→R given byTrop(fb)(λ):=minα∈Mb⟨λ,α⟩,

for λ∈Rm. Then Trop(f):Rm→Rn is defined as (Trop(fb))b=1n.

We will not define here the tropical variety Trop(C)⊆Rn, but we note two relevant facts (see e.g. Maclagan and Sturmfels (2021)):Trop(C) is a polyhedral complex with dimension bounded by dim(C),

and Im(Trop(f))⊆Trop(C).

Therefore the Jacobian of Trop(f) at a point λ∈Rm where the map is differentiable gives a lower bound on dim(C) (although it is no longer true that equality necessarily holds when λ is generic).

Fix λ such that Trop(f) is differentiable at λ, meaning that Trop(f) is linear in an open neighborhood U of λ. Specifically Trop(fb)(μ)=⟨μ,αb′⟩ for all μ∈U where αb′ is the unique vector in Mb that minimizes ⟨λ,αb′⟩. Then Trop(f)(μ)=AλTμ where Aλ is the m×n matrix with columns α1′,…,αn′. (Note that AλT is also the Jacobian matrix of Trop(f) at λ.) The lemma below follows.

Lemma 6

(Draisma (2008), Corollary 2.3) Let the notation be as above. ThendimC≥maxλ∈RmrankRAλ.

For our purposes, f will be given by the polynomial parameterization map ϕN. Since the variety VN(G,B) is equal to the Zariski closure of ϕN(Cn-1), and since each polynomial in the parameterization is homogeneous, VN(G,B) is a closed cone.

Toric Fiber Products

The toric fiber product is an algebraic operation that takes two homogeneous ideals with compatible multigradings and produces a new homogeneous ideal. It was introduced in Sullivant (2006) in order to generalise the gluing operation for toric ideals that appear in tree-based models of evolution and elsewhere in algebraic statistics, and further studied in Engström et al (2014) and Kahle and Rauh (2014). More recently toric fiber products were introduced into the geometric modelling setting in Duarte et al (2023). Here, we will introduce the basic objects and recommend that the reader consult (Sullivant 2006) for further details.

Let r∈N and s,t∈Nr, and let A={a1,…,ar}⊂ZD be a linearly independent set for some D>0. Denote the affine semigroup generated by A by NA. Let K be an algebraically closed field and letK[x]=K[xji|i∈[r],j∈[si]],

andK[y]=K[yki|i∈[r],k∈[ti]],

be multigraded polynomial rings with multidegree given by deg(xji)=deg(yki)=ai for all i=1,…,r, j=1,…,si, and k=1,…,ti. Note that since the ai are linearly independent, ideals in K[x] and K[y] that are homogeneous with respect to the multigrading are also homogeneous with respect to the total degree. For homogeneous ideals I⊂K[x] and J⊂K[y], let R=K[x]/I and S=K[y]/J be the corresponding quotient rings, which inherit the multigrading from K[x] and K[y] respectively. LetK[z]=K[zjki|i∈[r],j∈[si],k∈[ti]]

be the polynomial ring with the analogous multigrading (i.e. degzjki=ai). Let ϕIJ be the ring homomorphism given byϕIJ:K[z]⟶R⊗KSzjki⟼xji⊗yki.

Definition 2

With notation as above, the toric fiber product of I and J isI×AJ:=kerϕIJ.

Note that when I and J are prime ideals, since the toric fiber product I×AJ is the kernel of a ring homomorphism into an integral domain, it is a prime ideal. It will be helpful for us to also consider the monomial homomorphismϕB:K[z]⟶K[x,y]zjki⟼xjiyki,

where we think of B as being the integral matrix of exponent vectors of this map. The ideal IB=kerϕB is a toric ideal and is given byIB=〈QuadB〉,

whereQuadB={zj1k2izj2k1i-zj1k1izj2k2i|i∈[r],1≤j1<j2≤si,1≤k1<k2≤ti},

and QuadB is a Gröbner basis for IB with respect to any term order that selects the first term (as written above) as the initial term for each quadric (Sullivant 2006, Proposition 10).

We may also define I×AJ as ϕB-1(I+J), where we consider I and J as being their natural extensions in K[x,y]. If ω1 and ω2 are weight vectors on K[x] and K[y] respectively, then we have a natural weight vector (ω1,ω2) on K[x,y], and the pullback ϕB∗(ω1,ω2) is a weight vector on K[z]. These weight vectors have the property that for all monomials za∈K[z] we have wtϕB∗(ω1,ω2)(za)=wt(ω1,ω2)(ϕB(za)).

Let f∈K[x] be a homogeneous polynomial with respect to the multigrading NA and total degree d, so that we may writef=∑u=1vcuxj1u1⋯xjdud,

with each jlu∈[sil] and cu∈K. The upper indices i1,…,id can be written independent of u since f is homogeneous with respect to NA and A is linearly independent. For any k=(k1,…,kd) with kl∈[til] define the lift of f by k, denoted fk∈K[z] by4 fk=∑u=1vcuzj1uk11⋯zjdukdd.

For a set F⊂K[x] define LiftF to be the subset of K[z] consisting of all possible fk with f∈F. We define LiftG for G⊂K[y] analogously. Observe that we haveϕB(fk)=∑u=1vcuxj1u1⋯xjdudy11⋯ydd=(y11⋯ydd)f.

Since the weight of each monomial in fk with respect to ϕB∗(ω1,ω2) is equal to the weight with respect to (ω1,ω2) of the image of that monomial under ϕB, and this is in turn given by the sum of the weight with respect to ω1 of the corresponding monomial in f and the weight with respect to ω2 of y11⋯ydd, we have that inϕB∗(ω1.ω2)(fk)=(inω1(f))k. It follows that inϕB∗(ω1.ω2)(⟨LiftF⟩)=Lift(inω1(⟨F⟩), and by symmetry inϕB∗(ω1.ω2)(⟨LiftG⟩)=Lift(inω2(⟨G⟩).

One of the key results on toric fiber products is the following.

Theorem 7

(Sullivant (2006), Theorem 13) Let F be a homogeneous Gröbner basis for I with respect to a weight vector ω1, let G be a homogeneous Gröbner basis for J with respect to a weight vector ω2, and let ωq be a weight vector such that QuadB is a Gröbner basis for IB. ThenLift(F)∪Lift(G)∪QuadB

is a Gröbner basis for I×AJ with respect to the weight vector ϕB∗(ω1,ω2)+εωq for sufficiently small ϵ>0.

Note that if ε is chosen small enough, then inϕB∗(ω1,ω2)+εωq(fk)=inϕB∗(ω1,ω2)(fk) for all fk∈⟨LiftF,LiftG⟩.

Remark 1

Since QuadB⊂kerϕB we have that inϕB∗(ω1,ω2)(f)=f for all f∈QuadB. Now inϕB∗(ω1,ω2)+εωq(f)=inωq(inϕB∗(ω1,ω2)(f))=inωq(f), so it follows that on QuadB, the weight vector ϕB∗(ω1,ω2)+εωq chooses the same leading term as the weight vector ωq.

Dimension of Toric Fiber Products

In this section we give a dimension formula for the toric fiber product of two prime ideals when the set A is linearly independent, and then apply this to level-1 phylogenetic networks.

Recall the following definitions, from e.g. Becker and Weispfenning (1993). Let I be an ideal in the polynomial ring K[x1,⋯,xn]. We say that a set U⊆{x1,…,xn} is independent modulo I if I∩K[U]={0}. We say that U is maximally independent modulo I if it is independent modulo I and there exists no other set U′⊆{x1,…,xn} such that U⊆U′ and U′ is independent modulo I. The dimension of I, denoted dimI, is given by max{|U||U⊆{x1,…,xn}is independent moduloI}. If I is a prime ideal then for all sets U⊆{x1,…,xn} that are maximally independent modulo I we have dimI=|U|. We begin with the following lemma.

Lemma 8

Let M⊂K[x] be a set of monomials, and let U⊆{xii|i∈[r],ji∈[si]} be maximally independent modulo ⟨M⟩, given byU={xjihi|i∈I,h=1,…,ni},

where I⊂[r] and for each i∈I we have jih∈[si] for h=1,…,ni. Then the setLiftU={zjihki|i∈I,h=1,…,ni,k∈[ti]}⊆K[z]

is maximally independent modulo ⟨LiftM⟩.

Proof

First observe that ⟨LiftM⟩ is a monomial ideal generated by monomials of the form mk as in equation (4) for m∈M. Thus, in order to show independence, it is sufficient to only consider monomials mk. Now if mk∈⟨LiftM⟩∩K[zjihki|i∈I,h=1,…,ni,k∈[ti]], then m∈M∩K[xii|i∈I,ji∈[si]]={0}, and thus LiftU is independent modulo ⟨LiftM⟩. Furthermore, if LiftU is not maximal then there exists some i′∈[r],j′∈[si′], and k′∈[ti′] such that LiftU∪{zj′k′′} is independent modulo ⟨LiftM⟩. But then LiftU∪{zj′k′|k∈[ti′]}=Lift(U∪{x′′}) is also independent modulo ⟨LiftM⟩, so U∪{x′′} is independent modulo ⟨M⟩, contradicting the maximality of U. □

Note that we have the analogous result for a set of monomials M⊂K[y] and U⊆{yii|i∈[r],ki∈[ti]}.

Theorem 9

Let I and J be homogeneous ideals in K[x] and K[y] respectively, let ω1 be a weight vector for K[x], and let ω2 be a weight vector for K[y]. Let the set {xjihi|i∈I1,jih∈[si],h=1,…,ni} be maximally independent modulo inω1(I) for some I1⊆[r], and let the set {ykigi|i∈I2,kig∈[ti],g=1,…,mi} be maximally independent modulo inω2(J) with I2⊆[r]. If the set A is linearly independent, then5 dimI×AJ≥∑i∈I1∩I2(ni+mi-1).

Furthermore, if I and J are prime and we have I1=I2=[r] then dimI×AJ=dimI+dimJ-|A|.

Proof

Let F and G be Gröbner bases of I and J with respect to the weight vectors ω1 and ω2 respectively, and let ωq be a weight vector on K[z] that for all i chooses zj1k2izj2k1i as the initial term for each polynomial in QuadB, where 1≤j1<j2≤si and 1≤k1<k2≤ti. By Theorem 7, we have that for the weight vector ω=ϕB∗(ω1,ω2)+εωq and sufficiently small ε>0, the set Lift(F)∪Lift(G)∪QuadB is a Gröbner basis of I×AJ. To prove inequality (5) it is sufficient to find a set of generators zjlkll that are maximally independent modulo inω(I×AJ) and that has size ∑i∈I1∩I2(ni+mi-1).

As in the statement of the theorem, let the set {xjihi|i∈I1,jih∈[si],h=1,…,ni} be maximally independent modulo inω1(I)=inω1(⟨F⟩), and for each i∈I1 arrange the jih so that ji1<ji2<⋯<jii. By Lemma 8, and since inω(⟨LiftF⟩)=Lift(inω1⟨F⟩), we have that the set{zjihki|i∈I1,h=1,…,ni,k=1,…,ti}⊂K[z]

is maximally independent modulo inω(⟨LiftF⟩). Similarly, since the set {ykigi|i∈I2,kig∈[ti],g=1,…,mi} is maximally independent modulo inω2(J), we have that{zjkigi|i∈I2,g=1,…,mi,j=1,…,si}⊂K[z]

is maximally independent modulo inω(⟨LiftG⟩). Again, for each i∈I2 arrange the kih so that ki1<ki2<⋯<kii. We now haveinω(⟨LiftF∪LiftG⟩)∩K[zjihkigi|i∈I1∩I2,h=1,…,ni,g=1,…,mi]={0},

and that the set {zjihkigi|i∈I1∩I2,h=1,…,ni,g=1,…,mi} is maximal with respect to this condition. We claim that the setZ={zjihki1i|i∈I1∩I2,h=1,…,ni}∪{zjiikigi|i∈I1∩I2,g=1,…,mi}

is maximally independent modulo inω(⟨LiftF∪LiftG∪QuadB⟩)=inω(I×AJ) (see Fig. 2).

First we show that inω(⟨LiftF∪LiftG∪QuadB⟩)∩K[Z]={0}. Observe that since LiftF∪LiftG∪QuadB is a Gröbner basis, we have inω(⟨LiftF∪LiftG∪QuadB⟩)=inω(LiftF)∪inω(LiftG)∪inω(QuadB). Since inω(⟨LiftF∪LiftG⟩)∩K[Z]={0}, it is sufficient to show that for each i∈I1∩I2 the elements of degree ai in Z do not appear together as a quadratic monomial in inω(⟨QuadB⟩). By Remark 1 and our choice of ω we have thatinω(QuadB)={zj1k2izj2k1i|i∈[r],1≤j1<j2≤si,1≤k1<k2≤ti}.

Fix i∈I1∩I2 and observe that for any two elements of Z of degree ai, say zjki and zj′k′i with j≤j′, we either have j=j′, k=k′, or k<k′. In all cases zjkizj′k′i∉inω(QuadB).

Next we show that Z is maximal. By the maximal independence of K[zjihkigi|i∈I1∩I2,h=1,…,ni,g=1,…,mi] modulo inω(⟨LiftF∪LiftG⟩), we need only consider those zjki∉Z with i∈I1∩I2, j=jih for some h=1,…,ni, and k=kig for some g=1,…,mi. But it is clear that for any such zjki, we can find zj0k0i∈Z such that zj0k0izjhkli∈inω(QuadB). It follows that Z is maximally independent modulo inω(⟨LiftF∪LiftG∪QuadB⟩). Since|Z|=∑i∈I1∩I2(ni+mi-1),

inequality (5) is proved. For the final statement, observe that since I is prime, we have dimI=∑i∈I1ni, and since J is prime, we have dimJ=∑i∈I2mi. If I1=I2=[r] then we get|Z|=∑i=1r(ni+mi-1)=∑i=1rni+∑i=1rmi-r=dimI+dimJ-|A|.

Now since I×AJ is prime, its dimension is equal to the size of any subset that is maximally independent modulo inω(⟨LiftF∪LiftG∪QuadB⟩). □

Fig. 2 Grid representing the generators zjki for a fixed i∈[r]. Columns shaded grey give monomials coming from the lift of the maximally independent set modulo inω1(I), and rows shaded grey give monomials coming from the lift of the maximally independent set modulo inω2(J). Cells shaded black represent the elements of the set Z of degree ai

Remark 2

Observe that if both I and J are prime ideals and there exist maximally independent sets with I1=I2=[r], then it is clear from the proof that I×AJ is also a prime ideal and there exists a maximally independent set modulo inω(I×AJ) in {zjki|i∈[r],j∈[si],k∈[ti]} with at least one element for each upper index i∈[r].

For the remainder of this section we will apply our results on toric fiber products to level-1 phylogenetic networks. Fix a group-based model (G, B), and let N be a level-1 phylogenetic network with a (directed) cut edge e. Then the operation of cutting N at e results in two smaller level-1 networks, that we denote N+ and N-. We denote by e the new edge in both N+ and N-, and this edge inherits the direction from N. We assume that the network N+ contains the leaves labelled 1,…,n′ for some n′<n, which are also leaves of N, and the new leaf, which we denote by ne. Then N- contains the leaves labelled n′+1,⋯,n, and the new leaf which we also denote by ne.

The vanishing ideal IN+ is contained in the polynomial ring R+=C[qg1⋯gn′gne+|g1+⋯+gn′+gne=0], and IN- is contained in R-=C[qgnegn′+1⋯gn-|gne+gn′+1+⋯+gn=0]. We give each polynomial ring the grading induced by deg(qg1⋯gN)=E[ξ(e)]∈Z≥0|B·G|, where ξ is the consistent edge labelling induced by the consistent leaf labelling g1,…,gN, and {E[g]|[g]∈B·G} is the standard basis of Z≥0|B·G|. Note that the set A consisting of the image under deg of the generators of R+ and R- is given by the linearly independent set {E[g]|[g]∈B·G}, and each element of this set is the image under deg of a generator of both R+ and R-. We assume that the edge e in N is directed towards N+ so that ξ(e)=g1+⋯+gn′ and therefore deg(qg1⋯gn)=E[g1+⋯+gn′].

We have a natural C-algebra homomorphism6 R→R+⊗CR-qg1⋯gn↦qg1⋯gn′g++⊗qg-gn′+1⋯gn-,

where g+=-(g1+⋯+gn′) and g-=-(gn′+1+⋯+gn). Note that deg(qg1⋯gn′g++)=E[g1+⋯+gn′] and deg(qg-gn′+1⋯gn-)=E[-(gn′+1+⋯+gn)]=E[g1+⋯+gn′]. As in the proof of (Cummings et al (2021), Proposition 3.2), the network parameterisation map ϕN factors through (6), so IN is the toric fiber product IN+×AIN-.

Example 2

We will consider the 2-state Cavender-Farris-Neyman model, for which G=Z/2Z, on the phylogenetic network N depicted in Figure 3. The corresponding ideal IN is contained in the polynomial ring R=C[qg1g2g3g4g5g6|g1+g2+g3+g4+g5+g6=0]. Cutting at the non-trivial cut edge e results in a 4 sunlet and a 4-leaf tree. Let N+ be the 4-sunlet, and N- be the 4-leaf tree. LetIN+⊂R+=C[qg1g2g3g4+|g1+g2+g3+g4=0]

and letIN-⊂R-=C[qg1g2g3g4-|g1+g2+g3+g4=0]

be the corresponding ideals. We give R+ the grading induced by deg(qg1g2g3g4+)=Eg4∈Z2=ZE0+ZE1, so that the degree E0 generators are q0000+,q1100+,q1010+, and q0110+, and the degree E1 generators are q0011+,q0101+,q1001+, and q1111+. We give R- the grading induced by deg(qg1g2g3g4-)=Eg1. In this case the degree E0 generators are q0000-,q0011-,q0101-, and q0110-, and the degree E1 generators are q1001-,q1010-,q1100-, and q1111-.Fig. 3 a A level-1 phylogenetic network N. b The phylogenetic networks N- and N+ obtained by cutting N at e (right). The toric fiber product of IN- and IN+ corresponds to gluing N- and N+ along the edge labelled e

The multigrading in R is given by deg(qg1g2g3g4g5g6)=Eg1+g2+g3 and the map ϕB is given byϕB:R→C[qg1g2g3g4+,qh1h2h3h4-|g1+g2+g3+g4=h1+h2+h3+h4=0]ϕB:qg1g2g3g4g5g6↦qg1g2g3g++qg-g4g5g6-,

where g+=g-=g1+g2+g3 and deg(qg1g2g3g+)=deg(qg-g4g5g6)=Eg1+g2+g3. As described above, IN is given by the toric fiber product IN+×AIN-, where A is given by {E0,E1}.

First we describe QuadB.Using that ⟨QuadB⟩=kerϕB we see that QuadB consists of all elements of the formqg1g2g3g4g5g6qh1h2h3h4h5h6-qg1g2g3h4h5h6qh1h2h3g4g5g6,

for generators qg1g2g3g4g5g6 and qh1h2h3h4h5h6 satisfying deg(qg1g2g3g4g5g6)=deg(qh1h2h3h4h5h6). Note that this condition guarantees that (g1,g2,g3,h4,h5,h6) and (h1,h2,h3,g4,g5,g6) are consistent leaf-labellings.

Next we consider lifts. For the generator q0000+ we lift by elements of degree E0 in R-. Thus we haveLiftq0000+={q000000,q0000011,q000101,q000110}.

Similarly, for the generator q0000- we haveLiftq0000-={q000000,q011000,q101000,q110000}.

Observe that, for example, ϕB(q0000011)=q0000+q0011- and ϕB(q101000)=q1010+q0000-. Note also that the generator q000000 can be obtained from lifting both q0000+ and q0000-.

The ideal IN+ is generated by the set F (consisting of a single quadratic), and the ideal IN- is generated by the set G. We give R+, and R- the monomial ordering qg1g2g3g4<qh1h2h3h4 if and only if (g1,g2,g3.g4)<(h1,h2,h3,,h4) with respect to lexicographic ordering and with 0<1 in Z/2Z. Then, with respect to lexicographic ordering on R+ and R-, F and G are Gröbner bases.F={f=q0000+q1111+-q1100+q0011++q1010+q0101+-q0110+q1001+},G={g1=q1010-q1100--q1001-q1111-,g2=q0110-q1100--q0101-q1010-,g3=q0011-q1100--q0000-q1111-,g4=q0110-q1001--q0101-q1010-,g5=q0011-q1001--q0000-q1010-,g6=q0011-q0101--q0000-q0110-}.

Observe that in all cases, each polynomial is homogeneous in the grading. We give an example lift for f and for g1. The degree of f is E0+E1. For k corresponding to the pair (q0011-,q1010-) we havefk=q000011q111010-q110011q001010+q101011q010010-q011011q100010.

The polynomial g1 has degree 2E1. For k corresponding to the pair (q0011+,q1001+) we have(g1)k=q001010q100100-q001001q100111.

Finally, LiftF is given by all possible lifts fk, and LiftG is given by all possible lifts (gi)k for i=1,…,6. Then the ideal IN is generated by the elements of LiftF, LiftG, and QuadB.

Corollary 10

Fix a group-based model (G, B). Let N be a level-1 phylogenetic network with a cut edge e, and let N+ and N- be the networks obtained by cutting N at e. Then dimVN(G,B)=dimV+(G,B)+dimV-(G,B)-|B·G|.

Proof

As described above, the ideal IN is the toric fiber product IN+×AIN-, so we apply Theorem 9. Both IN+ and IN- are prime ideals, so to prove the result, it is sufficient to show that for a phylogenetic network ideal I there exists a weight vector ω and a set U⊂{qg1⋯gn|g1+⋯+gn=0} that is independent modulo inω(I) and that contains at least one element of degree ai for each ai∈A. From Remark 2, we need only consider phylogenetic networks that are either sunlet networks or trees. Furthermore, if N is a sunlet network and T is a tree obtained from N be removing a reticulation edge, then IN⊂IT. It follows that if U is independent modulo inω(IT) then U is also independent modulo inω(IN), so in fact it is sufficient to show the result for any phylogenetic tree T.

To show the result for a tree T, we make the further observation that if T has an internal edge e, then T is a toric fiber product of the two trees given by cutting T at e. Thus in view of Remark 2 again, we need only consider claw trees. Since we are only considering binary phylogenetic trees, we need only consider the 3-claw tree T3.

Fix a set of representatives G⊂G of the B-orbits in G, let T=T3, let I=IT, and let the set of multidegrees be given by A={Eg|g∈G}. Note that 0∈G and that [0]={0}. We may assume, without loss of generality, that deg(qg′hk)=Eg, where g′∈[g] for some g∈G. Recall that I is given by the kernel of the map ψT whereψT:C[qghk|g+h+k=0]⟶C[ai[g]|g∈G,i=1,2,3]qghk⟼a1[g]a2[h]a3[k].

Let U={qg0(-g)|g∈G}. It is clear that U has exactly one element of each multidegree. Next, choose a term order on C[qghk|g+h+k=0] such that qghk<qg′h′k′ whenever g∈G and g′∉G, and let ω be a a weight vector whose induced term order satisfies this. We claim that C[U]∩inω(I)={0}.

To prove the claim, we will show that for any element f∈I, we have that inω(f) does not consist of a product of elements of U. Since I is homogeneous and generated by binomials, we may assume that f is a homogeneous binomial. Let G′⊆G with |G′|=n and suppose that we can writef=∏g∈G′qg0(-g)-m

for some other monomial m of total degree n. Since f∈kerψT we must have thatψT(m)=ψT(∏g∈G′qg0(-g))=(∏g∈G′a1[g])(∏g∈G′a3[-g])(a2[0])n.

Now if qg′h′k′ is a factor of m then we must have ψT(qg′h′k′)=a1[g]a2[0]a3[k] for some g,k∈G. Thus, h′∈[0] so h′=0 and g′∈[g], and since g′+0+k′=0 we must have k′=-g′. Now if g′=g then qg′h′k′=qg0(-g) appears as a factor in the first monomial of f. If this holds for all factors of m then we have f=0. If not, then for some factor qg′0(-g′) we must have g′∉G, so we have inω(f)=m. □

Remark 3

Notice that in the proof of Corollary 10, we made no assumptions on the number of reticulation vertices of N. Since a binary phylogenetic tree can be thought of as a phylogenetic network with no reticulation vertices, the result also holds for binary phylogenetic trees. Explicitly, we have that if T is a binary phylogenetic tree with an interior edge e, with trees T+ and T- obtained by cutting e, then we havedimVT(G,B)=dimV+(G,B)+dimV-(G,B)-|B·G|.

Sunlet Networks and Trees

If N is a level-1 phylogenetic network, then N can be decomposed along cut edges into a series of phylogenetic trees and sunlet networks. As shown in the previous section, the ideal structure of the corresponding varieties is given by the toric fiber product. It therefore remains for us give dimension results for the varieties corresponding to trees and sunlet networks. For an unrooted phylogenetic tree T, the dimension of the variety VT(G,B) is well known. We give a proof using the dimension result of the previous section.

Lemma 11

If T is a binary phylogenetic tree with m edges and no degree-2 vertices under a group-based evolutionary model (G, B), then the affine dimension of VT(G,B) is given bydimVT(G,B)=lm+1.

Proof

Denote by t the number of interior edges of T. If t=0 then T is the 3-claw tree. This has dimension 3l+1 by (Baños et al (2019), Proposition 5.2), so the proposition is true in this case. Now suppose T is a binary phylogenetic tree with m edges and t>0 interior edges. Let e be an interior edge and let T+ and T- be the trees obtained by cutting at e. If m+ and m- are the number of edges of T+ and T- respectively, we have m=m++m--1. Furthermore, the number of interior edges of T+ and of T- is less than t, so by induction we have dimV+(G,B)=lm++1 and dimV-(G,B)=lm-+1. It follows from Remark 3 thatdimVT(G,B)=(lm++1)+(lm-+1)-(l+1)=lm+1.

□

Observe that one could extend the above proof to give the analogous dimension result for any phylogenetic tree with no degree 2 vertices. To do so, the base-case for the induction must be extended to cover all claw trees Tn with n≥3. That is, one must show that for each Tn with corresponding ideal In, there exists a maximal independent set modulo inω(In) that contains at least one element of multidegree ai for each ai∈A, as in the proof of Corollary 10.

The remainder of this section is dedicated to giving the dimension of the varieties corresponding to sunlet networks. As we have already seen, the variety associated to a phylogenetic network N is equal to the variety associated to the corresponding contracted semi-directed phylogenetic network, so from this point onwards we will only consider contracted semi-directed phylogenetic networks. First we will give an upper bound on the dimension.

Proposition 12

If N is a contracted semi-directed phylogenetic network with only disjoint cycles and with m edges thendimVNG≤lm+1.

Proof

Let c denote the number of cycles in N. The affine variety VNG is parameterized by (l+1)m parameters, but the map is multihomogeneous. It is linear in the set of parameters for each non-reticulation edge, and in the union of the parameters for the two reticulation edges of each cycle. Thus we may think of the parameterization map as a projective mapPl×⋯×Pl×P2l+1×⋯×P2l+1⤏Pn-1,

where Pl appears m-2c times (once for each non-reticulation edge), and P2l+1 appears c times (once for each cycle). We use a dashed arrow to indicate that in order for the map to be well-defined we may need to take a subset of the domain. It follows that VNG has projective dimension at most lm+c, and thus its affine dimension is at most lm+c+1.

Now consider v=ϕN(w)∈Cn-1, where w∈Cm(l+1). For each pair of reticulation edges e1,e2, a consistent leaf labelling of N assigns both edges the same label. For each consistent leaf labelling of N in which they are labelled 0, the edges along the cycle all receive the same labels in both trees, so the coordinate of v corresponding to the consistent leaf labelling has a factor of we10+we20. For every consistent leaf labelling in which they are not labelled 0, the coordinate does not depend on we10 or we20. Therefore the map depends only on the sum we10+we20. This reduces the number of independent parameters by c, so the affine dimension of VNG is at most lm+1. □

General Group-Based Models

First, we restrict our attention to sunlet networks under general group-based models of evolution, i.e., those where the group B consists only of the identity automorphism. We will deal with the case G=Z/2Z separately.

Proposition 13

Let N be the n-sunlet network with n≥4 and let G be an abelian group with |G|=l+1>2. ThendimVNG=l(2n-1)+1.

Proof

Using Lemma 4, we may replace N by its contraction. This network has m=2n-1 edges, so by Proposition 12 we have dimVNG≤l(2n-1)+1.

Label the edges and vertices as in Fig. 4, and let T1 and T2 be the two trees got by removing the edges en+1 and e1 respectively. The parameterization map for N is given by7 qg1g2⋯gn=a22⋯ann(a11an+2g1+g2⋯a2n-1n+an+11an+22⋯a2n-1g1+gn),

where g1,…,gn is a consistent leaf labelling, the first monomial corresponds to T1, and the second monomial corresponds to T2. With notation as in Sect. 2.3, our aim will be to find λ that maximises rankRAλ, which by Lemma 6 gives a lower bound on dimVNG.Fig. 4 A contracted n-sunlet network with n≥4. Arrows indicate the orientation used for assigning a consistent edge labelling from a consistent leaf labelling

Let {Eig|g∈G,i=1,…,2n-1} be the standard basis of Rm(l+1), indexed by the edges of N and elements of G, and consider the dual vector space V=(Rm(l+1))∗ with the dual basis. Choose λ∈V such that λn+20=-2, λn+1g=1 for all g∈G, and all other entries are 0. Let g1,…,gn be a consistent leaf labelling of N. Then the corresponding column of Aλ has the following properties:If g1=0, then the monomial from T1 is chosen.

If g1≠0 and g2=0, then the monomial from T2 is chosen.

In all other cases the monomial from T1 is chosen.

We will show that rankAλ≥l(2n-1)+1 to give the lower bound.

Consider the submatrix given by consistent leaf labellings where g1=0, so that each column is an exponent vector coming from a monomial in T1. Perform column operations on Aλ so that the first (l+1)n-2 columns are given by this submatrix. Let S be the tree with n-1 leaves obtained from N by deleting the reticulation vertex. The consistent leaf labellings of N in which g1=0 give all of the consistent leaf labellings of S. Since S is a phylogenetic tree, its corresponding variety VSG is toric, and therefore the rank of its corresponding matrix A is equal to the dimension of the variety. By Lemma 11, the variety VSG has dimension l(2n-5)+1, so the submatrix of Aλ consisting only of the columns where g1=0 has rank l(2n-5)+1 (note that since S has a monomial parameterization, for all choices of λ we have that this submatrix is the same).

We make the following observations about this submatrix. First, since the monomial from T1 is always chosen, the entries corresponding to the parameters an+1g are 0 for all g∈G. Similarly, for the edge e1, only the parameter a10 appears in the parameterization of qg1g2⋯gn, so the entries corresponding to the parameters a1g are 0 for all g∈G except g=0. Next, observe that in this submatrix, the row corresponding to the parameter a2g is equal to the row corresponding to the parameter an+2g for all g∈G and similarly the row corresponding to the parameter ang is equal to the row corresponding to the parameter a2n-1g for all g∈G. This is because the label of e.g. the edge en+2 is g1+g2=0+g2=g2, which is also the label of the edge e2. We perform row operations on Aλ so that for each g∈G, the first (l+1)n-2 entries of the rows corresponding to the parameters a2g and ang are zero, by subtracting the rows an+2g and a2n-1g respectively. Now we perform further row operations to swap rows and obtain a matrix of the following form, where the upper left block is a (4l+3)×(l+1)n-2 matrix consisting of zeros,Aλ=0BAλ′∗,

and rankAλ′=l(2n-5)+1. It follows that rankAλ≥l(2n-5)+1+rankB, so it is sufficient to show that rankB≥4l.

The columns of B correspond to consistent leaf labellings g1,…,gn with g1≠0. Recall that λ was such that if g2=0 then the monomial from T2 is chosen, and otherwise the monomial from T1 is chosen. The rows of B correspond to the parameters a1g for g≠0, and an+1g,a2g, and ang for all g∈G. However, we performed row operations on the rows corresponding to a2g and ang, so for each column of B the coefficient of the standard basis vector E2g is given by the exponent of a2g minus the exponent of an+2g, and the coefficient of Eng is given by the exponent of ang minus the exponent of a2n-1g in the corresponding monomial from the parameterization (7). Thus the columns of B are given by8 (Enn-Eng1+gn)+En+11,

if g2=0 (so the monomial comes from T2), and9 (E22-E2g1+g2)+E11,

otherwise (so the monomial comes from T1), where g1,…,gn is a consistent leaf labelling with g1≠0. Note that since n≥4, we can find a consistent leaf labelling g1,…,gn for any choice of g1, g2, gn. Denote by X1 the vector space spanned by all the vectors of the form in equation (8). We have∑g∈G((Eng-Eng1+g)+En+11)=(l+1)En+11∈X1,

so En+11∈X1 for all g1≠0. It follows immediately that for a fixed gn∈G, we have Enn-Eng1+gn∈X1 for all g1≠0, and thus dimX1≥2l.

Next denote by X2 the vector space spanned by all the vectors of the form in equation (9). Using that ∑g∈GE2g-E2g1+g=0, we see that∑g∈G\{0}((E2g-E2g1+g)+E11)=lE11+E21-E20∈X2,

for each g1≠0. Now fix g∈G\{0} and let g2=g, and g1=-g, so that E1-g+E2g-E20∈X2. Then we have(lE1g+E2g-E20)-(E1-g+E2g-E20)=lE1g-E1-g∈X2.

Now if g=-g then we have E1g∈X2. If not, by swapping g1 and g2 we have lE1-g-E1g∈X2, so (l-1)E1g-(l-1)E1-g∈X2. Then lE1g-lE1-g∈X2, and subtracting lE1-g-E1g gives E1g∈X2, for all g∈G\{0}. As before, it follows that for a fixed g2 we have E22-E2g1+g2∈X2 for all g1∈G\{0}, so dimX2≥2l. It follows that rankB≥4l. □

We expect the result to hold for the case n=3 once the size of G is large enough, and this is explored in a forthcoming paper. Here, the proof of Proposition 13 breaks down in this case because, when finding the rank of B, we we have only l+1 columns when g2=0, since in this case g1=-gn. Thus the dimension of X1 is strictly less than 2l.

Next we deal with the case G=Z/2Z. The expected dimension for n-sunlets here is 2n. However, if n=3 then we only have 4<2n consistent leaf labellings of N, so in this case the expected dimension cannot be reached. When n=4 we have 8=2n consistent leaf labellings, however, in this case dimVNG=7. This can be shown by direct computation.

Proposition 14

Let N be the n-sunlet network with n≥5 and let G=Z/2Z. ThendimVNG=2n.

Proof

As before, Proposition 12 gives the upper bound. Label the edges and vertices as in Fig. 5, and let T1 and T2 be the two trees got by removing the edges en+1 and e1 respectively. Observe that we have at least one edge on the cycle, e.g. en+3, that is not adjacent to either reticulation edge. We proceed as in Proposition 13, this time choosing λ∈R2m such that λn+10=λn+11=1, λn+30=2. and all other entries are 0. Let g1,…,gn be a consistent leaf labelling of N. Then the corresponding column of Aλ has the following properties:If g1=0, then the monomial from T1 is chosen.

If g1=1 and g2+g3=1, then the monomial from T2 is chosen.

If g1=1 and g2+g3=0, then monomial from T1 is chosen.

Fig. 5 A contracted n-sunlet network with n≥5. Arrows indicate the orientation used for assigning a consistent edge labelling from a consistent leaf labelling

As in the proof of Proposition 13, we perform column operations so that the first 2n-2 columns are indexed by consistent leaf labellings where g1=0, and each column is an exponent vector coming from the corresponding T1 monomial. The submatrix consisting of these columns has rank 2n-4, and we perform the same row operations as before to give the block triangular matrixAλ=0BAλ′∗,

where the submatrix B is given by rows corresponding to the parameters a11,a20,a21, an0,an1,an+10, and an+11. However, we performed row operations on the rows corresponding to a2g and ang, so for each column of B the coefficient of E2g is given be the exponent of a2g minus the exponent of an+2g, and the coefficient of Eng is given by the exponent of ang minus the exponent of a2n-1g for g=0,1. Consider the following columns of B. For a consistent leaf labelling with g1=gn=1 and g2=g3=0, the monomial from T1 is chosen, so the labels assigned to an and a2n-1 are equal, and the labels assigned to a2 and an+2 are not equal. Thus the column is given byE11+E20-E21.

Next for a consistent leaf labelling with g1=g2=g3=gn=1, the monomial from T1 is chosen so the column is given byE11-E20+E21.

For g1=g3=1 and g2=gn=0, the monomial from T2 is chosen so the column is given byEn+11+En0-En1.

Finally, for a consistent leaf labelling with g1=g3=gn=1 and g2=0, the monomial from T2 is chosen so the column is given byEn+11-En0+En1.

These vectors are linearly independent, so rankB≥4 and the result follows. □

Observe that in the case n=4, the vector En+11-En0+En1, is not obtained, since there is no consistent leaf-labelling with g1=g2=g4=1 and g2=0. In this case B has four columns, corresponding to the consistent leaf labellings when g1=1. The two columns assigned to T2 correspond to (1, 0, 1, 0) and (1, 1, 0, 0). The reader can check that in both cases the column vector is E51. The two columns assigned to T1 remain linearly independent, so in this case rankB=3.

Group-Based Models

In this section, we use our results on general group-based models to obtain the result for all group-based models, following the method of (Baños et al (2019), Lemma 4.2). Throughout, let N be the contracted n-sunlet network, so the number of edges m is equal to 2n-1. Let G be a finite abelian group, and let B be a subgroup of the automorphism group Aut(G) with |B·G|=l+1. Let (R|G|m)∗ have standard basis elements εeg where g∈G and e∈E(N). Next, pick representatives g0=0,g1,…,gl in G for each B-orbit, and let (R(l+1)m)∗ have standard basis elements εe[gi] for i=0,…,l and e∈E(N).

Let p:(R|G|m)∗⟶(R(l+1)m)∗ be the map that sums coefficients of the unit vectors for each orbit, i.e.∑e∈E(N)∑g∈Gcegεeg⟼∑e∈E(N)∑i=0l(∑g∈[gi]ceg)εe[gi],

where ceg∈R. It is clear that p is a surjective, linear map, so dimkerp=(|G|-l-1)m. Now consider the parameterizations of VNG and VN(G,B). For a fixed consistent leaf labelling ξ, let α1 and α2 be the exponent vectors of the monomials corresponding to T1 and T2 respectively, in the parameterization of VNG. Similarly let α1′ and α2′ be the corresponding monomials in the parameterization of VN(G,B). Then p(αi)=αi′ for i=1,2. Furthermore, observe that if λ∈R|G|m is such that λeg=λeh whenever g and h are in the same B orbit for all edges e∈E(N), then there exists λ′∈R(l+1)m satisfying λ=λ′∘p (where we are considering λ′ as an element of the dual space of (R(l+1)m)∗).

Proposition 15

With the notation as above, let λ∈R|G|m be such that λeg=λeh whenever g and h are in the same B-orbit, for all e∈EN. Then there exists λ′∈R(l+1)m such thatp∘Aλ=Aλ′.

Proof

First observe that for any α∈(R|G|m)∗ we have⟨λ,α⟩=λ(α)=λ′∘p(α)=⟨λ′,p(α)⟩.

Now consider the polynomials of the parameterizations of VNG and VN(G,B), for a consistent leaf labelling ξ. Let α1 and α2 be as above, and suppose that ⟨λ,α1⟩<⟨λ,α2⟩. Then ⟨λ′,p(α1)⟩<⟨λ′,p(α2)⟩, so both λ and λ′ pick the monomial corresponding to T1. Since α1′=p(α1), the result follows. □

Note that Proposition 15 is easily generalizable to level-1 phylogenetic networks.

Corollary 16

Let N be the n-sunlet network with n≥4, let G be a finite abelian group, and let B be a non-trivial subgroup of the automorphism group Aut(G), with |B·G|=l+1. ThendimVN(G,B)=l(2n-1)+1.

Proof

As in the case for general group-based models, the upper bound is given by Proposition 12. For the lower bound, first observe that since B is a non-trivial subgroup, we must have |G|>2. Next observe that the vector λ chosen in the proof of Proposition 13 satisfies the condition in Proposition 15, so using Proposition 15 (and Lemma 6) there exists some λ′ such thatdimVN(G,B)≥rankRAλ′=rankR(p∘Aλ′).

Finally, since p is a surjective linear map with kernel of dimension (|G|-l-1)m, we haverankRAλ′≥(|G|-1)m+1-(|G|-l-1)m=lm+1.

□

We summarise our results on sunlet networks in a single theorem. Note that the final two cases are given by direct computation.

Theorem 17

Let N be a sunlet network with n leaves. Let G be a finite abelian group and let B be a subgroup of Aut(G). Denote by l+1 the number of B-orbits in G. Then dimVN(G,B) is given in the following cases.If n≥4 and |G|>2 then dimVN(G,B)=l(2n-1)+1.

If n≥5 and G=Z/2Z so that B={id} then dimVNZ/2Z=2n.

If n=4 then dimVNZ/2Z=7.

If n=3 then dimVNZ/2Z=4.

□

Proof of Theorems 1 and 2

We are now able to give simple inductive proofs of Theorems 1 and 2. Below we give only the proof of Theorem 1. The proof of Theorem  2 is almost identical, and is left to the reader with the aid of Table 1.

Proof of Theorem 1

We will prove the result using induction on the number of non-trivial cut edges of a level-1, triangle-free phylogenetic network N. For the case when there are no non-trivial cut edges, we must have that N is either the 3-claw tree, in which case the dimension of VN(G,B) is equal to lm+1 by Lemma 11, or N is an n-sunlet network with n≥4, in which case the dimension is l(2n-1)+1 by Theorem 17. In both cases the result holds.

Now suppose that N is a level-1, triangle-free phylogenetic network with a non-trivial cut edge e, and m edges and c cycles. Let N1 and N2 be the networks obtained by cutting at e, and let mi and ci denote the number of edges and cycles in Ni respectively for i=1,2. Since the number of non-trivial cut edges in N1 and N2 must be fewer than the number of non-trivial cut edges in N, by induction we have dimVNi(G,B)=l(mi-ci)+1 for i=1,2. By Corollary 10 we havedimVN(G,B)=dimVN1(G,B)+dimVN2(G,B)-(l+1)=l(m1+m2-c1-c2)+2-(l+1)=l(m-c)+1,

where m1+m2=m+1 and c1+c2=c. □

Application to Identifiability

In this section we apply Theorems 1 and 2 to give some immediate identifiability results. Throughout, fix an abelian group G and subgroup B of Aut(G), and let l+1 be the number of orbits in B·G. First, we extend the definition of distinguishibility from Gross and Long (2018) to all group-based models of evolution

Definition 3

Let (G, B) be a group-based model of evolution. Two distinct n-leaf networks N1 and N2 are distinguishable over (G, B) if VN1(G,B)⊈VN2(G,B) and VN2(G,B)⊈VN1(G,B).

When G and B are clear, we will simply say that N1 and N2 are distinguishable. Observe that if VN1(G,B) and VN2(G,B) are irreducible varieties of equal dimension, then in order to determine whether N1 and N2 are distinguishable it is sufficient to show that either VN1(G,B)⊈VN2(G,B) or VN2(G,B)⊈VN1(G,B). One of the key results we will use to show identifiability is the following.

Lemma 18

(Gross et al (2021) Lemma 3) Let N1 and N2 be n-leaf networks. If for some A⊆[n], we have that VN1|A(G,B)⊈VN2|A(G,B), then V1(G,B)⊈V2(G,B).

Corollary 19

Let N1 and N2 be n-leaf networks with dimV1(G,B)=dimV2(G,B). If for some A⊆[n] we have VN1|A(G,B)⊈VN2|A(G,B), then N1 and N2 are distinguishable over (G, B).

Proof

By Lemma 18, V1(G,B)⊈V2(G,B). Since they are irreducible varieties of the same dimension, they are distinguishable. □

We will use Corollary 19 in conjunction with the following dimension results.

Lemma 20

Let N1 and N2 be n-leaf, level-1 phylogenetic networks, both with exactly c cycles, where each cycle has length at least 4 when |G|>2 and at least 5 when G=Z/2Z. Then dimV1(G,B)=dimV2(G,B).

Proof

Observe that N1 and N2 have the same number of edges. To see this, suppose that N1 and N2 have m1 and m2 edges respectively. Then the corresponding contracted networks N1′ and N2′ have m1-c and m2-c edges, since for each reticulation vertex the outgoing edge is removed. Next for each of the c reticulation vertices v1,…,vc in N1′ arbitrarily pick a reticulation edge (ui,vi) and remove it. After removal, the vertex ui has degree 2 and can be suppressed. The result is an unrooted binary phylogenetic tree on n leaves with m1-3c edges. Performing the same operations on N2′ we also obtain a (possibly different) unrooted binary phylogenetic tree on n leaves with m2-3c edges. Since all unrooted binary phylogenetic trees on n leaves have 2n-3 edges, we have that m1=m2. Now since both N1 and N2 have exactly c cycles, the result follows from Theorems 1 and 2. □

Remark 4

From the proof of Lemma 20 it is clear that the number of edges of an unrooted level-1 phylogenetic network on n leaves with c cycles is 2n-3+3c

For the remaining results in this section we will need to use the fact that binary phylogenetic trees with group-based models of evolution are distinguishable. This result is well-known in the algebraic phylogenetics community, but we give a direct proof here for completeness.

Lemma 21

Let (G, B) be a group-based model of evolution, and let T1 and T2 be two distinct n-leaf, unrooted, binary phylogenetic trees. Then T1 and T2 are distinguishable over (G, B).

Proof

First observe that since T1 and T2 are determined by their quartets, there exists a subset A⊂[n] with |A|=4 such that T1 restricted to A and T2 restricted to A are distinct four-leaf, binary phylogenetic trees. By Corollary 19, it is sufficient to show that VT1|A(G,B)⊈VT2|A(G,B). Since the dimensions of these varieties are equal (Lemma 11), this is equivalent to the restricted trees being distinguishable.

We will show that the four leaf binary phylogenetic trees are distinguishable. Let T be the four-leaf tree with split 12|34, and the corresponding interior edge denoted e5. Pick g,h∈G such that h∉[g] and consider the polynomial f=qgqh-qg′qh′ where g=(g,-g,g,-g),h=(h,-h,h,-h),g′=(g,-g,h,-h), and h′=(h,-h,g,-g). We haveψT(f)=a1ga1ha2-ga2-ha3ga3ha4-ga4-ha50a50-a1ga1ha2-ga2-ha3ha3ga4-ha4-ga50a50=0,

so that f∈ker(ψT)=IT(G,B). On the other hand, by looking at the parameters corresponding to the interior edge, the reader can check that f does not belong to the ideals corresponding to the trees with splits 13|24 and 14|23 respectively.

In a similar manner one can find polynomials belonging only to the ideal of the tree with split 13|24 and only to the ideal of the tree with the split 14|23. It follows that the four leaf binary phylogenetic trees are distinguishable. □

Proposition 22

Let N1 and N2 be two distinct n-sunlet networks with n≥5 and distinct leaves adjacent to the reticulation vertex. Then N1 and N2 are distinguishable over (G, B).

Proof

By Theorem 17 we have that dimVN1(G,B)=dimVN2(G,B). Assume, without loss of generality, that for N1 the leaf adjacent to the reticulation vertex is leaf 1. Let A={2,…,n}, so that N1|A is a caterpillar tree on n-1 leaves and N2|A is an (n-1)-sunlet network. ThendimVN1|A(G,B)=l(2n-5)+1<l(2n-3)+1=dimVN2|A(G,B),

and so VN2|A(G,B)⊈VN1|A(G,B). By Corollary 19, N1 and N2 are distinguishable. □

Proposition 23

Let N1 and N2 be two distinct n-sunlet networks with n≥4 such that the leaf adjacent to the reticulation vertex is the same for both networks, and the trees obtained from each network by removing the reticulation vertex and adjacent leaf are distinct. Then N1 and N2 are distinguishable over (G, B).

Proof

Assume that N1 and N2 both have leaf 1 adjacent to the reticulation vertex. Let A={2,…,n} so that by assumption N1|A and N2|A are distinct caterpillar trees with n-1 leaves. Since these are distinguishable (Lemma 21), the result follows from Corollary 19. □

Observe that Propositions 22 and 23 are not sufficient to give identifiability for all sunlet networks. For example, take an n sunlet with leaves labelled in ascending order clockwise around the sunlet with 1 at the reticulation. Then obtain a distinct sunlet by swapping leaves 2 and 3. The caterpillar trees obtained from both of these sunlets by restricting to {2,…,n} are the same, so neither Proposition 22 nor Proposition 23 applies.

More generally we can give the following identifiability result for triangle-free, level-1 phylogenetic networks. The result relies on the existence of a subset A of the leaf set with particular properties.

Proposition 24

Let N1 and N2 be two triangle-free, level-1 phylogenetic networks on n leaves and both with exactly c cycles, and let G be an abelian group with |G|>2. If there exists a subset A⊂[n] such that either N1|A and N2|A are triangle-free level-1 phylogenetic networks with distinct number of cycles, or

N1|A is a tree and N2|A is a triangle-free level-1 phylogenetic network, or

N1|A and N2|A are distinct trees,

then N1 and N2 are distinguishable over (G, B).

Proof

First observe that dimV1(G,B)=dimV2(G,B) by Lemma 20. Let N1|A and N2|A have m1 and m2 edges respectively, and c1 and c2 cycles respectively.

For case 1, assume without loss of generality that c1<c2. Then by Remark 4 we have that m1=2|A|-1+3c1 and m2=2|A|-1+3c2. In particular, m1-c1<m2-c2. Then by Theorem 1 we have thatdimVN1|A(G,B)=l(m1-c1)+1<l(m2-c2)+1=dimVN2|A(G,B).

It follows that VN2|A(G,B)⊈VN1|A(G,B). For case 2 let us assume that N1|A is a tree and N2|A is a triangle-free level-1 phylogenetic network. Then dimVN1|A(G,B)<dimVN2|A(G,B) so as above VN2|A(G,B)⊈VN1|A(G,B). For case 3 we have that VN1|A(G,B)⊈VN2|A(G,B) and VN2|A(G,B)⊈VN1|A(G,B) by Lemma 21. In all three cases the result now follows by Corollary 19. □

Discussion

In this paper we have given a dimension formula for all triangle-free, level-1 phylogenetic networks under a group-based model of evolution. Our main tool was the toric fiber product, for which we gave a dimension formula that we hope will be useful beyond this work.

Our results confirmed a conjecture of Gross and Long which states that under the JC model of evolution, the dimensions of large cycle networks (that is, level-1 phylogenetic networks with a single cycle of length at least 4) are equal (Gross and Long 2018, Conjecture 5.1). In fact, as we have shown, this is true for all group-based models and level-1 phylogenetic networks where the number of cycles is equal. We were also able to give partial identifiability results for sunlet networks and larger level-1 networks that followed immediately from our results on dimension.

We were unable to give a general dimension result for 3-sunlets. For this case, our upper bound (Proposition 12) still holds, but our proof for the lower bound does not work. This is because with the λ we have chosen, when n=3 we have only l columns in the matrix Aλ coming from T2, whilst the rest come from T1. Thus the maximum rank of Aλ is dimVT1(G,B)+l=(2n-2)l+1, and this is too small. Nonetheless, we believe the result still holds, and we make the following conjecture.

Conjecture 25

If N is the 3-sunlet network and |G|>4 thendimVNG=lm+1.

Our conjecture is backed up by calculations of the dimension VN(G,B) for small sunlet networks and small groups. The deficiencies (i.e., the number of dimensions less than the expected dimension l(2n-1)+1) are shown in Table 1.Table 1 Values for the deficiency of dimVN(G,B), where N is an n-sunlet

n	Z/2Z	Z/3Z	JC	K2P	(Z/2Z)2	Z/4Z	Z/5Z	Z/6Z	Z/7Z	
3	2	2	1	1	1	0	0	0	0	
4	1	0	0	0	0	0	0	0	0	
5	0	0	0	0	0	0	0	0	0	
6	0	0	0	0	0	0	0	0	0	

Bold values in Table 1 indicate that the variety fills the whole space Cn-1, and this has dimension less than the expected dimension. Note that for the JC and K2P models we have binomial linear invariants, and it is customary to identify these and reduce the dimension of the ambient space. From Table 1, it appears that we only have two cases where the dimension of VN(G,B) is less than expected for unknown reasons. These are when G=Z/2Z and n=4, and when G=Z/2Z×Z/2Z and n=3. The latter case has implications for models of DNA sequence evolution, since the group G=Z/2Z×Z/2Z is usually identified with the four nucleic acids, and the corresponding general group-based model of evolution is the Kimura 3-parameter model (K3P). The 3-sunlet network models events such as hybridisation, so a good understanding of this case will be useful for models in molecular phylogenetics.

A full identifiability result, generalising (Gross et al 2021, Theorem 2), remains open. For the DNA group-based models (JC, K2P, and K3P), one of the key results is that the variety corresponding to the 3-sunlet has smaller dimension than expected. This result can be exploited to give identifiability results on level-1 phylogenetic networks with four leaves (e.g. (Gross and Long 2018, Corollary 4.8)), since for a fixed number of leaves a 3-cycle network will have a strictly lower dimension than a 4-cycle network. For general G however, this is not the case, as shown in Table 1, so an alternative approach will be necessary to show identifiability for general G.

As the authors note in Gross and Long (2018), this dimension deficiency is in contrast to group-based mixture models, where the number of leaves determines the dimension. Here, we have shown that the dimension of a triangle-free level-1 phylogenetic network variety is fully determined by the number of leaves and the number of cycles (see Theorem 1), and for large enough G we expect this to be true for all level-1 phylogenetic networks.

Acknowledgements

Elizabeth Gross is supported by the National Science Foundation (NSF) under grant DMS-1945584. Samuel Martin is supported by the Biotechnology and Biological Sciences Research Council (BBSRC), part of UK Research and Innovation, through the Core Capability Grant BB/CCG1720/1 at the Earlham Institute, and is grateful for funding from EPSRC (grant number EP/W007134/1) and BBSRC (grant number BB/X005186/1).

Publisher's Note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
==== Refs
References

Allman ES, Rhodes JA (2007) Phylogenetic invariants. Reconstructing evolution: new mathematical and computational advances, pp 108–146
Allman ES Rhodes JA Phylogenetic ideals and varieties for the general Markov model Adv Appl Math 2008 40 2 127 148 10.1016/j.aam.2006.10.002
Baños H Bushek N Davidson R Dimensions of group-based phylogenetic mixtures Bull Math Biol 2019 81 2 316 336 10.1007/s11538-018-0489-0 30225594
Becker T Weispfenning V Gröbner bases, a computational approach to commutative algebra 1993 New York Springer-Verlag
Casanellas M Fernández-Sánchez J Geometry of the Kimura 3-parameter model Adv Appl Math 2008 41 3 265 292 10.1016/j.aam.2007.09.003
Casanellas M Fernández-Sánchez J Relevant phylogenetic invariants of evolutionary models J Math Pures Appl 2011 96 3 207 229 10.1016/j.matpur.2010.11.002
Casanellas M Fernández-Sánchez J Michałek M Local equations for equivariant evolutionary models Adv Math 2017 315 285 323 10.1016/j.aim.2017.05.003
Casanellas M Fernández-Sánchez J Garrote-López M Distance to the stochastic part of phylogenetic varieties J Symb Comput 2021 104 653 682 10.1016/j.jsc.2020.09.003
Cummings J, Hollering B, Manon C (2021) Invariants for level-1 phylogenetic networks under the Cavendar-Farris-Neyman model. arXiv preprint arXiv:2102.03431
Draisma J A tropical approach to secant dimensions J Pure Appl Algebra 2008 212 349 363 10.1016/j.jpaa.2007.05.022
Drton M, Sturmfels B, Sullivant S (2009) Lectures on algebraic statistics, Oberwolfach seminars, vol 39. Birkhäuser Basel
Duarte E, Hollering B, Wiedmann M (2023) Toric fiber products in geometric modeling. arXiv preprint arXiv:2303.08754
Engström A Kahle T Sullivant S Multigraded commutative algebra of graph decompositions J Algebraic Combinatorics 2014 39 335 372 10.1007/s10801-013-0450-0
Eriksson N Ranestad K Sturmfels B Phylogenetic algebraic geometry Projective varieties with unexpected properties. 2005 237 255
Evans SN Speed TP Invariants of some probability models used in phylogenetic inference Ann Stat 1993 21 1 355 377 10.1214/aos/1176349030
Francis A Semple C Steel M New characterisations of tree-based networks and proximity measures Adv Appl Math 2018 93 93 107 10.1016/j.aam.2017.08.003
Francis AR Steel M Which phylogenetic networks are merely trees with additional arcs? Syst Biol 2015 64 5 768 777 10.1093/sysbio/syv037 26070685
Gross E Long C Distinguishing phylogenetic networks SIAM J Appl Algebra Geom 2018 2 1 72 93 10.1137/17M1134238
Gross E van Iersel L Janssen R Distinguishing level-1 phylogenetic networks on the basis of data generated by Markov processes J Math Biol 2021 83 32 1 34129100
Kahle T Rauh J Toric fiber products versus Segre products Abhandlungen aus dem Mathematischen Seminar der Universität Hamburg. 2014 84 187 201 10.1007/s12188-014-0095-5
Maclagan D Sturmfels B Introduction to tropical geometry, 2021 American Mathematical Society
Michałek M Geometry of phylogenetic group-based models J Algebra 2011 339 1 339 356 10.1016/j.jalgebra.2011.05.016
Michałek M Ventura E Phylogenetic complexity of the Kimura 3-parameter model Adv Math 2019 343 640 680 10.1016/j.aim.2018.11.021
Pachter L Strumfels B Algebraic statistics for computational biology Cambridge University Press 2005 10.1017/CBO9780511610684
Semple C Phylogenetic networks with every embedded phylogenetic tree a base tree Bull Math Biol 2016 78 1 132 137 10.1007/s11538-015-0132-2 26670315
Sturmfels B Sullivant S Toric ideals of phylogenetic invariants J Comput Biol 2005 12 4 457 481 10.1089/cmb.2005.12.457 15882142
Sullivant S Toric fiber products. J Algebra 2006 316 560 577 10.1016/j.jalgebra.2006.10.004
Sullivant S (2018) Algebraic statistics, vol 194. American Mathematical Soc
Székely LA Steel MA Erdős PL Fourier calculus on evolutionary trees Adv Appl Math 1993 14 200 216 10.1006/aama.1993.1011
Zwiernik P Smith JQ Implicit inequality constraints in a binary tree model Electron J Stat 2011 5 1276 1312 10.1214/11-EJS640
