
==== Front
J Math Biol
J Math Biol
Journal of Mathematical Biology
0303-6812
1432-1416
Springer Berlin Heidelberg Berlin/Heidelberg

38902549
2117
10.1007/s00285-024-02117-5
Article
Homeostasis in networks with multiple inputs
http://orcid.org/0000-0002-3513-4020
de Oliveira Madeira João Luiz jldom20@bath.ac.uk

1
Antoneli Fernando 2
1 https://ror.org/002h8g185 grid.7340.0 0000 0001 2162 1699 Department of Mathematical Sciences, University of Bath, Bath, BA2 7AY UK
2 https://ror.org/02k5swt12 grid.411249.b 0000 0001 0514 7202 Escola Paulista de Medicina, Universidade Federal de São Paulo, São Paulo, 04039-032 Brazil
20 6 2024
20 6 2024
2024
89 2 1724 3 2023
8 6 2024
9 6 2024
© The Author(s) 2024
https://creativecommons.org/licenses/by/4.0/ Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/.
Homeostasis, also known as adaptation, refers to the ability of a system to counteract persistent external disturbances and tightly control the output of a key observable. Existing studies on homeostasis in network dynamics have mainly focused on ‘perfect adaptation’ in deterministic single-input single-output networks where the disturbances are scalar and affect the network dynamics via a pre-specified input node. In this paper we provide a full classification of all possible network topologies capable of generating infinitesimal homeostasis in arbitrarily large and complex multiple inputs networks. Working in the framework of ‘infinitesimal homeostasis’ allows us to make no assumption about how the components are interconnected and the functional form of the associated differential equations, apart from being compatible with the network architecture. Remarkably, we show that there are just three distinct ‘mechanisms’ that generate infinitesimal homeostasis. Each of these three mechanisms generates a rich class of well-defined network topologies—called homeostasis subnetworks. More importantly, we show that these classes of homeostasis subnetworks provides a topological basis for the classification of ‘homeostasis types’: the full set of all possible multiple inputs networks can be uniquely decomposed into these special homeostasis subnetworks. We illustrate our results with some simple abstract examples and a biologically realistic model for the co-regulation of calcium (Ca) and phosphate (PO4) in the rat. Furthermore, we identify a new phenomenon that occurs in the multiple input setting, that we call homeostasis mode interaction, in analogy with the well-known characteristic of multiparameter bifurcation theory.

Keywords

Homeostasis
Coupled systems
Combinatorial matrix theory
Input–output networks
Biochemical networks
Perfect adaptation
Mathematics Subject Classification

92C42 (primary)
92C45
37N25
http://dx.doi.org/10.13039/501100023395 Centre for Doctoral Training in Statistical Applied Mathematics, University of Bath EP/S022945/1 de Oliveira Madeira João Luiz http://dx.doi.org/10.13039/501100000266 Engineering and Physical Sciences Research Council EP/S022945/1 de Oliveira Madeira João Luiz http://dx.doi.org/10.13039/501100001807 Fundação de Amparo à Pesquisa do Estado de São Paulo 2019/12247-7 Antoneli Fernando issue-copyright-statement© Springer-Verlag GmbH Germany, part of Springer Nature 2024
==== Body
pmcIntroduction

A homeostatic process is characterized by the following property: approximately zero steady-state error to external disturbance, which means that an observable of interest is tightly controlled. Homeostasis is biologically important because it protects organisms against changes induced by the environment. A familiar example is thermoregulation, where the body temperature of an organism remains roughly constant despite variations in its environment (Morrison 1946). Another example is a biochemical reaction network, where the equilibrium concentration of some important molecule might not change much while the concentration of another reactant changes (Reed et al. 2017). Further examples include regulation of cell number and size (Lloyd 2013), sleep control (Wyatt et al. 1999), and expression level regulation of housekeeping genes (Antoneli et al. 2018).

Homeostasis can be mathematically defined as follows (see Sect. 2.1). Consider a dynamical system depending on an external parameter I which varies over an open interval ]I1,I2[ of external stimuli. Suppose there is a family of equilibrium points X(I) and an observable ϕ such that the input–output function z(I)=ϕ(X(I)) is well-defined on ]I1,I2[. In this situation, we say that the system exhibits homeostasis if, under variation of the external parameter I, the input–output function z(I) remains ‘approximately constant’ over the interval of external stimuli.

There are two formulations of ‘approximately constant’ often considered by researchers. The first, more stringent, called perfect homeostasis, is widely studied in control engineering and synthetic biology under the name ‘perfect adaptation’ [cf. Mello and Tu (2003); Ma et al. (2009); Ang and McMillen (2013); Araujo and Liotta (2018); Khammash (2021); Frei and Khammash (2021)]. Perfect homeostasis is defined as the ability of a system to reset to its pre-stimulated output level, called the set point, after responding to arbitrary external stimuli. It is obvious that this condition is equivalent to the requirement that the input–output function is identically constant.

The second, more general, called near-perfect homeostasis, requires that the input–output function stays within a ‘narrow’ range under variation of external stimuli over a bounded interval. Hence, a typical ‘plot’ of the input–output function has a bounded region of homeostasis where it is approximately constant, called the plateau, flanked by regions of escape from homeostasis, where it varies monotonically. See plots of input–output functions fitting data sets sampled from real biological systems in Morrison (1946), Golubitsky and Stewart (2017b), Nijhout et al. (2018).

The notion of near-perfect homeostasis has appeared in the literature under the names near-perfect adaptation (Mello and Tu 2003; Ang and McMillen 2013; Ferrell 2016) and imperfect adaptation (Bhattacharya et al. 2022, 2021). A refinement of the notion of near-perfect homeostasis, called infinitesimal homeostasis has been proposed by Golubitsky and Stewart (Golubitsky and Stewart 2017b). Since then, aspects of this new concept have been explored in several publications (Reed et al. 2017; Golubitsky and Stewart 2018; Duncan et al. 2018; Duncan and Golubitsky 2019; Golubitsky and Wang 2020; Wang et al. 2021; Madeira and Antoneli 2022).

In this paper, we shall study near-perfect adaptation from the point of view of infinitesimal homeostasis theory. Other contributions on near-perfect homeostasis include (Bhattacharya et al. 2023; Blanchini et al. 2022; Gross et al. 2019) and references therein. These three groups propose distinct approaches to near-perfect homeostasis, under various assumptions on the functional form of the dynamics. Moreover, since all these approaches are distinct from the one presented here, it would be a too large detour for us to try to explain and compare all these ideas. Nevertheless, we believe that a review unifying all these ideas would an extremely valuable achievement that could bring closer the several groups working in this subject under different viewpoints.

We say a system with input–output function z(I) exhibits infinitesimal homeostasis if dzdI(I0)=0 for some input value I0∈]I1,I2[. The vanishing of the derivative of z at I0 implies that I0 is a critical point of z. Moreover, the second order derivative of z with respect to I0 can be used to give a quantitative estimate on the size of the interval ]I1,I2[ where z(I) stays within z(I0)±δ, for a given δ>0 (see Golubitsky and Stewart (2022) for details). As we shall see in a moment, there are some additional advantages in adopting this point of view, besides providing a plausible notion of near-perfect homeostasis.

Nijhout, Reed, and Best (Nijhout et al. 2004, 2015, 2018; Best et al. 2009; Nijhout and Reed 2014; Nijhout et al. 2017, 2019) among others, have shown that homeostasis is an important phenomenon in biochemical reaction networks. In a biochemical network, each node represents the concentration of a chemical substrate and each arrow denotes a chemical interaction between the molecules at the head and tail of the arrow. In an input–output network formulation, one node is designated as the input node ι and another is designated as the output node o. The modeling assumes that some external stimuli (represented by an input parameter, or simply an input, I) affects the network dynamics only at the input node, and the end result of computation by the network dynamics is the value of the output node. In this setting, there is a canonical choice for the smooth observable ϕ: the coordinate function of the output node.

Motivated by these examples, Wang et al. (2021) introduced the notion of ‘abstract input–output network’ and devised a scheme for the classification of ‘homeostasis types’ in such networks. The notion of homeostasis type of a network makes precise the idea that homeostasis may be caused by different ‘mechanisms’ in that network. The results of Wang et al. (2021) apply to the case of single-input single-output networks where the external stimuli can only affect one input node via a single scalar input.

Even though single-input single-output (SISO) networks are quite popular in many engineering domains (Ma et al. 2009; Ang and McMillen 2013; Araujo and Liotta 2018; Bhattacharya et al. 2022), the single input node and single input assumptions seem unrealistic in biology, as disturbances that arise are typically very complex and do not have a single well-defined entry point (Gupta and Khammash 2022). As far as the input is concerned, there are two possible ways to extend the work of Wang et al. (2021) in order to include more complex situations: Multiple input nodes. A single input affects more than one of several input nodes.

Multiple inputs. Several inputs affect more than one of several input nodes.

Regarding (1), Madeira and Antoneli (2022) extended the classification of Wang et al. (2021) to the setting of multiple input nodes and used this extended theory to completely work out the homeostasis types of a representative model for bacterial chemotaxis (Clausznitzer et al. 2010; Tindall et al. 2008). As for (2), an interesting biologically relevant example is the regulation of extracellular dopamine (eDA) in response to variation in the activities of the enzyme tyrosine hydroxylase (TH) and the dopamine transporters (DAT) (Best et al. 2009; Golubitsky and Stewart 2018). Another biologically relevant example of the second situation is the mathematical model of Granjon et al. (2017) for the physiological co-regulation of calcium (Ca) and phosphate (PO4) in the rat. We will discuss this model in details in Sect. 3.

Let us recall the results of Madeira and Antoneli (2022). The main discovery of Wang et al. (2021) is that, in a given abstract input–output network, there is a finite number of ‘distinct mechanisms’ that may cause homeostasis, i.e. may force the derivative of the input–output function to vanish (at a fixed value of the input). These ‘distinct mechanisms’, called ‘homeostasis types’, bijectively correspond to a specific subnetworks of the abstract input–output network. These subnetworks, called homeostasis subnetworks, can be characterized in purely topological terms. In the single-input single-output theory of Wang et al. (2021), the homeostasis subnetworks can be divided into two classes: structural and appendage. The structural subnetworks correspond to feedforward mechanisms and the appendage subnetworks correspond to feedback mechanisms. These are called, respectively, ‘opposer modules’ and ‘balancer modules’ in the control theoretic literature (Araujo and Liotta 2018). In Madeira and Antoneli (2022) the single-input single-output theory is generalized, for the first time, to account for multiple input nodes. The main result is that everything from the single-input case generalizes, except that there is a new class of homeostasis subneworks, called input counterweight: every abstract multiple input node network has exactly one input counterweight subnetwork, which can be topologically characterized, as well.

In this paper we further build on the theory of Wang et al. (2021); Madeira and Antoneli (2022) to completely solve the problem of classifying the homeostasis types for input–output networks with multiple input nodes and multiple inputs (Sect. 2.3). More precisely, given an input–output network with multiple inputs we show that one can consider each parameter at a time. Thus, effectively reducing the problem of classification of homeostasis types to the single input case (still with multiple input nodes), that has been completely solved in Madeira and Antoneli (2022). Afterwards, we show how to combine these partial classifications for the single input cases into an algorithm that provides the full classification on the multiple inputs setting (Sect. 2.8).

The first issue to consider in the multiple inputs case is to obtain an analogue of the ‘determinant formula’ for the gradient of the inputs-output function (cf. Golubitsky and Stewart 2017b; Golubitsky et al. 2020; Wang et al. 2021; Madeira and Antoneli 2022). Versions of this ‘determinant formula’ have been obtained by several authors: Ma et al. (2009), Golubitsky and Wang (2020) for three-node networks and Araujo and Liotta (2018), Aoki et al. (2019) for arbitrary networks under the name ‘RPA equation’. In Sect. 2.3 we introduce a definition of a multiple-input single-output network and prove a multivariate generalization of ‘determinant formula’ (Lemma 2.1) mentioned above. A similar result to our ‘determinant formula’ has been obtained in Tang and McMillen (2016).

The main result of this paper allows us to completely classify homeostasis subnetworks of multiple inputs ‘core’ network (Sects. 2.4, 4.1). In the multiple inputs setting two new features arise. The first is related to being able to consider one parameter at a time. More specifically, for each scalar input IM we define a unique subnetwork, called IM-specialized subnetwork, that contains all the homeostasis subnetworks associated to the input IM (Sect. 2.5). When we have all the homeostasis subneworks of the specialized subnetworks we can proceed by considering two cases: (i) a pleiotropic subnetwork if it appears in all IM-specialized subnetworks, (ii) a coincidental subnetwork otherwise. Then we show that a pleiotropic subnetwork can only be of structural or appendage classes (Sects. 2.6, 4.2), whereas a coincidental subnetwork can be of structural, appendage or input counterweight class (Sect. 2.7). Furthermore, all our results hold generically in the setting of influence networks, which includes all ODE models used in biology (see Sect. 2.2).

The second new feature of multiparameter setting is related to the occurrence of overlapping between coincidental subnetworks contained in distinct IM-specialized subnetworks. These non-trivial interactions between homeostasis subnetworks in multiple inputs networks leads to the appearence of homeostasis mode interaction or higher codimension homeostasis. The notion of mode interaction is familiar in bifurcation theory. In a steady-state bifurcation the eigenvectors of the linearized equation corresponding to simple eigenvalues are called modes. A mode whose eigenvalues lie on the imaginary axis is said to be critical. Generically, it is expected that an one-parameter system has only one critical mode. However, in systems with more than one parameter, one expects multiple critical modes. The steady-state bifurcations that may arise in nonlinear systems near a (multi-) parameter value at which there are multiple critical modes are thought of as resulting from a nonlinear interaction of several critical modes. This process is called mode interaction and the (multi-) parameter values at which there are multiple critical modes are called higher codimension bifurcation points. We assert that there is an analogue process in the context of infinitesimal homeostasis (Ex. 2.16). Duncan et al. (2023) investigates the appearance of codimension-two homeostasis mode interaction in the different setting of infinitesimal homeostasis with a single input parameter.

We end this introduction by briefly mentioning other aspects of the infinitesimal homeostasis approach that we will not pursue in this paper: singularity theory network-preserving changes of coordinates (Golubitsky and Stewart 2017a, b, 2018; Antoneli and Stewart 2022), biological robustness (Kitano 2004, 2007a, b; Khammash 2016; Thom 1969, 1975, 1977; Hunt et al. 1992; Ott and Yorke 2005), numerical discovery and continuation (Govaerts 2000; Ermentrout 2002; Donovan 2019), classification of infinitesimal homeostasis in small ‘core networks’ (Huang and Golubitsky 2022), infinitesimal homeostasis for limit cycles (Yu and Thomas 2022) and miscellaneous applications to biology (Antoneli et al. 2018; Madeira and Antoneli 2022; Golubitsky et al. 2020; Golubitsky and Wang 2020).

Structure of the Paper. In Sect. 2 we give the definitions and state the main results of the paper. We discuss some simple abstract examples to illustrate the definition and results. In Sect. 3 we apply our results to a ‘real biological system’, a mathematical model of calcium and phosphate metabolism proposed in Granjon et al. (2017). In Sect. 4 we give the proofs of all our results. Finally, in Sect. 5 we briefly discuss our results in the context of the theory of infinitesimal homeostasis and conclude the paper with an outlook for future research.

Homeostasis in multiple inputs networks

In this section we state the main results of the paper and provide the necessary definitions.

Dynamical theory of infinitesimal homeostasis

Golubitsky and Stewart proposed a mathematical method for the study of homeostasis based on dynamical systems theory (Golubitsky and Stewart 2017b, 2018) [see the review (Golubitsky et al. 2020)]. In this framework, one consider a system of differential equations2.1 X˙=F(X,I)

where X=(x1,…,xn)∈Rn is the vector of state variables and I=(I1,…,IN)∈RN is the vector of input parameters.

Suppose that (X∗,I∗) is a linearly stable equilibrium of (2.1). By the implicit function theorem, there is a function X~(I) defined in a neighborhood of I∗ such that X~(I∗)=X∗ and F(X~(I),I)≡0. See Jahedi et al. (2022) for results on the generic existence and robustness of X~(I).

A smooth function ϕ:Rn→R is called an observable. Define the input–output function z:RN→R associated to ϕ and X~ as z(I)=ϕ(X~(I)). The input–output function allows one to formulate several definitions that capture the notion of homeostasis (see Ma et al. 2009; Ang and McMillen 2013; Tang and McMillen 2016; Golubitsky and Stewart 2017b, 2018).

Definition 2.1

Let z(I) be the input–output function associated to a system of differential Eqs. (2.1). We say that z(I) exhibits Perfect Homeostasis on an open set Ω⊆dom(z) if 2.2 ∇z(I)=0for allI∈Ω

That is, z is constant on Ω.

Near-perfect Homeostasis relative to a set point Is∈Ω⊆dom(z) if, for fixed δ, 2.3 |z(I)-z(Is)|⩽δfor allI∈Ω

That is, z stays within the range z(Is)±δ over Ω.

Infinitesimal Homeostasis at the point Ic∈dom(z) if 2.4 ∇z(Ic)=0

That is, Ic is a critical point of z. ◊

It is clear that perfect homeostasis implies near-perfect homeostasis, but the converse does not hold. Inspired by Nijhout, Reed, Nijhout et al. (2004); Best et al. (2009); Golubitsky and Stewart (2017b, 2018) introduced the notion of infinitesimal homeostasis that is intermediate between perfect and near-perfect homeostasis. It is obvious that perfect homeostasis implies infinitesimal homeostasis. On the other hand, it follows from Taylor’s theorem that infinitesimal homeostasis implies near-perfect homeostasis in a neighborhood of Ic, see Golubitsky and Stewart (2022). It is easy to see that the converse to both implications is not generally valid (see Reed et al. 2017).

The notion of infinitesimal homeostasis allows one to apply the tools from singularity theory. For instance, by considering higher degeneracy conditions, in addition to (2.4), one is lead to distinct forms of infinitesimal homeostasis that can be classified by elementary catastrophe theory (see Golubitsky and Stewart 2017b, 2018 for details). Finally, when combined with coupled systems theory (Golubitsky and Stewart 2006) the formalism of Golubitsky and Stewart (2017b), Golubitsky and Stewart (2018), Golubitsky et al. (2020) becomes very effective in the analysis of model equations.

Networks and dynamical systems

Before defining the appropriate class of dynamical systems (in Sect. 2.3) for our results we will briefly discuss the relation between networks and dynamics.

A large portion of the literature on network dynamical systems modeling seems to suggest that there is a unique way to associate a system of differential equations to a given directed graph G. With some rare exceptions, e.g. Bick et al. (2023), a precise definition of what is a “network dynamical system” is completely overlooked and the pairwise interaction interpretation (see below) is assumed without further justification. In fact, there are at least, two possible ways to attach a (class of) dynamical system(s) to a directed graph G. In order to discuss the distinction between these two possibilities we need precise definitions. Let G be a directed graph with k nodes. Pairwise interaction interpretation. In this interpretation the dynamics is encoded by a weighted adjacency matrix A compatible with the directed graph G. That is, Aji≠0 if and only if there is a link from node j to node i. For simplicity, suppose that each node of G represent an identical dynamical system of the form x˙i=F(xi), where xi∈Rn is the state vector of node i and F:Rn→Rn is a smooth function that describes the internal dynamics of node i. The interaction between nodes is given by a smooth pairwise coupling function G:Rn×Rn→Rn, also called point-to-point coupling (Golubitsky and Stewart 2002). The tuple (A, F, G) defines a network dynamical system through the set of differential equations 2.5 x˙i=F(xi)+∑j=1kAjiG(xi,xj)fori=1,⋯,k

The dynamics is determined by the evolution of the joint state of all nodes (x1,…,xk) through (2.5). It is important to note that network dynamical systems described via (2.5) have only additive interactions. Specifically, the interactions are in general nonlinear in the state variables xi, but linear in the coupling weights AjiAguiar and Dias (2018). By letting F and G vary over all smooth functions on the state space Rn, for a given family of weighted adjacency matrix A defining the same directed graph G, one obtains a space of vector fields XA∞(Rn). While setup (2.5) is arguably one of the most commonly used formulations of network-based modeling, it imposes a severe restriction that might not hold in real-world systems (Bick et al. 2023).

Influence network interpretation. In this interpretation the dynamics is given by a smooth vector-valued function H=(H1,…,Hk) that is compatible with the directed graph G. That is, the component function Hi explicitly depends on the state vector xj if and only if there is a link from node j to node i. Now the weights are implicitly incorporated into the function H. The dynamics is defined by the system of ODEs 2.6 x˙i=F(xi)+Hi(x1,…,xk)fori=1,⋯,k

here Hi:(Rn)k→Rn determines the influence of the joint state (x1,…,xk) on the i-th node state xi. The function Hi may depend not only on two node states, but may involve multiple nodes concurrently. Network dynamical systems of the form (2.6) have been considered in the groupoid formalism (Golubitsky and Stewart 2006, 2022). Now, despite node dependencies being captured by a graph, this does not exclude the possibility of nonlinear interactions involving three or more nodes, called higher-order interactions. By letting F and H vary over all smooth functions on the state space Rn one obtains a space of vector fields XG∞(Rn), this is the space of all dynamical systems (2.6) that are compatible with the network structure G. The main goal of the groupoid formalism is to study the space XG∞(Rn), rather than considering (2.6) for a specific F and H. This yields insights on how the ‘generic’ dynamical behavior of such a system depends on the imposed network structure encoded by G.

It is easy to see that the space of vector fields XG∞(Rn) contains the space of vector fields XA∞(Rn), for all families of weighted adjacency matrices A defining the directed graph G. In fact, XG∞(Rn) is the largest space of vector fields that can be attached to a directed graph G. Likewise, XA∞(Rn), for a fixed A, is the smallest space of vector fields that can be attached to a family of weighted adjacency matrix A. Remarkably, it seems that in order to generalize (2.5) to include higher order interactions only up to a fixed level, directed graphs are not enough to capture all the interaction relations. It is necessary to consider ‘higher dimensional’ generalizations of graphs, such as hypergraphs or simplicial complexes (Bick et al. 2023).

In this paper we adopt the influence network interpretation. As mentioned before, this approach emphasizes the ‘generic’ properties and how they are affected by the network structure encoded by G. This leads to the notion of model-independent approach, which is thoroughly explored in the book Golubitsky and Stewart (2022). The model-independent approach contrasts with the more common model-dependent one, where specific model equations are solved, usually numerically. Both approaches have advantages and disadvantages and should not be seen as competing against each other, on the contrary, they complement each other. Specific models are useful in connection with experimental tests, when the equations are obtained from precise laws. In a model-independent approach the exact equations may not be known, nevertheless one still can predict, from known properties of the equations, what types of behaviors are expected and which ones are forbidden.

Multiple-input single-output networks

A multiple-input single-output (MISO) network, or simply a multiple inputs network, is a network G with n distinguished input nodes ι={ι1,ι2,…,ιn}, all of them associated to at least one input parameter IM, M=1,…,N, one distinguished output node o, and r regulatory nodes ρ={ρ1,…,ρr}. The associated system of differential equations have the form2.7 x˙ι=fι(xι,xρ,xo,I)x˙ρ=fρ(xι,xρ,xo)x˙o=fo(xι,xρ,xo)

where I=(I1,⋯,IN)∈RN is the vector of input parameters, or simple the vector of inputs, and X=(xι,xρ,xo)∈Rn×Rr×R is the vector of state variables associated to the network nodes.

We write a vector field associated with the system (2.7) asF(X,I)=(fι(X,I),fρ(X),fo(X))

and call it an admissible vector field for the network G.

Let fj,xi denote the partial derivative of the jth node function fj with respect to the ith node variable xi. We make the following assumptions about the vector field F throughout: The vector field F is smooth and has a linearly stable equilibrium at (X∗,I∗). Therefore, by the implicit function theorem, there is a function X~(I) defined in a neighborhood of I∗ such that X~(I∗)=X∗ and F(X~(I),I)≡0.

The partial derivative fj,xi can be non-zero only if the network G has an arrow i→j, otherwise fj,xi≡0.

Only the input node coordinate functions fιk depend on at least one of the components of the vector of input parameters I and the partial derivative of fιk,IM generically satisfies 2.8 ∂fιk∂IM=fιk,IM≠0.

for some M=1,…,N.

Remark 2.2

In this paper we explicitly exclude the possibility that the output node is one of the input nodes. This assumption is included purely for the sake of convenience. In fact, all the results should be valid in this case, but then all the theorems and proofs should be properly adapted to take this particular case into account. This possibility, in the case of single input networks will be considered with great detail in another publication (Antoneli et al. 2023). ◊

The network structure provides a distinguished class of observables for an admissible system, namely, the state variables. In the particular case of an input–output network the observable of interest is given by the output state variable xo.

Definition 2.3

Let G be a multiple inputs network and F be a family of admissible vector fields with an equilibrium point X~(I)=(xι(I),xρ(I),xo(I)). The mapping I↦xo(I) is called the input–output function of the network G, relative to the family of equilibria (X~(I),I). ◊

Infinitesimal homeostasis in a multiple inputs network is given by the critical points of xo(I), namely, the zeros of the gradient vector2.9 ∇xo=∂xo∂I1,∂xo∂I2,⋯,∂xo∂IN

By a straightforward application of Cramer’s rule Wang et al. (2021) obtained a determinant formula for the derivative of the input–output function in the single-input single-output case. Madeira and Antoneli (2022) generalized the determinant formula of Wang et al. (2021) to the case of multiple input nodes networks. In the following we further generalize the determinant formula of Madeira and Antoneli (2022) to the case of multiple inputs networks.

Let J be the (n+r+1)×(n+r+1) Jacobian matrix of an admissible vector field F=(fι,fσ,fo), that is,2.10 J=fι,xιfι,xρfι,xofρ,xιfρ,xρfρ,xofo,xιfo,xρfo,xo

For each 1≤M≤N, consider the (n+r+1)×(n+r+1) matrix ⟨HM⟩ obtained from J by replacing the last column by (-fι,IM,0,0)t, is called IM-generalized homeostasis matrix:2.11 ⟨HM⟩=fι,xιfι,xρ-fι,IMfρ,xιfρ,xρ0fo,xιfo,xρ0

Here all partial derivatives fℓ,xj are evaluated at (X~(I),I).

Lemma 2.1

Let xo(I) be input–output function of a multiple inputs network. The partial derivative of xo(I) with respect to the M-th parameter IM satisfies2.12 ∂xo∂IM=det⟨HM⟩det(J)

where det(J) and det⟨HM⟩ are evaluated at the equilibrium point X~(I). Hence,2.13 ∇xo=1det(J)det⟨H1⟩,det⟨H2⟩,…,det⟨HN⟩

Moreover, I0 is a point of infinitesimal homeostasis if and only if2.14 det⟨HM⟩=0for all1≤M≤N

as a function of I evaluated at I0.

Proof

Implicit differentiation of the equation F(X~(I),I)=0 with respect to I yields the linear system2.15 Jxi′xρ′xo′=-fι,IM00

Since X~(I) is assumed to be a linearly stable equilibrium, it follows that det(J)≠0. On applying Cramer’s rule to (2.15) we can solve for ∂xo∂IM(I) obtaining (2.12). Applying (2.12) to (2.9), we obtain Eq. (2.13). □

Remark 2.4

An explicit expression for det⟨HM⟩ can be obtained by expanding it with respect to the last column and the ιm-th row:2.16 det⟨HM⟩=∑m=1n±fιm,IMdet(Hιm)

where Hιm is obtained from H by removing the last column and the ιm-th row. When there is a single input, i.e. N=1, the gradient ∇xo reduces to ordinary derivative xo′ and (2.13) gives the formula for xo′ obtained in Madeira and Antoneli (2022). When there is a single input and a single input node, N=n=1, there is only one matrix Hιm=H, called the homeostasis matrix and (2.13) gives the corresponding formula for xo′ obtained in Wang et al. (2021). ◊

Core networks

Wang et al. (2021) introduced a fundamental construction for the study of homeostasis in input–output networks, called ‘core subnetwork’. Madeira and Antoneli (2022) extended this construction to the case of input–output networks with multiple input nodes and single input parameter. Here we extend the arguments of Wang et al. (2021), Madeira and Antoneli (2022) to the case of multiple inputs networks.

Let (X∗,I∗) be a linearly stable equilibrium of the G-admissible ODE system (2.1). Then (X∗,I∗) it satisfies the system of equations2.17 fι1(xι1,…,xιn,xρ,xo,I1,…,IN)=0⋮fιn(xι1,…,xιn,xρ,xo,I1,…,IN)=0fρ(xι1,…,xιn,xρ,xo)=0fo(xι1,…,xιn,xρ,xo)=0

Partition the nodes of the network G as follows: (i) input nodes (whose dynamics explicitly depends on at least one input), (ii) the output node and (iii) the regulatory nodes, that can be classified into three types depending if they are upstream from the output node or/and downstream from at least one input node. More precisely, the set of regulatory nodes may be partitioned as: Those nodes σ that are both upstream from o and downstream from at least one input node ιm,

Those nodes d that are not downstream from any input node ιm,

Those nodes u which are downstream from at least one input node ιm, but not upstream from o.

Figure 1 shows the types of connections which can be found in G.Fig. 1 The possible connections in G. Here, inputs are highlighted by dotted circles of distinct colors. The arrows from each input to distinct input nodes are of the same color (the same color of the corresponding dotted circle)

Definition 2.5

Let G be a multiple inputs network. The core subnetwork Gc of G is the subnetwork whose nodes are: (i) the input nodes ι1,…,ιn, (ii) the regulatory nodes σ that are upstream from the output node and downstream of at least one input node, and (iii) the output node o. The arrows of Gc are the arrows of G connecting the nodes of Gc. ◊

Theorem 2.2

Let G be a multiple inputs network and Gc the corresponding core subnetwork. Then the input–output function xoc of Gc exhibits infinitesimal homeostasis at I∗ if and only if the input–output function xo of G exhibits infinitesimal homeostasis at I∗.

Proof

Follows from Theorem 4.2. □

Theorem 2.2 allows one to assume, without loss of generality, that G is a core network, that is G=Gc, as far as infinitesimal homeostasis is concerned.

Structure of infinitesimal homoestasis

In this subsection, unless explicitly stated, we assume that G is a core multiple inputs network with input nodes ι1,…,ιn and inputs I1,…,IN.

By Lemma 2.1 a network G exhibits infinitesimal homeostasis at a point I0 whenever the vector-valued function (when evaluated at (X~(I),I)) vanishes at I0:2.18 h→=(det⟨H1⟩,det⟨H2⟩,…,det⟨HN⟩).

here det⟨HM⟩ are the determinants of the IM-generalized homeostasis matrices.

In order to analyze and simplify these determinants let us introduce some terminology. A multivariate vector-valued polynomial, or, simply a polynomial mapping is a mapping P:Rk→Rk with polynomial components. That is, if P is a polynomial mapping, there exist multivariate polynomials P1,P2,…,Pk:Rk→R such that we can write P asP(x1,…,xk)=(P1(x1,…,xk),…,Pk(x1,…,xk)).

We say that P is irreducible if and only if each component Pj is irreducible. Suppose there is a multivariate polynomial function p:Rk→R that is common factor to all components Pj. Then we can factor p from the polynomial vector P asP(x1,…,xk)=p(x1,…,xk)(P~1(x1,…,xk),…,P~k(x1,…,xk)).

We say that p is a scalar factor of P.

Recall that the nonzero entries of the IM-generalized homeostasis matrices ⟨HM⟩ are the partial derivatives fj,xi and fj,IM. In particular, det⟨HM⟩ is a homogeneous polynomial function of degree (n+r+1) in the partial derivatives fj,xi and fj,IM. Hence, the vector-valued function h→ is a (formal) polynomial mapping on the ‘variables’ fj,xi and fj,IM. The scalar-valued function h→(I) (depending on the vector of input parameters I) is obtained by evaluating the partial derivatives fj,xi and fj,IM at X~(I).

Let us motivate the next definition with a simple observation. In the multiparameter setting, even a core network may have nodes that are not affected by all inputs. For example, consider the 5-node multiple inputs network G shown in Fig. 2. In this figure inputs are highlighted by dotted circles of distinct colors. The arrows from each input to distinct input nodes are of the same color (the same color of the corresponding dotted circle). The network shown in (a) has three input nodes, ι1, ι2 and ι3, and two inputs, I1 (blue) and I2 (red). Although, G is a core network, the input node ι1 is not affected by the parameter I2, and the node ι3 is not affected by parameter I1. To overcome this difficulty, we define the ‘specialized networks’ relative to a single input parameter.Fig. 2 A 2-parameter 5-four node network (a) and its IM-specialized subnetworks (b) and (c). Here, inputs are highlighted by dotted circles of distinct colors. The arrows from each input to distinct input nodes are of the same color (the same color of the corresponding dotted circle). The 2-parameter network (a), has 5 nodes: three input nodes ι1, ι2, ι3, one output node o and one regulatory node σ. The two IM-specialized subnetworks of (a) are always single-input multiple input node networks (see Definition 2.6). The I1-specialized subnetwork (b) has 1 input node (ι1). Notice that ι2 becomes a regulatory node for this network. The I2-specialized subnetwork (c) has 2 input nodes (ι2, ι3)

Definition 2.6

Let G be a core multiple inputs network with inputs I1,…,IN. The IM-specialized subnetwork GIM is defined as the (single input) input–output subnetwork of G consisting of all the input nodes that receive the input IM, all the regulatory nodes that are downstream from those input nodes and the output node. The arrows of GIM are the arrows of G between the nodes of GIM. The subnetwork DIM=G\GIM generated by the nodes in G that do not belong to GIM is called the IM-vestigial subnetwork. ◊

The specialized subnetwork GIM can be considered as a multiple input node network with single input IM, as studied in Madeira and Antoneli (2022), by ‘forgetting’ the effect of the other parameters and reducing to the core network using the core reduction theorem of (Madeira and Antoneli 2022, Thm. 3.2). The input nodes of GIM are exactly the input nodes of G that are affected by the parameter IM.

Definition 2.7

Let G be a core multiple inputs network with inputs I1,…,IN. The IM-homeostasis matrix ⟨HIM⟩ associated to GIM, is the generalized homeostasis matrix of the multiple input–output network GIM (see Madeira and Antoneli (2022, Sec 2.3)). Similarly, the corresponding IM-vestigial subnetwork DIM has an associated jacobian matrix JDIM (see Madeira and Antoneli (2022, Sect. 3.2)). To simplify the notation, in the case where the IM-vestigial subnetwork is empty (DIM=∅), we write det(JDIM)≡1. ◊

Now we need to specify the set Ω⊆RN of allowable parameter values. This set depends on the admissible vector field F and the type of model being considered. For instance, in a biochemical network the set Ω is the positive orthant of some RN. The subset of non-singular parameters of F on Ω is defined as2.19 ΩJ={I∈Ω:det(J)≠0}.

where J=(DF)(X~(I),I) is the jacobian. The set ΩJ also depends on the vector field F and, generically, is an open dense subset of Ω.

Lemma 2.3

For each M=1,…,N, we have:2.20 det⟨HM⟩=det(JDIM)det⟨HIM⟩,

Moreover, det(JDIM)≠0 over ΩJ and the irreducible factors of det(JDIM) never are irreducible scalar factors of h→.

Proof

In case DIM=∅, the result follows from the convention that det(JDIM)≡1. In case DIM≠∅, the vestigial subnetwork is composed by nodes that are not downstream from the input nodes affected by the parameter IM. Hence, we can apply to GIM the ‘core network’ theorem for networks with multiple input nodes and a single input parameter (Madeira and Antoneli 2022, Thm 3.2). The statement about the irreducible factors of det(JDIM) follows from an argument similar to the one employed in Madeira and Antoneli (2022, Prop 3.8). □

Lemma 2.3 allows us to further simplify the components of h→, by considering the determinants det⟨HIM⟩. This reduce to the situation already studied in Madeira and Antoneli (2022).

Definition 2.8

The vector determinant associated to an input–output network is the vector-valued function defined by2.21 h^=(det⟨HI1⟩,det⟨HI2⟩,…,det⟨HIN⟩),

where det⟨HIM⟩, M=1,…,N, is the determinant of generalized homeostasis matrix of the IM-specialized subnetwork GIM. The vector-valued function h^ can be considered as a (formal) polynomial mapping on the ‘variables’ fj,xi and fj,IM. ◊

Proposition 2.4

The vector-valued functions ∇xo, h→ and h^, defined on Ω→RN, have the same set of zeros on ΩJ.

Proof

The first equality follows from Lemma 2.1 and the second equality follows from Lemma 2.3. □

The König-Frobenius theorem (Schneider 1977; Brualdi and Cvetkoić 2009) (see also Wang et al. (2021); Madeira and Antoneli (2022)) imply that the components of the polynomial mapping h^ can be factorized as the product of the determinants of the irreducible diagonal blocks of each ⟨HIM⟩ (defined up to row and column permutations). An irreducible block B of some ⟨HIM⟩ is called a homeostasis block. We can further collect the factors that are common irreducible diagonal blocks of all matrices ⟨HIM⟩ and bring them to the front as scalar factors. Then we can write2.22 h^=det(B1)⋯det(Bk)∏j1detBI11,…,∏jNdetBINN

Therefore, we can split the problem of classifying homeostasis types supported by G into two cases according to whether the components of h^ have a common scalar factor or not.

Definition 2.9

Let G be a core multiple inputs network and consider its vector determinant h^ as in (2.22). A homeostasis block corresponding to scalar factor det(Bi) (i=1,…,k) of h^ is called a pleiotropic homeostasis block. The other homeostasis blocks of G are called coincidental. ◊

Remark 2.10

In genetics, pleiotropy refers to the phenomenon when a single locus affects multiple traits (Stearns 2010). Here, we employed the term pleiotropic homeostasis referring to the fact that the nullification of one single homeostasis block leads to the annulment of the whole homeostasis vector h^. ◊

Recall that the homeostasis types of a single parameter input–output network G are given in terms of the factors of h=det(H) (see Wang et al. (2021); Madeira and Antoneli (2022))2.23 det(H)=det(B1)⋯det(Bk),

where each irreducible block Bj can be of three types, called appendage, structural and counterweight. There is only one counterweight block defined as the only irreducible block that contains all the partial derivatives of f with respect to the input I. Infinitesimal homeostasis of type Bj occurs if det(Bj)=0 and det(Bi)≠0 for all i≠j. This is generic when there is only one input parameter.

Now, suppose that G has N inputs affecting n input nodes. Generically, it is expected that N irreducible factors of h^ can simultaneously vanish at a fixed input value.

Definition 2.11

Let G be a multiple inputs core network. Let B be a homeostasis block of size ℓ. We say that the homeostasis class of B is Input counterweight if B contains partial derivatives with respect to inputs (the simplest counterweight block is of the form fιm,IM),

Appendage if B has ℓ self-couplings,

Structural if B has exactly ℓ-1 self-couplings. ◊

It follows from the argument in (Madeira and Antoneli 2022, Sec. 3.4), applied to the specialized subnetworks GIM, that each homeostasis block of G is of one of the classes in Definition 2.11.

Definition 2.12

Let G be a core multiple inputs network. We say that pleiotropic homeostasis occurs when at least one pleiotropic block has vanishing determinant at some fixed input value. The pleiotropic blocks determine the pleiotropic homeostasis types of G.

We say that coincidental homeostasis occurs when a N-tuple of coincidental blocks (BI11,…,BINN) has simultaneously vanishing determinants at some fixed input value. The N-tuples of coincidental blocks determine the coincidental homeostasis types of G. ◊

Definition 2.13

Let G be a core multiple inputs network and B be a homeostasis block. The homeostasis subnetwork KB associated to B is defined as follows. The nodes of KB are the nodes σ and ρ of G such that fσ,xρ is a non-zero entry of B. The arrows of KB are the arrows σ→ρ of G such that σ,ρ∈KB with σ≠ρ. ◊

Pleiotropic homeostasis types

In this section we classify the pleiotropic sub-blocks of a multiple inputs core network.

Proposition 2.5

Let G be a multiple inputs core network and B be a pleiotropic block of G. (i) Then B is either appendage or structural.

(ii) More precisely, B is an appendage (respect. structural) block if and only if it is ⟨HIM⟩-appendage (respect. ⟨HIM⟩-structural) block, for all M=1,…,N.

Proof

(i) From the results of Wang et al. (2021), Madeira and Antoneli (2022), we see that, for each M=1,…,N, B can be classified with respect to the specialized subnetwork GIM associated to the input IM as an ⟨HIM⟩-input counterweight, an ⟨HIM⟩-structural or an ⟨HIM⟩-appendage block. As the derivatives fιj,IM would appear in the expression of det(B) if it was a ⟨HIM⟩-input counterweight block, we conclude that det(B) must be either an ⟨HIM⟩-structural or an ⟨HIM⟩-appendage block, for all M=1,…,N.

(ii) This follows immediately from the fact that the classification is based on the number of self-coupling entries. □

In Remark 2.4 we observed that when the network G has a single parameter the theory developed here reduces to the situation considered in Madeira and Antoneli (2022). The next result shows that when the multiple inuts network G has a single input node then the theory essentially reduces to the case where there is only one input parameter, considered in Wang et al. (2021). This is an extreme case where only pleiotropic homeostasis occurs.

Proposition 2.6

Suppose the core multiple inputs network G has only one input node ι and multiple inputs I1,…,IN. Then, we have:∇xo=det(H)det(J)fι,I1,…,fι,IN

where det(H) is the homeostasis determinant of the network G, as a polynomial function of the partial derivatives fj,xi. In particular, Condition (2.8) implies that infinitesimal homeostasis occurs if and only if det(H)=0.

Proof

This is a consequence of Lemma 2.1 and of Eq. (2.16) for det⟨HM⟩ when G has a single input node. □

Therefore, Proposition 2.6 implies that the classification of homeostasis types of a multiple inputs network with a single input node is exactly the same as that of a single input parameter single input node network. However, it is not true that we expect to see the same ‘homeostasis phenomena’ in both networks. In order to see this, suppose that G has a single input node, but multiple inputs (I1,…,IN) affecting the input node. Consequently, the function h, which is the same polynomial on the partial derivatives fj,xi, becomes a multivariate function when evaluated at X~(I1,…,IN). Generically, it is expected that N irreducible factors of (2.23) can simultaneously vanish at a fixed value (I10,…,IN0).

Returning to the general case, the next result gives a complete topological classification of the homeostasis subnetworks corresponding to the pleiotropic homeostasis types.

Theorem 2.7

Let G be a multiple inputs core network, B be a pleiotropic block of G and KB be the corresponding homeostasis subnetwork to B in G. (i) Then KB is either an appendage or structural subnetwork of all IM-specialized subnetworks GIM.

(ii) More precisely, KB is an appendage (respect. structural) subnetwork if and only if it is a ⟨HIM⟩-appendage (respect. ⟨HIM⟩-structural) subnetwork, for some (and hence for all) M=1,…,N.

Proof

The result follows from Theorems  4.3 and 4.4 for the appendage case and Theorems 4.8 and 4.9 for the structural case. See Sect. 4.2 for precise characterization of each type of subnetwork. □

Coincidental homeostasis types

The occurrence of coincidental homeostasis reflects the fact that the mechanism leading to homeostasis is not the same with respect to all the inputs. The coincidental homeostasis types are given by all the possible combinations of coincidental blocks. A coincidental type can be of structural class, appendage class or input counterweight class. Thus, depending on the network, a coincidental type can have the form of a mix of these three classes.

In the simplest case the determinant of a coincidental block can be an entry of some ⟨HIM⟩ of the form fxιm,IM. Since, by assumption, these entries cannot vanish it may happen that some coincidental types do not yield infinitesimal homeostasis.

On one hand, as shown in Proposition 2.6, networks that have only one input node, only support pleiotropic homeostasis. On the other hand, it is easy to find networks that support only coincidental homeostasis (see Sect. 2.9).

Still, one may wonder whether there is a multiple inputs core network that do not support either pleiotroic nor coincidental homeostasis, that is, it does not support infinitesimal homeostasis. The next proposition shows that this cannot happen, namely, any multiple inputs core network always support at least one type of homeostasis.

Proposition 2.8

A multiple inputs core network G always supports infinitesimal homeostasis.

Proof

In order to prove the proposition, consider all input nodes ιm, such there is an ιm-simple node σ (σ≠ιm) that receives an arrow from ιm and such that fσ,xιm=0 (Haldane homeostasis). Let Gm be the core subnetwork between the input node ιm and output node o (Madeira and Antoneli 2022, Def. 2.13). By definition, Gm is a single input–output network. Then, by the characterization of structural homeostasis in networks with single one input node (see Wang et al. 2021), the homeostasis determinant of Gm vanish, i.e., if Hmc is the homeostasis matrix of Gm, then detHmc=0. This fact together with (Madeira and Antoneli 2022, Eq. 3.39) implies that det⟨HIM⟩=0, for all M=1,…,N. To conclude the argument, we claim that this construction does not force det(J)=0, generically. This follows from that fact that one of the terms that appear in the expression of the Jacobian determinant is the product of all the self-couplings of nodes of G. As the construction above does not assume that the self-couplings to be equal to zero, the claim holds. □

Finally, we state below a sufficient condition for a core multiple inputs network to support coincidental homeostasis. The network of Fig. 4b shows that the condition given below is sufficient, but not necessary, for a core multiple inputs network to support coincidental homeostasis.

Proposition 2.9

Let G be a multiple inputs core network. If none of the input nodes of G is an absolutely super-simple node (see Definition 4.1), then G supports at least one coincidental homeostasis type.

Proof

Note that an input node is an absolutely super-simple node if and only if it is the first absolutely super-simple node of the network. Hence, the hypothesis that none of the input nodes of G is an absolutely super-simple node is equivalent to: the first absolutely super-simple node of G is not an input node. First, suppose that pleiotropic homeostasis does not occurs in G. Then by Proposition 2.8 it follows that coincidental homeostasis must occur in G. Now suppose that pleiotropic homeostasis does occur in G. Clearly, as the input nodes are not absolutely appendage, by Theorem 2.7, they do not belong to a pleiotropic-appendage subnetwork. In addition, none of the input nodes belong to any absolutely super-simple structural subnetwork, as the input nodes are not absolutely super-simple and cannot be between two absolutely super-simple nodes (this is a consequence of Madeira and Antoneli (2022, Lem 3.15)). Hence, by Theorem 2.7, none of the input nodes belong to a pleiotropic-structural subnetwork. Therefore, each input node belong to a counterweight subnetwork and thus coincidental homeostasis must occur. □

Remark 2.14

As previously explained, Proposition 2.9 does not provide us with a necessary condition for the occurrence of coincidental homeostasis. It is then a open problem to determine necessary and sufficient conditions for the occurrence of coincidental homeostasis. As it will be exemplified in Sect. 2.9, the interaction between the different subnetworks makes this a non-trivial problem. ◊

Algorithm to determine all homeostasis types

Using the results obtained here, together with Wang et al. (2021); Madeira and Antoneli (2022), one can write down a general algorithm to find all homeostasis types of a given multiple inputs core network G. Step 1 For each parameter IM with M=1,…,N determine the IM-specialized subnetwork GIM as in Definition 2.6.

Step 2 Since each GIM is a single parameter multiple input–output network one can apply the algorithm of (Madeira and Antoneli 2022, Sect. 2.6) to determine all the homeostasis subnetworks K of each GIM.

Step 3 Determine the homeostasis subnetworks that are common to all GIM. The output of this step is the list of pleiotropic homeostasis types.

Step 4 Determine the N-tuples formed by combinations of the remaining homeostasis subnetworks. The output of this step is the list of coincidental homeostasis types.

Some simple examples

In this section we present some examples of small networks exhibiting an astonishing array of phenomena that can arise in the multiparameter setting.

For instance, there are networks that do support both pleiotropic and coincidental homeostasis (e.g. Example 2.16) and networks that support only one of each type: Example 2.15 supports only pleiotropic homeostasis. Whereas Example (...) supports only coincidental homeostasis.

Moreover, we will see that when there is a proper coincidental type (i.e. all determinants can vanish) non-trivial interaction between the homeostasis subnetworks can occur.

Let us start with the minimal non-trivial examples. There are some constraints to get non-trivial networks: There must be at least two inputs.

There must be at least two input nodes (see Proposition 2.6).

The output node is distinct from the input nodes (see Remark 2.2).

Therefore, the network must have at least three nodes, two input nodes ι1, ι2 and the output node o. In addition, let us make the simplifying assumption that each input parameter affects exactly one input node. Granted these conditions, it is not difficult to show that, up to core-equivalence and input-relabeling, there are exactly 8 networks, shown in Fig. 3. Two core networks are core-equivalent if they have identical vector determinants, up to permutation (cf. Wang et al. 2021, Def. 1.9).Fig. 3 Three-node core networks with one input per input node

Example 2.15

Consider the eight 3-node core networks shown in Fig. 3. We begin by determining the specialized subnetworks. Since the networks have one input per input node the specialized subnetwork is a single parameter single input 3-node network. Then we can use the results from Golubitsky and Wang (2020) to write the vector determinant. We also note that, by definition, fι1,I1 and fι2,I2 cannot vanish.

Network (a).  In this example we haveI1→ι1→oI2→ι2→o

Therefore, the vector determinant is given byh^=(fι1,I1fo,xι1,fι2,I2fo,xι2).

Hence, the network only supports coincidental homeostasis, given by the simultaneous vanishing of the irreducible (structural) factors fo,xι1 and fo,xι2.

Network (b).  In this example we haveI1→ι1→o↑↓ι2I2→ι2→o

In the second specialized network we omitted the arrow o→ι2, since it does not affect the vector determinant. Therefore, the vector determinant is given byh^=(fι1,I1fo,xι1fι2,xι2,fι2,I2fo,xι2).

Hence, the network does not support pleiotropic homeostasis. There are two possibilities for the occurrence of coincidental homeostasis fo,xι1 (structural) and fo,xι2 (structural),

fι2,xι2 (appendage) and fo,xι2 (structural).

Now, the jacobian determinant of the network isdet(J)=fι1,xι1(fι2,xι2fo,xo-fι2,xofo,xι2).

Hence, the occurrence of homeostasis in case (2) necessarily forces det(J)=0 (see Remark 2.17). Therefore, coincidental homeostasis only can occur in case (1).

Network (c).  In this example we haveI1→ι1→o↑↓ι2I2→ι2→o↑↓ι1

Therefore, the vector determinant is given byh^=(fι1,I1fo,xι1fι2,xι2,fι2,I2fo,xι2fι1,xι1).

Now, the jacobian determinant of the network isdet(J)=fι1,xι1fι2,xι2fo,xo-fι1,xofι2,xι2fo,xι1-fι2,xofι1,xι1fo,xι2

Hence, the network only supports coincidental homeostasis. Moreover, from the 4 possible combinations of factors of h^ the only that does not force det(J)=0 is given by fo,xι1 and fo,xι2 (see Remark 2.17).

Network (d).  In this example we haveI1→ι1→↗↘ι2oI2→ι2→↗↘ι1o

In both specialized networks we omitted the arrow o→ι2 since it does not affect the vector determinant. Therefore, the vector determinant is given byh^=(fι1,I1(fι2,xι1fo,xι2-fo,xι1fι2,xι2),fι2,I2(fι1,xι2fo,xι1-fo,xι2fι1,xι1)).

Hence, the network only supports coincidental homeostasis, given by the simultaneous vanishing of the two irreducible (structural) factors.

Network (e).  In this example we haveI1→ι1→↙↖ι2oI2→ι2→ι1→o

In the second specialized network we omitted the arrow o→ι2, since it does not affect the vector determinant. Therefore, the vector determinant is given byh^=fo,xι1(fι1,I1fι2,xι2,fι2,I2fι1,xι2).

Hence, the network does support pleiotropic homeostasis. In order for coincidental homeostasis to occur, both irreducible factors below must vanish simultaneouslyfι2,xι2andfι1,xι2

Now the jacobian determinant of the network isdet(J)=fι1,xι1fι2,xι2fo,xo+fι1,xι2fι2,xofo,xι1

Thus, the vanishing of the two factors force det(J) to vanish and so coincidental homeostasis can not occur in this network (see Remark 2.17).

Network (f).  In this example we haveI1→ι1→↗↘ι2oI2→ι2→o

Therefore, the vector determinant is given byh^=(fι1,I1(fι2,xι1fo,xι2-fo,xι1fι2,xι2),fι2,I2fo,xι2).

Hence, the network does not support pleiotropic homeostasis. In order for coincidental homeostasis to occur, both irreducible factors below must vanish simultaneouslyfι2,xι1fo,xι2-fo,xι1fι2,xι2andfo,xι2.

Note that both factors are of structural homeostasis type. The vanishing of fo,xι2 reduces the first factor to fo,xι1fι2,xι2. The jacobian determinant of the network isdet(J)=fι1,xι1fι2,xι2fo,xo

Hence, the condition fι2,xι2=0 forces det(J)=0, whereas fo,xι1=0 does not (see Remark 2.17). Therefore, the vanishing of the factor fo,xι10 is the only possibility for the occurrence of coincidental homeostasis.

Network (g).  In this example we haveI1→ι1→ι2→oI2→ι2→o

Therefore, the vector determinant is given byh^=fo,xι2(fι1,I1fι2,xι1,fι2,I2).

Hence, the network does not support coincidental homeostasis. In order for pleiotropic homeostasis to occur the irreducible (structural) factor fo,xι2 must vanish. Here, the obstruction to the occurrence of coincidental homeostasis is due to the fact that the second component of h^ consists only of the non-vanishing factor fι2,I2.

Network (h).  In this example we haveI1→ι1→ι2→oI2→ι2↑↓ι1→o

In the first specialized network we omitted the arrow ι2→ι1, since it does not affect the vector determinant. Therefore, the vector determinant is given byh^=fo,xι2(fι1,I1fι2,xι1,fι2,I2fι1,xι1).

Hence, pleiotropic homeostasis occurs when the irreducible (structural) factor fo,xι2 vanishes. Coincidental homeostasis is given by the simultaneous vanishing of the irreducible factors fι2,xι1 and fι1,xι1. ◊

Next, we consider an example obtained from the network shown in Fig. 3g by adding the influence from input I2 on node ι1. The main difference from the networks in Example 2.15 is the appearance of an input counterweight factor. This illustrates the effect of having more than one input node affected by the same input (see Fig. 4). Note that this is core equivalent to adding the influence from input I2 on node ι1 on the network shown in Fig. 3h.Fig. 4 Three-node core network with input affecting both input nodes

Example 2.16

Consider the 2-parameter 3-node core network shown in Fig. 4. The specialized subnetworks are:I1→ι1→ι2→oι1→↖↗I2ι2→o

Therefore, the vector determinant is given byh^=fo,xι2(fι1,I1fι2,xι1,fι1,I2fι2,xι1-fι2,I2fι1,xι1).

Pleiotropic homeostasis can occur by the vanishing of the irreducible (structural) factor fo,xι2. In order for coincidental homeostasis to occur both irreducible factors (the first is structural and the second is input counterweight) below must vanish simultaneouslydetBI12=fι2,xι1anddetBI21=fι1,I2fι2,xι1-fι2,I2fι1,xι1.

Occurrence of coincidental homeostasis requires the simultaneous vanishing of fι2,xι1 and fι1,xι1. Now, the jacobian determinant of the network isdet(J)=fo,xofι1,xι1fι2,xι2-fι1,x2fι2,x1.

Hence the vanishing of the two factors above forces det(J)=0. Thus, coincidental homeostasis cannot occur in this network (see Remark 2.17). ◊

Remark 2.17

In three of the eight networks of Example 2.15, networks (b), (e), (f), and the network of Example 2.16, we faced a situation where the vanishing of certain factors, that could cause coincidental homeostasis, forced the vanishing of the jacobian determinant of the network. In other words, the homeostasis point occurs at the same value of the input parameters that makes the family of equilibria to undergo a steady-state bifurcation. Strictly speaking, this means that the situation mentioned above cannot be considered as a ‘proper’ infinitesimal homeostasis and thus we have excluded these cases. Indeed, the definition of infinitesimal homeostasis (Definition 2.1) excludes the simultaneous occurrence of homeostasis and steady-state bifurcation. However, if one considers extending the definition of homeostasis to include such cases (see Duncan et al. (2018); Duncan and Golubitsky (2019) for some advances in this direction) then one may get a much richer variety of phenomena. ◊

Application of the theory to a model of calcium and phosphate homeostasis

In this section, we shall apply our theory to a ‘real biological system’, a mathematical model for the metabolic regulation of calcium and phosphate proposed by Granjon et al. (2017). Our aim here is to exemplify an application of the results of this paper to mathematical model from the literature, rather than exploit the details of calcium metabolism under physiological and pathological conditions.

Calcium is an essential metal ion that takes part in many signaling pathways and biochemical processes, including bone metabolism. Hence, its extracellular concentration must be tightly regulated (Blaine et al. 2015). Importantly, the regulation of extracellular calcium concentration is coupled to phosphate homeostasis (Blaine et al. 2015), which is an anion essential to human body. An explanation of the many pathways involved in calcium and phosphate metabolism is beyond the scope of this paper, and the interested reader is referred to Blaine et al. (2015) and Melmed et al. (2015, Ch 29).

The model used here is adapted from Granjon et al. (2017) and can be described by a network with 7 nodes (two input nodes, one output nodes and four regulatory nodes) and two inputs (see Fig. 5). The two inputs represent (1) the calcium intake (I1) and (2) the phosphate intake (I2). This is a quite natural choice, since one can assume that the intake of these ions depend on the availability of food, which can be reasonably variable. These inputs directly affect, respectively, the dynamics of the intestinal concentration of free calcium (xι1) and of free phosphate (xι2). Hence, these concentrations correspond to the two input nodes. The output node corresponds to the extracellular concentration of calcium xo. Since calcium and phosphate metabolism is regulated by a complex network of hormones and signaling molecules, we include here the components that were highlighted by Granjon et al. (2017). The four regulatory nodes are (1) the extracellular phosphate concentration xρ1, (2) the concentration of calcitriol, i.e. the active form of vitamin D, xρ2, (3) the PTH concentration xρ3 and (4) the FGF23 concentration xρ4. Calcitriol, PTH and FGF23 are hormones that regulate bone metabolism, kidney reabsorption and intestinal absorption of calcium and phosphate, respectively (Melmed et al. 2015, Ch 29).

Following the abstract formulation introduced in Sect. 2.3, we can describe this dynamical system by the following system of ODEs3.1 x˙ι1=fι1(ι1,ρ2,o,I1)x˙ι2=fι2(ι2,ρ1,ρ2,I2)x˙ρ1=fρ1(ι2,ρ1,ρ2,ρ3,ρ4,o)x˙ρ2=fρ2(ρ1,ρ2,ρ3,ρ4,o)x˙ρ3=fρ3(ρ1,ρ2,ρ3,o)x˙ρ4=fρ4(ρ1,ρ2,ρ4)x˙o=fo(ι1,ρ1,ρ2,ρ3,o)

Since we our aim will be to describe the possible types of homeostasis supported by this system rather then to analyze the specific values that the dynamical system can assume, the abstract formulation of the system as given in (3.1) will be enough to our purposes. We refer the reader interested in the precise formulation of the system to Granjon et al. (2017). The multiple-input single-output network associated to the dynamical system above is given by Fig. 5.Fig. 5 The network associated to the dynamical system (3.1) and its associated specialized subnetworks. a The core network associated to (3.1). From a modeling perspective, I1 represents the calcium intake, I2 the phosphate intake, xι1 the intestinal concentration of free calcium, xι2 the intestinal concentration of free phosphate, xo the extracellular concentration of calcium, xρ1 the extracellular phosphate concentration, xρ2 the concentration of calcitriol, xρ3 the PTH concentration and xρ4 the FGF23 concentration. b The I1-specialized subnetwork GI1. The I1-absolutely super-simple nodes are in green and the appendage nodes in orange. c The I2-specialized subnetwork GI2. The I2-absolutely super-simple nodes are in green and the other I2-absolutely simple nodes in pink. Since GI2 has no appendage nodes, it does not support appendage homeostasis. Consequently, the system does not support pleiotropic-appendage homeostasis. Moreover, since the absolutely super-simple nodes of GI1 and GI2 are different from each other (with the exception of o), by Theorem 4.8, the network does not support pleiotropic-structural homeostasis. Consequently, the network supports only coincidental homeostasis. All the nodes belong to both IM-specialized subnetworks GIM, for M=1 and M=2

The homeostasis determinants with respect to the inputs I1 and I2, respectively, are given by3.2 det⟨H1⟩=fι1,I1fo,xι1det(BI1)anddet⟨H2⟩=fι2,I2fρ1,xι2det(BI2)

where the blocks BI1 and BI2 are given byBI1=fι2,xι2fι2,xρ1fι2,xρ200fρ1,xι2fρ1,xρ1fρ1,xρ2fρ1,xρ3fρ1,xρ40fρ2,xρ1fρ2,xρ2fρ2,xρ3fρ2,xρ40fρ3,xρ1fρ3,xρ2fρ3,xρ300fρ4,xρ1fρ4,xρ20fρ4,xρ4,

andBI2=fι1,xι10fι1,xρ2000fρ2,xρ1fρ2,xρ2fρ2,xρ3fρ2,xρ40fρ3,xρ1fρ3,xρ2fρ3,xρ300fρ4,xρ1fρ4,xρ20fρ4,xρ4fo,xι10fo,xρ2fo,xρ30.

Hence, the vector determinant is given by3.3 h^=(fι1,I1fo,xι1det(BI1),fι2,I2fρ1,xι2det(BI2)).

Note that by the structure of h^ in (3.3), it is clear that the coordinates of h^ have no common factor. Hence, according to Definition 2.9, the system does not support pleiotropic homeostasis. As by Proposition 2.8, the system must support in general some type of infinitesimal homeostasis, we conclude that it may present coincidental homeostasis. By our algorithm described in Sect. 2.8, this conclusion can also be derived directly from the analysis of the network corresponding to the dynamical system (3.1) (see Fig. 5).

We shall now list all the possible types of coincidental homeostasis that may happen. To simplify notation, we list the factor that appear in the coordinates of h^ that may be equal to 0, and the corresponding classification of homeostasis. fo,xι1 (I1-structural) and fρ1,xι2 (I2-structural);

fo,xι1 (I1-structural) and detBI2 (I2-structural);

detBI1 (I1-appendage) and fρ1,xι2 (I2-structural);

detBI1 (I1-appendage) and detBI2 (I2-structural).

The theoretical results above give the list of all possible homeostasis types of the general admissible system (3.1). As often, in a model-independent approach, we can not say much about what happens in a specific model equation of the form (3.1), such as the original model in Granjon et al. (2017). However, it may happen that some of the homeostasis types above do not occur in a specific model equation. For instance, it is easy to check if case (1) above can occur in a specific model equation: it is enough to compute fo,x1 and fρ1,xι2 and verify that they never vanish. When this is the case, we can conclude that this homeostasis type cannot occur in that specific model equation. On the other hand, if they both can vanish, then it may be possible to find homeostasis points by numerical computation.

In general, there is no obstruction for a ‘generic’ admissible system to display all possible homeostasis types. Moreover, it is not difficult to numerically find a point of infinitesimal homeostasis in a ‘generic’ admissible system. In Fig. 6 we present the result of a numeric computation of the input–output function xo(I1,I2) of a generic admissible vector field (3.1) truncated up to quadratic order. The numeric computation allows us to find that infinitesimal homeostasis occurs at (I10,I20)≈(2.9,12.7). The plateau is located at xo(2.9,12.7)≈0.09. Near the singularity the function xo(I1,I2) is topologically equivalent to a hyperbolic saddle—a Morse singularity in R2 with normal form h(I1,I2)=I12-I22 (see Golubitsky and Stewart (2018) for more details). Recall that a Morse singularity has codimension 0, thus it is structurally stable, namely any small perturbation of xo(I1,I2) (induced by a small perturbation of the admissible vector field) is topologically equivalent to the unperturbed function. The flatness of the input–output function xo(I1,I2) near the homeostasis point is reflected in the graph Fig. 6a, which shows that for (I1,I2)∈[6,15]×[-2,7], the value of xo stays in [0, 2].Fig. 6 Numerical computation of the input–output function xo(I1,I2) of a generic admissible vector field (3.1) truncated up to quadratic order. Infinitesimal homeostasis occurs at (I10,I20)≈(2.9,12.7), with xo(2.9,12.7)≈0.09. Panel a shows the 3D plot of the graph of xo(I1,I2). Here, the scale of the z-axis (xo) is different from the the scale of the other two axes. Panel b shows the contour plot (level curves) of xo(I1,I2). Near the homeostasis point the function xo(I1,I2) is topologically equivalent to hyperbolic saddle. The input–output function was numerically computed using xppaut (Ermentrout 2002) and plotted using r (R Core Team 2023)

Classification of homeostasis types

In this section we present the proofs of the main results of the paper.

Reduction to the core network

In this section, unless explicitly stated, we assume that G is a multiple inputs network with input nodes ι1,…,ιn, and inputs I1,…,IN.

The definition of core subnetwork implies that the admissible system of Eqs. (2.17) can be written as4.1 fι1(xι1,…,xιn,xρ,xd,xo,I1,…,IN)=0⋮fιn(xι1,…,xιn,xρ,xd,xo,I1,…,IN)=0fρ(xι1,…,xιn,xρ,xd,xo)=0fu(xι1,…,xιn,xρ,xu,xd,xo)=0fd(xd)=0fo(xι1,…,xιn,xρ,xd,xo)=0

Now we can freeze the variables xd at an appropriate value and obtain an admissible system for Gc from system (4.1).

Lemma 4.1

Suppose that the point X∗=(xι1∗,…,xιn∗,xρ∗,xu∗,xd∗,xo∗) is a linearly stable equilibrium of (4.1). Then the Gc-admissible system obtained from (4.1) by freezing xd at xd∗, given by4.2 x˙ι1=fι1(xι1,…,xιn,xρ,xd∗,xo,I1,…,IN)⋮x˙ιn=fιn(xι1,…,xιn,xρ,xd∗,xo,I1,…,IN)x˙ρ=fρ(xι1,…,xιn,xρ,xd∗,xo)x˙o=fo(xι1,…,xιn,xρ,xd∗,xo)

has a linearly stable equilibrium Xc∗=(xι1∗,…,xιn∗,xρ∗,xo∗).

Proof

Clearly, Xc∗ is an equilibrium of (4.2). As shown in Madeira and Antoneli (2022, Lem 3.1), it is linearly stable. Indeed, the Jacobian matrix J of (4.1) evaluated at X∗ is4.3 J=fι1,xι1⋯fι1,xιnfι1,xρfι1,xd0fι1,xo⋮⋱⋮⋮⋮⋮⋮fιn,xι1⋯fιn,xιnfιn,xρfιn,xd0fιn,xofρ,xι1⋯fρ,xιnfρ,xρfρ,xd0fρ,xo0⋯00fd,xd00fu,xι1⋯fu,xιnfu,xρfu,xdfu,xufu,xofo,xι1⋯fo,xιNfo,xρfo,xd0fo,xo

Therefore, the eigenvalues of J are the same eigenvalues of fd,xd, fu,xu and of the matrix Jc, where4.4 Jc=fι1,xι1⋯fι1,xιnfι1,xρfι1,xo⋮⋱⋮⋮⋮fιn,xι1⋯fιn,xιnfιn,xρfιn,xofρ,xι1⋯fρ,xιnfρ,xρfρ,xofo,xι1⋯fo,xιnfo,xρfo,xo

Since Jc is the Jacobian matrix of (4.2) calculated at Xc∗, it follows that if X∗ is a linearly stable equilibrium then so it is Xc∗. □

Theorem 4.2

Let xo(I) be the input–output function of the admissible system 2.17 for the network G and let xoc(I) be the input–output function of the admissible system (4.2) for the corresponding core network Gc. Then xoc exhibits infinitesimal homeostasis at I∗ if and only if xo exhibits infinitesimal homeostasis at I∗.

Proof

For each weighted homeostasis matrix ⟨HM⟩, we have:4.5 ⟨HM⟩=fι1,xι1⋯fι1,xιnfι1,xρfι1,xd0-fι1,IM⋮⋱⋮⋮⋮⋮⋮fιN,xι1⋯fιN,xιnfιN,xρfιN,xd0-fιN,IMfρ,xι1⋯fρ,xιnfρ,xρfρ,xd000⋯00fd,xd00fu,xι1⋯fu,xιnfu,xρfu,xdfu,xu0fo,xι1⋯fo,xιnfo,xρfo,xd00

Hence, for each 1≤M≤N, we have:4.6 det⟨HM⟩=det(fd,xd)det(fu,xu)det⟨HMc⟩

where4.7 ⟨HMc⟩=fι1,xι1⋯fι1,xιnfι1,xρ-fι1,IM⋮⋱⋮⋮⋮fιn,xι1⋯fιn,xιnfιn,xρ-fιn,IMfρ,xι1⋯fρ,xιnfρ,xρ0fo,xι1⋯fo,xιnfo,xρ0

From Lemma 4.1, we have4.8 det(J)=det(fd,xd)det(fu,xu)det(Jc)

Applying (4.6) and (4.8) to (2.13), we get:4.9 ∇xo=1det(Jc)(det⟨H1c⟩,det⟨H2c⟩,…,det⟨HNc⟩)=∇xoc

Therefore, xo and xoc have exactly the same critical points. □

Classification of pleiotropic homeostasis types

In this sub-section, unless explicitly stated, we assume that G is a core multiple inputs network with input nodes ι1,…,ιn, and inputs I1,…,IN, with n,N≥2.

We shall now study the subnetworks associated to pleiotropic homeostasis blocks. Bearing this in mind, we start by extending the classification of nodes from Madeira and Antoneli (2022).

Definition 4.1

Let G be a multiparameter core network. A directed path connecting nodes ρ and τ is called a simple path if it visits each node on the path at most once.

An ιmo-simple path is a simple path connecting the input node ιm to the output node o.

A node is ιm-simple if it lies on an ιmo-simple path.

A node is ιm-appendage if it is downstream from ιm and it is not an ιm-simple node.

A node is IM-absolutely simple if it is an ιm-simple node, for every m such that fιm,IM≢0.

A node is IM-absolutely appendage if it is an ιm-appendage node, for every m such that fιm,IM≢0.

An ιm-super-simple node is an ιm-simple node that lies on every ιmo-simple path.

An IM-absolutely super-simple node is a node that lies on every ιmo-simple path, for every m such that fιm,IM≢0. ◊

It is immediate that the output node o is an IM-absolutely super-simple node, for all M=1,…,N.

Pleiotropic-appendage homeostasis

To study the structure of pleiotropic-appendage homeostasis, we shall first generalize the concepts of path equivalence and appendage subnetworks employed in Wang et al. (2021), Madeira and Antoneli (2022) to the current context.

Definition 4.2

Let K be a nonempty subnetwork of G. We say that nodes ρi,ρj of K are path equivalent in K (or K-path equivalent) if there are paths in K from ρi to ρj and from ρj to ρi. A K-path component is a path equivalence class in K. ◊

Definition 4.3

The G-complementary subnetwork of an ιmo-simple path S is the subnetwork CS consisting of all nodes of G not on S and all arrows in G connecting those nodes. ◊

Definition 4.4

Let G be a multiparameter core network. For every m=1,…,n, we define the ιm-appendage subnetwork AGm as the subnetwork of G composed by all ιm-appendage nodes and all arrows in G connecting ιm-appendage nodes.

For every M=1,…,N, we define the IM-appendage subnetwork AGIM as the subnetwork of G composed by all IM-absolutely appendage nodes and all arrows in G connecting IM-absolutely appendage nodes. That is, AGIM=⋂1≤m≤n:fιm,IM≢0AGm.

The appendage subnetwork AG is the subnetwork of G composed by nodes which are IM-absolutely appendage, for all M=1,…,N, and the arrows connecting such nodes. That is, AG=⋂1≤M≤NAGIM=⋂1≤m≤nAGm.

Now we can characterize the structure of pleiotropic-appendage homeostasis. Let B be a pleiotropic appendage block. By a similar argument employed in Madeira and Antoneli (2022), we conclude that B must be the jacobian matrix of the corresponding subnetwork KB.

Theorem 4.3

Let KB be a subnetwork of G associated with a pleiotropic-appendage block B. Then the following statements are valid: (i) Each node in KB is an IM-absolutely appendage node, for all M=1,…,N.

(ii) For every ιmo-simple path S, nodes in KB are not CS-path equivalent to any node in CS\KB, for all m=1,…,n;

(iii) KB is a path component of AG.

Proof

Statements (a) and (b) follow by applying (Madeira and Antoneli 2022, Thm 3.11) to each of the core subnetworks GIM. Statement (c) is proved along the same line as (Madeira and Antoneli 2022, Thm 3.11c). □

Now we shall verify that the conditions listed in Theorem 4.3 are also sufficient to guarantee the existence of a pleiotropic-appendage homeostasis block.

Theorem 4.4

Suppose K is a subnetwork of G such that: (i) K is an AG-path component;

(ii) For every ιmo-simple path S, nodes in K are not CS-path equivalent to any node in CS\Kj, for all m=1,…,n.

Then det(JK) is an irreducible factor of h^.

Proof

Apply (Madeira and Antoneli 2022, Thm 3.13) to each of the specialized subnetworks GIm. The validity of condition (b) of (Madeira and Antoneli 2022, Thm 3.13) for each specialized subnetwork GIM follows directly of condition (b) of this theorem. It is then enough to prove that K is a path component of AGIM, for all m=1,…,n. As Kj is a path component of AG=⋂1≤M≤NAGIM, then for each M=1,…,N, there is a AGIM-path component TM such that K⊆TM. By condition (b), it follows that K=TM, for each M=1,…,N. □

Pleiotropic-structural homeostasis

Now we shall study the pleiotropic-structural blocks.

Let VG be the set of nodes of G, VιG the set of nodes that are ιm-super simple, for all m=1,…,n and VIG the set of nodes that are IM-absolutely super-simple, for all M=1,…,N. In Madeira and Antoneli (2022), we introduced the notion of absolutely super-simple nodes with respect to the input nodes. This suggests that we can define absolutely super-simple nodes with respect to the inputs. This leads to the question: Which subset of VG is more suitable to base the characterization of pleiotropic-structural subnetworks:VιG or VIG. The simple, yet paramount, observation that the answer to this question is that both sets are equal.

Lemma 4.5

Let G be a multiple inputs core network. Then VιG=VIG.

Proof

It is enough to verify that VG\VιG=VG\VIG. First, suppose there is a node ρ∈VG\VιG. Then, there is at least one input node ιm such that ρ is not an ιm-super-simple node. As G is a core network, there is an input IM such that fIM,ιm≢0, which implies that ρ is not IM-absolutely super-simple and hence ρ∈VG\VIG. On the other hand, if ρ∉VIG, then there exists M such that ρ is not IM-absolutely super-simple ⇒ρ is not ιm-super-simple, for some m such that fIM,ιm≢0⇒ρ∉VιG. □

The importance of Lemma 4.5 is that it allows us to study the set VιG=VIG through either the characterization with respect to the input nodes or to the inputs, whichever is more convenient. In particular, we can easily extend many of the results obtained in Madeira and Antoneli (2022).

A slightly modification of the argument of Lemma 4.5 shows that the set of nodes that are ιm-simple, for all m=1,…,n, and the set of nodes IM-absolutely simple, for all M=1,…,N, are also equal. These observations justify the generalization of the concept of absolutely simple and absolutely super-simple nodes.

Definition 4.5

Let G be a multiparamete core network. A node ρ is called absolutely super-simple if and only if it is an ιm-super simple node, for all m=1,…,n. Equivalently, ρ is called absolutely super-simple if and only if it is an IM-absolutely super-simple node, for all M=1,…,N.

A node ρ is called absolutely simple if and only if it is an ιm-simple node, for all m=1,…,n. Equivalently, ρ is called absolutely simple if and only if it is an IM-absolutely simple node, for all M=1,…,N. ◊

Following Madeira and Antoneli (2022), we now define a total order relation in the set of absolutely super-simple nodes.

Definition 4.6

Let G be a multiparamete core network. Define a relation on VιG=VIG as follows: for any pair of nodes σ,τ∈VιG=VIG, σ≠ρ, we write σ>ρ when ρ is downstream from σ by all ιmo-simple paths, for any m=1,…,n. ◊

Lemma 4.6

The relation on VιG=VIG given in Definition 4.6 is a total order.

Proof

This result is analogous to (Madeira and Antoneli 2022, Lem 3.15) □

Consider now the ordered elements of VιG: ρ1>ρ2>⋯>ρp>o. Similarly to Wang et al. (2021); Madeira and Antoneli (2022), we say that two elements ρk>ρk+1 of VιG are adjacent when ρk+1 is the first element of VιG which appears after ρk in that ordering. We can now use this concept to introduce the elements that are crucial to characterise pleiotropic-structural homeostasis blocks.

Definition 4.7

Let ρk>ρk+1 be adjacent elements of VιG. An ιm-absolutely simple node ρ is between ρk and ρk+1 if there exists an ιwo-simple path that includes ρk to ρ to ρk+1 in that order, for some w=1,…,n. ◊

The idea is to construct the structural subnetworks employing the concepts above, as it was done in Wang et al. (2021); Madeira and Antoneli (2022).

The absolutely super-simple subnetwork, denoted L(ρk,ρk+1), is the subnetwork whose nodes are absolutely simple nodes between ρk and ρk+1 and whose arrows are arrows of G connecting nodes in L(ρk,ρk+1). As we can characterise the absolutely super-simple and absolutely simple nodes (and consequently the absolutely super-simple subnetworks) with respect to each input node, we can construct the basic unit of pleiotropic-structural homeostasis in the same way the basic unit of structural homeostasis was constructed in Madeira and Antoneli (2022).

Definition 4.8

Let ρk and ρk+1 be adjacent absolutely super-simple nodes in G. The absolutely super-simple structural subnetwork L′(ρk,ρk+1) is the input–output subnetwork consisting of nodes in L(ρk,ρk+1)∪B, where B consists of all absolutely appendage nodes that are CSm-path equivalent to nodes in L(ρk,ρk+1) for some ιmo-simple path Sm, for some m∈{1,…,n}. That is, B consists of all AG-path components Bi that are CSm-path equivalent to nodes in L(ρk,ρk+1) for some Sm, for some m∈{1,…,n}. Arrows of L′(ρk,ρk+1) are arrows of G that connect nodes in L′(ρk,ρk+1). Note that ρk is the input node and that ρk+1 is the output node of L′(ρk,ρk+1). ◊

We shall employ the characterisation of super-simple structural subnetworks with respect to each of the input nodes. This was the strategy employed in Madeira and Antoneli (2022), and hence we will be able to apply directly the results contained in Madeira and Antoneli (2022, Sect. 3.4.2) to the case of networks with multiple inputs.

First, for ρk and ρk+1 adjacent ιm-super-simple nodes in the core subnetwork Gm, define as in Madeira and Antoneli (2022) the ιm-super-simple structural subnetwork Lm′(ρk,ρk+1) as the input–output subnetwork consisting of nodes in Lm(ρk,ρk+1)∪Bm, where Bm consists of all ιm-appendage nodes that are CmSm-path equivalent to nodes in Lm(ρk,ρk+1) for some ιmo-simple path Sm. As usual, arrows of Lm′(ρk,ρk+1) are arrows of Gm that connect nodes in Lm′(ρk,ρk+1).

We notice that (Madeira and Antoneli 2022, Lemma 3.21) is still valid in the current context. Hence, we obtain the following.

Lemma 4.7

Let ρk>ρk+1 be two adjacent absolutely super-simple nodes. Then Lm′(ρk,ρk+1)=L′(ρk,ρk+1), for every m=1,…,n.

Theorem 4.8

Let KB be a subnetwork of G associated with a pleiotropic-structural block B. Then G has adjacent absolutely super-simple nodes ρk and ρk+1 such that KB=L′(ρk,ρk+1).

Proof

If B is an irreducible pleiotropic-structural block, then it is a structural block associated to each specialized subnetwork GIM. Fix an input IM and consider the corresponding specialized subnetwork GIM. By Madeira and Antoneli (2022, Thm 3.22), (Golubitsky and Wang 2020, Thm 6.11) and Lemma 4.7, this implies that there exist ιm-absolutely super-simple nodes ρkM and ρkM+1 such that KB=Lm′(ρkM,ρkM+1) for all m such that ιm is an input node of the specialized subnetwork GIM. Now, as the input and output nodes of all these networks must be the same, we conclude that there exist absolutely super-simple nodes ρk,ρk+1 such that for all m=1,…,n, KB=Lm′(ρk,ρk+1). By Lemma 4.7, this means that KB=L′(ρk,ρk+1). □

The argument in the proof of Theorem 4.8 suggests that, as in the case of input–output networks with only one input (Madeira and Antoneli 2022; Golubitsky and Wang 2020), a multiple inputs input–output network supports pleiotropic-structural homeostasis whenever there are more than one absolutely super-simple node.

Theorem 4.9

If G has absolutely super-simple nodes other than the output node, then each absolutely super-simple structural subnetwork corresponds to a pleiotropic-structural homeostasis subnetwork.

Proof

Consider the adjacent absolutely super-simple nodes ρk,ρk+1 in G. By Lemma 4.5, for every m=1,…,n, we have Lm′(ρk,ρk+1)=L′(ρk,ρk+1). As proved in Madeira and Antoneli (2022, Cor 3.23), this means that the homeostasis matrix of L′(ρk,ρk+1) is an irreducible structural homeostasis subnetwork of each IM-specialized subnetwork GIM. Therefore the homeostasis matrix of L′(ρk,ρk+1) is an irreducible pleiotropic-structural homeostasis subnetwork. □

Conclusion and outlook

In this paper, we present a framework for the analysis and classification of homeostasis types multiple input single output networks. We accomplish this by generalizing and extending the results of Wang et al. (2021) and Madeira and Antoneli (2022) for the classification of homeostasis types in single-input networks single-output networks. Wang et al. (2021) treat the case where the single input parameter affects a single input node and Madeira and Antoneli (2022) consider the case where the single input parameter may affect multiple input nodes.

In the terminology of Golubitsky and Stewart (2022) our theory is an example of a model independent approach. This means that the classification results obtained here provide a complete list of possible behaviors, with respect to homeostasis, that is independent of the model equations—the list depends only on the topology of the network. Which of those behaviors will be observed in a particular realization of the dynamics (e.g. a model equation) depends on the specific form of the dynamics.

We illustrate the application of the theory in several examples. In Sect. 2.9, Example 2.15, we analyze the simplest class of multiple inputs networks: the two inputs, three node networks, where each input node is affected by exactly one input parameter (see Fig. 3). In Example 2.16 we have a two inputs, three node network violating this condition—namely, with more than one input parameter affecting the same input node (see Fig. 4). Finally, in Sect. 3 we consider a biologically realistic model for the co-regulation of calcium and phosphate (Granjon et al. 2017) (see Fig. 5).

In three of the eight networks in Fig. 3—cases (b), (e) and (f)—and the network in Fig. 4, we found the ‘simultaneous occurrence’ of infinitesimal homeostasis and steady-state bifurcation, for certain coincidental homeostasis types (see Remark 2.17). Strictly speaking, this kind of behavior is forbidden by definition, because at a bifurcation point the input–output function becomes ill-defined. However, it is possible, in certain situations, to extend the definition of input–output function to allow for the presence of singular points (see Duncan et al. 2018; Duncan and Golubitsky 2019). These extensions of the notion of homeostasis open up the door for a rich variety of phenomena. For instance, in Mulukutla et al. (2014) the authors investigate glycolysis metabolism and discover a switch mechanism based on a bistability phenomena occurring simultaneously with homeostasis.

The systematic blending of homeostasis and steady-state bifurcations seems to be a promising research avenue. In this regard, the infinitesimal homeostasis approach has some benefit due to its singularity theoretic flavor and the fact that there exists a mature theory of bifurcations based on singularity theory (Golubitsky and Schaeffer 1985; Golubitsky et al. 1988). In fact, Duncan and Golubitsky (2019) is, in part, an attempt to explain the observations of Mulukutla et al. (2014) using singularity theory to uncover the ‘interaction’ between homeostasis and steady-state bifurcations.

In our examples it seems that the interaction between homeostasis and steady-state bifurcations is ‘caused’ by the overlapping of the subnetworks associated to certain coincidental blocks in distinct components of the vector determinant. This is distinct from the phenomena discovered in Duncan et al. (2023), where it is shown that an interaction between homeostasis and steady-state bifurcations may occur already in single input node, single input parameter networks.

Regarding the classification of homeostasis types, we were able to completely characterize the pleiotropic homeostasis types and have provided necessary and sufficient conditions for its occurrence (Sect. 4). The main result essentially says that pleiotropic homeostasis types are exactly the homeostasis types that occur in single input parameter, single input node networks.

As for the coincidental homeostasis type, the situation is much more complex. On one hand, were able to obtain some sufficient conditions for its occurrence (see Proposition 2.9). On the other hand, we have given examples where only pleotropic types can occur (Proposition  2.6) and examples where only coincidental types can occur (Example 2.16, cases (a), (b), (c), (d), (f) and the network for calcium and phosphate homeostasis). Furthermore, by Proposition  2.8 any core network must have at least one homeostasis type. Which implies that if there is no coincidental homeostasis type the all homeostasis types must be pleiotropic. All these considerations suggest that a necessary and sufficient condition for occurrence of coincidental types seems rather elusive (see Remark 2.14) and is an important open problem at the moment.

Acknowledgements

We thank Martin Golubitsky, Ian Stewart, Yangyang Wang, Zhengyuan Huang, Will Duncan, Jiaxin Jin, Pedro Cardoso de Andrade and Misaki Yamada for helpful conversations. The research of JLOM and FA was supported by Fundação de Amparo à Pesquisa do Estado de São Paulo (FAPESP) grant 2019/12247-7. FA is also supported by Fundação de Amparo à Pesquisa do Estado de São Paulo (FAPESP) grant 2019/21181-0. JLOM is also supported by a scholarship from the EPSRC Centre for Doctoral Training in Statistical Applied Mathematics at Bath (SAMBa), under the project EP/S022945/1.

Publisher's Note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
==== Refs
References

Aguiar MAD Dias APS Synchronization and equitable partitions in weighted networks Chaos 2018 28 7 073105 30070529
Ang J McMillen DR Physical constraints on biological integral control design for homeostasis and sensory adaptation Biophys J 2013 104 2 505 515 23442873
Antoneli F, Best J, Golubitsky M, Jin J (2023) Homeostasis in networks with same input and output nodes. In preparation
Antoneli F Golubitsky M Stewart I Homeostasis in a feed forward loop gene regulatory motif J Theor Biol 2018 445 103 109 29477558
Antoneli F Stewart I Right network-preserving diffeomorphisms. J Singul 2022 25 1 29
Aoki SK Lillacci G Gupta A Baumschlager A Schweingruber D Khammash M A universal biomolecular integral feedback controller for robust perfect adaptation Nature 2019 570 7762 533 537 31217585
Araujo RP Liotta LA The topological requirements for robust perfect adaptation in networks of any size Nat Commun 2018 9 1 1757 29717141
Best JA Nijhout HF Reed MC Homeostatic mechanisms in dopamine synthesis and release: a mathematical model Theor Biol Med Modell 2009 6 1 21
Bhattacharya P Raman K Tangirala AK Marchisio MA Systems-theoretic approaches to design biological networks with desired functionalities Computational methods in synthetic biology 2021 New York Springer 133 155
Bhattacharya P Raman K Tangirala AK Discovering adaptation-capable biological network structures using control-theoretic approaches PLoS Comput Biol 2022 18 1 1 28
Bhattacharya P Raman K Tangirala AK On biological networks capable of robust adaptation in the presence of uncertainties: A linear systems-theoretic approach Math Biosci 2023 358 108984 36804384
Bick C Gross E Harrington HA Schaub MT What are higher-order networks? SIAM Rev 2023 65 3 686 731
Blaine J Chonchol M Levi M Renal control of calcium, phosphate, and magnesium homeostasis Clin J Am Soc Nephrol 2015 10 7 1257 25287933
Blanchini F Colaneri P Giordano G Zorzan I Vertex results for the robust analysis of uncertain biochemical systems J Math Biol 2022 85 4 35 36123409
Brualdi RA Cvetkoić DM A Combinatorial approach to matrix theory and its applications 2009 Florida Chapman & Hall/CRC Press
Clausznitzer D Oleksiuk O Løvdok L Sourjik V Endres RG Chemotactic response and adaptation dynamics in Escherichia coli PLoS Comput Biol 2010 6 5 1 11
Donovan GM Numerical discovery and continuation of points of infinitesimal homeostasis Math Biosci 2019 311 62 67 30878361
Duncan W, Antoneli F, Best J, Golubitsky M, Reed M, Stewart I, Nijhout F (2023) Homeostasis mode interactions. In preparation
Duncan W Best J Golubitsky M Nijhout H Reed M Homeostasis despite instability Math Biosci 2018 300 130 137 29596852
Duncan W Golubitsky M Coincidence of homeostasis and bifurcation in feedforward networks Int J Bifurcat Chaos 2019 29 13 1930037
Ermentrout GB Simulating, analyzing, and animating dynamical systems: a guide to XPPAUT for researchers and students 2002 Philadelphia SIAM
Ferrell JE Perfect and near-perfect adaptation in cell signaling Cell Syst 2016 2 2 62 67 27135159
Frei T Khammash M Adaptive circuits in synthetic biology Curr Opin Syst Biol 2021 28 100399
Golubitsky M Schaeffer D Singularities and groups in bifurcation theory 1985 New York Springer
Golubitsky M Stewart I Newton P Holmes P Weinstein A Patterns of oscillation in coupled cell systems Geometry, mechanics, and dynamics 2002 New York Springer 243 286
Golubitsky M Stewart I Nonlinear dynamics of networks: the groupoid formalism Bull Am Math Soc 2006 43 3 305 364
Golubitsky M Stewart I Coordinate changes for network dynamics Dyn Syst 2017 32 1 80 116
Golubitsky M Stewart I Homeostasis, singularities, and networks J Math Biol 2017 74 1–2 387 407 27255135
Golubitsky M Stewart I Homeostasis with multiple inputs SIAM J Appl Dyn Sysy 2018 17 2 1816 1832
Golubitsky M Stewart I Dynamics and bifurcation in networks - theory and applications of coupled differential equations 2022 Philadelphia SIAM
Golubitsky M Stewart I Antoneli F Huang Z Wang YY Junge O Ober-Blobaum S Padburg-Gehle K Froyland G Schütze O Input-output networks, singularity theory, and homeostasis Advances in dynamics, optimization and computation 2020 Cham Springer 36 65
Golubitsky M Stewart I Schaeffer D Singularities and groups in bifurcation theory 1988 New York Springer
Golubitsky M Wang Y Infinitesimal homeostasis in three-node input-output networks J Math Biol 2020 80 1163 1185 31919651
Govaerts W Numerical methods for bifurcations of dynamical equilibria 2000 Philadelphia SIAM
Granjon D Bonny O Edwards A Coupling between phosphate and calcium homeostasis: a mathematical model Am J Physiol Renal Physiol 2017 313 6 F1181 F1199 28747359
Gross E Harrington H Meshkat N Shiu A Linear compartmental models: input-output equations and operations that preserve identifiability SIAM J Appl Math 2019 79 4 1423 1447
Gupta A Khammash M Universal structural requirements for maximal robust perfect adaptation in biomolecular networks Proc Natl Acad Sci USA 2022 119 43 e2207802119 36256812
Huang Z Golubitsky M Classification of infinitesimal homeostasis in four-node input-output networks J Math Biol 2022 84 4 1 19
Hunt BR Sauer T Yorke JA Prevalence: a translation-invariant “almost every” on infinite-dimensional spaces Bull Am Math Soc 1992 27 2 217 238
Jahedi S Sauer T Yorke JA Robustness of solutions of almost every system of equations SIAM J Appl Math 2022 82 5 1791 1807
Khammash MH An engineering viewpoint on biological robustness BMC Biol 2016 14 1 1 11 26728391
Khammash MH Perfect adaptation in biology. Cell Syst. 2021 12 6 509 521 34139163
Kitano H Biological robustness Nat Rev Genet 2004 5 11 826 837 15520792
Kitano H Bringmann P Butcher EC Parry G Weiss B The theory of biological robustness and its implication in cancer Systems biology 2007 Berlin, Heidelberg Springer 69 88
Kitano H Towards a theory of biological robustness Mol Syst Biol 2007 3 1 137 17882156
Lloyd AC The regulation of cell size Cell 2013 154 1194 24034244
Ma W Trusina A El-Samad H Lim WA Tang C Defining network topologies that can achieve biochemical adaptation Cell 2009 138 4 760 773 19703401
Madeira JLO Antoneli F Homeostasis in networks with multiple input nodes and robustness in bacterial chemotaxis J Nonlinear Sci 2022 32 3 1 53
Mello BA Tu Y Perfect and near-perfect adaptation in a model of bacterial chemotaxis Biophys J 2003 84 5 2943 2956 12719226
Melmed S Polonsky KS Larsen PR Kronenberg HM Williams textbook of endocrinology E-Book 2015 Amsterdam Elsevier
Morrison PR Temperature regulation in three central American mammals J Cell Comp Physiol 1946 27 125 137 20992047
Mulukutla BC Yongky A Daoutidis P Hu W-S Bistability in glycolysis pathway as a physiological switch in energy metabolism PLoS ONE 2014 9 6 1 12
Nijhout HF Best J Reed MC Systems biology of robustness and homeostatic mechanisms WIREs Syst Biol Med 2018 11 e1440
Nijhout HF Best JA Reed MC Using mathematical models to understand metabolism, genes and disease BMC Biol 2015 13 79 26400419
Nijhout HF Best JA Reed MC Systems biology of robustness and homeostatic mechanisms WIREs Syst Biol Med 2019 11 3 e1440
Nijhout HF Reed MC Homeostasis and dynamic stability of the phenotype link robustness and plasticity Integr Comput Biol 2014 54 2 264 275
Nijhout HF Reed MC Budu P Ulrich CM A mathematical model of the folate cycle: new insights into folate homeostasis J Biol Chem 2004 279 55008 55016 15496403
Nijhout HF Sadre-Marandi F Best J Reed MC Systems biology of phenotypic robustness and plasticity Integr Comput Biol 2017 57 2 171 184
Ott W Yorke J Prevalence. Bull Am Math Soc 2005 42 3 263 290
R Core Team R: a language and environment for statistical computing 2023 Vienna, Austria R Foundation for Statistical Computing
Reed M Best J Golubitsky M Stewart I Nijhout HF Analysis of homeostatic mechanisms in biochemical networks Bull Math Biol 2017 79 11 2534 2557 28884446
Schneider H The concepts of irreducibility and full indecomposability of a matrix in the works of Frobenius König and Markov Lin Alg Appl 1977 18 139 162
Stearns FW One hundred years of pleiotropy: a retrospective Genetics 2010 186 3 767 773 21062962
Tang ZF McMillen DR Design principles for the analysis and construction of robustly homeostatic biological networks J Theor Biol 2016 408 274 289 27378006
Thom R Topological models in biology Topology 1969 8 3 313 335
Thom R Structural stability and morphogenesis 1975 W.A., New York Benjamin Inc
Thom R Structural stability, catastrophe theory, and applied mathematics SIAM Rev 1977 19 2 189 201
Tindall M Maini P Porter S Armitage J Overview of mathematical approaches used to model bacterial chemotaxis II: bacterial populations Bull Math Biol 2008 70 6 1570 1607 18642047
Wang Y Huang Z Antoneli F Golubitsky M The structure of infinitesimal homeostasis in input-output networks J Math Biol 2021 82 62 34021398
Wyatt JK Cecco AR-D Czeisler CA Dijk D-J Circadian temperature and melatonin rhythms, sleep, and neurobehavioral function in humans living on a 20-h day Am J Physiol 1999 277 1152 1163
Yu Z Thomas PJ A homeostasis criterion for limit cycle systems based on infinitesimal shape response curves J Math Biol 2022 84 4 1 23
