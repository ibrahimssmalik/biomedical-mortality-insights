
==== Front
J Chem Inf Model
J Chem Inf Model
ci
jcisd8
Journal of Chemical Information and Modeling
1549-9596
1549-960X
American Chemical Society

38804973
10.1021/acs.jcim.4c00421
Article
Learning Electronic Polarizations in Aqueous Systems
Jana Arnab †
https://orcid.org/0000-0003-1741-4093
Shepherd Sam †
https://orcid.org/0000-0002-6890-4052
Litman Yair ‡
https://orcid.org/0000-0003-3739-5512
Wilkins David M. *†
† Centre for Quantum Materials and Technologies, School of Mathematics and Physics, Queen’s University Belfast, Belfast BT7 1NN, U.K.
‡ Yusuf Hamied Department of Chemistry, University of Cambridge, Lensfield Road, Cambridge CB2 1EW, U.K.
* Email: d.wilkins@qub.ac.uk.
28 05 2024
10 06 2024
64 11 44264435
12 03 2024
14 05 2024
10 05 2024
© 2024 The Authors. Published by American Chemical Society
2024
The Authors
https://creativecommons.org/licenses/by/4.0/ Permits the broadest form of re-use including for commercial purposes, provided that author attribution and integrity are maintained (https://creativecommons.org/licenses/by/4.0/).

The polarization of periodically repeating systems is a discontinuous function of the atomic positions, a fact which seems at first to stymie attempts at their statistical learning. Two approaches to build models for bulk polarizations are compared: one in which a simple point charge model is used to preprocess the raw polarization to give a learning target that is a smooth function of atomic positions and the total polarization is learned as a sum of atom-centered dipoles and one in which instead the average position of Wannier centers around atoms is predicted. For a range of bulk aqueous systems, both of these methods perform perform comparatively well, with the former being slightly better but often requiring an extra effort to find a suitable point charge model. As a challenging test, we also analyze the performance of the models at the air–water interface. In this case, while the Wannier center approach delivers accurate predictions without further modifications, the preprocessing method requires augmentation with information from isolated water molecules to reach similar accuracy. Finally, we present a simple protocol to preprocess the polarizations in a data-driven way using a small number of derivatives calculated at a much lower level of theory, thus overcoming the need to find point charge models without appreciably increasing the computation cost. We believe that the training strategies presented here help the construction of accurate polarization models required for the study of the dielectric properties of realistic complex bulk systems and interfaces with ab initio accuracy.

Queen''s University Belfast 10.13039/501100000873 NA Deutsche Forschungsgemeinschaft 10.13039/501100001659 467724959 document-id-old-9ci4c00421
document-id-new-14ci4c00421
ccc-price
==== Body
pmc1 Introduction

The polarization P of a condensed-phase system determines its coupling with an electric field, underpinning such diverse physical phenomena as linear1 and nonlinear spectroscopy,2,3 interactions between surfaces and adsorbates,4 and domain wall conductivity.5,6 To disentangle the information contained within experimental results, it is commonplace to supplement them with computer simulations.4,7−10 However, computing the polarization requires quantum-mechanical calculations, which can be highly sensitive to the level of theory used.8 Over the past few years, it has also become standard to use machine-learning (ML) methods to circumvent the need for costly quantum-mechanical calculations, with ML potentials (MLPs) for the energies and forces in a system11−13 and ML multipole moment surfaces (ML-MMSs) for the response to electric fields10,14−58 saving enormous amounts of time and effort and making it possible to tackle highly complex systems.

It is well-known that there are subtleties in the calculation of electronic polarizations in periodic systems, which due to periodic boundary conditions (PBCs) are only defined modulo a “quantum of polarization” Q, proportional to the system’s unit cell.19,20 This means that the elements of the reduced polarization p = Q–1P are between −1/2 and +1/2. In practice, this means that p is a discontinuous function of the atomic coordinates, as a small change in positions may lead to elements of p going from ±1/2 to ∓1/2. A few methods have been given in the literature to overcome this problem and make it possible to learn the polarization: For systems containing pure water, it is possible to add integer values to p so that it agrees as well as possible with the results of a simple point charge model.10,15,21 However, this approach requires the availability of a reference model. Gigli et al. note that the derivatives of the polarization (i.e., the Born effective charges) can be used to render P a smooth function of atomic positions in the case of solids.9 Zhang et al. advocate learning the positions of Wannier centers in a system,17 which requires no preprocessing of data but does require that the Wannier centers are available within the data set. This approach also requires a well-defined way to assign Wannier centers to individual atoms, which may not be the case for molecules in which electrons are shared more evenly between atoms.

In this paper, we present ML models to predict the polarization of aqueous systems and compare their performance in bulk water as well as in more challenging scenarios such as the air–water interface and concentrated electrolyte solutions, in which long-ranged electrostatic effects are important. We focus on two learning strategies: In the first one, we use surrogate point charge models to render the polarization a smooth function of positions, while in the second one, we learn the positions of Wannier functions. We show that both methods lead to very accurate models for P, with the former method performing slightly better for a large number of training points but requiring additional preprocessing for electrostatically complex systems. Learning the average positions of Wannier centers works better “out-of-the-box”, though only for cases where every atom of the same element is assigned the same number of Wannier centers.

We further show that even when a straightforward molecular model with point charges is not available, it is possible to generate a polarization that is a smooth function by using a data-driven approach that requires a small number of polarization derivatives with respect to atomic positions, known as Born effective charges (BEC), which are always continuous in the positions. Since the BEC can be computed at a lower level of theory than the original polarizations, even if they are not provided with the data set, their calculation requires a minor computational overhead. The remainder of this manuscript is organized as follows: In Section 2, we introduce the error function used in this work and describe the different training strategies as well as the employed data sets. In Section 3, we start by presenting the results for bulk water, followed by the study of the air–water interface, where we predict the interfacial dielectric constant and the analysis of concentrated NaCl aqueous solutions. In Section 3.4, we propose and benchmark a data-driven unwrapping procedure based on BECs, and in Section 4, we conclude the manuscript with closing remarks and a future outlook.

2 Computational Details

2.1 Error Functions for Periodic Data

When all the predicted polarizations are very similar to the target values modulo the quantum of polarization, we can use the root mean squared error (RMSE), which will allow comparison with other methods in the literature. That is,1

where Picalc is the calculated polarization for the ith training structure, Pipred is the predicted value, Qi is the quantum of polarization for this structure, and ni is a vector containing three integers. The notation “minni” indicates that the vector ni minimizing each term should be taken.

However, in the general case, we note that a more appropriate error function for gauging predictions of circular data is the von Mises function,222

where Ntr is the number of training points, pi, jcalc is the jth Cartesian component of the calculated p for testing structure i, and pi, jpred is the prediction of a model. The von Mises error is unchanged when any integer ni,j is added to pi, jcalc, reflecting the fact that the components of p are only defined up to an additive integer.

2.2 Preprocessing Polarization Data

For systems that can be described well as neutral molecular units, it is possible to find a set of integers ni for each training point i such that a small change in the positions leads to a small change in the polarization. The polarization for these systems can be approximated straightforwardly as the sum of the molecular dipole moments Pmol = ∑j=1μj, where μj is the dipole moment of the jth molecule. Each individual dipole moment is a smooth function of atomic positions, meaning that Pmol is also a smooth function. We then preprocess the data by finding the vector of integers ni for the ith frame such that3

is minimized, where Pi is the calculated polarization for the ith frame and Pimol is the sum of molecular dipole moments. By making the replacement Pi → Pi + Qini, we render the polarization a smooth function of the atomic positions while retaining the correct physics. This approach was used to build the μH2O model,21 which has been used to accurately model linear and nonlinear vibrational spectra of pure water.10,21,23

Since the only requirement of a reference model for the molecular dipole moments is that the prediction Pimol should correlate well with the unwrapped Pi + Qini, we are free to choose a model based on simple point charges. Since a fairly wide range of atomic charges will lead to the same set of integers ⟨ni⟩, we expect the models to be quite robust to the exact values used for the atomic charges; we will test this robustness along with the method. In some cases, we will also use the prediction of the reference model as a baseline to be subtracted from the training data. Once the polarizations have been processed, they can be learned with the symmetry-adapted Gaussian process regression (SA-GPR) approach,15,24 in which the polarization of a bulk system is predicted as a sum of atom-centered dipole contributions. In this work, we will use two different types of vector kernel as appropriate: For all systems, we will use the standard short-ranged λ-SOAP (smooth overlap of atomic positions) kernel, which is a generalization of the SOAP kernel25 to learn spherical tensors of order λ = 1. In cases where the polarization may be affected by long-ranged effects, we will also use the λ-LODE (long-range density equivariant) kernel,26 which generalizes the LODE kernel27 and includes nonlocal information into the learning process.

2.3 Learning Wannier Displacement

The polarization of a bulk system is given formally by204

where Ri is the position of the ith atom, eZi is its nuclear charge, and rjW is the position of the jth Wannier center, where it is assumed that all Wannier orbitals are fully occupied. If the Wannier centers can be assigned to atoms, then5

where ∑j∈ i refers to a sum over all centers assigned to atom i, δij = rjW – Ri is the displacement from the ith nucleus to the jth Wannier center, and Zi′ = Zi – ∑j∈ i 2. An alternative model for the polarization, as suggested by Zhang et al., is to predict Δi = ∑j∈ iδij for each atom to which Wannier centers are assigned.17 We train models for this property using standard SA-GPR, where the training set consists of local environments and their respective Δi values, and predictions are made for a new local environment using its λ = 1-SOAP kernel with the environments in the training set. P can then be predicted for a system via eq 5, using the Δi predicted for each environment and the Zi′, which can be computed once the number of Wannier centers assigned to each atom is known.

In ref (17), the Δi is predicted using neural networks; here, we predict the individual atomic Δi using SA-GPR. For the systems we will consider in this paper, the number of Wannier centers NiW = ∑j∈ i assigned to atom i is always either 0 (in the case of H atoms) or 4 (for heavier atoms). In future work focusing on more complex systems, such as those in which there is covalent bonding between atoms that have a more even share of electron density than does the O–H bond, the number of Wannier centers assigned to an atom may depend not only on the atom’s identity but also on its local environment.

2.4 Data Set Details

The models we generate in this paper are described by three strings, one describing the type of system, one the type of data that was learned, and one the descriptor type. The type of system is one of,bulk water (H2O–B),

interfacial water (H2O–I), and

concentrated sodium chloride solution (NaCl);

the type of data learned is one of,data preprocessed using a point charge model (PP),

data preprocessed using a point charge model, with additional data on molecular dipole moments included during training (PP-M),

data preprocessed using a point charge model and then baselined against the prediction of the model (PP-B), and

average displacement of Wannier centers (W);

and the type of descriptor is one of,short-range λ-SOAP descriptor (SR) and

long-range λ-LODE descriptor (LR).

Each model is then described by concatenating the three strings as SYSTEM_DATA_DESCRIPTOR; for example, H2O–B_PP_SR is a model trained on the preprocessed polarizations of frames of bulk water, using a short-ranged λ-SOAP descriptor. The Supporting Information gives example input files used to calculate the polarizations of these systems.

3 Results and Discussion

3.1 Bulk Water

We began by studying pure bulk water, for which short-ranged ML models perform very well as MLPs28−31 and ML-MMSs.15,17,21 Using a set of 1000 frames each containing 32 water molecules, we tested the data preprocessing approach, for which the partial charges of the SPC/E model32 were used to provide molecular dipole moments. We also predicted Wannier displacements, with each Wannier center assigned to the nearest O atom; this resulted in each O atom being assigned 4 Wannier centers. Figure 1a shows learning curves of the von Mises error in predicting the polarizations of 200 bulk water frames using either the data preprocessing (H2O–B_PP_SR) or the Wannier displacement approach (H2O–B_W_SR), as a function of the number of frames used to train the model.

Figure 1 (a) Learning curves for the polarization P of bulk water systems, with the total polarization either learned directly using preprocessed data (H2O–B_PP_SR, solid red line) or calculated by predicting the average vector separation of Wannier centers from the oxygen atoms (H2O–B_W_SR, dashed black line). (b) Scatterplot of partially resummed dipole moments from the H2O–B_PP_SR model, comparing the prediction of the atom-centered dipole model with the calculated Wannier dipoles. (c) Histograms of molecular dipole moment magnitudes from calculated Wannier centers (dashed black line) and from H2O–B_PP_SR predictions (solid red lines). Gray shaded area shows the experimental confidence interval for the dipole moment magnitude.33

For a small number of training points, the H2O–B_W_SR model has a better performance than the H2O–B_PP_SR, but the error using the latter method decreases much more quickly with the number of frames, and this approach performs better for more than 500 frames. Both techniques give excellent predictions of the polarization: The corresponding RMSEs are equal to 1.3% of the intrinsic deviation in the data set for the preprocessing approach and 1.8% for the Wannier center approach. In ref (17), the average Wannier displacement assigned to the O atoms in water was learned using deep neural networks, with an RMSE of 0.032 D for the molecular dipole moments, using 95,000 training frames with 64 molecules each. Despite using ∼200 times fewer data points, our models give an RMSE of 0.053 D per molecule, indicating a very similar performance.

For the data preprocessing method, the H atoms were assigned a partial charge of qH = +0.4238 e, where e is the electron charge, and the O atoms were assigned a partial charge of qO = −2qH, as per the original SPC/E model.32 Because this processing involves rounding the elements of Qi–1(Pi – Pimol) to the nearest integer, it is possible to vary qH between +0.3 e and +0.7 e and obtain the same training data. This suggests that the processing is extremely robust to the point charge model used and that the user is free to process their training data with whichever model is most convenient.

Given the importance of molecular dipole moments in modeling the results of experiments such as sum-frequency generation,34−38 it is worth investigating further the molecular dipoles that are given by the two approaches we have studied. In each case, we obtain atom-centered properties, which can be partially summed over all atoms in a molecule. Figure 1b compares the components of these molecular dipole moments from the predicted atom-centered dipole moments trained using preprocessed data with the calculated Wannier centers from density functional theory (DFT). Despite the fact that the model is trained on total polarizations P and the splitting into molecular dipole moments is purely data-driven, the correlation between the two is remarkably good. Histograms of the magnitudes of molecular dipole moments from the predictions and from the calculations are shown in Figure 1c: While the dipole moments predicted by SA-GPR have a broader distribution than those calculated using Wannier centers, both have their average at 2.89 D, which is within the experimental error bars.33 While the correlation between the dipole moments is fortunate and justifies the use of partially resummed molecular dipole predictions in calculating SFT spectra,10 there is no reason to believe a priori that this correlation will exist for general systems. Instead, the results of a model should be checked on a case-by-case basis before using them to make further predictions.

3.2 Air–Water Interface

A more challenging test of the two methods for learning polarizations is given by the air–water interface, an anisotropic slab system that contains a dielectric boundary: this means that not only are the local environments much more varied than in bulk water but also we might expect long-ranged electrostatic effects to be more important. Indeed, MLPs for aqueous interfaces that are based on short-ranged descriptors tend to give a poorer description of the spatial and orientational structure than do those in which long-ranged information is accounted for by learning the positions of partial charges.39,40

In Figure S1 in the Supporting Information, we show learning curves for the polarizations of water slabs, using a data set comprising 1000 frames with 128 water molecules each and with the two approaches applied to the bulk system; with the largest training set size, the von Mises error for predicting the preprocessed polarization is 7.5 × 10–3 (i.e., 13 times as large as for bulk water) and learning the Wannier displacement Δ the error is 5.4 × 10–3 (i.e., 8 times as large as for bulk water), albeit with an error that saturates very quickly as a function of the number of training points. In both cases, the errors are significantly larger than observed for bulk systems, likely reflecting the fact that interfacial systems are more complex, with a wider variety of local environments. In this case, the model based on learning the Wannier displacements performs slightly better, although as in the case of bulk water, the two have a very similar performance.

Figure 2a compares the molecular dipole moments predicted by an SA-GPR model trained on the (preprocessed) total polarization of water slabs (H2O–I_PP_SR), with the molecular dipole moments obtained from calculating the positions of Wannier centers with DFT. In contrast to the case of bulk water, the H2O–B_PP_SR model gives very different molecular dipole moments than those calculated using Wannier centers. Although the dipole moment at the center of the slab is within the (large) experimental error bars,33 there is a statistically significant difference between the model’s predictions and the calculations, with the model trained on preprocessed data consistently giving smaller dipole moments than those predicted using Wannier centers.

Figure 2 (a) Average molecular dipole moment as a function of distance from the center of a slab of water; solid black lines show the predictions from the calculated Wannier centers; dashed blue lines show the partially resummed results of SA-GPR models of total polarizations trained on water slabs (H2O–I_PP_SR); dotted red lines show the results of total polarization models trained on bulk water (H2O–B_PP_SR); and dash-dotted orange lines show the results of models trained on the total polarization of water slabs alongside molecular dipole moments calculated using point charges (H2O–I_PP-M_SR). Dashed vertical line shows the position of the Gibbs dividing surface. (b) Local perpendicular dielectric constant ϵ⊥ as a function of distance from the slab center. Here, the solid black line is computed using Wannier centers predicted from an SA-GPR model (H2O–I_W_SR).

In ref (10), it was shown that a model trained only on bulk water configurations gave a very good description of the SFG spectrum of the air–water interface. To gain more insight into this perhaps surprising success, we also show in Figure 2a the average molecular dipole moments for a model trained only on bulk polarizations. Indeed, the distribution of molecular dipole moments in the bulk, where the model was trained, matches very well with the Wannier center predictions; closer to the interface, this agreement is much less good. The interfacial dipole moments from the bulk polarization model are very similar to those predicted by the model trained on water slabs. In some sense, this suggests that the “best” atom-centered dipole model for the polarization of an interfacial system is one trained on the bulk phase, which performs no worse than the mode trained on water slabs at the interface, and performs better in the bulk.

To rationalize this observation, we note that the presence of dangling O–H bonds at the air–water interface means that water dipoles tend to point outward, meaning that the total polarization component normal to the interface is relatively small due to cancellation of molecular dipoles on opposite sides of the slab’s center of mass;35,36 this is not accounted for in our models and means that the atom-centered predictions are smaller. Figure 2a also shows the molecular dipole moment distributions from a model trained not only on the polarization of slab systems but also on the individual dipole moments of single molecules as obtained from the SPC/E model (H2O–I_PP-M_SR). With this simple extension, we obtain much better agreement with the molecular dipole moments from Wannier centers. In the Supporting Information, we further show that a model trained on the Wannier center displacements from bulk water (i.e., H2O–B_W_SR) also gives molecular dipole moments that do not agree with H2O–I_W_SR and that an accurate model for the displacements Δi of Wannier centers in slab systems must include in their training set local environments from the interface. By tuning the importance of the molecular dipole term in the fitting, we are able to build a model that predicts physically reasonable dipole moment without sacrificing the performance of the model for P on a validation set.

The performance of a model for the polarization can be further gauged by its predicted fluctuations, which are related to the dielectric constant εr: In ref (18), it was shown that a model for Wannier center positions in liquid water gives an excellent description of water’s dielectric constant. We used our models to calculate the local dielectric constant ε⊥, resolved along the z direction normal to the slab,41,42 which further shows how well the models account for fluctuations as a function of the distance from the center of the slab. Figure 2b shows ε⊥ as a function of distance from the center of the box (see Supporting Information for details of the calculation), calculated along a 10 ns trajectory of SPC/E water. The calculated value of the dielectric constant depends strongly on the system size, the statistics available, and on the electrostatic constraints and boundary conditions of the simulation from which the frames were taken.41,43 This sensitivity, along with the fact that we have combined configurations taken from classical force field simulations with a polarization surface trained on data at the revPBE/D3 level, means that it is likely not fruitful to compare either to the experimental dielectric constant of 78 or to the value of 71 found for SPC/E water44 and begin simply by comparing the predictions of the four models.

As in Figure 2a, the predicted dielectric constant calculated from Wannier centers (black curve) and that from a model trained on the slab polarization along with molecular dipole moments (orange curve) is in excellent agreement. The model trained solely on slab polarizations (blue curve) predicts a much lower dielectric constant, indicating that not only are the dipole moments themselves smaller than for the other models but their fluctuations are also smaller. Finally, the predictions of the bulk model (red curve) are not in agreement with the former two in the bulk region,but are within their error bars near the interface. Overall, the consistency between H2O–I_W_SR and H2O–I_PP-M_SR together with the discrepancy from other models suggests that one of these two models should be used when modeling interfaces.

3.3 Concentrated Electrolyte Solutions

Electrolyte solutions contain free charges, which adds an extra layer of complexity to the problem: Opposite charges may now be separated by significant distances, and the properties of the system are determined by long-ranged electrostatics. It has been shown that accurately predicting the properties of systems containing free charges requires these long-ranged effects to be accounted for,40,45,46 suggesting that we may need long-ranged descriptors. We calculated the polarization P of a set of 1000 concentrated sodium chloride solution frames each containing 31 water molecules and a single NaCl pair (i.e., a concentration of ∼1.6 M). The method used to preprocess the data differs slightly from that in pure water, in which every atom could be assigned to a well-defined molecule that is expected to be almost electrically neutral.47 Although the NaCl solutions contain free ions, treating the Na···Cl pair as a neutral molecule allows us to calculate a target polarization Pmol using simple point charges. For the Wannier center models, the total displacement Δi around every heavy atom (i.e., O, Na, and Cl) is found. In practice, the values of Δi for the Na and Cl centers are much smaller than for the O atoms, with the electrons much closer to the nuclei, and can be reasonably well approximated by placing the Wannier centers at the position of the nuclei without affecting the performance in predicting P.

Figure 3a shows learning curves for three models of the polarization of concentrated sodium chloride: two in which the polarizations are preprocessed as described above and then learned either using the short-ranged λ-SOAP kernel or a combination of the λ-SOAP and the long-ranged λ-LODE kernel and one in which the average position of Wannier centers is predicted and used to build P. Scatterplots comparing the calculated reduced polarizations with the target values for the largest training set size are shown in Figure 3b. The difference between models trained using λ-SOAP and λ-LODE descriptors is significant: The short-ranged λ-SOAP model performs only a little better than drawing predictions from a uniform distribution. Incorporating long-range information with the λ-LODE models gives a much better performance, although one that is still 2 orders of magnitude worse than the performance of the models for pure water. In fact, we found that combining any amount of the λ-SOAP kernel with the λ-LODE model resulted in a worse model, with the results of Figure 3a showing the results of a pure λ-LODE model.

Figure 3 (a) Learning curves for the full polarization P of concentrated NaCl solutions, with preprocessed data learned using short-ranged λ-SOAP kernels (NaCl_PP_SR, solid black line), long-ranged λ-LODE kernels (NaCl_PP_LR, dashed blue line), or with the average displacements of Wannier centers learned (NaCl_W_SR, dotted red line). (b) Scatterplots of the predicted components of the reduced polarization p against the calculated components, with each component transformed by the cosine function to account for their circular nature. (c) As (a), but with the preprocessed data baselined against the polarization Pmol from a point charge model (solid black line shows the results of the NaCl_PP-B_SR model and dashed blue line shows the results of the NaCl_PP-B_LR model).

The difference between both of these models and the one trained on the Wannier displacements is striking: The performance of this latter model is comparable to the corresponding model for the polarization of bulk water. These results, demonstrating the importance of long-ranged information, accounted for by either allowing the partial dipole assigned to each atom to depend on the long-range structure (in the case of the preprocessed data) or explicitly accounting for charge separation via the Wannier centers, are not surprising. The improved performance for the Wannier displacement models compared to the λ-LODE model is likely due to the fact that the charge separation responsible physically for long-range electrostatic effects is built automatically into the Wannier center picture. This gives it an advantage over the λ-LODE models, which have to fit atom-centered dipoles that best model a situation where there is charge transfer between atoms.48

An alternative approach to account for long-ranged physics is to use baselining or delta-learning46,49−52 and to learn the difference between the calculated polarization and the result of another model. We thus baseline our training data against the results of the polarization model Pmol calculated using point charges, which were readily available. This ensures that some amount of the required long-ranged physics is already present in the baseline. Figure 3c demonstrates that each of the SOAP and LODE models for the baselined polarization PΔ = P – Pmol have errors 1–2 orders of magnitude lower than the models for the full polarization P. The baselined SOAP model also performs better than the model trained on Wannier center Δs, echoing the findings for pure water. Mixing the λ-LODE kernels with the λ-SOAP kernels led to essentially no improvement over pure λ-SOAP, indicating that the baseline point charge model already accounts for most of the long-ranged physics needed to accurately model the polarization, with short-ranged improvements made by the λ-SOAP kernel. This is underscored by the fact that the optimal weighting of the λ-LODE kernel in the combination is ∼10–2 times the weighting of the λ-SOAP. For concentrated solutions, we find ourselves again in the best possible situation: One in which we are free to use whichever method gives the lowest error for our data set of choice.

The simulation boxes used in this section contain a single NaCl ion pair, meaning that it is straightforward to partition the system into neutral units. A larger system containing more ions would necessitate an ion pairing scheme such as that of refs (53) and (54), which sorts oppositely charged ions into unique pairs. We are left only with the question of how to handle systems for which a simple point charge molecular model cannot be found.

3.4 Data-Driven Unwrapping

While the preprocessing approach we have described so far is very straightforward to implement and requires very little computational effort, it does require that a polarization model Pmol can be found that is a smooth function of atomic positions. In turn, designing this model requires that the system is split into neutral molecular units so that Pmol is unchanged when atoms cross periodic boundaries. For systems in which bonds can break and reform, it may not be possible to define neutral molecular units without explicitly running further calculations, which may be costly at best and highly dependent on the method used at worst.55,56 However, if Wannier centers are not available in a given data set or their assignment to individual atoms is ambiguous, then a way to preprocess the polarizations in a model-free manner would be required. The starting point for the approach is the fact, as pointed out by Gigli et al., that while polarizations are discontinuous, their derivatives with respect to the atomic positions, which are proportional to the BEC, are continuous functions of positions.9 By incorporating information about these derivatives into the learning process, we were able to infer the optimum preprocessing of the training data.

The method we use is as follows: we begin by training a model for polarizations, solely using the derivatives ∂ Pi/∂ xj,k of the polarization with respect to atomic coordinates xj,k (i.e., the kth Cartesian coordinate of the jth atom). The prediction for the ith component of the polarization of atomic configuration is6

where N is the number of training points (or in the case of the projected-process approach, the number of active points57) and is the vector kernel between configuration and training configuration , related to the λ = 1 kernel by a similarity transformation.48 The weights { wn = (wn,1, wn,2, wn,3, n = 1, ..., N)} are found by minimizing the loss function7

where the index m refers to a training point for which we have the derivative ∂Pm/∂xm with respect to some xm (a given Cartesian component of the position of a given atom in a given frame), Nd is the number of derivative training points, and is the derivative of the kernel with respect to xm. σ2 is a regularization. By training on the derivatives of the polarization, which are a continuous function of atomic positions, the predicted polarizations are guaranteed also to be continuous functions. We have no reason to believe a priori that the predictions of this model will be accurate, and indeed, we show that they are extremely inaccurate, but there is no requirement for them to be so, as they need only to predict whether the difference in the jth polarization components Pi,j – Pi′,j between two frames i and i′ should be positive or negative; if this prediction differs from the observed data, then we conclude that the polarization has gone through |Pi| = Qi and changed sign. By plotting the predictions of the model trained on the derivatives against the calculated values, we can identify branches in the data that allow us to add multiples of the quantum of polarization to make the data into a smooth function of position.

This is illustrated by Figure 4, which shows the results of this process as applied to pure bulk water. 800 training points were used for the derivative model, with each point the derivative of the polarization of a randomly chosen frame with respect to a randomly chosen Cartesian coordinate of a randomly chosen atom. It should be noted that this amounts to ∼0.3% of the available data. Figure 4a compares this model’s prediction of the polarization components Pj with the calculated values. Although they differ by several orders of magnitude, branches can clearly be identified in which there is a clear linear correlation between the predictions and the calculations. The main branch consists of data points in which the correlation can be described by a straight line through the origin, while the remaining branches are those that do not pass through the origin.

Figure 4 (a) Blue crosses show the total polarizations predicted using a model trained on their derivatives (eq 7). Points in red are those identified as the “main branch”, which is fit to the straight line shown. All points are then shifted by Qn to be as close as possible to the straight line, where Q is the quantum of polarization and n is a vector of integers; this is illustrated for points off of the main branch by arrows; their shifted positions are shown in gray. (b) Predictions of an SA-GPR model trained on the preprocessed data.

Once the points on the main branch have been identified, a straight line can be fitted through these points; each polarization is then modified as Pi → Pi + Qini, where ni is a vector of three integers chosen to bring the result as close as possible to the straight line. In doing so, we have carried out exactly the same procedure as described in Section 2.2 and minimized the difference between our data and the results of a polarization model that is a continuous function of the atomic positions, determined in this case by a data-driven approach. The optimum values of ni for each frame are identical to those obtained using a simple point charge model, and the processed calculation data can be used to train a more accurate model as in Section 3.1, whose extremely high accuracy is illustrated in Figure 4b. Because we do not require the derivative model to give accurate results for polarizations but instead simply for the sign of polarization differences, we might expect that our results should be robust to the number of derivatives used. Using as few as 10 derivatives, we were still able to identify branches in the scatterplot between predicted and calculated polarization and thus to obtain exactly the same training data as was given by using a point charge model.

For concentrated NaCl solutions, we were unable to identify branches in the polarization data, which is unsurprising given how difficult it is to learn the pure (i.e., not baselined) polarization of this system. Rather than baselining against a point charge model for the full system, which will likely not be available if we must resort to data-driven preprocessing, we instead make the problem tractable by using a minimal amount of chemical intuition. Assigning partial charges only to the Na and Cl atoms based on their expected oxidation states in aqueous solution (+e and – e, respectively), we learn the difference between the total polarization P and the dipole moment of the Na···Cl pair. In doing so, we are able to identify distinct branches in the plot of the predictions of a derivative model against the calculated polarizations. The final model gives the same accuracy as the fully baselined results of the previous section (see Supporting Information).

Using this approach ostensibly requires that either the BEC be provided as part of the data set we would like to learn or that enough details are given on the computation of polarizations and that sufficient computer time is available to calculate their derivatives. We have, however, shown that the results are very robust to the amount of data used because it is not important for the model trained on derivatives to give an accurate polarization but merely for the predicted polarizations to be correlated with the calculated ones so that different branches can be identified. This suggests that the derivatives used in training may not need to be computed at the same level of theory as the polarizations that we would like to learn, echoing the findings of ref (9). Taking 10 frames of bulk water, choosing one Cartesian coordinate of one atom at random from each frame and calculating the derivative of the polarization with respect to this coordinate, we obtain the same preprocessed data using much looser convergence settings than the original calculation, as well as with exchange-correlation functionals that are cheaper to evaluate (see Supporting Information). Even if the BEC are not present in the data set we wish to use, it is sufficient to find a handful of polarization derivatives at whatever level of theory is most convenient and use those to infer the optimum preprocessing of the data.

3.5 Molecular Dynamics Trajectories

To further test the performance of our models, we carried out short molecular dynamics (MD) simulations of the bulk water, the air–water interface, and concentrated NaCl solutions, using ab initio MD (AIMD) for bulk water and NaCl solutions and using the SPC/E force field for the air–water interface. For each trajectory, the polarizations were calculated using DFT calculations at the same level of theory as the training data were collected. Figure 5 compares the z-component of the polarization Pz from molecular dynamics (MD) trajectories with the results of SA-GPR models trained on preprocessed polarizations and on the Wannier center displacements. The results for the x and y components are shown in the Supporting Information. For bulk water and NaCl solutions, the postprocessed models (H2O-B_PP_SR and NaCl_PP-B_SR, respectively) and the models for Wannier displacements both perform excellently, giving polarizations that agree extremely well with those from DFT: Neither type of model performs noticeably better than the other. For interfacial water, while the Wannier displacement model performs extremely well, the H2O-I_PP_SR model underpredicts the magnitude of polarization fluctuations by a large degree. This is to be expected in light of the fact that the polarization itself was found to be smaller in this model due to symmetry considerations. The H2O-I_PP-M_SR model that includes information on molecular dipole moments gives agreement with the MD results that is comparable with the Wannier displacement model. The performance of all of the models is slightly worse than for the other two system types studied, reflecting the fact that the models in Section 3.2 have somewhat larger errors on their testing sets.

Figure 5 z-component of the system polarization along a molecular dynamics trajectory (left hand panels) and time autocorrelation function of the polarization CPP(t) (right hand panels) for (a) bulk water, (b) the air–water interface, and (c) concentrated NaCl solutions. In all cases, solid black lines give the results calculated using density functional theory, dashed red lines show the predictions from SA-GPR models for the postprocessed polarization (in the case of the NaCl solution, this has been baselined against the polarization from a simple point charge model), and dotted blue lines show the predictions from SA-GPR models for the Wannier displacements around each oxygen atom. Additionally, for the air–water interface, the dash-dotted green line shows the predictions of an SA-GPR model trained on the total system polarization as well as on molecular dipole moments.

The polarization autocorrelation function8

is also shown in Figure 5, where P(t) is the polarization vector at time t. CPP(0) reports on the fluctuations of the total polarization, and the t > 0 behavior reports on the relaxation of these fluctuations toward equilibrium. In almost every case, the agreement between the predicted and the calculated correlation function is excellent, underscoring the capability of all of these models to give very accurate results. The only exception is the autocorrelation function predicted by the H2O-I_PP_SR, which unsurprisingly agrees very poorly with the simulation results. However, we show in the Supporting Information that most of this discrepancy is due to the poor description of fluctuations by this model: When the correlation function is normalized by its t = 0 value, the time decay predicted by this model is in very good agreement with DFT results. The results in this section reinforce the point that either method of training a model for the polarizations gives results with excellent accuracy.

4 Conclusions

In this paper, we have presented and tested two methods for symmetry-adapted learning of the polarization of aqueous systems by either preprocessing the polarization data to obtain a suitable continuous function of atomic positions or learning the average displacement of Wannier centers from the atoms; both of these methods lead to highly accurate models. Of the two, the latter method is the most likely to work without any further modifications, requiring no specialist knowledge about the system and accounting naturally for charge separation. However, the former method has provided a slightly better accuracy for the systems studied, and crucially, this accuracy increases faster with the number of training points used. The Wannier center approach is currently applicable only to systems for which the number of centers assigned to each atom is constant; if paired with a reliable model for this number, it could be applied to more general systems.

While the excellent performance of both methods to predict total polarizations means that this added accuracy may not be needed, in situations where the Wannier center positions are difficult to learn, not provided with a data set or not straightforward to assign to atomic centers in a way that can be predicted by our models, it is practical to use a preprocessing method. Moreover, where there is no well-defined reference model that can be used to process the polarizations, this processing can instead be carried out in a data-driven way using a small number of derivatives of the polarizations with respect to atomic positions. This approach is highly robust to the level of theory used to calculate the derivatives, and therefore, a much lower level of theory can be used.

When calculating the molecular dipole moments in pure water, as required for the determination of the interfacial dielectric constant, the best results were originally obtained by predicting the positions of Wannier centers. However, by using the simple point charge model to process the raw polarizations to provide additional information to the SA-GPR model about the expected size of the molecular dipole moments, both methods were made consistent. Having demonstrated the high accuracy possible using both of these methods, future work will focus on using them to predict vibrational spectra of electrostatically complex systems such as ionic solutions and their interfaces with air.

Data Availability Statement

The data used to train models, as well details of quantum-mechanical calculations and the models themselves and instructions for applying them, can be found at https://github.com/dilkins/polarization-learning. The structure of this repository is described in the Supporting Information.

Supporting Information Available

The Supporting Information is available free of charge at https://pubs.acs.org/doi/10.1021/acs.jcim.4c00421.Description of online repository and further details on model building and validation (PDF)

Supplementary Material

ci4c00421_si_001.pdf

The authors declare no competing financial interest.

Acknowledgments

D.M.W. acknowledges startup funding from Queen’s University Belfast (QUB). We are also grateful for computer time from QUB’s Research Computing Centre. Y.L. has been funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) project number 467724959.
==== Refs
References

McQuarrie D. A. Statistical Mechanics; University Science Books: Sausalito, 2000.
Morita A. ; Hynes J. T. A theoretical analysis of the sum frequency generation spectrum of the water surface. Chem. Phys. 2000, 258 , 371–390. 10.1016/S0301-0104(00)00127-0.
Morita A. ; Hynes J. T. A Theoretical Analysis of the Sum Frequency Generation Spectrum of the Water Surface. II. Time-Dependent Approach. J. Phys. Chem. B 2002, 106 , 673–685. 10.1021/jp0133438.
Li D. ; Zhao M. H. ; Garra J. ; Kolpak A. M. ; Rappe A. M. ; Bonnell D. A. ; Vohs J. M. Direct in situ determination of the polarization dependence of physisorption on ferroelectric surfaces. Nat. Mater. 2008, 7 , 473 10.1038/nmat2198.18469819
Catalan G. ; Seidel J. ; Ramesh R. ; Scott J. F. Domain wall nanoelectronics. Rev. Mod. Phys. 2012, 84 , 119 10.1103/RevModPhys.84.119.
Maguire J. R. ; McCluskey C. J. ; Holsgrove K. M. ; Suna A. ; Kumar A. ; McQuaid R. G. P. ; Gregg J. M. Ferroelectric Domain Wall p–n Junctions. Nano Lett. 2023, 23 , 10360 10.1021/acs.nanolett.3c02966.37947380
Khatib R. ; Hasegawa T. ; Sulpizi M. ; Backus E. H. G. ; Bonn M. ; Nagata Y. On-The-Fly” Calculation of the Vibrational Sum-Frequency Generation Spectrum at the Air-Water Interface. J. Phys. Chem. C 2016, 120 , 18665 10.1021/acs.jpcc.6b06371.
Marsalek O. ; Markland T. E. Quantum Dynamics and Spectroscopy of Ab Initio Liquid Water: The Interplay of Nuclear and Electronic Quantum Effects. J. Phys. Chem. Lett. 2017, 8 , 1545–1551. 10.1021/acs.jpclett.7b00391.28296422
Gigli L. ; Veit M. ; Kotiuga M. ; Pizzi G. ; Marzari N. ; Ceriotti M. Thermodynamics and dielectric response of BaTiO3 by data-driven modeling. npj Comput. Mater. 2022, 8 , 209 10.1038/s41524-022-00845-0.
Litman Y. ; Lan J. ; Nagata Y. ; Wilkins D. M. Fully First-Principles Surface Spectroscopy with Machine Learning. J. Phys. Chem. Lett. 2023, 14 , 8175 10.1021/acs.jpclett.3c01989.37671886
Behler J. Perspective: Machine learning potentials for atomistic simulations. J. Chem. Phys. 2016, 145 , 170901 10.1063/1.4971792.27825224
Deringer V. L. ; Caro M. A. ; Csányi G. Machine Learning Interatomic Potentials as Emerging Tools for Materials Science. Adv. Mater. 2019, 31 , e1902765 10.1002/adma.201902765.31486179
Behler J. ; Csányi G. Machine learning potentials for extended systems: a perspective. Eur. Phys. J. B 2021, 94 , 142 10.1140/epjb/s10051-021-00156-1.
Fletcher T. L. ; Popelier P. L. A. Transferable kriging machine learning models for the multipolar electrostatics of helical deca-alanine. Theor. Chem. Acc. 2015, 134 , 135 10.1007/s00214-015-1739-y.
Grisafi A. ; Wilkins D. M. ; Csányi G. ; Ceriotti M. Symmetry-Adapted Machine Learning for Tensorial Properties of Atomistic Systems. Phys. Rev. Lett. 2018, 120 , 036002 10.1103/PhysRevLett.120.036002.29400528
Wilkins D. M. ; Grisafi A. ; Yang Y. ; Lao K.-U. ; DiStasio R. A. ; Ceriotti M. Accurate Molecular Polarizabilities with Coupled Cluster Theory and Machine Learning. Proc. Natl. Acad. Sci. U. S. A. 2019, 116 , 3401 10.1073/pnas.1816132116.30733292
Zhang L. ; Chen M. ; Wu X. ; Wang H. ; E W. ; Car R. Deep neural network for the dielectric response of insulators. Phys. Rev. B 2020, 102 , 041121 10.1103/PhysRevB.102.041121.
Krishnamoorthy A. ; Nomura K.-I. ; Baradwaj N. ; Shimamura K. ; Rajak P. ; Mishra A. ; Fukushima F. S. ; Shimojo ; Kalia R. ; Nakano A. ; Vashishta P. Dielectric Constant of Liquid Water Determined with Neural Network Quantum Molecular Dynamics. Phys. Rev. Lett. 2021, 126 , 216403 10.1103/PhysRevLett.126.216403.34114857
Inoue K. ; Litman Y. ; Wilkins D. M. ; Nagata Y. ; Okuno M. Is Unified Understanding of Vibrational Coupling of Water Possible? Hyper-Raman Measurement and Machine Learning Spectra. J. Phys. Chem. Lett. 2023, 14 , 3063 10.1021/acs.jpclett.3c00398.36947156
Resta R. ; Vanderbilt D. Physics of Ferroelectrics; Springer Berlin Heidelberg: Berlin, Heidelberg, 2007; pp 31–68.
Spaldin N. A beginner’s guide to the modern theory of polarization. J. Solid State Chem. 2012, 195 , 2 10.1016/j.jssc.2012.05.010.
Kapil V. ; Wilkins D. M. ; Lan J. ; Ceriotti M. Inexpensive Modelling of Quantum Dynamics using Path Integral Generalized Langevin Equation Thermostats. J. Chem. Phys. 2020, 152 , 124194 10.1063/1.5141950.
Bishop C. M. Pattern Recognition and Machine Learning; Springer: Singapore, 2006.
Shepherd S. ; Lan J. ; Wilkins D. M. ; Kapil V. Efficient Quantum Vibrational Spectroscopy of Water with High-Order Path Integrals: From Bulk to Interfaces. J. Phys. Chem. Lett. 2021, 12 , 9108 10.1021/acs.jpclett.1c02574.34523941
Deringer V. L. ; Bartók A. P. ; Bernstein N. ; Wilkins D. M. ; Ceriotti M. ; Csányi G. Gaussian Process Regression for Materials and Molecules. Chem. Rev. 2021, 121 , 10073 10.1021/acs.chemrev.1c00022.34398616
Bartók A. P. ; Kondor R. ; Csányi G. On representing chemical environments. Physical Review B - Condensed Matter and Materials Physics 2013, 87 , 184115 10.1103/PhysRevB.87.184115.
Grisafi A. ; Nigam J. ; Ceriotti M. Multi-scale approach for the prediction of atomic scale properties. Chemical Science 2021, 12 , 2078–2090. 10.1039/D0SC04934D.
Grisafi A. ; Ceriotti M. Incorporating long-range physics in atomic-scale machine learning. J. Chem. Phys. 2019, 151 , 204105 10.1063/1.5128375.31779318
Kapil V. ; Behler J. ; Ceriotti M. High order path integrals made easy. J. Chem. Phys. 2016, 145 , 234103 10.1063/1.4971438.28010075
Zhang L. ; Han J. ; Car R. ; E W. Deep Potential Molecular Dynamics: A Scalable Model with the Accuracy of Quantum Mechanics. Phys. Rev. Lett. 2018, 120 , 143001 10.1103/PhysRevLett.120.143001.29694129
Cheng B. ; Engel E. A. ; Behler J. ; Dellago C. ; Ceriotti M. Ab initio thermodynamics of liquid and solid water. Proc. Natl. Acad. Sci. U.S.A. 2019, 116 , 1110–1115. 10.1073/pnas.1815117116.30610171
Qu C. ; Yu Q. ; Conte R. ; Houston P. L. ; Nandi A. ; Bowman J. M. Correction: A Δ-machine learning approach for force fields, illustrated by a CCSD(T) 4-body correction to the MB-pol water potential. Digital Discovery 2022, 1 , 941 10.1039/D2DD00057A.
Berendsen H. J. C. ; Grigera J. R. ; Straatsma T. P. The missing term in effective pair potentials. J. Phys. Chem. 1987, 91 , 6269–6271. 10.1021/j100308a038.
Gubskaya A. V. ; Kusalik P. G. The total molecular dipole moment for liquid water. J. Chem. Phys. 2002, 117 , 5290 10.1063/1.1501122.
Wan Q. ; Galli G. First-Principles Framework to Compute Sum-Frequency Generation Vibrational Spectra of Semiconductors and Insulators. Phys. Rev. Lett. 2015, 115 , 246404 10.1103/PhysRevLett.115.246404.26705645
Ohto T. ; Usui K. ; Hasegawa T. ; Bonn M. ; Nagata Y. Toward ab initio molecular dynamics modeling for sum-frequency generation spectra; an efficient algorithm based on surface-specific velocity-velocity correlation function. J. Chem. Phys. 2015, 143 , 124702 10.1063/1.4931106.26429027
Khatib R. ; Sulpizi M. Sum Frequency Generation Spectra from Velocity–Velocity Correlation Functions. J. Phys. Chem. Lett. 2017, 8 , 1310 10.1021/acs.jpclett.7b00207.28247752
Moberg D. R. ; Straight S. C. ; Paesani F. Temperature Dependence of the Air/Water Interface Revealed by Polarization Sensitive Sum-Frequency Generation Spectroscopy. J. Phys. Chem. B 2018, 122 , 4356 10.1021/acs.jpcb.8b01726.29614228
Apostolidou C. Vibrational Spectra of the OH Radical in Water: Ab Initio Molecular Dynamics Simulations and Quantum Chemical Calculations Using Hybrid Functionals. Adv. Theory Simul. 2020, 3 , 2000174 10.1002/adts.202000174.
Gao A. ; Remsing R. C. Self-consistent determination of long-range electrostatics in neural network potentials. Nat. Commun. 2022, 13 , 1572 10.1038/s41467-022-29243-2.35322046
Zhang L. ; Wang H. ; Muniz M. C. ; Panagiotopoulos A. Z. ; Car R. ; E W. A deep potential model with long-range electrostatic interactions. J. Chem. Phys. 2022, 156 , 124107 10.1063/5.0083669.35364869
Olivieri J.-F. ; Hynes J. T. ; Laage D. Confined Water’s Dielectric Constant Reduction Is Due to the Surrounding Low Dielectric Media and Not to Interfacial Molecular Ordering. J. Phys. Chem. Lett. 2021, 12 , 4319 10.1021/acs.jpclett.1c00447.33914550
Ballenegger V. ; Hansen J.-P. Dielectric permittivity profiles of confined polar fluids. J. Chem. Phys. 2005, 122 , 114711 10.1063/1.1845431.15836247
Zhang C. ; Sprik M. Computing the dielectric constant of liquid water at constant dielectric displacement. Phys. Rev. B 2016, 93 , 144201 10.1103/PhysRevB.93.144201.
Reddy M. R. ; Berkowitz M. The dielectric constant of SPC/E water. Chem. Phys. Lett. 1989, 155 , 173 10.1016/0009-2614(89)85344-8.
Grisafi A. ; Wilkins D. M. ; Willatt M. J. ; Ceriotti M. Machine Learning in Chemistry: Data-Driven Algorithms, Learning Systems, and Predictions; ACS Publications, 2019; Chapter 1, p 1.
Staacke C. G. ; Heenen H. H. ; Scheurer C. ; Csányi G. ; Reuter C. ; Margraf J. T. On the Role of Long-Range Electrostatics in Machine-Learned Interatomic Potentials for Complex Battery Materials. ACS Appl. Energy Mater. 2021, 4 , 12562 10.1021/acsaem.1c02363.
Poli E. ; Jong K. H. ; Hassanali A. Charge transfer as a ubiquitous mechanism in determining the negative charge at hydrophobic interfaces. Nat. Commun. 2020, 11 , 901 10.1038/s41467-020-14659-5.32060273
Veit M. ; Wilkins D. M. ; Yang Y. ; DiStasio R. A. ; Ceriotti M. Predicting molecular dipole moments by combining atomic partial charges and atomic dipoles. J. Chem. Phys. 2020, 153 , 024113 10.1063/5.0009106.32668949
Ramakrishnan R. ; Dral P. O. ; Rupp M. ; von Lilienfeld O. A. Big Data Meets Quantum Chemistry Approximations: The Δ-Machine Learning Approach. J. Chem. Theory Comput. 2015, 11 , 2087–2096. 10.1021/acs.jctc.5b00099.26574412
Ghasemi S. A. ; Hofstetter A. ; Saha S. ; Goedecker S. Interatomic potentials for ionic systems with density functional accuracy based on charge densities obtained by a neural network. Phys. Rev. B 2015, 92 , 045131 10.1103/PhysRevB.92.045131.
Faraji S. ; Ghasemi S. A. ; Rostami S. ; Rasoulkhani R. ; Schaefer B. ; Goedecker S. ; Amsler M. High accuracy and transferability of a neural network potential through charge equilibration for calcium fluoride. Phys. Rev. B 2017, 95 , 104105 10.1103/PhysRevB.95.104105.
Ko T. W. ; Finkler J. A. ; Goedecker S. ; Behler J. A fourth-generation high-dimensional neural network potential with accurate electrostatics including non-local charge transfer. Nat. Commun. 2021, 12 , 398 10.1038/s41467-020-20427-2.33452239
Stillinger F. H. ; Lovett R. Ion-Pair Theory of Concentrated Electrolytes. I. Basic Concepts. J. Chem. Phys. 1968, 48 , 3858 10.1063/1.1669709.
Lovett R. ; Stillinger F. H. Ion-Pair Theory of Concentrated Electrolytes. II. Approximate Dielectric Response Calculation. J. Chem. Phys. 1968, 48 , 3869 10.1063/1.1669710.
Wiberg K. B. ; Rablen P. R. Comparison of atomic charges derived via different procedures. J. Comput. Chem. 1993, 14 , 1504 10.1002/jcc.540141213.
Stone A. J. Distributed Multipole Analysis: Stability for Large Basis Sets. J. Chem. Theory Comput. 2005, 1 , 1128 10.1021/ct050190+.26631656
Rasmussen C. E. ; Williams C. K. I. Gaussian Processes for Machine Learning; MIT Press: London, 2005.
