
==== Front
Sci Rep
Sci Rep
Scientific Reports
2045-2322
Nature Publishing Group UK London

61168
10.1038/s41598-024-61168-2
Article
Low salinity water flooding: estimating relative permeability and capillary pressure using coupling of particle swarm optimization and machine learning technique
Khosravi Razieh
Simjoo Mohammad simjoo@sut.ac.ir

Chahardowli Mohammad
https://ror.org/03wdrmh81 grid.412345.5 0000 0000 9012 9027 Faculty of Petroleum and Natural Gas Engineering, Sahand University of Technology, Tabriz, Iran
8 6 2024
8 6 2024
2024
14 1321325 1 2024
2 5 2024
© The Author(s) 2024
https://creativecommons.org/licenses/by/4.0/ Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/.
The reservoir’s properties are required for proper reservoir simulation, which also involves uncertainties. Experimental methods to estimate the relative permeability and capillary pressure data are expensive and time-consuming. This study aims to determine the relative permeability and capillary pressure functions of a sandstone core in the presence and absence of clay during low-salinity water floods. The data were provided by automatic history matching the results from previously lab-reported studies through coupling a simulator with the particle swarm optimization algorithm. Correlations were proposed using multiple-linear regression for relative permeability and capillary pressure parameters at low-salinity conditions. They were validated against experimental results of no clay and clayey formation with regression of 95% and 97%. To assign one curve of relative permeability and capillary pressure to the grid cells of the simulator, averaging techniques were implemented. The effect of salinity and clay content on the obtained curves was investigated. Changing salinity from 42000 to 4000 ppm, the reduction in water relative permeability appeared to be higher than the oil relative permeability increment. Moreover, a noticeable shift in the relative permeability curves toward the highest saturations related to the clay content was observed. The proposed hybrid method could be a suitable tool to estimate the relative permeability and capillary pressure functions of the water-based EOR methods.

Subject terms

Chemical engineering
Mechanical engineering
issue-copyright-statement© Springer Nature Limited 2024
==== Body
pmcIntroduction

A large amount of the oil reserves remains as residual oil, even using secondary recovery methods like water flooding. Thus, investigating enhanced oil recovery (EOR) techniques to improve oil recovery is very important. Experimental and field evidence demonstrates that low-salinity flood in sandstones improves oil recovery by altering the wettability of the reservoir rock towards a more water-wet state1. Many studies in recent years have focused on low-salinity water (LSW) flood as an EOR method for increasing oil recovery in sandstone oil reservoirs2,3. A better understanding of the reservoir through developed models leads to more accurate decisions to optimize field applications and increase reservoir productivity4,5. Reservoir simulation is the most used tool to realize the prediction of the field6,7. The reservoir’s static and dynamic properties throughout the reservoir are required for proper reservoir simulation, which also has uncertainties. As a result, a discrepancy occurs between the simulated and observed values7.

History Matching (HM) is a technique where reservoir data matches uncertain parameters of the reservoir model for further reservoir applications4. Computer-aided optimization techniques for HM purposes, known as Automatic History Matching (AHM), have been widely applied5. It is more efficient than manual methods because it uses an optimization algorithm to find the best values such that the match to dynamic data is acceptable4,8. Various optimization methods have been adopted in the AHM process, including Gradient-Based, Hybrid, Stochastic (Genetic Algorithm (GA), Particle Swarm Optimization (PSO)), and Probabilistic methods. Each method has positives and negatives4,5,8–13. Many studies aim to find the best HM algorithm among several available methods. Ensemble Kalman Filter (ENKF) and stochastic methods are the most popular algorithms for reservoir HM4,11,12,14. ENKF has many advantages, such as the ease of implementation, ease of formulation, and ability to handle non-linear systems. However, it has a high computational cost, and it is suggested for large systems and field optimizations rather than core scale simulations12. Both PSO and GA algorithms are suitable for solving complex problems and have easy implementation in every simulator. However, they may not be suitable for large systems, and the problem of convergence speed exists. Based on the purpose of our study, in which HM is conducted at a core scale (ENKF is not necessary) and running time is important, PSO is preferred. The reason is that the optimized parameters will be determined faster and less scattered than GA10,12.

Relative permeability curves describe oil and water mobility in the simulation model and are important for successful reservoir simulation15,16. Capillary pressure is also significant for LSW flooding because part of the benefit of LSW flooding is to make capillary pressure less negative, and thereby improving water flood efficiency. Therefore, a low-salinity capillary pressure is needed to estimate low-salinity benefits at high resolution properly17. Relative permeability and capillary pressure curves are widely applied in reservoir engineering applications12, so accurate estimations of them are necessary12,18. Since experimental methods to estimate the relative permeability are expensive and time-consuming12,19,20, optimization algorithms to estimate these parameters are suggested. In this case, evolutionary and stochastic algorithms could be a promising solution for different applications. For the application of LSW flood in sandstone reservoirs, many studies have been conducted to determine optimization parameters12,21–23. Among them, optimization studies to determine relative permeability and capillary pressure functions using the combination of evolutionary and machine learning algorithms are rare.

Flow properties are a function of pore geometry, and each lithology usually has special relative permeability and capillary pressure curves, which are not always available for each rock type24. Capillary pressure and relative permeability curves measured in the laboratory may be only available for a subset of samples25–27. Although these curves may be available on core scale models, it is required to upscale these core-size curves measured by laboratory experiments for different types of simulation. In other words, several pairs of relative permeability curves should be available because of the uncertainty associated with relative permeability data. The relative permeability and capillary pressure parameters (estimated by laboratory tests or AHM) must be averaged at the core scale to obtain a single pair of curves for each rock type. Coats was the first to introduce pseudo-relative permeability curves based on the assumption of vertical equilibrium in each grid cell of the reservoir model28. After that, different methods have been proposed to estimate the average relative permeability (Kyte & Berry, Pore Volume Weighted, Stone, Total Mobility, Quasi-Steady State, and Weighted relative permeability)29–36. J-function is the most common method for averaging capillary pressure curves29,37–40.

In this study, hybrid particle swarm optimization coupled with a machine learning technique is proposed to determine the relative permeability and capillary pressure functions during the low-salinity water injection for different rock types (with/without clay content) of a heterogeneous sandstone core. To this end, the particle swarm optimization algorithm is coupled with a reservoir simulator to provide the required data by automatic history matching recovery factor and pressure drop results. Correlations are proposed to estimate core scale relative permeability and capillary pressure functions at low-salinity conditions based on multiple linear regression. Different relative permeability and capillary pressure curves were determined using experimental data under different rock and fluid conditions. Then, one single curve was assigned to the grid cells through averaging techniques for core scale low-salinity flood simulation. The effect of salinity and clay content on the obtained relative permeability and capillary pressure curves was investigated. The proposed hybrid method could be a suitable tool for low-salinity flooding applications at the core and field level.

Method

In this section, the properties of a sandstone core, hybrid PSO coupled with multiple linear regression to provide the required data for proposing correlations, and a discussion on averaging techniques to assign a single capillary pressure and relative permeability curve to grid blocks in the simulator is elaborated.

Sandstone core properties

The sandstone core properties are investigated regarding porosity, permeability, clay content, and wettability. Two rock types are selected, and their properties are reported in Table 1:

For RTP1, the average core porosity and permeability are reported as 0.3 and 4.5 (Darcy), respectively. For RTP2, the reported values are 0.20 and 1.50 (Darcy), respectively. RTP1 is considered a no clay formation, and RTP2 is a clayey formation. The permeability and porosity correlation for RTP1 and RTP2 is as shown in Fig. 1:Figure 1 The permeability and porosity correlation for RTP1 and RTP2.

Hybrid particle swarm optimization coupled with machine learning technique for estimating core scale relative permeability and capillary pressure curves

To determine the relative permeability and capillary pressure functions for the LSW process at the core scale, the studies of similar sandstone oil reservoirs are used and categorized into different rock types. These parameters are reported in some studies, but most are not. So, there is a need to determine the matching parameters by coupling the reservoir simulator and PSO algorithm.

Studies similar to our lithology (with and without clay content) are gathered thoroughly. Their properties including formation type, injected brine salinity, wettability, and clay content are investigated and the objective of each study is elaborated. The results are summarized in Tables 2 and 3:Table 1 Properties of Rock Type1 and Rock Type2.

Rock type	k-φ relation	Wettability	Clay content	
Rock Type1 (RTP1)	Figure 1	Mixed Wet	 < 1 wt% (No Clay)	
Rock Type2 (RTP2)	Figure 1	Weakley Water Wet	6 wt% (Clayey Formation)	

Table 2 Studies similar to RTP1 and their properties.

Refs.	Formation	Injected Brine Salinity (ppm)	Wettability	Clay content (%)	Objective	
Zhang41	Berea Sandstone	387	Mixed to Weakly Water Wet	Kaolinite > Ilite > Chlorite	Mixed wet cores were used to investigate the effect of initial water saturation on secondary and tertiary oil recovery factors	
Rivett42	Berea Sandstone	1140	Mixed Wet	Less than 5 wt% clay	Mixed wet cores were used to study the effect of LSWF on oil recovery, residual oil saturation, and relative permeability	
Winoto43	Brial Hill (Sandstone)	17,000	Mixed to Weakly Water Wet	Kaolinite and Ilite	17 mixed wet sandstone outcrops were tested for water flood response to on- twentieth dilution of se water and the oil recovery factor for each case was monitored	
Wang44	Minnelusa Formation Rock Samples	2800	Mixed Wet	–	Measurements of drainage, spontaneous imbibition, and forced imbibition capillary pressure was analyzed under LSWF conditions	
Tahir3	Bentheimer Sandstone Core	4000	Mixed wet	Negligible amount of clay (< 1 wt%),	The study focuses on the influence of the sulfate ion on LSWF for applications in sandstone reservoirs	
Hernández45	Sandstone Core	1000	Mixed wet	–	The impact of salinity on oil recovery and polymer rheology was studied	

Table 3 Studies similar to RTP2 and their properties.

Refs.	Formation	Injected Salinity (ppm)	Wettability	Clay content (%)	Objective	
Kozaki46	Berea Sandstone	1000	Mixed Wet	kaolinite, illites, and mixed-layer montmorillonite-illiltes (5 wt%)	Several core flood experiments were conducted to study the efficiency of LSWF in mixed-wet Berea sandstone cores	
Aladasani47	Berea and Wyoming Sandstone	2500	Mixed wet	–	The sensitivities of LSWF recovery mechanisms in sandstone reservoirs have been measured	
Fjelde48	Sandstone Reservoir in the North Sea	105	Mixed wet	13 wt%	The brine-rock interactions at high and low salinity conditions using reservoir core plugs were described	
Mjøs49	Berea Sandstone	3000	Mixed wet	6 wt% kaolinite and 1wt% Ilite	The effect of LSW in secondary and tertiary modes in six Berea cores was compared	
Sorop1	High Permeability Sandstone Reservoir	1500	Mixed to Weakly Water Wet	–	A steady-state experimental procedure was implemented to measure relative permeability data during LSWF in sandstone core floods	
Shojaei50	Asmari Formation, from Zagros Fold and Thrust belt	3500	Mixed wet	Ilite > Montmorillonite > Chlorite > Kaolinite	The capillary pressure and relative permeability curves are evaluated from inverse modeling of the obtained pressure drop and oil production data. Then, capillary pressure and relative permeability models as a function of water saturation and salinity are determined	
Kadeethum51	Sandstone Core	700	Mixed Wet	–	A comparison of LSWF and conventional water flood regarding oil recovery using mixed wet sandstone core plugs was conducted	
					A numerical simulation was used to investigate the impact of physical diffusion/dispersion on oil	
Attar52	Sandstone Core	1000	Weakly Water Wet	–	recovery from LSWF	

Moreover, the distribution of porosity and permeability in the investigated studies are compared to ours as in Fig. 2:Figure 2 The distribution of porosity and permeability for RTP1 (a) and RTP2 (b).

After categorizing the conducted studies into two different rock types, the gathered data from these studies is used to determine the HM parameters of both rock types, which will be discussed in the following sections.

Coupling reservoir simulator and PSO algorithm to determine model parameters

If the relative permeability and capillary pressure parameters are not reported directly, the matching parameters must be obtained by coupling the reservoir simulator and the PSO algorithm (AHM). The Coupling procedure to obtain the optimized model parameters is described in 9 steps:Preparing the initial swarm; n values (n = 50 in this study) are given to each parameter of the swarm.

Calculating relative permeability and capillary pressure values for each parameter. Corey’s model is used to calculate water and oil relative permeability:1 krw=krw0×(Swn)nw

2 kro=kro0×(1-Swn)no

In the above equations,krw/o0 water/oil endpoint relative permeability and no/w are Corey exponent parameters, which would be obtained by AHM.3 JSwm=a11+k1Snw-a21+k2(1-Snw)+b1

4 -1<Jm<1.PcowSnw=PcowmaxJSnw

In Eq. 3,a1, k1,a2, k2, and b1 are correlation parameters. Pcowmax in Eq. 4 presents maximum capillary pressure. If the values of relative permeability and capillary pressure are not reported in the investigated studies, the constant parameters of the capillary pressure, along with Corey’s equation, would be determined by AHM.3. Creating include file.

4. Run MATLAB coupled with reservoir simulator.

5. Post Processing: The exclude file is an Excel file containing the results of oil recovery and pressure drop; other results would be omitted. In HM, rock properties (permeability and porosity), fluid properties (viscosity, compressibility, density, and API), and rock-fluid properties (kr and PC) are considered as inputs. If the model result does not match the experimental data, then model parameters are changed using the HM algorithm (PSO), and it is rerun.

6. The final purpose is to minimize the difference between the model and experimental results, evaluating the objective function as Eq. 5:5 ERROR=(RF.ΔP)Sim-(RF.ΔP)Exp2

The model can be used to predict reservoir performance when the difference between predicted (RF.ΔP)Sim and measured values (RF.ΔP)Exp is minimized4.7. Optimizing the errors, Pbest (the best solution of particle i) and Gbest (the best solution of all particles) are calculated.

8. Creating a new swarm based on Pbest and Gbest.

9. Repeating 2–8 steps to reach the lowest error or convergence.

The overall fellow chart of coupling the simulator and PSO to obtain optimized model parameters is shown in Fig. 3:Figure 3 The overall fellow chart of coupling the simulator and PSO to obtain optimized model parameters.

By coupling the simulator and PSO algorithm, experimental results of recovery factor and pressure drop are matched with simulated results, and relative permeability and capillary pressure curves are determined as matching parameters. The summarized variation of optimized parameters for RTP1 is reported in Table 4:Table 4 The summarized range of optimized relative permeability parameters for RTP1.

Refs.	nw(High Sal)	no(High Sal)	kroend(High Sal)	krwend(High Sal)	Sro(High Sal)	
nw(Low Sal)	no(Low Sal)	kroend(Low Sal)	krwend(Low Sal)	Sro(Low Sal)	
High:38,000

Low:386

Zhang41

	1.69	2.60	0.82	0.3	0.31	
2.33	2.48	0.88	0.14	0.21	
High:30,000

Low:1140

Rivett42

	2.15	1.37	0.28	0.14	0.3	
3.2	1.21	0.38	0.05	0.2	
High:35,000

Low:17,000

Winoto43

	1.34	2.19	0.42	0.35	0.33	
1.49	2.047	0.55	0.23	0.2	
High:57,000

Low:2800

Wang44

	1.33	2.8	0.68	0.56	0.17	
2.07	1.96	0.84	0.13	0.11	
High:40,000

Low:4000

Tahir3

	1.25	1.10	0.68	0.33	0.24	
1.37	1.02	0.76	0.16	0.18	
High:36,000

Low:1035

Hernández45

	1.55	1.7	0.9	0.53	0.25	
2.08	1.61	0.99	0.28	0.17	

The summarized variation of optimized parameters for RTP2 is reported in Table 5:Table 5 The summarized range of optimized relative permeability parameters for RTP2.

Ref	nw(High Sal)	no(High Sal)	kroend(High Sal)	krwend(High Sal)	Sro(High Sal)	
nw(Low Sal)	no(Low Sal)	kroend(Low Sal)	krwend(Low Sal)	Sro(Low Sal)	
High:38,000

Low:1000

Aladasani47

	2.16	2.12	0.61	0.15	0.2	
2.97	1.6	0.8	0.09	0.03	
High:33,000

Low:1000

Kozaki46

	1.6	4.19	0.57	0.026	0.38	
2.74	4.11	0.65	0.013	0.35	
High:105,000

Low:1000

Fjelde48

	2.7	2.5	0.8	0.2	0.3	
3.6	4	0.92	0.04	0.19	
High:36,000

Low:3000

Mjøs49

	1.63	1.95	0.62	0.16	0.31	
2.45	1.44	0.82	0.12	0.21	
High:35,000

Low:2500

Shojaei50

	1.8	1.9	0.98	0.06	0.22	
2.6	1.4	0.98	0.04	0.12	
High:26,000

Low:1500

Sorop1

	1.16	2.74	0.75	0.59	0.18	
2.51	2.34	0.76	0.39	0.11	
High:20,000

Low:700

Kadeethum51

	2.8	5.84	0.97	0.28	0.34	
3.7	1.39	0.99	0.18	0.29	
High:30,000

Low:1000

Attar52

	2.1	2.8	0.89	0.38	0.35	
3.7	2	0.99	0.28	0.27	

Similarly, for capillary pressure, matching parameters are also obtained in each study for both rock types. HM parameters reported in Tables 4 and 5 are computed with approximately less than 5% error and a running time of 2.5 h. High salinity relative permeability curves for studies similar to RTP1 and RTP2 were compared with those of our cases.

Proposed correlation for relative permeability parameters (machine learning technique)

Having the matching parameters in two different salinities (high and low), in other low-salinity conditions the relative permeability and capillary pressure parameters were estimated through linear interpolation, and finally by using multi-linear regression, the correlations were developed.

For RTP1 (no clay), the correlations for relative permeability and capillary pressure parameters are proposed using multiple-linear regression as Eqs. 6–10 for every desired low-salinity condition (1000–10000 ppm). The experimental conditions for developing correlations include the porosity range of 0.15–0.4, permeability range of 0.01–100 Darcy, mixed wet wettability, and clay-free formation.6 nwLSW=-2.32+2.58E-05×HSWConcentration+[2.19×(nwHSW)-8.2E-06×LSWConcentration]R2=0·98.MSE=1E-04

7 noLSW=1.14-(2.9E-05)×(HSWConcentration)]+(0.895)×(noHSW)]+2.4E-06×LSWConcentrationR2=0·98.MSE=6E-04

8 krwLSWend=0.279-8.1E-06×HSWConcentration+[0.545×(krwHSWend)+6E-06×LSWConcentration]R2=0·98.MSE=7E-05

9 kroLSWend=0.149+2.39E-06×HSWConcentration+[0.81×(kroHSWend)-2.9E-06×(LSWConcentration)]R2=0·97.MSE=5E-05

10 SorLSW=0.097-(1.3E-06)×(HSWConcentration)]+0.46×(SorHSW)]+[3.44E-06×(LSWConcentration)]R2=0·95.MSE=8E-04

11 PCmaxLSW=-13.44+1.2E-04×HSWConcentration+[0.93×(PCmaxHSW)+7.58E-04×LSWConcentration]R2=0·93.MSE=1·2E-02

12 a1LSW=0.314-(8.51E-06)×(HSWConcentration)]+(1.35)×(a1HSW)]-2.6E-05×LSWConcentrationR2=0·90.MSE=4·3E-01

13 a2LSW=0.034+2.3E-07×HSWConcentration+[1.22×(a2HSW)-1.6E-05×LSWConcentration]R2=0·99.MSE=6·7E-05

14 k2LSW=-68.44+(1.3E-03)×(HSWConcentration)]+(1.13)×(k2HSW)]+[8E-04×(LSWConcentration)]R2=0·97.MSE=3·4E-04

In the above equations, (HSW Concentration) is the concentration of high-salinity water, and (LSW Concentration) is the concentration of low-salinity water. The subscript of each of the coefficients indicates high and low salinity conditions.

For RTP2 (clayey formation), the proposed correlations are as Eqs. 11–15 for every desired low-salinity case. The experimental conditions for developing correlations include the porosity range of 0.1–0.35, permeability range of 0.00001–100 Darcy, weakly water wet wettability, and clayey formation. Moreover, these correlations are used for the salinity range between 1000 and 10,000 ppm:15 nwLSW=2.063-1E-05×HSWConcentration+[0.601×(nwHSW)-2E-05×LSWConcentration]R2=0·94.MSE=9·09E-05

16 noLSW=-0.611-8E-06×HSWConcentration+[1.17×(noHSW)+1.62E-05×LSWConcentration]R2=0·98.MSE=1·3E-05

17 krwLSWend=0.025-2.2E-06×HSWConcentration+[0.778×(krwHSWend)+7.73E-06×LSWConcentration]R2=0·97.MSE=3·37E-06

18 kroLSWend=-0.89+1.99E-05×HSWConcentration+[1.57×(kroHSWend)-3.9E-06×(LSWConcentration)]R2=0·94.MSE=1·1E-05

19 SorLSW=0.097-(9.6E-06)×(HSWConcentration)]+(1.45)×(SorHSW)]+[3.17E-06×(LSWConcentration)]R2=0·99.MSE=3·1E-05

20 PCmaxLSW=-24.83+6.95E-04×HSWConcentration+[0.55×(PCmaxHSW)+8.98E-04×LSWConcentration]R2=0·92.MSE=2·3E-02

21 a1LSW=1.4-(3.6E-05)×(HSWConcentration)]+(1.17)×(a1HSW)]-2.5E-05×LSWConcentrationR2=0·97.MSE=6·5E-04

22 a2LSW=-0.37+(4.5E-06)×(HSWConcentration)]+(1.7)×(a2HSW)]-3E-05×LSWConcentrationR2=0·90.MSE=7·2E-02

23 k2LSW=-6.2+(2.8E-07)×(HSWConcentration)]+(1.01)×(k2HSW)]+[4.19E-04×(LSWConcentration)]R2=0·99.MSE=7·5E-05

Since few similar studies were available, the results of Rivett for RTP142, and Shojaei for RTP250 were used to validate the developed correlations and is presented in Table 6:Table 6 Validation of the proposed correlations for RTP1 and RTP2 against reported experimental data.

Refs.	nw(Low Sal)	no(Low Sal)	krwend(Low Sal)	kroend(Low Sal)	Sor(Low Sal)	
Correlation	Exp	Correlation	Exp	Correlation	Exp	Correlation	Exp	Correlation	Exp	
Rivet42 (RTP1)	3.35	3.2	1.19	1.21	0.06	0.05	0.44	0.38	0.19	0.2	
Shojaei50 (RTP2)	2.62	2.6	1.37	1.4	0.03	0.04	0.99	0.99	0.121	0.12	

Although the data from these two studies were not used to develop oil and water relative permeability correlations, a suitable match was observed (R2 = 0.95, MSE = 1.2E-04 for RTP1 and R2 = 0.97, MSE = 8E-05 for RTP2). Therefore, it is possible to use these proposed correlations to determine the relative permeability and capillary pressure functions at every desired low-salinity condition, within the scope of the mentioned conditions with high accuracy.

Averaging relative permeability and capillary pressure curves

Among the rock properties, capillary pressure and relative permeability are more challenging, as are functions of fluids’ saturation. TEM function is calculated by having relative permeability, permeability, porosity, and viscosity. Equation 24 is similar to the J function and is extensively used to scale the capillary pressure curve27. The average relative permeability should be determined for each rock type as a function of the normalized saturation. The weighted relative permeability approach (Eq. 25) determines the average relative permeability curve for RTP1 and RTP2. The obtained pseudo relative permeability curve in this method varies between zero and one27,36.

In Eq. 17, kra(Ave) is the average phase relative permeability for each rock type, Tx is the phase transmissibility, μa is the phase viscosity, φ is the rock’s porosity, and k is the rock’s absolute permeability.24 TEMa=kkraφμa

25 kra(Ave)=∑i=1n[Txkra]i∑i=1n[TX]i=∑i=1n[TEMa]i∑i=1n[kφμa]i=∑i=1n[kkraφμa]i∑i=1n[kφμa]i

“The Leverett J” is a dimensionless number relating capillary pressure to rock and fluid properties such as porosity, interfacial tension, and mean pore radius. It is the most common method used for averaging capillary pressure curves and can be calculated using Eq. 266:26 J(Sw)=0·2166×Pc×kφσ×cosθ

Pc is capillary pressure (psi), σ is the interfacial tension (0.27 dynes/cm), θ is the fluid’s contact angle (θ = 0), and J is a dimensionless value. To estimate the average capillary pressure using J-function, the following steps are required:Equation 26 converts the capillary pressure values to the J-function.

Calculation of the average J-function for a block by using the pore volume averaging is as Eq. 27:27 Jave=∑i=1nJiViφi∑i=1nViφi

Vi and φi stand for each rock sample’s bulk volume and porosity, respectively.3. The average capillary pressure is finally calculated (Eq. 28) by having the average J-function values (Eq. 27).28 Pc(ave)=Jave×δ×0·2166Kaveφave

Results

The HSW for our case is 42,000 ppm (sea water). Based on the literature review3,46,51,53–59, approximately ten times the dilution of HSW could be considered as the optimized salinity. All relative permeability and capillary pressure curves obtained from studies (RTP1 and RTP2) are calculated to a low salinity of 4000 ppm (based on developed correlations). The low-salinity (4000 ppm) relative permeability curves from all studies of RTP1 and RTP2 are shown in Fig. 4a,b:Figure 4 The low-salinity (4000 ppm) relative permeability curves from all studies of RTP1 (a) and RTP2 (b).

Averaged relative permeability and capillary pressure curve for a low salinity case

As mentioned, the size of grid cells in the simulator for large-scale applications is much larger than laboratory core plugs where rock properties are measured. Thus, averaging techniques should be used to obtain simulation block properties6 (Fig. 5).Figure 5 Averaging process of the relative permeability and capillary pressure curves.

The obtained pseudo relative permeability curves for RTP1 and RTP2 using the weighted relative permeability approach for a low-salinity case of 4000 ppm are shown in Fig. 6:Figure 6 Averaging relative permeability model parameters in normalized form for RTP1 (a) and RTP2 (b).

The average capillary pressure curves for RTP1 and RTP2 for a low-salinity case of 4000 ppm are also illustrated in Fig. 7a,b:Figure 7 Averaging model parameters and converting to averaged Pc for RTP1 (a) and RTP2 (b).

Finally, a single curve for capillary pressure and relative permeability would be assigned to each grid cell within a rock type.

Investigating the effect of salinity and clay content on the obtained averaged curves

The salinity condition of 4000 ppm is considered to determine averaged relative permeability and capillary pressure curves. For RTP1 and RTP2, the comparison of HSW (42,000) and LSW relative permeability curves is shown in Fig. 8a,b:Figure 8 Comparison of HSW (42,000) and LSW (4000 ppm) water/oil relative permeability curves for RTP1 (a) and RTP2 (b).

Comparison of HSW and LSW capillary pressure for RTP1 and RTP2 is as Fig. 9a,b:Figure 9 Comparison of HSW (42,000) and low-salinity water (4000 ppm) capillary pressure for RTP1 (a) and RTP2 (b).

Discussion

As shown in Fig. 8a,b, as a result of changing salinity from high to low, water relative permeability curves have declined significantly, and oil relative permeability curves have increased. It is noticed that the change in water relative permeability appears to be higher than in the oil relative permeability. Moreover, the relative permeability curve shifted to the right, which implied higher water wettability. For RTP2, due to the clay content, a noticeable shift toward the highest saturations is observed. Moreover, a decrease in residual oil saturation and an increase in irreducible water saturation are also observed, which confirms the water-wetting nature of the rock.

As demonstrated in Fig. 9a,b, less negative capillary pressure is obtained by LSW flooding, and thereby, water flood efficiency is improved.

A shift in capillary pressure due to clay content is also observed in RTP2 compared to RTP1. Moreover, the capillary pressure of RTP2 has fewer negative parts due to its wetting nature. The obtained averaged low-salinity curves would be assigned to grid cells in the reservoir simulator to investigate the low-salinity flood process at the core and field (after upscaling) scale.

The entire process to achieve averaged relative permeability and capillary pressure curves at a desired low-salinity condition is shown in Fig. 10:Figure 10 Hybrid particle swarm optimization with machine learning technique to achieve averaged relative permeability and capillary pressure curves at a desired low-salinity condition.

The proposed hybrid method of coupling PSO and machine learning technique for estimating relative permeability and capillary pressure functions could be a suitable tool for core scale simulations of water-based EOR methods, and in particular, low-salinity flooding applications. Moreover, upscaling the obtained averaged low-salinity curves would help investigate the low-salinity flood process at the field scale.

Conclusions

Due to the challenges of obtaining the experimental data of relative permeability and capillary pressure in the low-salinity flood, hybrid particle swarm optimization coupled with a multiple linear regression method is proposed in this study to determine the relative permeability and capillary pressure functions. To this end, the particle swarm optimization algorithm is coupled with a simulator to provide the required data from previously lab-reported studies for low-salinity floods. By having the matching parameters in two different salinities (high and low), the relative permeability and capillary pressure parameters were estimated through linear interpolation in other low-salinity conditions, and finally, by using multi-linear regression, a set of correlations for relative permeability and capillary pressure functions for low salinity flood were developed. The experimental conditions for developing correlations included the porosity range of 0.15–0.4 for rock type 1, and 0.1–0.35 for rock type 2, the permeability range of 0.01–100 Darcy for rock type 1, and 0.00001–100 Darcy for rock type 2, type of wettability (mixed and weakly water wet), salinity range from 1000 to 10000 ppm, and clay content. The weighted-relative permeability approach and the Leverett J function were used as averaging techniques to assign one single curve of relative permeability and capillary pressure. The main results obtained in this study are as follows:As a result of automatic history matching by coupling particle swarm optimization algorithm and a simulator, relative permeability and capillary pressure parameters were obtained with less than 5% error and a running time of 2.5 h.

The developed correlations were validated against experimental results of no clay rock type and clayey formation rock type with regression of 95% and 97%, and mean square error of 1.2E-04 and 8E-05 respectively.

Based on the obtained averaged relative permeability and capillary pressure curves, the effect of salinity on the results was investigated. By changing salinity from 42000 to 4000 ppm, water relative permeability curves have declined significantly, and oil relative permeability curves have increased. The change in water relative permeability appears to be higher than oil relative permeability.

The effect of clay content on the results was also investigated. For the clayey formation rock type, a noticeable shift toward the highest saturations related to the clay content in the relative permeability and capillary pressure curves was observed. Also, the corresponding capillary pressure curve exhibited fewer negative parts as compared to the no-clay rock type.

The proposed hybrid method could be a suitable tool for core scale simulations of the water-based EOR methods. Upscaling the obtained averaged low-salinity curves would help investigate the low-salinity flood process at the field scale since limited data are available on the subject, which is suggested as future work.

List of symbols

a1.2 Correlation parameters [−]

b1 Correlation parameters [−]

k1.2 Correlation parameters [−]

Jave The average J-function for a block [−]

J(Sw) The Leverett J function [−]

k Absolute permeability [m2]

kra(Ave) The phase average relative permeability [−]

krw/o(HSW)end Water/oil endpoint relative permeability at high salinity [−]

krw/o(LSW)end Water/oil endpoint relative permeability at low-salinity [−]

nw/o(HSW) The constant of Corey’s equation for water/oil at high salinity [−]

nw/o(LSW) The constant of Corey’s equation for water/oil at low-salinity [−]

PCave The average capillary pressure [kPa]

(RF)Exp Measured recovery factor [−]

(RF)Sim Simulated recovery factor [−]

Snw Normalized water saturation [m3]

Sor(HSW) Residual oil saturation at high salinity [m3/m3]

Sor(LSW) Residual oil saturation at low-salinity [m3]

Tx The phase transmissibility [m2/mp s]

Vi The rock sample’s bulk volume [m3]

(ΔP)Exp Measured differential pressure [kPa]

(ΔP)Sim Simulated differential pressure [kPa

Greek letters

θ The fluid’s contact angle [−]

μa The phase viscosity [mPa·s]

φ Porosity [m3/m3]

σ The interfacial tension [N/m

Author contributions

R.K.: Conducting simulation and optimization sections, writing the article, and analyzing the results. M.S.: Conceived of the presented idea, discussed the results and contributed to the final manuscript. M.C.: Conceived of the presented idea, discussed the results and contributed to the final manuscript.

Competing interests

The authors declare no competing interests.

Publisher's note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
==== Refs
References

1. Sorop, T. G., Masalmeh, S. K., Suijkerbuijk, B. M., van der Linde, H. A., Mahani, H., Brussee, N. J., Marcelis, F. A. & Coorn, A. Relative permeability measurements to quantify the low salinity flooding effect at field scale. In Abu Dhabi International Petroleum Exhibition and Conference. 2015. OnePetro. 10.2118/177856-MS.
2. Saboorian-Jooybari H Dejam M Chen Z Heavy oil polymer flooding from laboratory core floods to pilot tests and field applications: Half-century studies J. Petrol. Sci. Eng. 2016 142 85 100 10.1016/j.petrol.2016.01.023
3. Tahir, M., Hincapie, R. E., Foedisch, H., Abdullah, H. & Ganzer, L. Impact of sulphates presence during application of smart water flooding combined with polymer flooding. In SPE Europec featured at 80th EAGE conference and Exhibition. 2018. OnePetro. 10.2118/190796-MS
4. Udy J Hansen B Maddux S Petersen D Heilner S Stevens K Hedengren JD Review of field development optimization of waterflooding, EOR, and well placement focusing on history matching and optimization algorithms Processes 2017 5 3 34 10.3390/pr5030034
5. Chai Z Nwachukwu A Zagayevskiy Y Amini S Madasu S An integrated closed-loop solution to assisted history matching and field optimization with machine learning techniques J. Pet. Sci. Eng. 2021 198 108204 10.1016/j.petrol.2020.108204
6. Semnani AK Shahverdi H Khaz'ali AR Averaging the experimental capillary pressure curves for scaling up to the reservoir condition in the imbibition process J. Pet. Sci. Eng. 2020 184 106539 10.1016/j.petrol.2019.106539
7. Ranazzi, P. H. & Pinto, M. A. S. Assisted history matching using combined optimization methods. In Proceedings of the Iberian Latin-American Congress on Computational Methods in Engineering, Florianópolis, Brazil. 2017.
8. Lee, S. & Stephen, K. Field application study on automatic history matching using particle swarm optimization. In SPE Reservoir Characterisation and Simulation Conference and Exhibition. 2019. OnePetro. 10.2118/196678-MS
9. Romero C Carter J Using genetic algorithms for reservoir characterisation J. Pet. Sci. Eng. 2001 31 2–4 113 123 10.1016/S0920-4105(01)00124-3
10. Razghandi M Dehghan A Yousefzadeh R Application of particle swarm optimization and genetic algorithm for optimization of a southern Iranian oilfield J. Pet. Explor. Prod. 2021 11 4 1781 1796
11. Sanghyun, L. & Stephen, K. D. Optimizing automatic history matching for field application using genetic algorithm and particle swarm optimization. In Offshore Technology Conference Asia. 2018. OnePetro. 10.4043/28401-MS.
12. Adibifard M Talebkeikhah M Sharifi M Hemmati-Sarapardeh A Iterative ensemble Kalman filter and genetic algorithm for automatic reconstruction of relative permeability curves in the subsurface multi-phase flow J. Pet. Sci. Eng. 2020 192 107264 10.1016/j.petrol.2020.107264
13. Mohammadi S Khodapanah E Tabatabaei-Nejad SA Simulation study of salinity effect on polymer flooding in core scale J. Chem. Pet. Eng. 2019 53 2 137 152
14. Christie, M., Eydinov, D., Demyanov, V., Talbot, J., Arnold, D. & Shelkov, V. Use of multi-objective algorithms in history matching of a real field. In SPE Reservoir Simulation Symposium. 2013. OnePetro. 10.2118/29127-MS.
15. Al-Sawafi MSM Simulation of Enhanced Heavy Oil Recovery: History Match of Water Flooding and Polymer Injection at Adverse Mobility Ratio 2015 The University of Bergen
16. Fayazi A Bagherzadeh H Shahrabadi A Estimation of pseudo relative permeability curves for a heterogeneous reservoir with a new automatic history matching algorithm J. Pet. Sci. Eng. 2016 140 154 163 10.1016/j.petrol.2016.01.013
17. Ligthelm, D. J., Gronsveld, J., Hofman, J., Brussee, N., Marcelis, F. & van der Linde, H. Novel waterflooding strategy by manipulation of injection brine composition. In EUROPEC/EAGE Conference and Exhibition. 2009. OnePetro. 10.2118/119835-MS.
18. Korovin, M., Merkulov, V. & Gojkovic, S. Permeability inhomogeneity accounting in terms of efficient development strategy. In IOP Conference Series: Earth and Environmental Science. 2015. IOP Publishing.
19. Guler B Ertekin T Grader A An artificial neural network based relative permeability predictor J. Can. Pet. Technol. 2003 10.2118/03-04-02
20. Mohamadi-Baghmolaei M Azin R Sakhaei Z Mohamadi-Baghmolaei R Osfouri S Novel method for estimation of gas/oil relative permeabilities J. Mol. Liq. 2016 223 1185 1191 10.1016/j.molliq.2016.08.096
21. Bazargan H Adibifard M A stochastic well-test analysis on transient pressure data using iterative ensemble Kalman filter Neural Comput. Appl. 2019 31 8 3227 3243 10.1007/s00521-017-3264-5
22. Ershadnia R Amooie MA Shams R Hajirezaie S Liu Y Jamshidi S Soltanian MR Non-Newtonian fluid flow dynamics in rotating annular media: Physics-based and data-driven modeling J. Pet. Sci. Eng. 2020 185 106641 10.1016/j.petrol.2019.106641
23. Ahmadi MA Zendehboudi S Dusseault MB Chatzis I Evolving simple-to-use method to determine water–oil relative permeability in petroleum reservoirs Petroleum 2016 2 1 67 78 10.1016/j.petlm.2015.07.008
24. Wang, K., Killough, J. E. & Sepehrnoori, K. A new upscaling method of relative permeability curves for reservoir simulation. In SPE Annual Technical Conference and Exhibition. 2009. OnePetro. 10.2118/124819-MS.
25. Compan A Bodstein G Couto P A relative permeability rock-typing methodology with a clustering method combined with a heuristic optimization procedure SPE J. 2016 21 05 1899 1915 10.2118/180916-PA
26. Ferreira, F., Pairoys, F., Klemin, D., Baser-Langenau, B., Safonov, S., Dinariev, O., Evseev, N., Silva, M. & Da Fraga Carneiro, G. Innovative workflow for grouping, averaging, end-point scaling and assessing uncertainty of water-oil relative-permeability curves, considering corresponding normalized water-fractional-flow curves, reservoir-rock types and wettability indexes. In Abu Dhabi International Petroleum Exhibition & Conference. 2017. OnePetro. 10.2118/188260-MS.
27. Mirzaei-Paiaman A Ghanbarian B A note on dynamic rock typing and TEM-function for grouping, averaging and assigning relative permeability data to reservoir simulation models J. Nat. Gas Sci. Eng. 2021 87 103789 10.1016/j.jngse.2020.103789
28. Coats K Nielsen R Terhune MH Weber A Simulation of three-dimensional, two-phase flow in oil and gas reservoirs Soc. Pet. Eng. J. 1967 7 04 377 388 10.2118/1961-PA
29. Gasda S Celia MA Upscaling relative permeabilities in a structured porous medium Adv. Water Resour. 2005 28 5 493 506 10.1016/j.advwatres.2004.11.009
30. Han S Kwak D Lee Y Jang Y Sung W Relative permeability prediction considering complex pore geometry and wetting characteristics in carbonate reservoirs Int. J. Oil Gas Coal Technol. 2017 15 4 10.1504/IJOGCT.2017.084836
31. Lemouzy, P., Romeu, R. K. & Morelon, I. A new scaling-up method to compute relative permeability and capillary pressure for simulation of heterogeneous reservoirs. In SPE Annual Technical Conference and Exhibition. 1993. OnePetro. 10.2118/26660-MS.
32. Kyte JR Berry D New pseudo functions to control numerical dispersion Soc. Pet. Eng. J. 1975 15 04 269 276 10.2118/5105-PA
33. Stone, H. Rigorous black oil pseudo functions. In SPE Symposium on Reservoir Simulation. 1991. OnePetro.
34. Christie, M., Mansfield, M., King, P., Barker, J. & Culverwell, I. renormalisation-based upscaling technique for WAG floods in heterogeneous reservoirs. In SPE Reservoir Simulation Symposium. 1995. OnePetro. 10.2118/29127-MS.
35. Saad, N., Cullick, A. & Honarpour, M. Effective relative permeability in scale-up and simulation. In Low Permeability Reservoirs Symposium. 1995. OnePetro. 10.2118/29592-MS.
36. Barker JW Dupouy P An analysis of dynamic pseudo-relative permeability methods for oil-water flows Pet. Geosci. 1999 5 4 385 394 10.1144/petgeo.5.4.385
37. Pickup GE Stephen KD An assessment of steady-state scale-up for small-scale geological models Pet. Geosci. 2000 6 3 203 210 10.1144/petgeo.6.3.203
38. Lohne A Virnovsky G Durlofsky LJ Two-stage upscaling of two-phase flow: From core to simulation scale SPE J. 2006 11 03 304 316 10.2118/89422-PA
39. Leverett MC Lewis WB Steady flow of gas–oil–water mixtures through unconsolidated sands Trans. AIME 1941 142 01 107 116 10.2118/941107-G
40. Kazemi Nia Korrani, A. & Jerauld, G. R. Upscaling low salinity benefit from lab-scale to field-scale-an ensemble of models with a relative permeability uncertainty range. In SPE Improved Oil Recovery Conference. 2022. OnePetro. 10.2118/209412-MS.
41. Zhang, Y., Xie, X. & Morrow, N. R. Waterflood performance by injection of brine with different salinity for reservoir cores. In SPE Annual Technical Conference and Exhibition. 2007. OnePetro. 10.2118/109849-MS
42. Rivet, S. M., Lake, L. W. & Pope, G. A. A coreflood investigation of low-salinity enhanced oil recovery. In SPE Annual Technical Conference and Exhibition. 2010. OnePetro. 10.2118/134297-MS
43. Winoto, W., Loahardjo, N., Xie, X. S., Yin, P. & Morrow, N. R. Secondary and tertiary recovery of crude oil from outcrop and reservoir rocks by low salinity waterflooding. In SPE Improved Oil Recovery Symposium. 2012. OnePetro. 10.2118/154209-MS
44. Wang X Alvarado V Analysis of capillary pressure and relative permeability hysteresis under low-salinity waterflooding conditions Fuel 2016 180 228 243 10.1016/j.fuel.2016.04.039
45. Hernández, E., Valero, E., Rodríguez, I., Guerra, E., Espinoza, J., Briceño, R. & Veliz, A. Enhancing the recovery of an extra heavy oil reservoir by using low salinity polymer flooding. In SPE Latin American and Caribbean Petroleum Engineering Conference. 2020. OnePetro. 10.2118/199014-MS.
46. Kozaki, C. Efficiency of low salinity polymer flooding in sandstone cores. (2012)
47. Aladasani, A., Bai, B. & Wu, Y.-S. Investigating low-salinity waterflooding recovery mechanisms in sandstone reservoirs. In SPE Improved Oil Recovery Symposium. 2012. OnePetro. 10.2118/152997-MS.
48. Fjelde, I., Asen, S. M. & Omekeh, A. Low salinity water flooding experiments and interpretation by simulations. In SPE Improved Oil Recovery Symposium. 2012. OnePetro. 10.2118/188260-MS.
49. Mjøs JES Low Salinity Water Flood in Combination with Surfactant/Polymer: Effect of Brine Composition 2014 The University of Bergen
50. Shojaei M-J Ghazanfari MH Masihi M Relative permeability and capillary pressure curves for low salinity water flooding in sandstone rocks J. Nat. Gas Sci. Eng. 2015 25 30 38 10.1016/j.jngse.2015.04.023
51. Kadeethum, T., Sarma, H. & Maini, B. Overcome viscous fingering effect in heavy oil reservoirs by an optimized smart water injection scheme. In SPE Canada Heavy Oil Technical Conference. 2017. OnePetro. 10.2118/184966-MS
52. Attar A Muggeridge A Low salinity water injection: Impact of physical diffusion, an aquifer and geological heterogeneity on slug size J. Pet. Sci. Eng. 2018 166 1055 1070 10.1016/j.petrol.2018.03.023
53. Shaker Shiran B Skauge A Enhanced oil recovery (EOR) by combined low salinity water/polymer flooding Energy Fuels 2013 27 3 1223 1235 10.1021/ef301538e
54. Almansour AO AlQuraishi AA AlHussinan SN AlYami HQ Efficiency of enhanced oil recovery using polymer-augmented low salinity flooding J. Pet. Explor. Prod. Technol. 2017 7 4 1149 1158 10.1007/s13202-017-0331-5
55. Unsal E Ten Berge A Wever D Low salinity polymer flooding: Lower polymer retention and improved injectivity J. Pet. Sci. Eng. 2018 163 671 682 10.1016/j.petrol.2017.10.069
56. Rock, A., Hincapie, R., Wegner, J. & Ganzer, L. Advanced flow behavior characterization of enhanced oil recovery polymers using glass-silicon-glass micromodels that resemble porous media. In SPE Europec Featured at 79th EAGE Conference and Exhibition. 2017. OnePetro.
57. Zhao, Y., et al. Performance of low salinity polymer flood in enhancing heavy oil recovery on the Alaska North slope. In Unconventional Resources Technology Conference, 20–22 July 2020. 2020. Unconventional Resources Technology Conference (URTEC).
58. Tahir, M., Hincapie, R. E., Foedisch, H., Strobel, G.-J. & Ganzer, L. Potential benefits of fluid optimization for combined smart-water and polymer flooding: Impact on remaining oil saturation. In SPE Russian Petroleum Technology Conference. 2019. OnePetro.
59. Tahir M Hincapie RE Langanke N Ganzer L Jaeger P Coupling microfluidics data with core flooding experiments to understand sulfonated/polymer water injection Polymers 2020 12 6 1227 10.3390/polym12061227 32481627
