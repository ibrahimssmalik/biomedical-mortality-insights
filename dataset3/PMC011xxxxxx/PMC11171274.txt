
==== Front
J Chem Theory Comput
J Chem Theory Comput
ct
jctcce
Journal of Chemical Theory and Computation
1549-9618
1549-9626
American Chemical Society

38820347
10.1021/acs.jctc.3c01403
Article
Orbital-Resolved DFT+U for Molecules and Solids
https://orcid.org/0009-0003-4546-0887
Macke Eric *†
https://orcid.org/0000-0002-6531-9966
Timrov Iurii ‡§
https://orcid.org/0000-0002-9764-0199
Marzari Nicola ‡¶
https://orcid.org/0000-0003-1444-9733
Ciacchi Lucio Colombi †
† Faculty of Production Engineering, Bremen Center for Computational Materials Science and MAPEX Center for Materials and Processes, Hybrid Materials Interfaces Group, University of Bremen, Am Fallturm 1, 28359 Bremen, Germany
‡ Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (MARVEL), École Polytechnique Fédérale de Lausanne, CH-1015 Lausanne, Switzerland
¶ University of Bremen Excellence Chair, Bremen Center for Computational Materials Science, Am Fallturm 1, 28359 Bremen, Germany
* E-mail: emacke@uni-bremen.de.
31 05 2024
11 06 2024
20 11 48244843
22 12 2023
02 05 2024
25 03 2024
© 2024 The Authors. Published by American Chemical Society
2024
The Authors
https://creativecommons.org/licenses/by/4.0/ Permits the broadest form of re-use including for commercial purposes, provided that author attribution and integrity are maintained (https://creativecommons.org/licenses/by/4.0/).

We present an orbital-resolved extension of the Hubbard U correction to density-functional theory (DFT). Compared to the conventional shell-averaged approach, the prediction of energetic, electronic and structural properties is strongly improved, particularly for compounds characterized by both localized and hybridized states in the Hubbard manifold. The numerical values of all Hubbard parameters are readily obtained from linear-response calculations. The relevance of this more refined approach is showcased by its application to bulk solids pyrite (FeS2) and pyrolusite (β-MnO2), as well as to six Fe(II) molecular complexes. Our findings indicate that a careful definition of Hubbard manifolds is indispensable for extending the applicability of DFT+U beyond its current boundaries. The present orbital-resolved scheme aims to provide a computationally undemanding yet accurate tool for electronic structure calculations of charge-transfer insulators, transition-metal (TM) complexes and other compounds displaying significant orbital hybridization.

Deutsche Forschungsgemeinschaft 10.13039/501100001659 286518848 RTG 2247 QM3 UniversitÃ¤t Bremen 10.13039/501100007837 NA Schweizerischer Nationalfonds zur FÃ¶rderung der Wissenschaftlichen Forschung 10.13039/501100001711 205602 document-id-old-9ct3c01403
document-id-new-14ct3c01403
ccc-price
==== Body
pmc1 Introduction

Hubbard corrections are among the most widely used improvements to approximate Kohn–Sham (KS) density-functional theory (DFT).1,2 The combination of DFT with the Hubbard model,3 referred to as DFT+U, was inspired by this widely studied model of electron correlations and introduced to improve the description provided by local or semilocal exchange-correlation (xc) functionals, such as the local-density approximation (LDA) and the generalized-gradient approximation (GGA), for the case of Mott-Hubbard insulators4−6 or more broadly strongly correlated electrons.

It was recognized early on7,8 that a simplified, rotationally invariant formulation of DFT+U9 provided a natural connection to the requirement of piecewise linearity of the exact energy functional:10,11 the Hubbard correction of Dudarev et al. effectively removes the nonlinear (almost quadratic) behavior of the total energy with respect to the occupation of the Hubbard manifold, and replaces it with a linear term. In this light, the strength of the U parameter can be determined fully from first-principles (for practical reasons using the response of the occupations to a linear perturbation7,8), so that the quadratic curvature is removed by DFT+U. This connection is heuristic, and relies on the (very reasonable) assumption that the localized electrons in the d or f manifold are only weakly interacting with the rest of the electron bath, so that this manifold also follows the condition of piecewise linearity (PWL) that is in principle valid only for the total energy functional.10 The overstabilization of fractional occupations in standard (semi)local functionals is driven by the incomplete cancellation from the xc functional to the Hartree term (cancellation that is exact instead in Hartree–Fock), leading to a strong (one-electron) self-interaction component. This is particularly severe for localized electrons, that overdelocalize and overhybridize with their ligands. So, the DFT+U correction should be seen as a self-interaction correction, providing an approximate screened Fock-like contribution; this was stated early on, highlighting how even for molecular systems containing only one site (i.e., one TM atom) the electronic-structure description provided by DFT+U is greatly improved, both qualitatively and quantitatively.12 In other words, while the original Hubbard model was concerned with the correlation effects that appear on a lattice, where each site can only contain 0, 1, or 2 electrons, the functional form that the model inspires, once applied to the continuum of the electron gas of approximate DFT, does not any more account for correlations between sites, but counteracts the tendency of strongly localized electrons to hybridize with their ligands, driven by incomplete cancellation in the Hartree term of the one-electron self-interaction. This can be easily argued not only by applying DFT+U to molecules,12 but also by the simple observation that changing the value of U changes the charge transfer to/from the ligands,13 but does not transfer charge to the Hubbard manifolds on the other sites, highlighting the completely different physics of the Hubbard Hamiltonian on a lattice, and the Hubbard U correction in the continuum of KS electrons. Incidentally, strongly correlated materials have almost invariably very localized d or f electrons, so do benefit from DFT+U – but not because the latter improves the treatment of correlations, but just because it decreases the self-interaction errors (SIE). It is important to iterate that PWL is a property that a system must obey on the global scale, i.e., with respect to the changes in the total number of electrons.14 DFT+U, on the other hand, seeks to eliminate the curvature locally by restoring the piecewise linear behavior in a subspace known as the Hubbard manifold.8,15 The relation between self-interaction and PWL in many-electron systems is somewhat confusing; in fact, Koopmans functionals16,17 impose (very accurately) PWL on each orbital in a given system, but do not correct self-interaction; the integer Koopmans functional (KI) provides the same exact total energy of the base functional (LDA or GGA), but a completely different spectrum. Other recent approaches (based on DFT+U)18−21 even aim to fulfill the flat-plane condition,22 which, in addition to PWL, demands energetic invariance with respect to changes in electron spin in half filled orbitals.

A key challenge in DFT+U arises from the (a priori) choice of the value of the on-site Hubbard U parameter. Often, U is considered a tunable quantity, adjusted to achieve agreement with experimental results for specific properties of interest such as band gaps, lattice parameters, magnetic moments, or formation enthalpies.23−26 However, this empirical procedure possesses limited predictive capabilities due to its reliance on experimental data; not to mention that the KS levels used to compute band gaps are incorrect even in exact DFT (bar the HOMO). Alternatively, U values can be computed from first principles. The different methods that have been proposed for this purpose can be classified into three groups: the constrained DFT approach (cDFT),27−35 the constrained random phase approximation (cRPA),36−40 and Hartree–Fock based approaches.41−46 The linear-response formulation of constrained DFT (LR-cDFT)8 has become a method of choice for many DFT+U studies.47−55 A recent reformulation of this method in terms of density-functional perturbation theory (DFPT)56,57 has significantly enhanced its success. This reformulation enables the replacement of computationally expensive supercells with primitive unit cells, utilizing monochromatic perturbations. As a result, the computational burden of determining Hubbard parameters is substantially reduced.

As evident from the large variety of available methods, considerable attention has been devoted to the numerical evaluation of U for a given manifold. However, the question how this manifold must be defined, that is, which electronic states require on-site Hubbard corrections, is a critical yet often overlooked aspect in DFT+U. Recalling that the main motivation of Hubbard U corrections lies in the mitigation of local SIE through recovery of PWL of the total energy, the Hubbard manifold should contain those and only those states that substantially contribute to the former. Oftentimes, self-interaction occurs in partially occupied d and f shells due to their high electron count and localization; hence, these are the traditional targets of Hubbard U corrections. Nevertheless, self-interaction can also manifest itself in s and p shells, and even in localized molecular orbitals (MO).58 Moreover, the definition of the Hubbard manifold also involves choosing so-called Hubbard-projector functions that suitably represent the states to be corrected (details follow in Section 2.2). In fact, it has been shown that the choice of the projector function can have a strong impact on the calculation, especially when orbital overlap is appreciable.50,59−61 Therefore, it is essential to choose a U value that is consistent with the projectors used (see appendix of ref (62)).

The significance of judiciously selecting the Hubbard manifold becomes particularly evident in the context of optical properties. Although DFT is a total energy theory and KS orbitals have no direct physical meaning except for the highest occupied molecular orbital (HOMO) in exact DFT, KS eigenvalues are commonly used as estimates for experimental quasiparticle energies. Unfortunately, uncorrected (semi)local DFT functionals tend to severely underestimate properties such as band gaps and ionization energies; a fact that has been linked to deviations from PWL.16,17,63 Thus, Koopmans-compliant functionals16,17,64 systematically improve spectral properties by imposing PWL on all orbitals in the system. For example, a study by Nguyen et al. found an average band gap error of only 0.22 eV for a test set of 30 semiconductors.65 Conversely, DFT+U can only achieve such improvements if the Hubbard manifold sufficiently overlaps with the frontier orbitals.15,50,66 This might explain why DFT+U has been successfully applied to many Mott-Hubbard insulators, while its predictive capabilities are less reliable when applied to charge-transfer insulators. While in the former both the valence band maximum (VBM) and the conduction band minimum (CBM) primarily consist of localized TM d states, the frontier states of the latter possess significant ligand orbital character. In this case, the sole correction of TM d shells does not necessarily target all major sources of SIE. Additionally, the representation of the hybridized orbitals through atomic-like Hubbard projectors can be deceptive.

Some authors have explored including ligand orbitals in the on-site Hubbard manifold, for example applying U corrections to O-p and S-p shells of TM compounds.50,53,67−69 The extended DFT+U+V framework58 was adopted for scenarios where hybridization plays an eminent role. This method augments DFT+U by an intersite Hubbard V term, and so acts on combinations of projectors located on different sites, enhancing accuracy and transferability.46,59,70−79 Finally, many open-shell systems require unlike-spin terms such as Hund’s J. In DFT+U+J, these terms introduce an unlike-spin exchange correction, while also reducing the effective value of the U parameter.53,66,68,80,81 It remains to be shown in how far a single-determinant method such as DFT+U(+J) suffices to adequately describe compounds with a strong multireference character, but it is likely that Hubbard U and Hund’s J corrections can improve the description of approximate single-determinant solutions to multiconfigurational systems8,82 (often obtained by breaking the symmetry83).

What is striking about the aforementioned approaches is that the d shell Hubbard manifold is either extended by additional states (U on ligands or V on molecular orbitals) or internally rebalanced (DFT+U+J). But what if the practice of including the entire d shell is, in itself, problematic? Recent work by Mariano et al. suggests that this might indeed occur in some cases.84,85 Their study revealed that applying U corrections to the d shells of Fe in strong-field Fe(II) hexacomplexes leads to a spurious suppression of low-spin states due to what appears to be an overcorrection of hybridized eg orbitals. Furthermore, the use of ab initio Hubbard U parameters derived from LR-cDFT led to a significant decrease in the overall accuracy of the spin-state energies when compared to empirical U values. These and other observations suggest a critical analysis of the current practice of how (shell-averaged) Hubbard U corrections are applied to DFT. After all, the correction of all magnetic quantum orbitals within a given shell using the same scalar U parameter is inherently a simplistic approximation.86

Therefore, it is worthwhile to investigate whether departing from the shell-averaged approximation can improve DFT+U calculations concerning energetic, structural, and magnetic properties. This possibility has been explored in a few works. For example, Solovyev et al. showed that a selective application of U corrections to the t2g manifolds of LaMO3 perovskites (M=Ti–Cu) significantly improves the agreement of band gaps and magnetic orderings with experiments compared to both uncorrected LDA and shell-averaged LDA+U.87 The authors argue that eg electrons are reasonably described by the uncorrected LDA functional because of their “itinerant” behavior that arises due to the strong σ overlap between O-2p and M-eg orbitals. Pickett et al. adopted the cDFT approach to compute the Hubbard parameters of Fe in bulk FeO as a matrix (U) with U values specific to the t2g and eg manifolds, respectively.32 Using a different scheme, orbital-resolved Hubbard parameters were obtained by mapping shell-averaged U and J parameters onto orbital-dependent interaction and exchange matrices Umm′ and Jmm′ using atomic Slater integrals and Gaunt’s numbers.88−91 Other works focused on the spin-dependence of U, finding that the spin-resolved on-site parameters can be pivotal for a physical description of magnetic systems.54,55,92

Despite these early efforts, orbital-resolved Hubbard U parameters have not gained widespread use in the DFT community. This is surprising in light of the fact that orbital-specific Hubbard manifolds are quite common in the dynamical mean-field theory (DMFT) community.93−96 In the latter, Hubbard U parameters are routinely computed for manifolds that range from groups of orbitals (e.g., t2g models) to combinations of multiple shells localized on different atoms (e.g., d – p models)94 using cRPA in conjunction with various sets of Wannier projector functions that encompass the specific manifold of interest.36,37 To date, only a few publicly available DFT codes incorporate this capability. For example, DFT codes that use Wannier function-based Hubbard projectors (e.g., ONETEP(97)) indirectly facilitate orbital-resolved DFT+U calculations as the Wannier functions can be chosen to only represent the desired subset of orbitals, e.g., t2g.61

In this paper we present a user-friendly yet general implementation of orbital-resolved DFT+U that works with any kind of Hubbard projector. The numerical values of the necessary parameters are extracted from first-principles using an orbital-resolved LR-cDFT approach.8 We benchmark the orbital-resolved scheme by carrying out calculations of bulk pyrite (FeS2), bulk pyrolusite (β – MnO2) and six Fe(II) molecular hexacomplexes of varying ligand strength. For all of these strongly covalent compounds, the refined approach leads to a substantial improvement in the prediction of structural and energetic properties, aligning more closely with experimental observations than conventional DFT+U or even DFT+U+V. Moreover, we observe that the orbital-resolved U parameters are considerably smaller, by up to 80%, than their corresponding shell-averaged counterparts.

The remainder of the paper is organized as follows. In Section 2, we describe the transition from the customary, shell-averaged implementations of the DFT+U energy functional and the LR-cDFT approach to their generalized, orbital-resolved forms. Subsequently, Section 3 briefly lists the relevant technical details of the calculations, whose results are presented and discussed in Section 4. Section 5 is dedicated to the relationship between the orbital-resolved (on-site) Hubbard U presented in this work and the (intersite) V terms of ref (58). Finally, we summarize the main conclusions in Section 6.

2 DFT+U: Orbital-Resolved Hubbard Parameters

2.1 The Energy Functional

As this work focuses on the on-site U term of Hubbard-corrected DFT, we start from the widespread shell-averaged and rotationally invariant formulation of DFT+U by Dudarev et al.9 Written in a way that allows for the simultaneous correction of multiple subshells on the same atom, the energy functional reads:981

where EDFT is the DFT total energy computed with standard (semi)local xc functionals, UnlI is an effective on-site Hubbard parameter, and nnlIσ is the orbital occupation matrix. The summation over the principal (n) and orbital (l) quantum numbers implies that Hubbard U corrections can be applied simultaneously to multiple subshells of the same atom,50,58 although it usually suffices to treat the valence shell alone. For the sake of clarity, we henceforth omit the index nl, assuming that the Hubbard manifolds consist of, at most, one subshell per atom. The orbital occupation matrix defines how the Hubbard correction is applied. For a given spin σ, its elements are computed by projecting the valence KS wave functions onto the Hubbard manifold of an atom I:2

where m and m′ are the magnetic quantum numbers of the Hubbard manifold, ν represents the band labels of the KS wave functions, k indicates points in the first Brillouin zone, and fk,νσ are occupations of the KS wave functions ψk,νσ. If atomic-like orbitals (φmI) are used as projector functions (vide infra), one may define . Note, however, that if plane-wave basis sets are used, the expression of P̂ also depends on the type of the pseudopotential.57 Applying Hubbard U corrections also modifies the KS potential of the target orbitals according to3

where δmm′ is the Kronecker delta. It is evident from eq 3 that Hubbard U corrections exert a stabilizing influence on fully occupied orbitals, reducing their KS potential by up to U/2, while producing the opposite effect on empty orbitals.

Provided a correct normalization of the Hubbard projector functions, the eigenvalues of express the occupation of the 2l + 1 orbitals with numbers between 0 (fully empty) and 1 (fully occupied). They are obtained by solving the eigenvalue problem84

where λiIσ and viIσ are the eigenvalues and eigenvectors, respectively, and i is a dummy index running from 1 to 2l + 1. This allows us to rewrite the EU contribution of eq 1 more concisely in terms of these eigenvalues:5

Within this diagonal representation, eq 5 can be readily generalized to become an orbital-resolved correction:6

Here, UiI is now an effective on-site Hubbard parameter specific to the ith orbital of the Hubbard manifold localized on atom I. Similar generalizations of the shell-averaged DFT+U functional were already postulated by Pickett et al. and used by Solovyev et al., although these early works adopted DFT+U energy functionals different from Dudarev et al.’s formulation.32,87

In practical calculations, not every orbital requires a distinct UiI, and it might suffice to distinguish between the irreducible representations that follow from local point group symmetry. For instance, considering the d shell of an octahedrally coordinated atom with local Oh point group symmetry, eq 6 can be written as7

where and are the Hubbard parameters for the t2g and eg orbitals, respectively, and i ∈ {t2g} means that i runs over the orbital indices of the t2g subshell, while i ∈ {eg} means that i runs over the orbital indices of the eg subshell. It is also possible to selectively exclude specific orbitals from receiving Hubbard corrections by setting UiI=0.

The calculation of the Hubbard potential (eq 3) is also performed in the diagonal representation by rotating the atomic-like orbitals φmI from the global to the local coordinate system using the eigenvectors viIσ. However, after computing the orbital-resolved contributions to the Hubbard potential , we perform a backrotation into the nondiagonal representation as this allows to use existing implementations of density mixing as well as the calculation of forces and stresses with no further adaption.

A crucial aspect for a successful application of Hubbard corrections lies in finding a suitable projector function for the target manifold, as this controls the occupation eigenvalues λiIσ (eq 2) which govern the corrective Hubbard energy. The next subsection offers a concise introduction to the prevailing and commonly utilized approaches.

2.2 Hubbard Projector Functions

There are many ways to define Hubbard projector functions within the DFT+U approach, and the reader is referred to ref (99) and references therein for a more comprehensive overview. For electronic-structure codes employing a localized basis set, natural choices for Hubbard occupations are either Mulliken or Löwdin population matrices.100 In contrast, codes based on plane-wave basis sets often use atomic orbitals as projectors,8,101 whose localized functions are parametrized with free-atom calculations and then stored in the pseudopotentials. During the generation of pseudopotentials, the atomic orbitals are chosen to be orthonormal to all other orbitals centered on the same atom. However, this cannot guarantee orthogonality to orbitals localized on other sites during practical calculations. Hence, these projector functions are referred to as nonorthogonalized atomic orbitals (NAO).59 While straightforward to implement and use, NAO may display spatially extended “tails”, potentially resulting in the same domain being tackled twice by Hubbard corrections if the atomic orbitals of two neighboring atoms overlap.

Truncation spheres101 provide a means of ruling out such double counting by cutting off possible tails.1 However, the radius of these spheres represents an additional parameter that affects the obtained occupation numbers.102 The value of this parameter varies depending on the code utilized and may require manual adjustment (e.g., muffin-tin radius in the linearized augmented plane-wave approach) or can be embedded within the pseudopotential (typical of projector-augmented-wave (PAW) pseudopotentials).

An alternative, parameter-free approach to circumvent truncation involves orthogonalizing NAO across all atomic sites, e.g., using Löwdin’s scheme,103 thus transforming them into orthogonalized atomic orbitals (OAO).59,99 The resulting intersite orthogonality clears the overlap of projectors on different sites99 and even accounts for possible hybridization between them, albeit to a limited extent. Several benchmark studies have shown that OAO projectors consistently outperform NAO projectors with respect to structural, electronic and spectral properties.50,59,75

Finally, Wannier functions are also viable Hubbard projector functions.34,104,105 Specifically, maximally localized Wannier functions (MLWF)106,107 can separate manifolds in a system-specific fashion,108 and can serve as effective Hubbard projector functions within the generalized DFT+U framework presented in eq 6. Despite the extensive use of Wannier functions, their current adoption in DFT+U calculations remains limited,61,109,110 possibly due to the nontrivial steps of finding an appropriate starting guess and disentangling overlapping bands during wannierization. Moreover, features relevant for practical studies such as the calculation of forces and stresses are cumbersome to implement.

2.3 LR-cDFT to Compute Orbital-Resolved U Parameters

LR-cDFT is based on using the DFT+U energy functional to (heuristically) restore PWL for the Hubbard manifold in (semi)local DFT functionals suffering from electron self-interaction.8,12 An important manifestation of the latter are so-called fractional charge errors (FCE), which are spurious (usually convex) deviations from linearity of EDFT with respect to fractional addition or removal of charge,15 i.e.,8

where q represents the charge of the system under consideration. Inspection of eq 1 shows that the Hubbard U correction amounts to removing a quadratic term and adding a linear one, scaled by the numerical value of U. Note, however, that the curvature removed by eq 1 is not with respect to the total charge of the system q but instead with respect to the projected local occupation of the Hubbard manifold nIσ. Thus, a fundamental assumption is that the electrons in this localized Hubbard manifold are the most affected by self-interaction and can be dealt with separately. This interpretation makes it possible to define the value of Hubbard U as the one for which the second derivative of the total energy functional becomes zero with respect to changes in the occupation of the shell,89

where we now use to define the local occupation of the Hubbard manifold. Because a direct control of orbital occupations is not tractable in codes that obtain them as output quantities, Lagrange multipliers α are introduced to linearly shift the potential of the Hubbard manifold and thus indirectly control ΛI (see refs (7, 8, 32) for the derivation). Then, two response matrices are defined using finite differences:10

where χ represents the self-consistent, screened response of the manifold, whereas χ0 is due to the noninteracting, unscreened response coming from the rehybridization of the electronic states that results from the perturbation. In many plane-wave codes, these latter noninteracting orbital occupations Λ0I can be obtained from the first iteration in the self-consistent cycle of the perturbative calculation. Since the response χ0 is unrelated to electron self-interaction, it must be subtracted from the interacting (i.e., screened) response when computing U:11

In practice, the response functions are obtained by either applying multiple small (positive and negative) perturbations to the shells of interest of a converged ground state8 (with periodic systems requiring a supercell approach to avoid interactions between a perturbed Hubbard manifold and its periodic images) or from DFPT56,57,111 using the response to monochromatic perturbations in a primitive cell. Importantly, during peturbative calculations, the Hubbard potential should be fixed to its self-consistent unperturbed DFT+U value, so as to ensure that U is evaluated using only the DFT-part of the curvature.47,58,112

Orbital-resolved Hubbard U parameters can be evaluated using the formalism of eqs 10 and 11 by adapting the definition of the total occupation of the Hubbard manifold. In the most general case, every magnetic quantum orbital i of the nl subshell can acquire an individual Hubbard parameter. The occupation of such a manifold is given by12

With this, the elements of the response matrices (eq 10) can be redefined as13

while the expression for the orbital-resolved on-site Hubbard U parameters becomes14

The generalized formalism of eq 14 not only accommodates orbital-resolved on-site U parameters, but allows for the determination of intersite parameters (UijIJ with I ≠ J, or, following the nomenclature of DFT+U+V, VijIJ), as well as on-site interorbital parameters (UijII for i ≠ j). Nevertheless, the primary emphasis of this study lies in investigating the on-site intramanifold parameters UiiII ≡ UiI.

For the sake of illustration, let us consider a d shell of an atom exhibiting local Oh symmetry. Also, we assume that this atom be the only Hubbard atom in the system, thereby enabling us to neglect intersite responses and to drop the superscript I. Then, one can define an orbital-resolved Hubbard matrix of size 2 × 2 that reads15

where the indices represent the response in occupations of manifold a to perturbation of manifold b, , for instance . Pickett et al. showed that the orbital-resolved matrix elements of eq 15 are related to the shell-averaged Hubbard parameter U through a sum rule.32 A slightly adapted form of this rule that accounts for the role of the noninteracting response reads216

The lesson to learn from eq 16 lies in the off-diagonal values of χ, whose physical implication consists in intrashell screening (in this example eg ↔ t2g). Since the sign of these off-diagonal values is normally opposite to that of the diagonal ones,3 they diminish the contribution of the term ∑ab(χ)a,b, which may substantially increase U values upon computation of the inverse. Note that χ0 is not affected by this, because the off-diagonal elements of the unscreened response are zero by definition (except for numerical noise). In the extreme scenario where perturbations are exclusively screened within the same shell, the sum over the off-diagonal elements equals the trace of χ, causing det(χ) to approach zero, leading to U → ∞. Consequently, if the current definition of the response matrices is used to compute orbital-resolved U parameters, the determinant required for the full inversion of χ inadvertently reintroduces the shell-averaging of the response. This is evident in the findings of the aforementioned study by Pickett et al., where the computed Ut2g (≡Ut2g,t2g) displayed only minimal differences compared to Ueg (≡Ueg,eg) and the shell-averaged U.32 It should be noted that singularities in χ of shells with little to no alternative intershell screening channels occur regardless of the way the shell is partitioned. Even by replacing the t2g/eg distinction by one where all five d orbitals are treated individually, the determinant would still be singular.

Therefore, in order to derive on-site U parameters that explicitly incorporate intrashell screening effects (and avoid singularities), it is necessary to set the off-diagonal matrix elements of χ and χ0 to zero before computing their inverses. This scheme was employed by Linscott et al., who refer to it as pointwise (“1 × 1”) inversion, in order to compute screened and spin-resolved Hubbard parameters for metal aquo complexes.55 Solovyev et al. also applied this strategy, albeit implicitly, to obtain screened U parameters specific to t2g in perovskites.87 Although the removal of off-diagonal elements seems a drastic approximation, it allows for a more tailored definition of Hubbard manifolds compared to the conventional DFT+U approach. The latter assumes (without proof) that ligand orbitals account for the majority of screening while the role of intrashell interactions is neglected. In fact, several cRPA studies suggest that the opposite is true, showing that intrashell screening can be as significant, or even more so, as intershell screening.94,95 Although we are not aware of a metric that allows to gauge how much screening should be present during the evaluation of Hubbard parameters, the examples in Sec. 4 demonstrate that intrashell screening is crucial for some manifolds. That being the case, we expect DFT+U calculations to benefit from using U parameters whose numerical values reflect the true screening environment rather than values computed for a system where important screening channels are absent (either due to orbitals being perturbed simultaneously or due to their inadvertent elimination by performing a full inversion of the orbital-resolved χ matrix). An important caveat to the LR-cDFT approach that also affects the orbital-resolved form presented here is that unphysical U values may result when it is applied to fully occupied manifolds. This is a well-known limitation113,114 that follows from the fact that the response of a deep-lying state to a relatively small perturbation (≈0.05 eV) is often on the same order of magnitude as the numerical noise, leading to instabilities during the inversion of the response matrices.

3 Computational Details

All calculations are carried out using the Quantum ESPRESSO distribution.115−117 We have incorporated the capability to utilize and determine orbital-resolved Hubbard U parameters with the pw.x code and will make this feature available in the next official release. Structure and isosurface plots for pyrite (FeS2) and pyrolusite (β – MnO2) are generated using VESTA.118 Unless stated otherwise, all systems are structurally optimized using the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm119 with convergence thresholds of 10–4 Ry, 10–3 Ry/Bohr, and 0.5 kbar for the total energy, forces, and pressure, respectively. KS wave functions (charge density) are expanded in plane waves up to a kinetic-energy cutoff of 90 Ry (1080 Ry) using PBE120 pseudopotentials for pyrite and the Fe(II) molecular complexes, and PBEsol154 pseudopotentials4 for β – MnO2 taken from the SSSP Precision library v. 1.1.2.124,125 The projected density of states (PDOS) is obtained using a Gaussian smearing with a broadening parameter of 0.02 Ry and employing the diag_basis feature of the projwfc.x code, which projects the wave functions onto the eigenstates of the occupation matrix rather than using unrotated atomic orbital projectors.59 This allows for a clear distinction between tg/t2g and eg states, regardless of the orientation of the global coordinate system. Fe(II) molecular complexes are simulated at a fixed +2 charge state in cubic boxes with an edge length of 15 Å and using only the Γ point to sample the Brillouin zone. The total magnetization of the molecular complexes is always fixed to either 4.0 μB or 0.0 μB in order to compute high-spin (HS) and low-spin (LS) configurations, respectively. The starting geometries of the Fe(II) molecular complexes are taken from the SI of ref (84), whereas experimental structures are chosen as a starting points for FeS2 and β – MnO2. The Brillouin zones of FeS2 and β – MnO2 are sampled with uniform Γ-centered Monkhorst–Pack meshes of sizes 9 × 9 × 9 and 4 × 4 × 6, respectively.

We use Löwdin-orthogonalized atomic orbitals as Hubbard projectors (OAO)99,103 for all DFT+U calculations. Orbital-resolved Hubbard U parameters and orbital-resolved perturbations (α) are applied by targeting specific eigenstates of the occupation matrix (e.g., those corresponding to t2g orbitals). A tracking algorithm126 implemented in the code ensures that the corrections are consistently applied to the desired eigenstates, even if the states’ eigenvalue indices shift during the self-consistent field (SCF) calculation (see SI for further details). As indicated in Section 2.1, the change in potential due to Hubbard U corrections or linear perturbations is computed within the diagonal representation but is rotated back to the nondiagonal one. This transformation is always performed using the eigenvectors of the current occupation matrix, i.e., the occupation matrix corresponding to the charge density of the current SCF iteration. This choice entails some inconsistency because the eigenvectors (of the occupation matrix) are altered by active Hubbard corrections or perturbations. In practice, however, these alterations are minimal and negligible (Table SI 1). Moreover, the self-consistency scheme explained below not only converges the Hubbard parameters but also the eigenvectors of the occupation matrix, thereby eliminating the inconsistency.

As the orbitals’ response depends on the system’s electronic structure, calculated Hubbard parameters may vary significantly when transitioning from a PBE/PBEsol ground state to a PBE+U/PBEsol+U one. Therefore, we achieve self-consistency of the computed U values by employing the iterative procedure detailed in section 4 of ref (57), which has also been used in previous works.47,48,71 In this scheme, one starts from an initial set of Hubbard parameters Uin and an initial structure (where Uin can be zero or can adopt a finite value based on an educated guess35,57). First, a geometry optimization of the structure is performed where energies, forces and stresses are evaluated using DFT+U with U = Uin. The DFT+U ground state of the relaxed structure provides the starting point for perturbative calculations using either LR-cDFT or DFPT. Next, the perturbative calculations are carried out, yielding a new set of Hubbard parameters Uout. If the difference between the input and the output parameters is smaller than a predefined threshold (in this work we use ∼0.1 eV), Uin and the structure are considered to be converged. Otherwise, Uin is set equal to Uout and the procedure is restarted from the structural relaxation step. For a detailed discussion of this and an alternative self-consistency scheme,12 the reader is referred to ref (127).

For the perturbative calculations, the DFPT implementation56,57 of the HP code (hp.x)111 included in Quantum ESPRESSO is employed to evaluate the shell-averaged Hubbard parameters. We use q point meshes of size 2 × 2 × 2 for FeS2 and β – MnO2, and 1 × 1 × 1 for the Fe(II) molecular complexes, respectively. Orbital-resolved U parameters are computed according to the LR-cDFT approach by applying perturbations of α = [−0.05, 0.05]eV to the manifold(s) of interest and recording the noninteracting and interacting responses of the orbital occupations. To avoid interactions of perturbations with their periodic images, the calculations of FeS2 and β – MnO2 are conducted in 2 × 2 × 2 supercells containing 96 atoms. We emphasize that DFPT and LR-cDFT are equivalent by construction, and therefore yield the same Hubbard parameters when applied to identical systems.56 The resulting Hubbard parameters are reported in Section 4.

4 Results and Discussion

4.1 Pyrite (FeS2)

4.1.1 Challenging Theoretical Description

Under normal conditions, pyrite is the stable polymorph of FeS2 and crystallizes in the cubic space group Pa3̅ with an experimental lattice parameter a = 5.418 Å.128 The crystal structure, shown in Figure 1, consists of S2 dimers octahedrally coordinating Fe2+ ions, which form a fcc sublattice.129 At 0 K, the compound is diamagnetic (S = 0) due to the preferred LS configuration of the Fe2+ ions. Pyrite’s natural abundance, optical band gap of ∼0.95 eV, and large optical absorption coefficient make it an appealing material for photovoltaic applications. Nevertheless, despite theoretical predictions suggesting an open circuit voltage of ∼0.71 V based on the Shockley-Queisser equations, experimental results have consistently fallen short, typically measuring values around 0.2 V.130 This discrepancy is among several reasons motivating an accurate quantum-mechanical description of pyrite’s ground state.

Figure 1 Experimental crystal structure of pyrite (FeS2). Fe (brown) is octrahedrally coordinated by S (yellow), which also forms characteristic S– S dimers. The octahedra are slightly distorted and display angles different from 90°.

In early DFT studies, the LDA functional demonstrated exceptional accuracy in predicting the equilibrium volume, band gap, and relative energy levels of the S-3p bands compared to the VBM.129,131 PBE120 and AM05132 provide a qualitatively similar picture but underestimate the band gap by about 0.5 and 0.75 eV, respectively.130

At first glance, the dominant eg contributions in the conduction band (Figure 2) indicate Mott-Hubbard insulation. However, a more detailed analysis of the electronic band structure (Figure 3) reveals that the CBM, located at the Γ point, is composed of a d–pσ* hybrid orbital with dominant S-3pz contributions.

Figure 2 Stacked projected density of states (PDOS) of the nonmagnetic PBE ground-state of pyrite FeS2. The small tg contributions5 in the conduction band and the eg contributions close to the VBM are likely projection artifacts resulting from the slightly canted geometry of the FeS6 octahedra.

Figure 3 (Fat-)Band structure of pyrite computed using the PBE functional. The coloring indicates the most dominant contribution of the manifolds to the individual bands. The uppermost valence bands are predominantly Fe-tg, whereas the conduction bands display a strong S-3pz character at Γ but Fe-eg character elsewhere. Thus, the band gap of pyrite is not a d-d transition, but a d-p one.

This observation holds the key to understanding why numerous electronic structure methods, including more advanced approaches, face challenges in improving the prediction of the band gap beyond the capabilities of PBE. For instance, when employing G0W0, the small PBE band gap diminishes further.134 In contrast, hybrid functionals such as PBE0,135 HSE06,136 DSH,137 and M06138 overestimate its value by more than 1 eV.139 Previous PBE+U studies focused on correcting the Fe-d shell using shell-averaged Hubbard parameters. For example, Sun et al. applied U = 2.0 eV (with PAW projectors),130 whereas Schena et al. used a combination of U = 3.0 eV with J = 1.0 eV (with Muffin-Tin sphere projectors).134 Notably, no set of ab initio computed Hubbard parameters has been published for this material to date, to the best of our knowledge. The rationale behind the use of empirical parameters likely lies in a pronounced influence of shell-averaged U corrections on the equilibrium properties, as we demonstrate hereinafter.

4.1.2 Double Impact of Shell-Averaged U Corrections

We perform PBE+U calculations incorporating empirical on-site Hubbard U corrections ranging from 1.0 to 5.0 eV and analyze their impact on the estimated band gap and on the crystal structure. To differentiate between a band gap broadening caused by structural changes and one resulting directly from the influence of U on the electronic structure, we perform the calculations under three differently constrained conditions. Initially, we retain the PBE ionic structure, keeping the cell vectors and ionic positions fixed (setup 1). Subsequently, we perform another set of calculations with ionic position relaxations while maintaining a constant cell volume (setup 2). Lastly, we conduct full optimization, allowing for simultaneous adjustments of both ionic positions and cell vectors (setup 3). While band gaps are fundamentally outside the realm of DFT, DFT+U should improve upon the performance of the uncorrected functional as long as the compound’s frontier states are well-represented by the Hubbard manifold.50,63 For this case, one can argue that the Hubbard U corrections (locally) act in the spirit of a Koopmans-compliant functional.17

Figure 4 illustrates that even when no ionic relaxation is considered (setup 1), the band gap slowly but steadily expands with increasing U values. The shifts in band eigenvalues indicate that this expansion primarily stems from a downshift of the tg orbitals’ KS potential in the valence region (see Table SI 2). On the other hand, the CBM remains largely unaffected by the Hubbard correction with the corresponding eigenvalues showing minimal changes. Consistent with previous studies, we find that the experimental band gap is accurately reproduced at U ≈ 2.0 eV, but is overestimated by approximately 53% at U = 5.0 eV. This overestimation of the band gap at such moderate values of U is surprising since the CBM, consisting of S-3pz states, is not included in the Hubbard manifold, and its local deviation from PWL remains uncorrected. Upon relaxing the ionic positions while keeping the cell volume constant (setup 2), the band gap shows a more sensitive response to higher values of U. The experimental band gap is already achieved at U ≈ 1.5 eV and is overestimated by 115% at U = 5.0 eV. This trend becomes even more pronounced when relaxation of the cell vectors is enabled (setup 3), resulting in a band gap overestimation of 147% at U = 5.0 eV. As shown in Figure 4(b), the additional expansion following ionic relaxations is correlated with a significant contraction of the S– S bonds. This aligns well with the findings of Eyert et al., who pointed out that the S–S bond length governs the band gap, as it controls the dispersion of the lowest conduction band around the Γ point.131 Remarkably, in variable-cell calculations (setup 3) the S–S bonds continue to contract with increasing values of U, despite the simultaneous growth of the lattice parameter (inset of Figure 4b).

Figure 4 (a) calculated band gaps and (b) S–S bond lengths computed with PBE+U using three setups: at fixed cell and ionic positions (setup 1); at constant cell volume relaxing the ionic positions (setup 2); and relaxing both the ionic positions and the cell volume (setup 3). The inset in the bottom panel shows the dependence of the lattice parameter on U during volume relaxations. Red dashed horizontal lines correspond to the experimental values.128,140

The differences observed between relaxed and fixed structure calculations reveal that shell-averaged U corrections modify the band gap through two distinct mechanisms: first, through the expected downshift of the valence band eigenvalues, and second by causing pronounced contractions of the S–S bonds.

We now shift our focus from conventional equilibrium properties to investigate the underlying reasons behind the substantial influence of shell-averaged U corrections on these bonds, which can be elucidated by examining the occupations of the individual orbitals. Table 1 presents the eigenvalues of the Fe-d occupation matrix and the corresponding Hubbard energies EU for an illustrative case with U = 3.0 eV, both prior to and after complete structural relaxation. As the eigenvalues of the tg eigenstates (v3, v4, v5) approach idempotency, this manifold is responsible for the smaller share of the overall Hubbard energy, approximately 33%. In contrast, the eg eigenstates (v1 and v2) contribute to nearly 66% of the total Hubbard energy due to possessing occupation eigenvalues far from 0 or 1. We note in passing that the tg eigenstates strongly resemble the (hydrogenic) Löwdin atomic orbitals dxy, dxz and dyz, whereas v1 and v2 are less well-represented by the atomic orbitals and dz2 because of significant hybridization with neighboring S ligand orbitals. Structural relaxation induces both intrashell and intershell charge transfers that allow for a 6% reduction of the total Hubbard energy. At the intrashell level, the occupation of tg orbitals grows at the expense of eg. Even more significantly, the overall d-occupancy slightly drops from 6.996 to 6.970, indicating a migration of some eg electrons into adjacent S-p orbitals. This transfer of charge effectively enhances the S– S bond order and leads to the observed contraction of dS–S. Thus, the unexpectedly potent influence of the value of U on the band gap is rooted in the correction of the eg manifold.

Table 1 Occupation Eigenvalues λ to Eigenstates v of the Fe-d Occupation Matrix and Corresponding Hubbard Energies EU for the PBE+U Ground State of Pyrite with U = 3.0 eVa

Representation	eg	tg	2Σ	
eigenstate	v1	v2	v3	v4	v5	 	
setup 1	λ	0.383	0.383	0.901	0.901	0.930	6.996	
 	EU (meV)	354	354	134	134	98	2148	
setup 3	λ	0.359	0.359	0.915	0.915	0.937	6.970	
 	EU (meV)	343	343	117	117	89	2018	
a Results are shown for the fixed PBE structure (setup 1, a = 5.406 Å and a S– S distance of 2.195 Å, top) and after structural relaxation (setup 3, a = 5.469 Å and a S– S distance of 2.132 Å, bottom). The last column shows the total occupations (2∑λ) and Hubbard energies (2∑EU), which correspond to twice the sum (due to spin degeneracy) of the individual contributions.

We recall that the eigenvalues listed in Table 1 are not universal quantities but the result of a projection of the KS wave functions onto atom-centered OAO. The accuracy of on-site occupations provided by atomic-like projectors relies on the similarity between a given orbital’s shape in the system under inspection and that in a free atom, since the general shape and extension of projector AOs is typically determined in free atom calculations. However, one-center projections using atomic orbitals struggle to account for strong orbital hybridization, where electrons localize “off-site” between the bonded atoms. In the case of FeS2, the tg manifold is only marginally bonding, while the formally unoccupied eg orbitals form σ MOs with neighboring S-3pz orbitals. Consequently, it is misleading to interpret the eigenvalues determined for the eg states (v1 and v2) as indicative of actual on-site orbital occupancies in the context of Hubbard U corrections. Moreover, their numerical values significantly hinge on computational factors like the chosen pseudopotentials and the specific charge state for which they were parametrized.62

Within the setup of this study, the U correction effectively penalizes the hybridization between Fe and S; however, the use of different Hubbard projector functions might cause the the opposite effect, for example, if NAO projectors yield eg eigenvalues larger than 0.5. In this case, the Hubbard correction would draw electrons into the eg manifold rather than expelling them (see Eq. 3).

4.1.3 Absence of Intrashell Screening in Shell-Averaged LR-cDFT

Having investigated how the shell-averaged U parameter affects equilibrium observables, our focus now shifts to understanding the implications when this parameter is determined from first principles. Applying DFPT to the PBE ground state of FeS2 yields a U value of 7.37 eV. After undergoing four iterations within the self-consistency loop detailed in Section 2.3, U converges to 6.47 eV. Unfortunately, neither of these parameters can reasonably reproduce the experimental characteristics of pyrite. In fact, both values result in the stabilization of a spurious ferromagnetic ground state (2 μB/cell) in unrestricted open-shell calculations. For comparison, all of the following U parameters and observables are reported for the nonmagnetic ground state that was enforced by fixing the total magnetization to 0.0 μB.

The reason for this significant overestimation of the shell-averaged Hubbard U parameter can be understood from Figure 5, which shows the response of orbital occupancies to perturbations for both the entire 3d-shell and for its irreducible representations tg and eg. This information cannot be extracted from shell-averaged LR-cDFT, but can be recovered by adopting the orbital-resolved approach. The substantial opposing responses of eg occupations to perturbations of tg and vice versa (represented by dotted lines) suggest the presence of a robust intrashell tg ↔ eg screening channel. Inserting the values of χ0 and χ (represented by the line slopes in Figure 5) into eq 16, one obtains17

Figure 5 Unscreened/noninteracting (top) and screened/interacting (bottom) responses of the occupations λ of manifolds “a” to perturbations α applied to manifolds “b” in FeS2, obtained through the orbital-resolved LR-cDFT approach. The starting point is the fully relaxed PBE ground state.

where the first and second matrix represent the unscreened and the screened responses, respectively. Note the almost perfect agreement between this LR-cDFT Hubbard parameter (U = 7.39 eV) and the one derived from DFPT (U = 7.37 eV); the minor discrepancies are due to numerical noise. The individual matrix elements of eq 17 reveal that the apparent overestimation of the shell-averaged Hubbard parameter primarily stems from the suppression of intrashell screening that occurs due to the simultaneous perturbation of the tg and the eg manifolds. While the individual screened responses of the tg and eg orbitals are substantial ( and ), the overall response of the d shell is massively reduced by the off-diagonal elements of χ (both 0.1843 eV–1). Inversion of this apparently small screened response of the d shell (−0.1172 eV–1) yields χ–1 = −8.532 eV, which is what ultimately fuels the overestimation of the shell-averaged Hubbard parameter.

It should be noted that this shell-averaged U parameter also encompasses, to a certain extent, the response of the S-3p orbitals, because the eg eigenstates likely contain substantial S-3p contributions. With these insights in mind, it becomes pertinent to investigate whether the orbital-resolved approach to Hubbard U can offer improvements over the unsatisfactory performance of shell-averaged PBE+U.

4.1.4 Application of the Orbital-Resolved U

Employing the orbital-resolved LR-cDFT methodology detailed in Section 2.3, we proceed to compute individual Hubbard parameters for the tg and eg orbitals of FeS2. Prior to inverting the response matrix, all off-diagonal intrashell matrix elements are set to zero (χ0 is set to zero only to avoid numerical noise):18

This ensures that the resulting orbital-resolved Hubbard parameters incorporate the effect of tg ↔ eg screening. The parameters Utg and Ueg converge rapidly, reaching their self-consistent values of 3.29 and 2.16 eV, respectively, within just three iterations of self-consistency. The final response matrices read19

Following the approach of Solovyev et al., one may also exclusively target the tg manifold and not correct the eg states at all. This choice is driven by the expectation that interactions of genuine on-site character should manifest within the occupied tg orbitals rather than in the hybridized and formally empty eg manifold. Moreover, as previously stated, it is unlikely that one-center atomic orbital projectors are suited to provide meaningful on-site occupation numbers for the eg orbitals. With Ueg corrections absent, the converged value of Utg slightly decreases to 3.01 eV.

Having established the necessary parameters, we now focus on their impact in practical calculations. Table 2 shows that the orbital-resolved approach consistently outperforms the shell-averaged approach, except when U is tuned empirically (Uemp). When utilizing only Utg, both the lattice parameter and the S– S bond length exhibit deviations of less than 1% from the experimental values. With orbital-resolved corrections applied to tg and eg, this agreement with the experimental data is slightly worsened but still surpasses that of shell-averaged PBE+U, where the lattice parameter deviates by 4%. Furthermore, the significant overestimation of the band gap amounting to 177% in the case of shell-averaged PBE+U is substantially mitigated to 53% when switching to Utg. The DFT+U+V approach yields noticeable improvements compared to the traditional + U approach; however, it appears that the intersite V term lacks the strength to fully restore the hybridization between Fe and S that is suppressed by the shell-averaged on-site term. Therefore, the estimation of the lattice parameters and the band gap still remains notably worse than for the orbital-resolved PBE+U approach.

Table 2 Comparison of the Equilibrium Lattice Parameter a, the S–S Bond Length dS–S, and the Band Gap Eg of Pyrite Derived from Hubbard-Corrected PBE Calculations Targeting Different Manifoldsa

 	PBE	+U	+U+V	+Uemp	+Utg+Ueg	+Utg	Expt.	
U1(eV)	—	6.47	6.73	1.50	3.29	3.01	—	
U2 or V(eV)	—	—	0.62	—	2.16	—	—	
a(Å)	5.41	5.63	5.51	5.43	5.46	5.44	5.42128	
dS–S(Å)	2.20	2.10	2.12	2.16	2.13	2.14	2.16128	
Eg(eV)	0.41	2.63	2.06	1.00	1.70	1.45	0.95140	
a On-site Hubbard U1 and U2 refer to various parametrizations of the PBE+U approach, while V is the inter-site Hubbard parameter of the PBE+U+V approach.

These results underscore the critical importance of the choice of the Hubbard manifold in DFT+U calculations for the FeS2 polymorph pyrite. Under the shell-averaged approximation, the ground-state properties are extremely sensitive to the numerical value of U. This sensitivity primarily arises due to the correction of the hybridized eg part of the d shell. Moreover, the shell-averaged Hubbard parameter derived from LR-cDFT lacks full screening, as the intrashell screening channel (tg ↔ eg) is deactivated during the concurrent perturbation of both manifolds. On the other hand, the orbital-resolved approach accounts for intrashell screening during perturbative calculations, resulting in significantly smaller Hubbard parameters. We have shown that correcting the localized Fe-tg manifold alone suffices to obtain structural properties in very good agreement with experimental data, all without requiring empirical adjustments to the parameters. A viable option for further improvements involves supplementing the orbital-resolved U corrections with intersite V terms, as discussed in Section 5. Additionally, the PWL condition should also be enforced for the S-3pz orbital composing the CBM. Given the strong sp3 hybridization of S, this would, however, require an adaption of the atomic-like projectors used in this study.

4.2 Fe(II) Molecular Complexes

4.2.1 Adiabatic Spin Energy Differences

A crucial quantity for many TM compounds is the total energy difference between their HS and LS states, denoted as20

Based on calculations of six Fe(II)-hexacomplexes, Mariano et al. showed that shell-averaged Hubbard U corrections to PBE and LDA introduce an unphysical bias against LS configurations, primarily due to substantial discrepancies in the Hubbard energies of LS and HS complexes.84 This arises from the electron occupation patterns: LS-Fe(II) complexes exhibit a t2g6/eg0 electron configuration, while HS complexes a t2g4/eg2 configuration. In octahedral coordination environments, unoccupied eg orbitals display substantial σ overlap with neighboring ligand orbitals. Consequently, in LS-Fe(II) all four eg spin–orbitals can adopt fractional occupation eigenvalues, whereas in HS-Fe(II) this only applies to two spin–orbitals, as the other two are fully occupied. Considering that the Hubbard energy functional (eq 1) induces corrections of up to U/2 eV for fractional occupations, but of 0 eV for idempotent occupations, Hubbard energies of LS-Fe(II) tend to be larger than those of HS-Fe(II). Furthermore, the LR-cDFT approach was shown to generate larger shell-averaged U parameters for LS-Fe(II) compared to HS-Fe(II),84 thus enhancing this disparity.

In the following, we investigate whether the orbital-resolved DFT+U approach can rectify the unphysical bias against LS states and deliver accurate adiabatic spin energy differences. For this purpose, we compute ΔEH–L for all six octahedrally coordinated Fe(II)-hexacomplexes studied in ref (84) and benchmark the results against coupled-cluster corrected CASPT2 (CASPT2/CC)141 values, which are also taken from ref (84). We compare the performance of two distinct Hubbard manifolds. In manifold I, Hubbard corrections are applied either only to eg states ( and ) or to only t2g states (, , , ). While it would be desirable to obtain t2g-specific Hubbard parameters for the former two compounds, this proves elusive due to the fact that the t2g orbitals are fully occupied in the numerical sense (λ ≥ 0.997) and thus respond nonlinearly to perturbations.113 For the same reason, no parameters could be computed for the HS complexes either. Therefore, all Hubbard corrections to t2g states utilize the value. In manifold II, both t2g and eg orbitals are corrected simultaneously. When comparing the present work with ref (84), it is important to recall our use of OAO projector functions and geometry optimizations, whereas in ref (84) NAO projector functions were used and the geometries were not optimized. A comprehensive list of all complexes, the Hubbard manifolds considered and the corresponding orbital-resolved and shell-averaged U parameters is provided in Table 3.

Table 3 PBE+U Manifolds and Their Calculated On-Site Parameters in eVa

Complex	manifold I	manifold II	Ut2gLS	UegLS	UegHS	ULS	UHS	
[Fe(H2O)6]2+	eg	—	—	4.28	2.69	5.71	4.13	
[Fe(NH3)6]2+	eg	—	—	3.64	3.07	6.14	4.43	
[Fe(NCH)6]2+	t2g	t2g+eg	7.05	2.12	1.87	6.76	5.53	
[Fe(PH3)6]2+	t2g	t2g+eg	4.13	2.29	2.12	6.88	4.78	
[Fe(CO)6]2+	t2g	t2g+eg	4.63	1.92	1.89	7.16	5.43	
[Fe(CNH)6]2+	t2g	t2g+eg	4.64	2.13	1.72	7.43	5.79	
a For t2g the same parameter was applied to LS and HS complexes. The complexes are sorted in ascending order according to the ligand’s field strength.

The resulting adiabatic spin energy differences are visualized in Figure 6. Additionally, Table 4 lists the mean absolute error (MAE) of the different corrections against the CASPT2/CC141 reference values. In line with the findings of ref (84), shell-averaged PBE+U drastically overstabilizes HS configurations and fails to reproduce the trend of steeply increasing ΔEH–L. Conversely, uncorrected PBE displays its known bias toward LS configurations. The introduction of orbital-resolved U corrections substantially enhances the predictive accuracy across all complexes analyzed, outperforming both PBE and the shell-averaged PBE+U by a large margin. Correcting either t2g or eg (manifold I) closely aligns adiabatic spin energy differences with the CASPT2/CC values, resulting in the lowest MAE of 0.27 eV. The simultaneous correction of t2g and eg (manifold II) yields a slightly higher MAE of 0.57 eV, with larger deviations particularly for and , but a better agreement for . In general, Ueg corrections are smaller and less significant for the overall quantitative agreement than Ut2g corrections, since the t2g orbitals host more–and more localized–electrons. The good overall agreement (qualitative and quantitative) of orbital-resolved PBE+U with the CASPT2/CC data is surprising since the latter is a multiconfigurational approach, while the former can only improve the accuracy of a single reference state.

Figure 6 Adiabatic spin energies calculated for six Fe(II)-hexacomplexes using different DFT corrections and CASPT2/CC as the reference method. Data for PBE, PBE+U, and CASPT2/CC was taken from the SI of ref (84).

Table 4 Mean Absolute Error (MAE) of ΔEH–L for Various Hubbard Correction Manifolds against the CASPT2/CC Reference Value from Ref (84)

 	PBE84	+U	+ Ut2g or + Ueg	+ Ut2g + Ueg	
MAE (eV)	1.07	1.94	0.27	0.57	

The good performance of the orbital-resolved U compared to the shell-averaged approach stems from two main factors. First, excluding the eg orbitals from the Hubbard manifold of strong-field complexes (manifold I) eliminates the primary cause of spuriously large Hubbard energies. Again, the exclusion of eg orbitals can be justified with the inadequate representation of their strongly hybridized character by atomic orbital projectors. Second, even when the eg orbitals are included (manifold II), independently computed Ueg parameters are significantly smaller than Ut2g or shell-averaged U parameters owing to the explicit incorporation of intrashell screening. For instance, in eV compared to ULS = 7.16 eV. Hence, the orbital-resolved approach effectively mitigates the impact of nonideal Hubbard projectors.

4.2.2 Piecewise Linearity of the Total Energy

As mentioned earlier, the use of on-site Hubbard U corrections in (semi)local DFT is motivated by the mitigation of SIE, which have been linked to the spurious global deviation from PWL of the total energy with respect to fractional addition or removal of electronic charge q to the entire system.12,15,18 However, a study by Zhao et al. indicates that (shell-averaged) U corrections to TM d shells might be unfit for this purpose for a wide range of TM/ligand combinations when the Hubbard U parameters are derived from LR-cDFT.15

Thus, to directly benchmark the performance of orbital-resolved DFT+U, we explicitly determine the global curvature following the approach presented in ref (15). For our analysis, we chose the strongest ligand complex [Fe(CNH)6]q+ and perform several fixed-charge calculations where the total charge is varied between q = 2 and q = 3 in increments of 0.1e–.

A useful metric to assess a functional’s deviation from PWL is given by Edev, which is computed by subtracting the DFT total energy of a fractional charge calculation from the linear interpolation between the energies of the integer-charge end points Etot(q = 2) and Etot(q = 3). Note that this explicit approach differs from the method employed in ref (84), where Edev is approximated using a cubic interpolation parametrized by the energy difference ΔEq = Etot(q = 2) – Etot(q = 3) and the HOMO and LUMO eigenvalues of the integer-charge system.

Figure 7 shows that while shell-averaged Hubbard U corrections markedly reduce the deviation from PWL of HS [Fe(CNH)6]q+, the global curvature of the LS compound is not eased. In fact, in the LS case the typical convex-shaped FCE displayed by bare PBE is transformed into a concave one of similar magnitude. In contrast, the orbital-resolved corrections reduce the deviation from PWL by an order of magnitude for both the LS and the HS configurations. It is worth noting that the remaining curvature barely differs between manifold I (+Ut2g only) and manifold II (+Ut2g + Ueg). Again, this observation is likely related to the low numerical value of the Ueg parameters, which further supports the previous assumption that the primary contributor to the FCE is the rather localized t2g manifold. For the same reason, applying U corrections to ligand orbitals like C-p is unlikely to significantly affect the FCE.

Figure 7 Deviation from piecewise linearity of the total energy upon fractional addition/removal of charge of [Fe(CNH)6]q+ in low-spin (left) and high-spin (right) configurations. Note that the data points of PBE + Ut2g and PBE + Ut2g+Ueg overlap in the LS case.

4.3 The Importance of Correcting Ligand States in β-MnO2

Unlike in TM sulfides, partially filled d shells of TM oxides are a frequent target for on-site corrections (see the discussion e.g. in ref (79)). While Mott-Hubbard insulators such as the prototypical wüstite (FeO) present an energy gap separating different d states, charge-transfer insulators, often involving highly oxidized and/or heavy TM species, exhibit O-2p → d band gaps.142 The significant fraction of electrons localized on O-2p orbitals adds complexity to the definition of the Hubbard manifold for DFT+U calculations, as studied below for the case of β – MnO2.

Crystallizing in the rutile structure (space group P42/mnm), β – MnO2 displays a complex helical (screw-type spiral) antiferromagnetic (AFM) ordering below TN = 92K.143 As done here, this ordering can be approximated by a collinear arrangement of the Mn4+ ions along [001], referred to as A1-AFM.59 Considerable uncertainty surrounds the electronic properties of β – MnO2. Sato et al. measured a large electrical resistivity at 0.3 K, suggesting insulating behavior.143 However, the magnitude of the band gap has not been yet determined with universally accepted accuracy. Midtwentieth-century works reported narrow band gaps around 0.26–0.28 eV,144,145 while more recent optical absorption studies reported much larger values ranging from 1.5 eV (nanocacti and nanorods)146 to 2.0 eV for β – MnO2 nanostructures grown on fluorine-doped tin oxide.147 These results align with a reported hybrid functional DFT (PBE0) value of 1.5 eV, but not with a prediction of the closely related HSE03 functional (0.6 eV).148 Previous works also indicate that the opening of a band gap is relatively insensitive to shell-averaged Hubbard U corrections to the Mn-d states.59,148 For example, in ref (59) the use of a self-consistent U parameter of 6.34 eV only induced an extremely small gap of 0.02 eV in the A1-AFM case (using orthogonalized atomic Hubbard projectors). In general, the calculated properties are sensitive to the choice of projector functions. For instance, NAO projectors stabilize a ferromagnetic ordering, whereas OAO projectors favor the expected A1-AFM ordering.59 Only by adding intersite V between Mn-d and O-p states59 or Hund’s J corrections,149 small gaps ranging from 0.25 to 0.32 eV emerge. A band gap of 0.8 eV was also obtained91 with the anisotropic DFT+U + J approach of Czyżyk and Sawatzky. In this method, shell-averaged Hubbard U and J corrections are augmented with orbital-resolved Umm′ and Jmm′ matrices parametrized from summation relations involving Slater integrals of atomic Hartree–Fock calculations.88 This approach thus differs from the here-presented scheme, which does not rely on model systems like the free atom and includes intrashell screening effects, such as t2g ↔ eg.

The wide range of band gap values reported in both the theoretical and experimental literature underscores the pressing need for a more profound understanding of the insulating behavior of β – MnO2. Considering the charge-transfer nature of the band gap and the coexistence of relatively localized and strongly hybridized states in both the Mn-d shell and the O-p shell, orbital-resolved DFT+U calculations offer a promising starting point. In the interest of comparability, our calculations are carried out using a setup equivalent to that of ref (59), imposing the A1-AFM ordering in a 2 × 2 × 2 supercell containing 48 atoms and considering once again different Hubbard manifolds.

The first manifold solely considers the t2g orbitals in order to single out the impact of the localized Mn-d states.6 As shown in Table 5, this correction only marginally influences the band gap or the structural properties in comparison to bare PBEsol. This observation aligns with the modest value of eV, indicative of minimal local curvature due to the t2g states. A much more significant improvement is achieved by considering the localized O-pz orbitals (Figure 8). Correcting these states with a self-consistent Hubbard parameter eV (in addition to the correction) leads to an insulating gap of 1.01 eV. Moreover, the lattice parameters approach their experimental values, resulting in an error on the predicted cell volume smaller than 1%. Conversely, a shell-averaged U correction as large as 6.34 eV for Mn-d states only results in less accurate cell parameters and a still negligible band gap. This situation is only partly mended by the application of an additional intersite V parameter.59

Figure 8 Isosurface plot of the highest fully occupied KS band of A1-AFM β – MnO2 obtained using PBEsol , showing π interactions between O-pz and Mn-t2g orbitals. Mn atoms of opposite spin-polarization are colored dark and light brown, O atoms are red. For clarity, the interaction is only shown for one MnO6 octahedron.

Table 5 Comparison of Equilibrium Properties of A1-AFM β-MnO2 Obtained from PBEsol without and with Various Hubbard Correctionsa

 	PBEsol	

	

	+UMn (Ref 59)	+UMn+VMn–O (Ref 59)	Expt.	
U1 (eV)	—	1.59	1.64	6.34	6.76	—	
U2 or V (eV)	—	—	4.62	—	(0.99, 1.10)	—	
a (Å)	4.37	4.37	4.38	4.40	4.39	4.40150	
c (Å)	2.83	2.86	2.88	2.94	2.92	2.88150	
V0 (Å3)	54.68	54.64	55.26	57.07	56.35	55.79150	
Eg (eV)	0.00	0.00	1.01	0.02	0.32	0.26,144 1.50,146 2.0147	
a U1 and U2 refer to various parameterizations of the PBEsol+U approach, while V is the inter-site Hubbard parameter of the PBEsol+U+V approach. a and c are the lattice parameters, V0 is the unit cell volume, and Eg is the band gap value. All the presented results (including those from ref (59)) were obtained using OAO projectors.

The importance of including O-pz in the Hubbard manifold is evidenced by the PDOS depicted in Figure 9. The states near the Fermi level exhibit notable O-p contributions, regardless of the correction applied. These contributions primarily stem from localized pz orbitals, which engage in π interactions with the Mn-t2g manifold (Figure 8). The other two p orbitals are subject to sp2 hybridization and contribute to the formation of the lower-lying σ MOs in conjunction with Mn-eg states. This observation suggests that applying shell-averaged U corrections to the entire O-p shell would weaken the σ bonds and lead to Mn–O underbinding. For the same reason, applying corrections to the Mn-eg states is neither required nor useful.

Figure 9 Stacked spin-resolved PDOS of the A1-AFM collinear ordering of β – MnO2 computed with PBEsol and two types of orbital-resolved U corrections. Metallic behavior is observed when using PBEsol and PBEsol , whereas an insulating character is obtained with PBEsol . On each panel, the upper and lower subpannels correspond to the spin-up and and spin-down channels, respectively. Mn1 and Mn2 represent symmetry equivalent atoms of opposite spin polarization (due to AFM ordering).

In conclusion, the orbital-resolved approach pinpoints deviations from PWL in the localized O-pz orbitals as the potential root-cause of the absence of a band gap in β – MnO2 when using DFT with semilocal functionals. This outcome underscores the frequently overlooked significance of ligand orbitals in electronic localization and establishes a foundation for future investigations. Again, achieving more comprehensive descriptions of this intricate charge-transfer insulator could entail incorporating the orbital-resolved U approach alongside intersite V and unlike-spin Hund’s J terms.

5 Outlook: Orbital-Resolved Intersite Hubbard Interactions?

Hubbard U corrections are primarily designed to mitigate the FCE in KS states exhibiting strong atomic-like character, that is, at the on-site level. Orbitals involved in strong interatomic hybridization should not be corrected using U terms. This limitation is a consequence of the one-center projectors that are typically used to determine the occupation numbers for the Hubbard U energy functional, which inherently lack the ability to adequately represent localization on hybrid (i.e., molecular) orbitals. To counteract the FCE within covalent environments, the extended DFT+U+V framework was introduced in ref (58), where conventional shell-averaged U corrections are augmented with an intersite term scaled by a Hubbard parameter V in a way that restores ligand hybridization through two-center (dual) occupation numbers. However, although the + V correction often improves the predictions of electronic and structural properties compared to plain DFT+U, the results presented for FeS2 and β-MnO2 exemplify that it only partially mitigates the impact of shell-averaged U corrections. Specifically, intersite terms cannot rectify a substantial bias in the total energy arising from on-site terms since the values of U (for first-row TM elements) are typically between 4 and 10 eV, which is several times larger than typical values of V, which amount to ≈1 eV. For instance, the Hubbard U and V parameters of the strong-field molecular complex from Sec. 4 are 8.42 (for Fe-3d states) and 1.12 eV (between Fe-3d and C-2p states) for the LS configuration, and 6.57 and 1.11 eV for the HS configuration, respectively. Applying these parameters, one obtains an adiabatic spin energy difference ΔEH–L = −0.42 eV that erroneously implies a HS ground state for (the CASPT2/CC reference is +2.82 eV, see Figure 6).

Given that the majority of spurious contributions to the total energy arise from the shell-averaged form of U, the implementation of orbital-resolved DFT+U+V is an intriguing prospect, as already hinted in the concluding remarks of ref (58). This extension could exert precise control over electron localization on molecular orbitals, which could be achieved through individual Hubbard VijIJ parameters. Moreover, such highly tailored but still fully first-principles corrections should allow to eliminate potential conflicts arising from the simultaneous treatment of orbitals by both U and V terms. With regard to the compounds discussed in the present work, the orbital-resolved U corrections of the localized tg/t2g orbitals could be augmented by V terms specific to the interaction of eg with neighboring ligand orbitals. Note that orbital-resolved intersite V parameters are readily obtained as a byproduct of the calculation of U parameters within the generalized LR-cDFT approach.

However, practical calculations with this fully resolved approach would require the a priori assignment of two-center occupation numbers to specific MOs, causing additional preparatory effort. Desirable will be the conception and implementation of appropriate automation workflows in supporting tools such as AiiDA.151,152 Alternatively, a simplified approach could involve using the Hubbard V correction in its current (averaged) form while retaining the orbital-dependence of U. This would serve as a pragmatic ad-hoc solution to the issues of U at the expense of consistency.

Another avenue for extension pertains to Hund’s J corrections, whose combination with the orbital-resolved U should be straightforward. Such “unlike-spin” terms play a pivotal role in addressing the fractional spin error that occurs in systems characterized by significant magnetic coupling.18,22,55,68,81,82,92

6 Conclusions

In this study, we have introduced an orbital-resolved generalization of the DFT+U functional originally formulated by Dudarev et al. Our implementation is agnostic about the specific nature of the Hubbard projectors employed, and calculations involving forces and stresses require no adjustments stemming from this expansion. Despite not being a “rotationally invariant” approach in a strict sense,7 the method features invariance against basis vector rotations for practical purposes, since the corrections are applied to eigenstates of the occupation matrix (i.e., the correct linear combination of the orthogonalized atomic projectors). As long as these eigenstates are sorted based on their corresponding eigenvalues (which available solvers typically do), the present orbital-resolved DFT+U scheme will consistently target the same linear combination of projectors independently of the given orientation of the individual projectors. The true potential of the scheme emerges when the required Hubbard parameters are derived from first principles. For this purpose, we have employed an adapted version of the LR-cDFT approach, enabling perturbative calculations with orbital resolution. This approach intrinsically incorporates intra-shell screening, which often causes orbital-resolved U parameters to be significantly smaller than their shell-averaged counterparts. Provided a proper selection of the target manifold, the orbital resolution therefore enables a more surgical use of DFT+U that avoids overcorrections, as comparative calculations of six Fe(II) molecular hexacomplexes as well as of the charge-transfer insulators pyrite and pyrolusite demonstrate.

For instance, the orbital-resolved approach effectively addresses the bias in adiabatic spin energies toward HS states observed in shell-averaged DFT+U.84 Particularly noteworthy is its success in accurately predicting spin energies across a diverse spectrum of Fe(II) hexacomplexes, achieved through selective corrections of the highly localized t2g orbitals. Explicit fractional charge calculations on Fe[CNH]62+ suggest that these improvements are not coincidental: the orbital-resolved approach reliably counteracts the spurious global curvature of DFT with (semi)local functionals with respect to the fractional addition or removal of electrons, reducing the FCE by an order of magnitude. In contrast, shell-averaged Hubbard U corrections exhibit a mixed performance: while they effectively diminish the FCE in the HS states, their efficacy wanes when addressing the LS states. Here, instead of rectifying the FCE, the convex error characteristic of (semi)local DFT is converted into a comparably pronounced concave error. The results also suggest that a sole correction of the localized t2g orbitals performs slightly better than a joint correction of t2g and the rather hybridized eg manifold, even when using orbital-resolved U parameters. The superiority of the orbital-resolved formulation over the shell-averaged approximation also extends to the charge-transfer insulators FeS2 and β – MnO2. The correct nonmagnetic ground state of the former is only stabilized when orbital-resolved Hubbard parameters are used. The magnitude of the large experimental band gap of the latter can only be achieved by applying a pinpointed Hubbard correction to the frontier O-pz orbitals, whereas standard Hubbard U corrections to the d shell of Mn fail to open a significant band gap.

As these examples illustrate, the success of the orbital-resolved formulation predominantly originates from the exclusion of hybridized orbitals from the Hubbard manifold. From a theoretical perspective, the necessity to exclude hybridized orbitals is rooted in the very definition of U as an on-site term. However, practically implementing this definition poses challenges, particularly given that many DFT+U investigations rely on atomic-like orbitals as Hubbard projectors. This approach can lead to occupancy eigenvalues far from 0 or 1, especially in compounds featuring covalent bonds. These fractional values, however, are not related to the electron self-interaction, but arise from a one-center projector being applied to a two-center phenomenon, namely a molecular orbital. In such scenarios, the orbital-resolved approach provides an ad-hoc solution that allows to circumvent the potential conflict of on-site corrections with the intricacies of covalently bonded systems.

In a broader context, it is crucial to emphasize that the refined approach presented in this work constitutes just one among various potent (Hubbard) corrections available to DFT. As such, its effectiveness and ability to achieve consistent enhancements relies on a thoughtful and technically well-executed application. In practical terms, this is achieved by adopting a more nuanced strategy for the determination of Hubbard manifolds, tailored to the specific Hubbard projectors employed. Such a strategy should consider localized ligand orbitals for Hubbard corrections in situations where these act as frontier states. In addition, it might be desirable to address the FCE in hybrid (i.e., molecular) orbitals. For this purpose, the use of Wannier functions as Hubbard projectors or the adoption of an extended orbital-resolved DFT+U+V approach should be contemplated. A pivotal aspect of our future investigations will focus on developing a protocol to automate the choice of Hubbard manifolds based on measurable criteria. This step aims to streamline and standardize the approach’s application, ensuring its systematic and effective use across diverse systems and scenarios. The data used to produce the results of this work are available at the Materials Cloud Archive.153

Supporting Information Available

The Supporting Information is available free of charge at https://pubs.acs.org/doi/10.1021/acs.jctc.3c01403.A detailed description of the tracking routine and other technical details about the implementation of the orbital-resolved Hubbard U corrections, a demonstration of the influence of linear perturbations on the shape and extension of eigenstates of the occupation matrix and data on shifts of VBM and CBM KS eigenvalues in pyrite due to Hubbard corrections. (PDF)

Supplementary Material

ct3c01403_si_001.pdf

Author Present Address

§ Laboratory for Materials Simulations (LMS), Paul Scherrer Institut (PSI), CH-5232 Villigen PSI, Switzerland

The authors declare no competing financial interest.

Acknowledgments

We thank Louis Ponet for fruitful discussions. EM was funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) – Project No. 286518848 – RTG 2247 QM3. IT and NM acknowledge support from the Swiss National Science Foundation (SNSF) through its National Centre of Competence in Research (NCCR) MARVEL (Grant No. 205602). NM acknowledges funding from the U Bremen Excellence Chair programme. The authors also acknowledge the computing time granted by the Resource Allocation Board and provided on the supercomputers Lise and Emmy at NHR@ZIB and NHR@Göttingen as part of the NHR infrastructure (project hbc00053) and the Swiss National Supercomputing Centre (CSCS) under project No. s1073.

1 Note that this “double counting” must not be confused with the double counting term in DFT+U energy functionals derived from the Hubbard model.

2 Pickett et al. define the d shell-averaged Hubbard parameter (in their notation) as Udd=[∑a,b=t2g,eg(χ)a,b]−1, whereas in this work we use the definition of eq 16 that accounts for the noninteracting (bare) response.

3 This results from a physical necessity: if a perturbation to the potential of a manifold a causes the occupation of a to increase, the electrons must be borrowed from another manifold, whose orbital occupation will naturally decrease, since the global charge is kept constant in LR-cDFT.

4 We used Fe.pbe-spn-kjpaw_psl.0.2.1.UPF,121s_pbe_v1.4.uspp.F.UPF,122O.pbe-n-kjpaw_psl.0.1.UPF,121H.pbe-rrkjus_psl.1.0.0.UPF,123P.pbe-n-rrkjus_psl.1.0.0.UPF,123C.pbe-n-kjpaw_psl.1.0.0.UPF,123N.pbe-n-radius_5.UPF (THEOS pseudo) and mn_pbesol_v1.5.uspp.F.UPF(122) and O.pbesol-n-kjpaw_psl.0.1.UPF(121) for β – MnO2.

5 The point group symmetry of Fe in pyrite is Th rather than Oh; thus, the triply degenerate irreducible representation is correctly named tg instead of t2g.133

6 Here, we use the t2g irreducible representation in spite of the actual D4h site symmetry of Mn4+ and therefore neglect the small energetic splitting between the A1g, B1g and B2g representations.

7 This is because the matrix that diagonalizes the occupation matrix does not necessarily also diagonalize the orbital-resolved U matrix due to the elimination of the off-diagonal elements in χ and χ0.
==== Refs
References

Hohenberg P. ; Kohn W. Inhomogeneous Electron Gas. Phys. Rev. 1964, 136 , B864–B871. 10.1103/PhysRev.136.B864.
Kohn W. ; Sham L. J. Self-Consistent Equations Including Exchange and Correlation Effects. Phys. Rev. 1965, 140 , A1133–A1138. 10.1103/PhysRev.140.A1133.
Hubbard J. Electron correlations in narrow energy bands. Proc. R. Soc. A: Math. Phys. 1963, 276 , 238–257. 10.1098/rspa.1963.0204.
Anisimov V. ; Zaanen J. ; Andersen O. Band theory and Mott insulators: Hubbard U instead of Stoner I. Phys. Rev. B 1991, 44 , 943 10.1103/PhysRevB.44.943.
Anisimov V. I. ; Solovyev I. V. ; Korotin M. A. ; Czyżyk M. T. ; Sawatzky G. A. Density-functional theory and NiO photoemission spectra. Phys. Rev. B 1993, 48 , 16929–16934. 10.1103/PhysRevB.48.16929.
Liechtenstein A. I. ; Anisimov V. I. ; Zaanen J. Density-functional theory and strong interactions: Orbital ordering in Mott-Hubbard insulators. Phys. Rev. B 1995, 52 , R5467–R5470. 10.1103/PhysRevB.52.R5467.
Cococcioni M. A LDA+U Study of Selected Iron Compounds. Ph.D. thesis, International School for Advanced Studies (SISSA), Trieste, 2002.
Cococcioni M. ; de Gironcoli S. Linear response approach to the calculation of the effective interaction parameters in the LDA + U method. Phys. Rev. B 2005, 71 , 035105 10.1103/PhysRevB.71.035105.
Dudarev S. L. ; Botton G. A. ; Savrasov S. Y. ; Humphreys C. J. ; Sutton A. P. Electron-energy-loss spectra and the structural stability of nickel oxide: An LSDA+U study. Phys. Rev. B 1998, 57 , 1505–1509. 10.1103/PhysRevB.57.1505.
Perdew J. P. ; Parr R. G. ; Levy M. ; Balduz J. L. Density-Functional Theory for Fractional Particle Number: Derivative Discontinuities of the Energy. Phys. Rev. Lett. 1982, 49 , 1691–1694. 10.1103/PhysRevLett.49.1691.
Yang W. ; Zhang Y. ; Ayers P. W. Degenerate Ground States and a Fractional Number of Electrons in Density and Reduced Density Matrix Functional Theory. Phys. Rev. Lett. 2000, 84 , 5172–5175. 10.1103/PhysRevLett.84.5172.10990895
Kulik H. J. ; Cococcioni M. ; Scherlis D. A. ; Marzari N. Density Functional Theory in Transition-Metal Chemistry: A Self-Consistent Hubbard U Approach. Phys. Rev. Lett. 2006, 97 , 103001 10.1103/PhysRevLett.97.103001.17025809
Zhao Q. ; Kulik H. J. Where Does the Density Localize in the Solid State? Divergent Behavior for Hybrids and DFT+U. J. Chem. Theory Comput. 2018, 14 , 670–683. 10.1021/acs.jctc.7b01061.29298057
Levy M. Electron densities in search of Hamiltonians. Phys. Rev. A 1982, 26 , 1200–1208. 10.1103/PhysRevA.26.1200.
Zhao Q. ; Ioannidis E. I. ; Kulik H. J. Global and local curvature in density functional theory. J. Chem. Phys. 2016, 145 , 054109 10.1063/1.4959882.27497541
Dabo I. ; Ferretti A. ; Poilvert N. ; Li Y. ; Marzari N. ; Cococcioni M. Koopmans’ Condition for Density-Functional Theory. Phys. Rev. B 2010, 82 , 115121 10.1103/PhysRevB.82.115121.
Borghi G. ; Ferretti A. ; Nguyen N. L. ; Dabo I. ; Marzari N. Koopmans-Compliant Functionals and Their Performance against Reference Molecular Data. Phys. Rev. B 2014, 90 , 075135 10.1103/PhysRevB.90.075135.
Bajaj A. ; Janet J. P. ; Kulik H. J. Communication: Recovering the flat-plane condition in electronic structure theory at semi-local DFT cost. J. Chem. Phys. 2017, 147 , 191101 10.1063/1.5008981.29166114
Bajaj A. ; Liu F. ; Kulik H. J. Non-Empirical, Low-Cost Recovery of Exact Conditions with Model-Hamiltonian Inspired Expressions in jmDFT. J. Chem. Phys. 2019, 150 , 154115 10.1063/1.5091563.31005112
Burgess A. C. ; Linscott E. ; O’Regan D. D. DFT+U-Type Functional Derived to Explicitly Address the Flat Plane Condition. Phys. Rev. B 2023, 107 , L121115 10.1103/PhysRevB.107.L121115.
Janesko B. G. DFT+U Type Strong Correlation Functional Derived from Multiconfigurational Wavefunction Theory. arXiv, 2023.10.48550/arXiv.2305.07736.
Mori-Sánchez P. ; Cohen A. J. ; Yang W. Discontinuous Nature of the Exchange-Correlation Functional in Strongly Correlated Systems. Phys. Rev. Lett. 2009, 102 , 066403 10.1103/PhysRevLett.102.066403.19257614
Wang L. ; Maxisch T. ; Ceder G. Oxidation energies of transition metal oxides within the GGA+U framework. Phys. Rev. B 2006, 73 , 195107 10.1103/PhysRevB.73.195107.
Le Bacq O. ; Pasturel A. ; Bengone O. Impact on electronic correlations on the structural stability, magnetism, and voltage of LiCoPO4 battery. Phys. Rev. B 2004, 69 , 245107 10.1103/PhysRevB.69.245107.
Aykol M. ; Wolverton C. Local environment dependent GGA+U method for accurate thermochemistry of transition metal compounds. Phys. Rev. B 2014, 90 , 115105 10.1103/PhysRevB.90.115105.
Isaacs E. ; Marianetti C. Compositional phase stability of strongly correlated electron materials within DFT+U. Phys. Rev. B 2017, 95 , 045141 10.1103/PhysRevB.95.045141.
Dederichs P. H. ; Blügel S. ; Zeller R. ; Akai H. Ground States of Constrained Systems: Application to Cerium Impurities. Phys. Rev. Lett. 1984, 53 , 2512–2515. 10.1103/PhysRevLett.53.2512.
McMahan A. ; Martin R. ; Satpathy S. Calculated effective Hamiltonian for La2CuO4 and solution in the impurity Anderson approximation. Phys. Rev. B 1988, 38 , 6650 10.1103/PhysRevB.38.6650.
Gunnarsson O. ; Andersen O. ; Jepsen O. ; Zaanen J. Density-functional calculation of the parameters in the Anderson model: Application to Mn in CdTe. Phys. Rev. B 1989, 39 , 1708 10.1103/PhysRevB.39.1708.
Hybertsen M. ; Schlüter M. ; Christensen N. Calculation of Coulomb-interaction parameters for La2CuO4 using a constrained-density-functional approach. Phys. Rev. B 1989, 39 , 9028 10.1103/PhysRevB.39.9028.
Gunnarsson O. Calculation of parameters in model Hamiltonians. Phys. Rev. B 1990, 41 , 514 10.1103/PhysRevB.41.514.
Pickett W. E. ; Erwin S. C. ; Ethridge E. C. Reformulation of the LDA + U method for a local-orbital basis. Phys. Rev. B 1998, 58 , 1201–1209. 10.1103/PhysRevB.58.1201.
Solovyev I. ; Imada M. Screening of Coulomb interactions in transition metals. Phys. Rev. B 2005, 71 , 045103 10.1103/PhysRevB.71.045103.
Nakamura K. ; Arita R. ; Yoshimoto Y. ; Tsuneyuki S. First-principles calculation of effective onsite Coulomb interactions of 3d transition metals: Constrained local density functional approach with maximally localized Wannier functions. Phys. Rev. B 2006, 74 , 235113 10.1103/PhysRevB.74.235113.
Shishkin M. ; Sato H. Self-consistent parametrization of DFT + U framework using linear response approach: Application to evaluation of redox potentials of battery cathodes. Phys. Rev. B 2016, 93 , 085135 10.1103/PhysRevB.93.085135.
Springer M. ; Aryasetiawan F. Frequency-dependent screened interaction in Ni within the random-phase approximation. Phys. Rev. B 1998, 57 , 4364 10.1103/PhysRevB.57.4364.
Kotani T. Ab initio random-phase-approximation calculation of the frequency-dependent effective interaction between 3d electrons: Ni, Fe, and MnO. J. Phys.: Condens. Matter 2000, 12 , 2413 10.1088/0953-8984/12/11/307.
Aryasetiawan F. ; Imada M. ; Georges A. ; Kotliar G. ; Biermann S. ; Lichtenstein A. I. Frequency-dependent local interactions and low-energy effective models from electronic structure calculations. Phys. Rev. B 2004, 70 , 195104 10.1103/PhysRevB.70.195104.
Aryasetiawan F. ; Karlsson K. ; Jepsen O. ; Schönberger U. Calculations of Hubbard U from first-principles. Phys. Rev. B 2006, 74 , 125106 10.1103/PhysRevB.74.125106.
Karlsson K. ; Aryasetiawan F. ; Jepsen O. Method for calculating the electronic structure of correlated materials from a truly first-principles LDA + U scheme. Phys. Rev. B 2010, 81 , 245113 10.1103/PhysRevB.81.245113.
Mosey N. J. ; Carter E. A. Ab initio evaluation of Coulomb and exchange parameters for DFT + U calculations. Phys. Rev. B 2007, 76 , 155123 10.1103/PhysRevB.76.155123.
Mosey N. J. ; Liao P. ; Carter E. A. Rotationally invariant ab initio evaluation of Coulomb and exchange parameters for DFT+U calculations. J. Chem. Phys. 2008, 129 , 014103 10.1063/1.2943142.18624466
Andriotis A. ; Sheetz R. ; Menon M. LSDA+U method: A calculation of the U values at the Hartree-Fock level of approximation. Phys. Rev. B 2010, 81 , 245103 10.1103/PhysRevB.81.245103.
Agapito L. ; Curtarolo S. ; Buongiorno Nardelli M. Reformulation of DFT+U as a Pseudohybrid Hubbard Density Functional for Accelerated Materials Discovery. Phys. Rev. X 2015, 5 , 011006 10.1103/PhysRevX.5.011006.
Tancogne-Dejean N. ; Rubio A. Parameter-free hybridlike functional based on an extended Hubbard model: DFT+U+V. Phys. Rev. B 2020, 102 , 155117 10.1103/PhysRevB.102.155117.
Lee S.-H. ; Son Y.-W. First-principles approach with a pseudohybrid density functional for extended Hubbard interactions. Phys. Rev. Res. 2020, 2 , 043410 10.1103/PhysRevResearch.2.043410.
Cococcioni M. ; Marzari N. Energetics and cathode voltages of Li M PO 4 olivines (M = Fe, Mn) from extended Hubbard functionals. Phys. Rev. Materials 2019, 3 , 033801 10.1103/PhysRevMaterials.3.033801.
Ricca C. ; Timrov I. ; Cococcioni M. ; Marzari N. ; Aschauer U. Self-consistent site-dependent DFT+U study of stoichiometric and defective SrMnO3. Phys. Rev. B 2019, 99 , 094102 10.1103/PhysRevB.99.094102.
Sun Y. ; Cococcioni M. ; Wentzcovitch R. Phys. Rev. Mater. 2020, 4 , 063605 10.1103/PhysRevMaterials.4.063605.
Kirchner-Hall N. E. ; Zhao W. ; Xiong Y. ; Timrov I. ; Dabo I. Extensive Benchmarking of DFT+U Calculations for Predicting Band Gaps. Appl. Sci. 2021, 11 , 2395 10.3390/app11052395.
Xiong Y. ; Campbell Q. ; Fanghanel J. ; Badding C. ; Wang H. ; Kirchner-Hall N. ; Theibault M. ; Timrov I. ; Mondschein J. ; Seth K. ; Katzbaer R. ; Molina Villarino A. ; Pamuk B. ; Penrod M. ; Khan M. ; Rivera T. ; Smith N. ; Quintana X. ; Orbe P. ; Fennie C. ; Asem-Hiablie S. ; Young J. ; Deutsch T. ; Cococcioni M. ; Gopalan V. ; Abruña H. ; Schaak R. ; Dabo I. Optimizing accuracy and efficacy in data-driven materials discovery for the solar production of hydrogen. Energy Environ. Sci. 2021, 14 , 2335 10.1039/D0EE02984J.
Zhou J.-J. ; Park J. ; Timrov I. ; Floris A. ; Cococcioni M. ; Marzari N. ; Bernardi M. Ab Initio Electron-Phonon Interactions in Correlated Electron Systems. Phys. Rev. Lett. 2021, 127 , 126404 10.1103/PhysRevLett.127.126404.34597093
Moore G. C. ; Horton M. K. ; Ganose A. M. ; Siron M. ; Linscott E. ; O’Regan D. D. ; Persson K. A. High-throughput determination of Hubbard U and Hund J. values for transition metal oxides via linear response formalism. Phys. Rev. Mater. 2024, 8 , 014409 10.1103/PhysRevMaterials.8.014409.
Haddadi F. ; Linscott E. ; Timrov I. ; Marzari N. ; Gibertini M. On-Site and Inter-Site Hubbard Corrections in Magnetic Monolayers: The Case of FePS3 and CrI3. Phys. Rev. Materials 2024, 8 , 014007 10.1103/PhysRevMaterials.8.014007.
Linscott E. B. ; Cole D. J. ; Payne M. C. ; O’Regan D. D. Role of spin in the calculation of Hubbard U and Hund’s J parameters from first principles. Phys. Rev. B 2018, 98 , 235157 10.1103/PhysRevB.98.235157.
Timrov I. ; Marzari N. ; Cococcioni M. Hubbard parameters from density-functional perturbation theory. Phys. Rev. B 2018, 98 , 085127 10.1103/PhysRevB.98.085127.
Timrov I. ; Marzari N. ; Cococcioni M. Self-consistent Hubbard parameters from density-functional perturbation theory in the ultrasoft and projector-augmented wave formulations. Phys. Rev. B 2021, 103 , 045141 10.1103/PhysRevB.103.045141.
Leiria Campo V. Jr ; Cococcioni M. Extended DFT + U+V method with on-site and inter-site electronic interactions. J. Phys.: Condens. Matter 2010, 22 , 055602 10.1088/0953-8984/22/5/055602.21386347
Mahajan R. ; Timrov I. ; Marzari N. ; Kashyap A. Importance of intersite Hubbard interactions in beta - MnO2: A first-principles DFT+U+V study. Phys. Rev. Mater. 2021, 5 , 104402 10.1103/PhysRevMaterials.5.104402.
Park H. ; Millis A. J. ; Marianetti C. A. Density Functional versus Spin-Density Functional and the Choice of Correlated Subspace in Multivariable Effective Action Theories of Electronic Structure. Phys. Rev. B 2015, 92 , 035146 10.1103/PhysRevB.92.035146.
O’Regan D. D. ; Hine N. D. M. ; Payne M. C. ; Mostofi A. A. Projector self-consistent DFT + U using nonorthogonal generalized Wannier functions. Phys. Rev. B 2010, 82 , 081102 10.1103/PhysRevB.82.081102.
Kulik H. J. ; Marzari N. A self-consistent Hubbard U density-functional theory approach to the addition-elimination reactions of hydrocarbons on bare FeO+. J. Chem. Phys. 2008, 129 , 134314 10.1063/1.2987444.19045097
Kraisler E. ; Kronik L. Piecewise Linearity of Approximate Density Functionals Revisited: Implications for Frontier Orbital Energies. Phys. Rev. Lett. 2013, 110 , 126403 10.1103/PhysRevLett.110.126403.25166825
Linscott E. B. ; Colonna N. ; De Gennaro R. ; Nguyen N. L. ; Borghi G. ; Ferretti A. ; Dabo I. ; Marzari N. Koopmans: An Open-Source Package for Accurately and Efficiently Predicting Spectral Properties with Koopmans Functionals. J. Chem. Theory Comput. 2023, 19 , 7097–7111. 10.1021/acs.jctc.3c00652.37610300
Nguyen N. L. ; Colonna N. ; Ferretti A. ; Marzari N. Koopmans-Compliant Spectral Functionals for Extended Systems. Phys. Rev. X 2018, 8 , 021051 10.1103/PhysRevX.8.021051.
Himmetoglu B. ; Floris A. ; de Gironcoli S. ; Cococcioni M. Hubbard-corrected DFT energy functionals: The LDA+U description of correlated systems. Int. J. Quantum Chem. 2014, 114 , 14–49. 10.1002/qua.24521.
May K. J. ; Kolpak A. M. Improved description of perovskite oxide crystal structure and electronic properties using self-consistent Hubbard U corrections from ACBN0. Phys. Rev. B 2020, 101 , 165117 10.1103/PhysRevB.101.165117.
Orhan O. K. ; O’Regan D. D. First-principles Hubbard U and Hund’s J corrected approximate density functional theory predicts an accurate fundamental gap in rutile and anatase TiO 2. Phys. Rev. B 2020, 101 , 245137 10.1103/PhysRevB.101.245137.
Gelin S. ; Kirchner-Hall N. ; Katzbaer R. ; Theibault M. ; Xiong Y. ; Zhao W. ; Khan M. ; Andrewlavage E. ; Orbe P. ; Baksa S. ; Cococcioni M. ; Timrov I. ; Campbell Q. ; Abruna H. ; Schaak R. ; Dabo I. Ternary oxides of s- and p-block metals for photocatalytic solar-to-hydrogen conversion. PRX Energy 2024, 3 , 013007 10.1103/PRXEnergy.3.013007.
Timrov I. ; Agrawal P. ; Zhang X. ; Erat S. ; Liu R. ; Braun A. ; Cococcioni M. ; Calandra M. ; Marzari N. ; Passerone D. Electronic structure of Ni-substituted LaFeO3 from near edge x-ray absorption fine structure experiments and first-principles simulations. Phys. Rev. Res. 2020, 2 , 033265 10.1103/PhysRevResearch.2.033265.
Ricca C. ; Timrov I. ; Cococcioni M. ; Marzari N. ; Aschauer U. Self-consistent DFT+U+V study of oxygen vacancies in SrTiO3. Phys. Rev. Res. 2020, 2 , 023313 10.1103/PhysRevResearch.2.023313.
Floris A. ; Timrov I. ; Himmetoglu B. ; Marzari N. ; de Gironcoli S. ; Cococcioni M. Hubbard-corrected density functional perturbation theory with ultrasoft pseudopotentials. Phys. Rev. B 2020, 101 , 064305 10.1103/PhysRevB.101.064305.
Timrov I. ; Aquilante F. ; Cococcioni M. ; Marzari N. Accurate Electronic Properties and Intercalation Voltages of Olivine-Type Li-Ion Cathode Materials from Extended Hubbard Functionals. PRX Energy 2022, 1 , 033003 10.1103/PRXEnergy.1.033003.
Kulik H. J. ; Marzari N. Transition-metal dioxides: A case for the intersite term in Hubbard-model functionals. J. Chem. Phys. 2011, 134 , 094103 10.1063/1.3559452.21384946
Mahajan R. ; Kashyap A. ; Timrov I. Pivotal Role of Intersite Hubbard Interactions in Fe-Doped α-MnO2. J. Phys. Chem. C 2022, 126 , 14353–14365. 10.1021/acs.jpcc.2c04767.
Timrov I. ; Kotiuga M. ; Marzari N. Unraveling the effects of inter-site Hubbard interactions in spinel Li-ion cathode materials. Phys. Chem. Chem. Phys. 2023, 25 , 9061 10.1039/D3CP00419H.36919455
Binci L. ; Kotiuga M. ; Timrov I. ; Marzari N. Hybridization driving distortions and multiferroicity in rare-earth nickelates. Phys. Rev. Research 2023, 5 , 033146 10.1103/PhysRevResearch.5.033146.
Bonfá P. ; Onuorah I. ; Lang F. ; Timrov I. ; Monacelli L. ; Wang C. ; Sun X. ; Petracic O. ; Pizzi G. ; Marzari N. ; Blundell S. ; De Renzi R. Magnetostriction-driven muon localisation in an antiferromagnetic oxide. Phys. Rev. Lett. 2024, 132 , 046701 10.1103/PhysRevLett.132.046701.38335330
Gebreyesus G. ; Bastonero L. ; Kotiuga M. ; Marzari N. ; Timrov I. Understanding the role of Hubbard corrections in the rhombohedral phase of BaTiO3. Phys. Rev. B 2023, 108 , 235171 10.1103/PhysRevB.108.235171.
Shishkin M. ; Sato H. Challenges in computational evaluation of redox and magnetic properties of Fe-based sulfate cathode materials of Li- and Na-ion batteries. J. Phys.: Condens. Matter 2017, 29 , 215701 10.1088/1361-648X/aa6667.28426436
Shishkin M. ; Sato H. Evaluation of redox potentials of cathode materials of alkali-ion batteries using extended DFT+U+U↑↓ method: The role of interactions between the electrons with opposite spins. J. Chem. Phys. 2021, 154 , 114709 10.1063/5.0039594.33752357
Himmetoglu B. ; Wentzcovitch R. M. ; Cococcioni M. First-principles study of electronic and structural properties of CuO. Phys. Rev. B 2011, 84 , 115108 10.1103/PhysRevB.84.115108.
Noodleman L. Valence bond description of antiferromagnetic coupling in transition metal dimers. J. Chem. Phys. 1981, 74 , 5737–5743. 10.1063/1.440939.
Mariano L. A. ; Vlaisavljevich B. ; Poloni R. Biased Spin-State Energetics of Fe(II) Molecular Complexes within Density-Functional Theory and the Linear-Response Hubbard U Correction. J. Chem. Theory Comput. 2020, 16 , 6755–6762. 10.1021/acs.jctc.0c00628.33108722
Mariano L. A. ; Vlaisavljevich B. ; Poloni R. Improved Spin-State Energy Differences of Fe(II) Molecular and Crystalline Complexes via the Hubbard U -Corrected Density. J. Chem. Theory Comput. 2021, 17 , 2807–2816. 10.1021/acs.jctc.1c00034.33831303
O’Regan D. D. Optimised Projections for the Ab Initio Simulation of Large and Strongly Correlated Systems; Springer Berlin Heidelberg: Berlin, Heidelberg, 2012; pp 89–123.
Solovyev I. ; Hamada N. ; Terakura K. t23 versus all 3d localization in LaMO3 perovskites (M=Ti–Cu): First-principles study. Phys. Rev. B 1996, 53 , 7158–7170. 10.1103/PhysRevB.53.7158.
Czyżyk M. T. ; Sawatzky G. A. Local-density functional and on-site correlations: The electronic structure of La2CuO4 and LaCuO3. Phys. Rev. B 1994, 49 , 14211–14228. 10.1103/PhysRevB.49.14211.
Ylvisaker E. R. ; Pickett W. E. ; Koepernik K. Anisotropy and magnetism in the LSDA + U method. Phys. Rev. B 2009, 79 , 035103 10.1103/PhysRevB.79.035103.
Kasinathan D. ; Koepernik K. ; Pickett W. E. Pressure-driven magnetic moment collapse in the ground state of MnO. New J. Phys. 2007, 9 , 235–235. 10.1088/1367-2630/9/7/235.
Tompsett D. A. ; Middlemiss D. S. ; Islam M. S. Importance of Anisotropic Coulomb Interactions and Exchange to the Band Gap and Antiferromagnetism of beta-MnO2 from DFT+U. Phys. Rev. B 2012, 86 , 205126 10.1103/PhysRevB.86.205126.
Shishkin M. ; Sato H. DFT+ U in Dudarev’s formulation with corrected interactions between the electrons with opposite spins: The form of Hamiltonian, calculation of forces, and bandgap adjustments. J. Chem. Phys. 2019, 151 , 024102 10.1063/1.5090445.31301721
Georges A. ; Kotliar G. ; Krauth W. ; Rozenberg M. J. Dynamical mean-field theory of strongly correlated fermion systems and the limit of infinite dimensions. Rev. Mod. Phys. 1996, 68 , 13–125. 10.1103/RevModPhys.68.13.
Vaugier L. ; Jiang H. ; Biermann S. Hubbard U and Hund exchange J in transition metal oxides: Screening versus localization trends from constrained random phase approximation. Phys. Rev. B 2012, 86 , 165105 10.1103/PhysRevB.86.165105.
Hampel A. ; Lee-Hand J. ; Georges A. ; Dreyer C. E. Correlation-induced octahedral rotations in SrMoO3. Phys. Rev. B 2021, 104 , 035102 10.1103/PhysRevB.104.035102.
Merkel M. E. ; Ederer C. Calculation of Screened Coulomb Interaction Parameters for the Charge-Disproportionated Insulator CaFeO3. Phys. Rev. Res. 2024, 6 , 013230 10.1103/PhysRevResearch.6.013230.
Prentice J. C. A. ; Aarons J. ; Womack J. C. ; Allen A. E. A. ; Andrinopoulos L. ; Anton L. ; Bell R. A. ; Bhandari A. ; Bramley G. A. ; Charlton R. J. ; Clements R. J. ; Cole D. J. ; Constantinescu G. ; Corsetti F. ; Dubois S. M.-M. ; Duff K. K. B. ; Escartín J. M. ; Greco A. ; Hill Q. ; Lee L. P. ; Linscott E. ; O’Regan D. D. ; Phipps M. J. S. ; Ratcliff L. E. ; Serrano A. R. ; Tait E. W. ; Teobaldi G. ; Vitale V. ; Yeung N. ; Zuehlsdorff T. J. ; Dziedzic J. ; Haynes P. D. ; Hine N. D. M. ; Mostofi A. A. ; Payne M. C. ; Skylaris C.-K. The ONETEP linear-scaling density functional theory program. J. Chem. Phys. 2020, 152 , 174111 10.1063/5.0004445.32384832
Kulik H. J. Perspective: Treating electron over-delocalization with the DFT+U method. J. Chem. Phys. 2015, 142 , 240901 10.1063/1.4922693.26133400
Timrov I. ; Aquilante F. ; Binci L. ; Cococcioni M. ; Marzari N. Pulay forces in density-functional theory with extended Hubbard functionals: From nonorthogonalized to orthogonalized manifolds. Phys. Rev. B 2020, 102 , 235159 10.1103/PhysRevB.102.235159.
Kulik H. J. ; Seelam N. ; Mar B. D. ; Martínez T. J. Adapting DFT+ U for the Chemically Motivated Correction of Minimal Basis Set Incompleteness. J. Phys. Chem. A 2016, 120 , 5939–5949. 10.1021/acs.jpca.6b04527.27383567
Rohrbach A. ; Hafner J. ; Kresse G. Molecular adsorption on the surface of strongly correlated transition-metal oxides: A case study for CO/NiO(100). Phys. Rev. B 2004, 69 , 075413 10.1103/PhysRevB.69.075413.
Nawa K. ; Akiyama T. ; Ito T. ; Nakamura K. ; Oguchi T. ; Weinert M. Scaled effective on-site Coulomb interaction in the DFT+ U method for correlated materials. Phys. Rev. B 2018, 97 , 035117 10.1103/PhysRevB.97.035117.
Löwdin P. On the Non-Orthogonality Problem Connected with the Use of Atomic Wave Functions in the Theory of Molecules and Crystals. J. Chem. Phys. 1950, 18 , 365–375. 10.1063/1.1747632.
Korotin D. ; Kukolev V. ; Kozhevnikov A. ; Novoselov D. ; Anisimov V. Electronic correlations and crystal structure distortions in BaBiO3. J. Phys.: Condens. Matter 2012, 24 , 415603 10.1088/0953-8984/24/41/415603.23014377
Novoselov D. ; Korotin D. ; Anisimov V. Hellmann-Feynman forces within the DFT+U in Wannier functions basis. J. Phys.: Condens. Matter 2015, 27 , 325602 10.1088/0953-8984/27/32/325602.26214345
Marzari N. ; Vanderbilt D. Maximally localized generalized Wannier functions for composite energy bands. Phys. Rev. B 1997, 56 , 12847–12865. 10.1103/PhysRevB.56.12847.
Marzari N. ; Mostofi A. ; Yates J. ; Souza I. ; Vanderbilt D. Maximally localized Wannier functions: Theory and applications. Rev. Mod. Phys. 2012, 84 , 1419–1475. 10.1103/RevModPhys.84.1419.
Qiao J. ; Pizzi G. ; Marzari N. Automated mixing of maximally localized Wannier functions into target manifolds. npj Comp. Mater. 2023, 9 .10.1038/s41524-023-01147-9.
Tesch R. ; Kowalski P. M. Hubbard U parameters for transition metals from first principles. Phys. Rev. B 2022, 105 , 195153 10.1103/PhysRevB.105.195153.
Sakuma R. ; Aryasetiawan F. First-principles calculations of dynamical screened interactions for the transition metal oxides MO (M = Mn, Fe, Co, Ni). Phys. Rev. B 2013, 87 , 165118 10.1103/PhysRevB.87.165118.
Timrov I. ; Marzari N. ; Cococcioni M. HP – A code for the calculation of Hubbard parameters using density-functional perturbation theory. Comput. Phys. Commun. 2022, 279 , 108455 10.1016/j.cpc.2022.108455.
Hsu H. ; Blaha P. ; Cococcioni M. ; Wentzcovitch R. M. Spin-State Crossover and Hyperfine Interactions of Ferric Iron in MgSiO3 Perovskite. Phys. Rev. Lett. 2011, 106 , 118501 10.1103/PhysRevLett.106.118501.21469904
Kulik H. J. ; Marzari N. Systematic study of first-row transition-metal diatomic molecules: A self-consistent DFT+U approach. J. Chem. Phys. 2010, 133 , 114103 10.1063/1.3489110.20866122
Yu K. ; Carter E. Communication: Comparing ab initio methods of obtaining effective U parameters for closed-shell materials. J. Chem. Phys. 2014, 140 , 121105 10.1063/1.4869718.24697417
Giannozzi P. ; Baroni S. ; Bonini N. ; Calandra M. ; Car R. ; Cavazzoni C. ; Ceresoli D. ; Chiarotti G. ; Cococcioni M. ; Dabo I. ; Dal Corso A. ; De Gironcoli S. ; Fabris S. ; Fratesi G. ; Gebauer R. ; Gerstmann U. ; Gougoussis C. ; Kokalj A. ; Lazzeri M. ; Martin-Samos L. ; Marzari N. ; Mauri F. ; Mazzarello R. ; Paolini S. ; Pasquarello A. ; Paulatto L. ; Sbraccia C. ; Scandolo S. ; Sclauzero G. ; Seitsonen A. ; Smogunov A. ; Umari P. ; Wentzcovitch R. Quantum ESPRESSO: A modular and open-source software project for quantum simulations of materials. J. Phys.: Condens. Matter 2009, 21 , 395502 10.1088/0953-8984/21/39/395502.21832390
Giannozzi P. ; Andreussi O. ; Brumme T. ; Bunau O. ; Buongiorno Nardelli M. ; Calandra M. ; Car R. ; Cavazzoni C. ; Ceresoli D. ; Cococcioni M. ; Colonna N. ; Carnimeo I. ; Dal Corso A. ; de Gironcoli S. ; Delugas P. ; DiStasio Jr. R. A. ; Ferretti A. ; Floris A. ; Fratesi G. ; Fugallo G. ; Gebauer R. ; Gerstmann U. ; Giustino F. ; Gorni T. ; Jia J. ; Kawamura M. ; Ko H.-Y. ; Kokalj A. ; Küçükbenli E. ; Lazzeri M. ; Marsili M. ; Marzari N. ; Mauri F. ; Nguyen N. L. ; Nguyen H.-V. ; Otero-de-la-Roza A. ; Paulatto L. ; Poncé S. ; Rocca D. ; Sabatini R. ; Santra B. ; Schlipf M. ; Seitsonen A. ; Smogunov A. ; Timrov I. ; Thonhauser T. ; Umari P. ; Vast N. ; Wu X. ; Baroni S. Advanced capabilities for materials modelling with Quantum ESPRESSO. J. Phys.: Condens. Matter 2017, 29 , 465901 10.1088/1361-648X/aa8f79.29064822
Giannozzi P. ; Baseggio O. ; Bonfà P. ; Brunato D. ; Car R. ; Carnimeo I. ; Cavazzoni C. ; de Gironcoli S. ; Delugas P. ; Ferrari Ruffino F. ; Ferretti A. ; Marzari N. ; Timrov I. ; Urru A. ; Baroni S. Quantum ESPRESSO toward the exascale. J. Chem. Phys. 2020, 152 , 154105 10.1063/5.0005082.32321275
Momma K. ; Izumi F. VESTA for Three-Dimensional Visualization of Crystal, Volumetric and Morphology Data. J. Appl. Crystallogr. 2011, 44 , 1272–1276. 10.1107/S0021889811038970.
Fletcher R. Practical Methods of Optimization, 2nd ed.; Wiley: Chichester, 1987.
Perdew J. P. ; Burke K. ; Ernzerhof M. Generalized Gradient Approximation Made Simple. Phys. Rev. Lett. 1996, 77 , 3865–3868. 10.1103/PhysRevLett.77.3865.10062328
Perdew J. P. ; Ruzsinszky A. ; Csonka G. I. ; Vydrov O. A. ; Scuseria G. E. ; Constantin L. A. ; Zhou X. ; Burke K. Restoring the Density-Gradient Expansion for Exchange in Solids and Surfaces. Phys. Rev. Lett. 2008, 100 , 136406 10.1103/PhysRevLett.100.136406.18517979
Kucukbenli E. ; Monni M. ; Adetunji B. I. ; Ge X. ; Adebayo G. A. ; Marzari N. ; de Gironcoli S. ; Corso A. D. Projector augmented-wave and all-electron calculations across the periodic table: a comparison of structural and energetic properties. arXiv, 2014.10.48550/arXiv.1404.3015.
Garrity K. F. ; Bennett J. W. ; Rabe K. M. ; Vanderbilt D. Pseudopotentials for high-throughput DFT calculations. Comput. Mater. Sci. 2014, 81 , 446–452. 10.1016/j.commatsci.2013.08.053.
Dal Corso A. Pseudopotentials periodic table: From H to Pu. Comput. Mater. Sci. 2014, 95 , 337–350. 10.1016/j.commatsci.2014.07.043.
Lejaeghere K. ; Bihlmayer G. ; Björkman T. ; Blaha P. ; Blügel S. ; Blum V. ; Caliste D. ; Castelli I. E. ; Clark S. J. ; Dal Corso A. ; de Gironcoli S. ; Deutsch T. ; Dewhurst J. K. ; Di Marco I. ; Draxl C. ; Dułak M. ; Eriksson O. ; Flores-Livas J. A. ; Garrity K. F. ; Genovese L. ; Giannozzi P. ; Giantomassi M. ; Goedecker S. ; Gonze X. ; Grånäs O. ; Gross E. K. U. ; Gulans A. ; Gygi F. ; Hamann D. R. ; Hasnip P. J. ; Holzwarth N. A. W. ; Iuşan D. ; Jochym D. B. ; Jollet F. ; Jones D. ; Kresse G. ; Koepernik K. ; Küçükbenli E. ; Kvashnin Y. O. ; Locht I. L. M. ; Lubeck S. ; Marsman M. ; Marzari N. ; Nitzsche U. ; Nordström L. ; Ozaki T. ; Paulatto L. ; Pickard C. J. ; Poelmans W. ; Probert M. I. J. ; Refson K. ; Richter M. ; Rignanese G.-M. ; Saha S. ; Scheffler M. ; Schlipf M. ; Schwarz K. ; Sharma S. ; Tavazza F. ; Thunström P. ; Tkatchenko A. ; Torrent M. ; Vanderbilt D. ; van Setten M. J. ; Van Speybroeck V. ; Wills J. M. ; Yates J. R. ; Zhang G.-X. ; Cottenier S. Reproducibility in density functional theory calculations of solids. Science 2016, 351 .10.1126/science.aad3000.
Prandini G. ; Marrazzo A. ; Castelli I. E. ; Mounet N. ; Marzari N. Precision and efficiency in solid-state pseudopotential calculations. Npj Comput. Mater. 2018, 4 , 72 10.1038/s41524-018-0127-2.
Ku C. ; Sit P. H.-L. Oxidation-State Constrained Density Functional Theory for the Study of Electron-Transfer Reactions. J. Chem. Theory Comput. 2019, 15 , 4781–4789. 10.1021/acs.jctc.9b00281.31339717
Moynihan G. ; Teobaldi G. ; O’Regan D. D. A self-consistent ground-state formulation of the first-principles Hubbard U parameter validated on one-electron self-interaction error. arXiv, 2017.10.48550/arXiv.1704.08076.
Zuñiga-Puelles E. ; Cardoso-Gil R. ; Bobnar M. ; Veremchuk I. ; Himcinschi C. ; Hennig C. ; Kortus J. ; Heide G. ; Gumeniuk R. Structural stability and thermoelectric performance of high quality synthetic and natural pyrites (FeS2). Dalton Trans. 2019, 48 , 10703–10713. 10.1039/C9DT01902B.31243411
Banjara D. ; Malozovsky Y. ; Franklin L. ; Bagayoko D. First-principles studies of electronic, transport and bulk properties of pyrite FeS2. AIP Adv. 2018, 8 , 025212 10.1063/1.4996551.
Sun R. ; Chan M. K. Y. ; Ceder G. First-principles electronic structure and relative stability of pyrite and marcasite: Implications for photovoltaic performance. Phys. Rev. B 2011, 83 , 235311 10.1103/PhysRevB.83.235311.
Eyert V. ; Höck K.-H. ; Fiechter S. ; Tributsch H. Electronic structure of FeS2: The crucial role of electron-lattice interaction. Phys. Rev. B 1998, 57 , 6350–6359. 10.1103/PhysRevB.57.6350.
Armiento R. ; Mattsson A. E. Functional designed to include surface effects in self-consistent density functional theory. Phys. Rev. B 2005, 72 , 085108 10.1103/PhysRevB.72.085108.
Burns G. Introduction to group theory with applications; Materials science and technology; Academic Press: New York, 1977.
Schena T. ; Bihlmayer G. ; Blügel S. First-principles studies of FeS2 using many-body perturbation theory in the G0W0 approximation. Phys. Rev. B 2013, 88 , 235203 10.1103/PhysRevB.88.235203.
Perdew J. P. ; Ernzerhof M. ; Burke K. Rationale for mixing exact exchange with density functional approximations. J. Chem. Phys. 1996, 105 , 9982–9985. 10.1063/1.472933.
Heyd J. ; Scuseria G. E. ; Ernzerhof M. Hybrid functionals based on a screened Coulomb potential. J. Chem. Phys. 2003, 118 , 8207–8215. 10.1063/1.1564060.
Cui Z.-H. ; Wang Y.-C. ; Zhang M.-Y. ; Xu X. ; Jiang H. Doubly Screened Hybrid Functional: An Accurate First-Principles Approach for Both Narrow- and Wide-Gap Semiconductors. J. Phys. Chem. Lett. 2018, 9 , 2338–2345. 10.1021/acs.jpclett.8b00919.29669414
Zhao Y. ; Truhlar D. G. The M06 suite of density functionals for main group thermochemistry, thermochemical kinetics, noncovalent interactions, excited states, and transition elements: two new functionals and systematic testing of four M06-class functionals and 12 other functionals. Theor. Chem. Acc. 2008, 120 , 215–241. 10.1007/s00214-007-0310-x.
Zhang M.-Y. ; Jiang H. Accurate Prediction of Band Structure of FeS2: A Hard Quest of Advanced First-Principles Approaches. Front. Chem. 2021, 9 , 747972 10.3389/fchem.2021.747972.34650959
Ennaoui A. ; Tributsch H. Iron sulphide solar cells. Sol. Cells 1984, 13 , 197–200. 10.1016/0379-6787(84)90009-7.
Phung Q. M. ; Feldt M. ; Harvey J. N. ; Pierloot K. Toward Highly Accurate Spin State Energetics in First-Row Transition Metal Complexes: A Combined CASPT2/CC Approach. J. Chem. Theory Comput. 2018, 14 , 2446–2455. 10.1021/acs.jctc.8b00057.29614218
Zaanen J. ; Sawatzky G. A. ; Allen J. W. Band gaps and electronic structure of transition-metal compounds. Phys. Rev. Lett. 1985, 55 , 418–421. 10.1103/PhysRevLett.55.418.10032345
Sato H. ; Enoki T. ; Isobe M. ; Ueda Y. Transport properties and magnetism of a helically Hund-coupled conductor: beta-MnO2. Phys. Rev. B 2000, 61 , 3563–3569. 10.1103/PhysRevB.61.3563.
Chevillot J.-P. ; Brenet J. Influence d’ions étrangers sur la semi-conductibilité des bioxydes de manganèse. C. R. Acad. Sci. Paris 1959, 278 , 776–778.
Druilhe R. Nouveaux Semi-Conducteurs Magnetiques, Cristal-Lisant Dans La Structure Du Rutile. C. R. Hebd. Séances Acad. Sci., Ser. B 1966, 653.
Kumar N. ; Sen A. ; Rajendran K. ; Rameshbabu R. ; Ragupathi J. ; Therese H. A. ; Maiyalagan T. Morphology and phase tuning of alpha- and beta-MnO2 nanocacti evolved at varying modes of acid count for their well-coordinated energy storage and visible-light-driven photocatalytic behaviour. RSC Adv. 2017, 7 , 25041–25053. 10.1039/C7RA02013A.
Bigiani L. ; Gasparotto A. ; Maccato C. ; Sada C. ; Verbeeck J. ; Andreu T. ; Morante J. R. ; Barreca D. Dual Improvement of beta-MnO2 Oxygen Evolution Electrocatalysts via Combined Substrate Control and Surface Engineering. ChemCatChem. 2020, 12 , 5984–5992. 10.1002/cctc.202000999.
Franchini C. ; Podloucky R. ; Paier J. ; Marsman M. ; Kresse G. Ground-state properties of multivalent manganese oxides: Density functional and hybrid density functional calculations. Phys. Rev. B 2007, 75 , 195128 10.1103/PhysRevB.75.195128.
Lim J. S. ; Saldana-Greco D. ; Rappe A. M. Improved pseudopotential transferability for magnetic and electronic properties of binary manganese oxides from DFT+U+J calculations. Phys. Rev. B 2016, 94 , 165151 10.1103/PhysRevB.94.165151.
Bolzan A. ; Fong C. ; Kennedy B. ; Howard C. Powder Neutron Diffraction Study of Pyrolusite, beta-MnO2. Aust. J. Chem. 1993, 46 , 939 10.1071/CH9930939.
Huber S. P. ; Zoupanos S. ; Uhrin M. ; Talirz L. ; Kahle L. ; Häuselmann R. ; Gresch D. ; Müller T. ; Yakutovich A. V. ; Andersen C. W. ; Ramirez F. F. ; Adorf C. S. ; Gargiulo F. ; Kumbhar S. ; Passaro E. ; Johnston C. ; Merkys A. ; Cepellotti A. ; Mounet N. ; Marzari N. ; Kozinsky B. ; Pizzi G. AiiDA 1.0, a Scalable Computational Infrastructure for Automated Reproducible Workflows and Data Provenance. Sci. Data 2020, 7 , 300 10.1038/s41597-020-00638-4.32901044
Uhrin M. ; Huber S. P. ; Yu J. ; Marzari N. ; Pizzi G. Workflows in AiiDA: Engineering a high-throughput, event-based engine for robust and modular computational workflows. Comput. Mater. Sci. 2021, 187 , 110086 10.1016/j.commatsci.2020.110086.
Macke E. ; Timrov I. ; Marzari N. ; Ciacchi L. C. Orbital-resolved DFT+U for molecules and solids. Materials Cloud Archive, 2024.53 2024.10.24435/materialscloud:tw-b5.
