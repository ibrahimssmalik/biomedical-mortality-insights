
==== Front
Sensors (Basel)
Sensors (Basel)
sensors
Sensors (Basel, Switzerland)
1424-8220
MDPI

10.3390/s24113332
sensors-24-03332
Article
Secrecy Analysis of a Mu-MIMO LIS-Aided Communication Systems under Nakagami-m Fading Channels
https://orcid.org/0000-0002-9309-1735
Ferreira Ricardo Coelho Conceptualization Formal analysis Writing – original draft 1*
https://orcid.org/0000-0002-0517-1496
Fraidenraich Gustavo Conceptualization Formal analysis Writing – original draft 1
https://orcid.org/0000-0002-2167-7286
de Figueiredo Felipe A. P. Conceptualization Formal analysis Writing – original draft 12
https://orcid.org/0000-0003-4268-9726
de Lima Eduardo Rodrigues Conceptualization Formal analysis Writing – original draft 3
Gaillot Davy P. Academic Editor
1 Department of Communications, Faculty of Electrical and Computer Engineering, State University of Campinas (UNICAMP), Campinas 13083-970, SP, Brazil; gf@decom.fee.unicamp.br (G.F.); felipe.figueiredo@inatel.br (F.A.P.d.F.)
2 Instituto Nacional de Telecomunicações—INATEL, Santa Rita do Sapucaí 37540-000, MG, Brazil
3 Department of Hardware Design, Instituto de Pesquisas Eldorado, Alan Turing-275, Campinas 13083-898, SP, Brazil; eduardo.lima@eldorado.org.br
* Correspondence: rcoeferreira@gmail.com
23 5 2024
6 2024
24 11 333204 4 2024
26 4 2024
06 5 2024
© 2024 by the authors.
2024
https://creativecommons.org/licenses/by/4.0/ Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https://creativecommons.org/licenses/by/4.0/).
This study evaluates the performance of large intelligent surface (LIS) technology in the context of a multi-user MIMO mobile communication system (Mu-MIMO) proposed for the sixth generation (6G). LIS employs digitally controlled reflectors to enhance Signal-to-Interference plus Noise Ratio (SINR) and establish line of sight (LoS) connectivity in non-LoS environments, improving transmission security. Analytical expressions are derived to assess LIS performance metrics, including distribution parameters, bit error probability, and secrecy outage probability, considering the presence of eavesdroppers and environmental fading. The study highlights the potential of LIS technology to enhance the confidentiality and reliability of digital communication systems in next-generation networks.

large intelligent surfaces
reflecting surfaces
mobile communications
Nakagami-m fading
Mu-MIMO systems
CNPq302077/2022-7 403612/2020-9 311470/2021-1 403827/2021-3 São Paulo Research Foundation (FAPESP)2021/06946-0 Minas Gerais Research Foundation (FAPEMIG)APQ-00810-21 xGMobile—EMBRAPII-Inatel Competence Center on 5G and 6G Networks052/2023 This work was partially funded by CNPq (Grant Nos. 302077/2022-7, 403612/2020-9, 311470/2021-1, and 403827/2021-3), by the São Paulo Research Foundation (FAPESP) (Grant No. 2021/06946-0), by the Minas Gerais Research Foundation (FAPEMIG) (Grant No. APQ-00810-21) and by the project “Resource-aware Machine Learning Model Optimization for Edge Computing”, supported by xGMobile—EMBRAPII-Inatel Competence Center on 5G and 6G Networks, with financial resources from the PPI IoT/Manufatura 4.0 from MCTI grant number 052/2023, signed with EMBRAPII.
==== Body
pmc1. Introduction

Mobile communications face several challenges in delivering signals with a good signal-to-noise ratio (SNR) and high transmission rates to users. One is multipath propagation, which is present mainly in large urban centers, with increasingly larger buildings and many users sharing the spectrum. This study proposes the implementation of strategically positioned reflecting surfaces to enhance the channel SNR and deliver a clearer, less interfered signal.

Large, intelligent surfaces have been one of the biggest innovations in digital communications in recent years. The term has variants such as large reflecting surfaces or intelligent reflecting surfaces. They consist of a grid of reflecting units composed of a metamaterial with a controllable reflection coefficient that can be digitally controlled using an optimization algorithm to strengthen the channel’s LoS.

Zhang et al. [1] presented a cost-effective and energy-efficient solution to enhance signal coverage and improve system capacity in mobile communications. However, large intelligent surfaces face challenges such as multiplicative fading effects arising from composite channels between the LIS and base stations and between the LIS and users. Additionally, the LIS encounters difficulties in enhancing communication systems when a strong direct link is present. Almekhlafi et al. [2] investigated a scenario where a base station transmits signals to multiple users using a single antenna. They developed an algorithm to jointly optimize power allocation to users and phase shifts induced by the LIS. In contrast to other studies that perform optimization processes in a decoupled manner, the authors propose two solutions: one utilizing linear transformation to reduce the number of variables for optimization and another employing an element-wise Karush–Kuhn–Tucker approach to derive closed-form expressions for phase shifts in a multi-user scenario.

Researchers are actively involved in discussions about the sixth generation and beyond the fifth generation (B5G) of mobile communications in several countries [3,4,5,6]. To meet this advancement, the community faces a series of challenges, encompassing algorithmic and mathematical complexities, as well as issues related to hardware and materials [7,8,9,10].

Tataria et al. [11] contributed significantly to addressing the challenges associated with the real-time implementation of LISs. In the same vein, Wang et al. [12] presented a remarkable system proposal employing a reconfigurable smart reflective surface in a MIMO cognitive radio environment. Their approaches strive to optimize the system secrecy rate by jointly optimizing base station transmit beamforming, and RIS-reflected beamforming, considering the complexities of dynamic environments.

Despite being a relatively new topic, there are older references in the LIS literature [13]. The term LIS has gained evidence and prominence and become a relevant bet for the technological industry and also academic research as a promising alternative to improve spectral efficiency (since it can act passively, without energy expenditure), decrease the bit error probability, and allow the erasure of channels for eavesdroppers using beamforming techniques, allowing a more elaborate approach of physical layer security.

The ability of the LIS to adapt to the channel and generate a resulting channel with different statistics allows us to, in a way, think of a controllable and adjusted channel. The channel between the transmitter and the LIS, as well as the channel between the end-user and the LIS, can be generically modeled using the Nakagami-m distribution, with the m parameter allowing a generic analysis of the environment’s behavior [14] before considering the presence of the LIS. In addition, it is prudent to consider a possible direct channel between the user and the transmitter and channels between the transmitter and an eavesdropper; without losing the generality, we can consider all these channels as Nakagami-m. However, each one has its parameter m; for users close to the base station, the parameter m in the Nakagami distribution for the direct channel will be large between the user and the transmitter and may not even need the LIS, whereas a user outside the LoS may have m=1 and fall into the Rayleigh fading scenario (without LoS), where the LIS will create a channel resulting from the composition of all the links that result in a channel with LoS and a lower bit error rate [15].

The literature on mobile communication network optimization has been limited to two-point operations, with some strategies only for the transmitter (a base station) and the receiver. However, LISs changed this reality and created new possibilities to achieve even lower bit error rates, better spectral efficiency, decreased transmission power, and increased SNR. According to Gong et al. [16] the LIS allows modifying the channel characteristics and canceling its phase; in addition to projecting the beam towards the user, the adjustable reflector panels of the LIS can match the signals that reach them, thus enabling a smart radio environment that learns to beat the channel, even when its characteristics change.

Wu et al. [17] developed a framework in the form of a tutorial for implementing the LIS; the authors present the channel model, including the reflectors, discuss hardware aspects and practical issues related to the system deployment, and point out future possibilities for this technology.

Sánchez et al. [18] presented a performance analysis regarding physical layer security (PLS) in an environment assisted by a LIS, considering the possibility of phase errors. The authors assume that it is possible to model an equivalent scalar fading channel including the LIS, as shown by recent work [19] and show that the eavesdropper’s channel is Rayleigh distributed. The fading coefficient is statistically independent of the channel between the transmitter and the legitimate user; they also present the scaling laws for the SNR of the legitimate channel and the eavesdropper concerning the number of LIS reflectors.

Most preliminary articles on LISs present strategies for estimating the channel assisted by the LIS via least squares and other related methods, considering perfect knowledge of the CSI. However, this scenario is not close to reality since they are passive reflectors that intelligently reflect the inside electromagnetic waves to improve system performance. Nadeem et al. [20] present one of the first and most relevant contributions in studying a multi-user system assisted by the LIS assuming an imperfect CSI. The authors use the a priori knowledge of the fading statistics to feed a Bayesian minimum mean squared error (MMSE) estimator for the resulting fading, thus proposing a joint design of the precoder and the power allocation for transmission considering the application of beamforming in the LIS and show the impact of the channel estimation error on the efficiency of the designed system.

Basar et al. [21] present a script for the analytical calculation of the symbol error probability (SEP) in the transmission through the LIS in a generic scenario, in addition to presenting alternative modeling that considers the LIS as an access point (AP), which can or cannot know the phases of the channel.

The statistical analysis of cascaded MIMO channels poses a considerable challenge, complicating the modeling of resulting fading due to including both linear and non-linear transformations of random variables in its definition. However, by using the central limit theorem (CLT), it is possible to obtain, with great accuracy, the fading statistical model, taking into account the continuous phase errors committed by the LIS after the phase adjustment. The composite channel is the product of two channels with a Nakagami-m [14] distribution with different coefficients, modeling what goes to the LIS and what goes to the user, and a complex phase error modeled as a Von Mises distribution. Ferreira et al. [15] obtained the distribution of the resulting channel considering only one antenna in the receiver; in this work, we approach a more complex and more comprehensive system model, which includes all the analyses made by the authors, for a special case in which the number of antennas of the user is unitary.

This study investigates the fading distribution of a LIS-aided channel with multiple transmitters and users enabling the increase of SINR, allowing the strengthening of a LoS or improving spectrum sharing. It examines the impact of channel parameters (the number of LIS reflectors, users, the Von Mises error concentration parameter, and the number of transmitter antennas) on the bit error probability and the secrecy outage probability. The aim is to assess the impact of LIS design on performance and help design the system based on quality and information security metrics, evaluating performance that can be calculated directly through simple algebraic expressions involving the parameters of the statistical modeling of the system.

Recent papers on LISs present various mobile system modeling schemas. Lin et al. [22] focused on joint beamforming design for LIS-aided hybrid satellite–terrestrial relay networks, employing a refracting LIS approach to enhance satellite signals for obstructed users. Lin et al. [23] investigated destructive beamforming by a malicious LIS in IoT networks to minimize received SNR at IoT devices. Ma et al.’s [24] study converted mmWave communications with finite blocklength, optimizing antenna gain for covert transmission against spatially random wardens. Niu et al. [25] analyzed robust beamforming design in a secrecy MISO network with LIS, addressing imperfections in CSI and potential eavesdroppers. These articles considered different beamforming strategies, addressing challenges such as power optimization, security, and robustness to channel variations. In contrast, our paper focuses on the phase error distribution without being restricted to a specific optimization technique and can be applied, regardless of how the LIS is designed, provided that the phase error concentration parameter is known. With this level of abstraction, we analyzed the system performance in terms of physical layer security and bit error probability across various fading scenarios involving multiple users.

2. System Model

This work considers a base station composed of M uncorrelated antennas and K uncorrelated users, as shown in Figure 1. The base station sends the same message to all users; however, it applies a normalized precoding vector for each one of the fading channels.

The signal received by the uncorrelated antenna array at the user side is (1) y=GHΦHHH+HdHΨ+η,

where H∈CM×N is the channel between each one of the uncorrelated antennas at the base station and each one of the LIS reflectors, G∈CN×K is the channel between the LIS reflectors and the users, Φ∈CN×N is the phase matrix with the phase shifts applied by the LIS in the incoming signals, and Hd∈CM×K is the direct link between the base station and each user. The eavesdropper link is w∈CM×1 and is only considered for the secrecy outage probability analysis. Therefore, it was neglected in the first analysis.

One possible strategy to cancel the channel phase is to apply a precoding matrix at the base station; in this case, the sub-optimal solution is the normalized hermitian of the overall channel.

Let (2) Υ=HΦG+Hd,

whose dimensions are Υ∈CM×K, and the elements of the matrix Υ are the υk vectors.

The scalar elements of H have a Nakagami distribution with parameters mH and ΩH, the elements of G have a Nakagami distribution with parameters mG and ΩG, and the elements of Hd follow the complex normal distribution with mean zero.

The mean of a variable T with Nakagami-m distribution with parameters m and Ω can be calculated by (3) E[T]=Γm+12Γ(m)Ωm12,

and the second-order moment ET2=Ω.

The transmitted symbols after the application of the precoder are (4) Ψ=PAs,

where P is the power gain and A is the precoding matrix, and, for analysis purposes, the s symbols are generated as complex normal distributed s∼CN0,IK.

The sub-optimal precoding matrix, considering complete knowledge of the Channel State Information (CSI), is given by (5) A=PΥΥF,

where .F is the Frobenius norm. The precoding vector for each user is given by (6) ak=PKυkυk,

and each one of the υk has dimensions υk∈CM×1.

The scalar definition of each element of the υk vectors is (7) υlk=∑p=1N∑q=1Nhlpϕpqgqk+h(d),kl,

after the application of the LIS, these coefficients can be rewritten as (8) υlk=∑p=1N∑q=1Nhlpgqkejδ(h),lp+δ(g),qk−φpq+h(d),kl,

where δ(h),lp=arg(h), φpq=arg(ϕpq), and δ(g),qk=arg(gqk) are the phases of each channel.

To nullify the overall channel phase, the phase shift applied by the LIS panel must be equal to φpq=δ(h),lp+δ(g),qk−δpq

where δpq is the residual error of the LIS phase correction.

The elements of the overall channel matrix for each user are (9) υk=∑p=1N∑q=1Nhpgqkejδpq+h(d),k,

where hp=h1p,h2p…hMp

and h(d),k=h(d),k1,h(d),k2,…h(d),kM are the lines of the matrix Hd.

The norm of the overall channel for each user can be written as (10) υk2=∑l=1M∑p=1N∑q=1Nhlpgqkejδpq+h(d),kl2,

and the SINR at the user antenna k is (11) γk=|υkHak|2∑i=0,i≠kK|υiHai|2+ση2,

where the terms (12) υkHak2=PKυk2.

Therefore, (13) γk=PKυk2PK∑i=0,i≠kKυi2+ση2.

The SINR can be rewritten as (14) γk=Zkση2+∑i=0,i≠kKZi,

where Zi=υi2.

Since the summation terms of Equation (10) are complex variables, then (15) Zk=PK∑l=1Mrlk2,

where (16) rlk=∑p=1N∑q=1Nhlpgqkejδpq+h(d),kl.

Considering that the complex number rlk=clk+jslk, thus (17) Zk=PK∑l=1Mclk+jslk2,

in which (18) clk=∑p=1N∑q=1Nhlpgqkcosδpq+ℜ{h(d),kl},

and (19) slk=∑p=1N∑q=1Nhlpgqksinδpq+ℑ{h(d),kl}.

By substituting the imaginary and real parts of the complex scalar rlk, it follows that (20) υk2=∑l=1Mclk2+∑l=1Mslk2,

since the real and imaginary parts of the direct path h(d),kl are Gaussian and uncorrelated.

Let be Ck=∑l=1Mclk2 and Sk=∑l=1Mslk2; therefore, we can rewrite υk2 as (21) Rk=υk2=Ck+Sk,

then (22) Zk=PKRk,

we consider that (23) Fk=ση2+∑i=0,i≠kKZi.

Therefore, the SINR can be written in terms of these two coefficients as (24) γk=ZkFk.

Since Zk is the sum of squared Gaussian random variables, it is reasonable to assume that Zk is Gamma distributed with parameters αZ and βZ. The term Fk is the sum of Gamma random variables, and it is supposed to be also Gamma distributed with parameters αF and βF.

The SINR γk is the ratio between the variables Zk and Fk and also is supposed to be Gamma distributed. This study proposes an approximation for the SINR distribution to obtain the error and secrecy outage probability. Although not an exact solution, the approximation is very accurate, even for small values of M, N, and K.

The parameters of the SINR distribution can be obtained by calculating the moments of γk. Since γk is the ratio of Zk and Fk, therefore, the statistics of the numerator Zk and the denominator Fk must be evaluated.

The variables Zk and Fk are correlated, and because of this, the covariance between them must be taken into account.

According to Kendall et al. [26], the mean of the ratio between the Gamma random variables is (25) μγ=Eγk=μZμF,

where μZ=EZk and μF=EFk.

The variance can be approximated by (26) varγk=μZμF2σZ2μZ2−2cov(Zk,Fk)μZμF+σF2μF2,

where σF2=var(Fk) and σZ2=var(Zk).

The term cov(Zk,Fk)=EZkFk−EZkEFk can be computed as cov(Zk,Fk)=EZk∑i≠kKZi−EZkE∑i≠kKZi=∑i≠kKEZkZi−EZkEZi; by considering the definition of the covariance and considering that all the coefficients Zk are equally distributed, then (27) cov(Zk,Fk)=(K−1)cov(Zi,Zk),∀i≠k.

Given the covariance cov(Zk,Fk), the variance of γk can be derived as (28) σγ2=μZμF2σZ2μZ2−2(K−1)cov(Zi,Zk)μZμF+σF2μF2,

where σγ2 is an approximation for varγk.

Since μF=(K−1)μZ, thus (29) σγ2=1(K−1)2μZ2σZ2−2cov(Zi,Zk)+σF2(K−1)2,

with the overall channel moments, the fading parameters αγ and βγ can be computed as follows:(30) αγ=μγ2σγ2,βγ=μγσγ2,

where αγ and βγ are the shape and rate parameters of the SINR γk.

The mean and variance of Zk, Fk and γk are presented in Appendix A, Appendix B and Appendix C respectively.

2.1. Error Probability

The error probability of a LIS-aided communication system was derived by Ferreira et al. [19], considering that the transmitted symbols are M-QAM signals transmitted through a Gamma fading channel; in this scenario, the probability will be (31) P¯eQAM(γ)≈4log2MQ3γlog2MM−1.

Since the mu-MIMO LIS channel is considered as Gamma distributed, therefore, this expression for P¯eQAM(γ) will be used. The parameters γk are identically distributed and, therefore, P¯eQAM(γk)=P¯eQAM(γl)=P¯eQAM(γ).

2.2. Secrecy Outage Probability

Secrecy outage probability is a metric used in communication systems to quantify the likelihood of unauthorized information disclosure. It represents the probability that the confidential information transmitted between parties becomes susceptible to interception or eavesdropping. A lower secrecy outage probability indicates a higher level of security, where the confidential information is less likely to be compromised during transmission.

The SOP is the probability that the instantaneous secrecy capacity, C, is less or equal to a given capacity threshold, ln1+γth, which is expressed as (32) SOP=Prln(1+γD)(1+γE)≤ln1+γth=∫0∞∫01+γE1+γD−1fγE(w)fγD(u)dudw,

the instantaneous secrecy capacity can be written as (33) C=ln1+γD−ln1+γEγD>γE0γD≤γE,

where γE is the SINR of the channel between the source and the eavesdropper and γD is the SINR of the channel between the source and the correct destination (the user).

Ferreira et al. [15] derived the exact formula of the SOP for a Nakagami-m distributed eavesdropper channel as (34). (34) SOP=∑k=0∞(−1)kβα+kγthα+kΓ(α)Γ(k+1)×(πmm2−α−kv−2mΩ−mΓ(m+12)csc(π(α+k+2m))2F˜2(m,m+12;12(k+2m+α+1),12(k+2m+α+2);−mv2Ω)Γ(−k−α+1)+π3/2Ωα+k2m12(−α−k)vα+k2Γ(m)(2csc(12π(α+k+2m))2F˜2(12(−k−α),12(−k−α+1);12,12(−k−2m−α+2);−mv2Ω)α+k−msec(12π(α+k+2m))2F˜2(12(−k−α+1),12(−k−α+2);32,12(−k−2m−α+3);−mv2Ω)vΩ)),

where v=1+γthγth.

3. Numerical Results

This section demonstrates the performance of the LIS for a multi-user system through simulations using the Monte Carlo method and analyzing the validity of the proposed approximations for various analysis scenarios in terms of the number of antennas at the LIS panel, the number of users in the system, the number of antennas at the base station, and the Von Mises parameter for the phase error distribution.

In this study, the SINR was simulated for each user using the parameters of each channel involved in the total link, being the Nakagami-m channels from the base station to the LIS, from the LIS to the user, and the complex normal direct channel from the base station to the user, which may be strong for near-field communications and weak for far-field communications. The SINR histograms were generated by the Monte Carlo method, simulating the resulting channel several times, and the contours of the histograms are shown close to the PDF of the Gamma distribution.

3.1. Probability Distribution

For 105 iterations of the Monte Carlo method, it is shown in Figure 2 that the probability density function of the SINR is close to the Gamma distribution.

Figure 2 shows a comparison between the exact Gamma distribution and the simulated PDF of the SINR via the Monte Carlo method for m=2,Ω=1,K=16 users, and M=2 for different values of the number of reflectors N.

It is possible to note that the SINR follows a gamma distribution for a wide variety of parameters in such a way that the analytical calculations of the moments and the statistical parameters of the SINR are valid for the formulas proposed for the probability of bit error and the secrecy outage probability.

3.2. Bit Error Probability

One possible way to demonstrate that the LIS can improve the SINR is by showing how the bit error probability varies, increasing the number of antennas at the base station, the number of reflecting elements, and the concentration parameter of the phase error distribution.

Figure 3 illustrates how the bit error probability decreases when the number of reflectors increases. This scenario has four users, eight transmitting antennas, the Nakagami parameter m=2, and the Von Mises κ=2. Notably, although the bit error probability is low, the values do not change significantly from N=32 to N=64 as much as from N=16 to N=32 reflectors. This may be because the channel already has LoS. Additionally, and beyond a certain number of reflectors, the SINR becomes optimal with the assistance of the LIS, which is something this type of analysis can help discover.

Figure 4 demonstrates that increasing the number of system users raises the bit error probability when keeping the number of LIS reflectors, base station antennas, and the Von Mises parameter constant. In this scenario, the transmission of 16-QAM signals was considered. One strategy to mitigate the increase of the error probability is to use many reflectors to enhance the LIS’s capacity to serve more users with higher SINR and, consequently, reduce the bit error probability.

For the scenario depicted in Figure 5, in which signals from the 4-QAM constellation are transmitted, the approximation of SINR by the gamma distribution continues to hold, and the bit error probability remains higher when the system accommodates more users.

When there is no line of sight as in Figure 6, where the scenario with SINR channels following a Rayleigh distribution (Nakagami with m=1) is analyzed, it is noticeable that the exact bit error probability continues to approximate the simulated bit error rate closely. In this case, a higher SINR was required compared to Figure 7 to reduce the bit error rate promoted by the LIS. In this simulation, the number of reflectors was kept constant. However, it is worth noting that one case deals with the 4-QAM constellation and the other with the 16-QAM constellation.

Regarding the Von Mises parameter, it is notable that the bit error probability decreases faster for larger values of κ, as observed in Figure 5. The worst-case scenario is when κ=0 and the error distribution is uniform. In this case, large and small phase errors have the same probability density and occur when the phase error has been poorly corrected.

If the phase error is concentrated around the mean (in this study, the mean phase error is zero), the PDF of the phase error approaches a delta function at the origin. In this case, the SINR will be higher because the sum of phasors will be greater if their phase is zero, and the complex exponential vanishes, leaving only the magnitudes.

3.3. Secrecy Outage Probability

To simulate the secrecy outage probability (SOP), the SINR corrected by the LIS was generated, and an additional eavesdropper channel with a Nakagami distribution with LoS access to the LIS signal was considered. This additional channel has a line of sight. The summation was truncated at index 100 to calculate the SOP, and the approximation closely matched the simulated SOP values via Monte Carlo. It was assumed that the Von Mises concentration parameter was κ=2, and the direct link had unity variance.

It can be observed in Figure 8, where an eavesdropper channel with m=2 and Ω=1 is considered, that the higher the number of reflectors, the lower the SOP will be. This demonstrates that the LIS contributes to the confidentiality of information.

4. Conclusions

This study shows that Mu-MIMO channels formed by links with Nakagami-m fading, when assisted by large intelligent surfaces, have an SINR with Gamma distribution and can considerably reduce their bit error probability by increasing the number of reflectors or the efficiency of the phase optimization algorithm (related to the κ parameter of the phase error distribution).

The worst case, considering the Nakagami-m fading channel, is the Rayleigh fading (for m=1); this study shows that Rayleigh channels can be converted to Gamma fading channels by applying the phase shift matrix of the LIS. It was also shown that creating a line of sight in scenarios where a LoS did not exist was possible. This study presented the probability distributions of SINR compared to the PDF of the Gamma distribution. It showed that the exact formula for the probability density is very close to the one generated by the histogram obtained from the channel simulation.

It was possible to show that the LIS can enable a low secrecy outage probability, even for a few reflecting units and low bit error probability values, when increasing the number of LIS elements or improving the quality of phase correction. Our study assumes complete knowledge of the channel state information. It considers phase errors due to the behavior of the reflecting panel when attempting to correct the phase of many signals simultaneously (and not being able to optimize this for all) or due to the influence of the superposition of electromagnetic signals.

Author Contributions

Conceptualization, R.C.F., G.F., F.A.P.d.F. and E.R.d.L.; Formal analysis, R.C.F., G.F., F.A.P.d.F. and E.R.d.L.; Writing—original draft, R.C.F., G.F., F.A.P.d.F. and E.R.d.L. All authors have read and agreed to the published version of the manuscript.

Institutional Review Board Statement

Not applicable.

Informed Consent Statement

Not applicable.

Data Availability Statement

Data are contained within the article.

Conflicts of Interest

The authors declare no conflicts of interest.

Appendix A. Statistical Parameters of Zk

Appendix A.1. Expected Value of Zk

The expected value of Zk will be (A1) EZk=PKE∑l=1Mrlk2,

since the expected value is a linear operator, then (A2) EZk=PK∑l=1MErlk2=PMKErlk2,

where the term Erlk2 must be calculated, but, first of all, the terms Eclk and Eslk are needed.

The expected value Eclk of the real part of rlk can be defined as (A3) Eclk=E∑p=1N∑q=1Nhlpgqkcosδpq+ℜ{h(d),kl},

since Eℜ{h(d),kl}=0 and the summation terms are independent and equally likely. Therefore, (A4) Eclk=N2EhlpEgqkEcosδpq=N2μhμgα1.

The moments of the fading channels are μh=Ehlp, ξh=Ehlp2, μq=Egqk, ξg=Egqk2, χh=E[hlp3], χg=E[gqk3], ϵh=E[hlp4], ϵg=E[gqk4], μℜ{h(d)}=Eℜ{h(d),kl}=0, ξℜ{h(d)}=Eℜ{h(d),kl}2, μℑ{h(d)}=Eℑ{h(d),kl}=0, and ξℑ{h(d)}=Eℑ{h(d),kl}2 and most of then will appear in the following equations.

The expected value Eslk of the imaginary part of rlk can be computed as (A5) Eslk=E∑p=1N∑q=1Nhlpgqksinδpq+ℑ{h(d),kl},

since Eℑ{h(d),kl}=0 and the summation terms are independent and equally likely, then (A6) Eslk=N2EhlpEgqkEsinδpq=N2μhμgβ1,

but the Von Mises variable δ has a PDF that is symmetric about zero, and the phase errors are zero mean, so ∀p.βp=Esinpδ=0, therefore (A7) Eslk=N2μhμgβ1=0.

The expected value Erlk2 of the magnitude of rlk can be obtained as (A8) Erlk2=Eclk2+Eslk2,

where (A9) Eclk2=E∑p=1N∑q=1Nhlpgqkcosδpq+ℜ{h(d),kl}2,

and (A10) Eslk2=E∑p=1N∑q=1Nhlpgqksinδpq+ℑ{h(d),kl}2,

by expanding the terms (A9), it follows that (A11) Eclk2=E∑p=1N∑q=1Nhlpgqkcosδpq+ℜ{h(d),kl}×…                 ∑b=1N∑e=1Nhlbgekcosδbe+ℜ{h(d),kl},

that can be rewritten as (A12) Eclk2=E∑p=1N∑q=1N∑p=1N∑q=1Nhlpgqkcosδpqhlpgqkcosδpq+Eℜ{h(d),kl}2+…             Eℜ{h(d),kl}∑p=1N∑q=1Nhlpgqkcosδpq+Eℜ{h(d),kl}∑b=1N∑e=1Nhlbgekcosδbe,

and since (A13) Eℜ{h(d),kl}∑p=1N∑q=1Nhlpgqkcosδpq=Eℜ{h(d),kl}∑b=1N∑e=1Nhlbgekcosδbe,

and the expected value is a linear operator, so (A14) Eclk2=∑p=1N∑q=1N∑b=1N∑e=1NEhlpgqkhlbgekcosδpqcosδbe+Eℜ{h(d),kl}2+…                          2Eℜ{h(d),kl}∑b=1N∑e=1NEhlbgekcosδbe,

by separating the independent coefficients, it follows that (A15) Eclk2=∑p=1N∑q=1N∑b=1N∑e=1NEhlphlbEgqkgekEcosδpqcosδbe+Eℜ{h(d),kl}2+                        2Eℜ{h(d),kl}∑b=1N∑e=1NEhlbEgekEcosδbe.

To compute Eclk2, four situations must be considered: N2 times the event p=b and q=e will occur in the summation, N2(N−1) times the event p=b and q≠e will occur, N2(N−1)2 times p≠b and q≠e, and N2(N−1) times p≠b and q=e, then (A16) E∑p=1N∑q=1Nhlpgqkcosδpq+ℜ{h(d),kl}2=N2(N−1)2Egqk2Ecosδpq2    +N2Ehlp2Egqk2Ecos2δpq+N2(N−1)Ehlp2Egqk2Ecosδpq2      +N2(N−1)Ehlp2Ehlp2Egqk2Ecosδpq2+                    Eℜ{h(d),kl}2+2Eℜ{h(d),kl}∑b=1N∑e=1NEhlbEgekEcosδbe.

Therefore, (A17) Eclk2=N22ξhξg(1+α2)+N2(N−1)ξhμq2α12+N2(N−1)μh2ξgα12+                N2(N−1)2μh2μq2α12+2N2μℜ{h(d)}μhμqα1+ξℜ{h(d)}.

The expected value Eslk2 of the squared magnitude of slk can be calculated as (A18) Eslk2=E∑p=1N∑q=1Nhlpgqksinδpq+ℑ{h(d),kl}2,

that can be rewritten as (A19) Eslk2=E∑p=1N∑q=1N∑b=1N∑e=1Nhlpgqksinδpqhlbgeksinδbe+Eℑ{h(d),kl}2+                Eℑ{h(d),kl}∑p=1N∑q=1Nhlpgqksinδpq+Eℑ{h(d),kl}∑b=1N∑e=1Nhlbgeksinδbe.

After expanding and simplifying the terms, it follows that (A20) Eslk2=∑p=1N∑q=1N∑b=1N∑e=1NEhlphlbEgqkgekEsinδpqsinδbe+Eℑ{h(d),kl}2+                         2Eℑ{h(d),kl}∑b=1N∑e=1NEhlbEgekEsinδbe,

that can be simplified to (A21) Eslk2=N22ξhξg(1−α2)+N2(N−1)ξhμq2β12+N2(N−1)μh2ξgβ12+             N2(N−1)2μh2μq2β12+2N2μℑ{h(d)}μhμqβ1+ξℑ{h(d)},

and, since β1=0, therefore, (A22) Eslk2=N22ξhξg(1−α2)+ξℑ{h(d)}.

To compute the expected value EZk substituting (A8) in (A2), then (A23) EZk=PMKEclk2+Eslk2.

After substituting (A17) and (A22) in (A23), it follows that (A24) μZk=EZk=PMKN22ξhξg(1+α2)+N2(N−1)ξhμq2α12+N2(N−1)μh2ξgα12+           N2(N−1)2μh2μq2α12+2N2μℜ{h(d)}μhμqα1+ξℜ{h(d)}+N22ξhξg(1−α2)+ξℑ{h(d)}.

Appendix A.2. Variance of Zk

To compute the variance of Zk, we consider that (A25) σZk2=varZk=varPK∑l=1Mrlk2,

in terms of the real and imaginary parts, the equation can be rewritten as (A26) σZk2=PK2var∑l=1Mclk2+∑l=1Mslk2,

since the variance of the sum of random variables can be computed in terms their covariances, then (A27) σZk2=PK2varCk+varSk+2covCk,Sk,

where (A28) varCk=var∑l=1Mclk2=M(M−1)covclk,cik+Mvarclk,

(A29) varSk=var∑l=1Mslk2=M(M−1)covslk,sik+Mvarslk,

and (A30) covCk,Sk=ECkSk−ECkESk.

To compute the previous variances, the covariances covclk,cik and covslk,sik are needed; we consider that (A31) covclk,cik=Eclkcik−EclkEcik→covclk,cik=Eclkcik−Eclk2

and (A32) covslk,sik=Eslksik−EslkEsik→covslk,sik=Eslksik−Eslk2,

since the expected value ECkSk can be obtained as (A33) ECkSk=E∑l=1M∑p=1N∑q=1Nhlpgqkcosδpq+ℜ{h(d),kl}2×…               ∑l=1M∑p=1N∑q=1Nhlpgqksinδpq+ℑ{h(d),kl}2,

thus (A34) Eclkcik=E∑p=1N∑q=1Nhlpgqkcosδpq+ℜ{h(d),kl}×…               ∑p=1N∑q=1Nhipgqkcosδpq+ℜ{h(d),ki}.

To compute the expected value Eclkcik, it is needed to change the summation indexes as (A35) Eclkcik=E∑p1=1N∑q1=1Nhlp1gq1kcosδp1q1+ℜ{h(d),kl}×…               ∑p2=1N∑q2=1Nhip2gq2kcosδp2q2+ℜ{h(d),ki}.

After applying the product and considering the independent indexes, it follows that (A36) Eclkcik=E∑p1=1N∑q1=1N∑p2=1N∑q2=1Nhlp1hip2gq1kgq2kcosδp1q1cosδp2q2+       Eℜ{h(d),ki}∑p1=1N∑q1=1Nhlp1gq1kcosδp1q1+Eℜ{h(d),kl}∑p2=1N∑q2=1Nhip2gq2kcosδp2q2+Eℜ{h(d),kl}ℜ{h(d),ki},

by expanding the previous equations, then (A37) Eclkcik=∑p1=1N∑q1=1N∑p2=1N∑q2=1NEhlp1hip2Egq1kgq2kEcosδp1q1cosδp2q2+Eℜ{h(d),ki}∑p1=1N∑q1=1NEhlp1Egq1kEcosδp1q1+Eℜ{h(d),kl}∑p2=1N∑q2=1NEhip2Egq2kEcosδp2q2+Eℜ{h(d),kl}ℜ{h(d),ki}.

Assuming that l≠i (A38) Eclkcik=2N2×μℜ{h(d)}μhμqα1+μℜ{h(d)}2+N2(N−1)Ehlp12Egq1k2Ecosδp1q12+N2(N−1)Ehlp12Egq1k2Ecosδp1q12+N2(N−1)2Ehlp12Egq1k2Ecosδp1q12+N2Ehlp12Egq1k2Ecosδp1q12,∀l≠i,

which can be simplified to (A39) Eclkcik=N22ξhξg1+α2+N2(N−1)ξhμq2α12+N2(N−1)ξhξgα12+N2(N−1)2ξhμq2α12+2N2×μℜ{h(d)}μhμqα1+μℜ{h(d)}2,∀l≠i.

The term Eslksik, assuming that l≠i, can be computed as follows:(A40) Eslksik=E∑p=1N∑q=1Nhlpgqksinδpq+ℑ{h(d),kl}×…                ∑p=1N∑q=1Nhipgqksinδpq+ℑ{h(d),ki},

by expanding the previous equation, then (A41) Eslksik=E∑p1=1N∑q1=1N∑p2=1N∑q2=1Nhlp1hip2gq1kgq2ksinδp1q1sinδp2q2+       Eℑ{h(d),ki}∑p1=1N∑q1=1Nhlp1gq1ksinδp1q1+Eℑ{h(d),kl}∑p2=1N∑q2=1Nhip2gq2ksinδp2q2+Eℑ{h(d),kl}ℑ{h(d),ki},

and can be rewritten as (A42) Eslksik=∑p1=1N∑q1=1N∑p2=1N∑q2=1NEhlp1hip2Egq1kgq2kEsinδp1q1sinδp2q2+Eℑ{h(d),ki}∑p1=1N∑q1=1NEhlp1Egq1kEsinδp1q1+Eℑ{h(d),kl}∑p2=1N∑q2=1NEhip2Egq2kEsinδp2q2+Eℑ{h(d),kl}ℑ{h(d),ki},

by substituting the statistical moments of the random variables, it follows that (A43) Eslksik=N2Ehlp12Egq1k2Esinδp1q12+N2(N−1)Ehlp12Egq1k2Esinδp1q12+N2(N−1)Ehlp12Egq1k2Esinδp1q12+N2(N−1)2Ehlp12Egq1k2Esinδp1q12+2N2×μℑ{h(d)}μhμqβ1+μℑ{h(d)}2,forl≠i,

that can be simplified to (A44) Eslksik=N22ξhξg1−α2+N2(N−1)ξhμq2β12+N2(N−1)ξhξgβ12+N2(N−1)2ξhμq2β12+                    2N2×μℑ{h(d)}μhμqβ1+μℑ{h(d)}2,forl≠i,

since β1=0, therefore (A45) Eslksik=N22ξhξg1−α2+μℑ{h(d)}2,forl≠i.

The covariance covclk,cik can be computed as (A46) covclk,cik=Eclkcik−Eclk2,

then (A47) covclk,cik=N22ξhξg1+α2+N2(N−1)ξhμq2α12+N2(N−1)ξhξgα12+       N2(N−1)2ξhμq2α12+2N2μℜ{h(d)}μhμqα1+μℜ{h(d)}2−N4μh2μg2α12,

and covariance covslk,sik can be calculated as (A48) covslk,sik=Eslksik=N22ξhξg1−α2+μℑ{h(d)}2.

The variances varclk and varslk can be computed as (A49) varclk=Eclk2−Eclk2,

that can be rewritten as (A50) varclk=N22ξhξg(1+α2)+N2(N−1)ξhμq2α12+N2(N−1)μh2ξgα12+       N2(N−1)2μh2μq2α12+2N2μℜ{h(d)}μhμqα1+ξℜ{h(d)}−N4μh2μg2α12,

since (A51) varslk=Eslk2−Eslk2=Eslk2,

then (A52) varslk=N22ξhξg(1−α2)+ξℑ{h(d)}.

The variance varCk can be calculated by (A53) σCk2=varCk=M(M−1)N22ξhξg1+α2+N2(N−1)ξhμq2α12+       N2(N−1)ξhξgα12+N2(N−1)2ξhμq2α12+2N2μℜ{h(d)}μhμqα1+μℜ{h(d)}2−N4μh2μg2α12+         MN22ξhξg(1+α2)+N2(N−1)ξhμq2α12+N2(N−1)μh2ξgα12+                    N2(N−1)2μh2μq2α12+2N2μℜ{h(d)}μhμqα1+ξℜ{h(d)}−N4μh2μg2α12.

The variance varSk can be defined as (A54) σSk2=varSk=M(M−1)N22ξhξg1−α2+μℑ{h(d)}2+                    MN22ξhξg(1−α2)+ξℑ{h(d)},

and the correlation ECkSk is (A55) ECkSk=E∑l=1M∑p=1N∑q=1Nhlpgqkcosδpq+ℜ{h(d),kl}2×…                    ∑l=1M∑p=1N∑q=1Nhlpgqksinδpq+ℑ{h(d),kl}2.

The term ECkSk can be calculated as (A56) ECkSk=E∑l1=1Msl1k2∑l2=1Mcl2k2=∑l=1M∑l2=1MEsl1k2cl2k2,

the term Esl1k2cl2k2 can be computed as (A57) Esl1k2cl2k2=E∑p1=1N∑p2=1N∑q1=1N∑q2=1Nhl1p1hl1p2gq1kgq2ksinδp1q1sinδp2q2+ℑ{h(d),kl1}2+2ℑ{h(d),kl1}∑p1=1N∑q1=1Nhl1p1gq1ksinδp1q1×∑p3=1N∑p4=1N∑q3=1N∑q4=1Nhl2p3hl2p4gq3kgq4kcosδp3q3cosδp4q4+ℜ{h(d),kl2}2+2ℜ{h(d),kl2}∑p3=1N∑q3=1Nhl2p3gq3kcosδp3q3,

then, μCkSk will be given by (A58). (A58) μCkSk=M(M−1)(N−1)4b10b18+N2b14b17b29α12+Nb14b27μgχgb28+Nb12b27μgχgb28+2b12b27ϵgb28+b12μhb23χhb28+4b8μh2ξhχgμgb28+2N2(N−1)μh2ξhϵgb28+b12b17b28+b8b23ξh2b28+N2(N−1)b23ξh2b28+N2(N−1)μgξh2χgb28+N2ξh2ϵgb28+(N−1)N2ξℜ{h(d)}b25b29+N2ξℜ{h(d)}ξhξgb29+N2((N−1)ξℑ{h(d)}b25α12+ξhξgb1)+ξℜ{h(d)}+b8ξℑ{h(d)}b24+N2(N−1)ξℑ{h(d)}μh2ξgα12+2ξℜ{h(d)}+M(N−1)4b10b18+N2b14b17b29α12+Nb14b27μgχgb28+N2b14b27μgχgb28+2b12b27ϵgb28+b12b27μgχgb28+b12μhb23χhb28+2N2(N−1)μhχhϵgb28+b12μg2χhμhξgb28+4b8μgχhμhχgb28+b8b23ϵhb28+N2(N−1)b23ϵhb28+N2(N−1)μgϵhχgb28+N2ϵhϵgb28+(N−1)N2ξℜ{h(d)}ξhμg2b29+ξℜ{h(d)}N2ξhξgb29+N2ξℑ{h(d)}((N−1)b25α12+ξhξgb1)+ξℜ{h(d)}+b8ξℑ{h(d)}b24+N2(N−1)ξℑ{h(d)}μh2ξgα12+2ξℜ{h(d)}.

The terms bi can be computed as b1=12(1+α2), b2=183+4α2+α4, b3=α12(1+α2), b4=14(3α1+α3)α1, b5=b1α12, b6=N2b5, b7=(N2−1)N2α14, b8=(N−1)2N2, b9=N(N−1)2, b10=(N−1)N2α14, b11=N(N−1)3, b12=N2(N−1)3, b13=(N−1)3, b14=(N−1)4, b15=μg4b1α12, b16=μhχhμg4, b17=μh2ξhξgμg2, b18=μh2ξhμg4, b19=μh4ξgμg2, b20=μh4μg4b10, b21=μhχhξg, b22=μhχhξg2, b23=ξgμg2, b24=μg2μh2α12, b25=ξhμg2, b26=μg2b1α12, b27=ξhμh2, b28=α121−α22, b29=1−α22.

Given μCkSk, it follows that (A59) covCk,Sk=μCkSk−μCkμSk,

therefore, the variance will be (A60) σZk2=PK2σCk2+σSk2+2μCkSk−μCkμSk.

Appendix B. Statistical Parameters of Fk

Appendix B.1. Expected Value of Fk

Since (A61) Fk=ση2+∑i=0,i≠kKZi,

then, the expected value of Fk can be calculated as (A62) EFk=ση2+E∑i=0,i≠kKZi=ση2+(K−1)EZi,

since the expected value of Zk was previously computed, therefore (A63) EFk=ση2+(K−1)PMKN22ξhξg(1+α2)+N2(N−1)ξhμq2α12+N2(N−1)μh2ξgα12+                    N2(N−1)2μh2μq2α12+2N2μℜ{h(d)}μhμqα1+ξℜ{h(d)}+N22ξhξg(1−α2)+ξℑ{h(d)}.

Appendix B.2. Variance of Fk

The variance varFk can be defined in terms of the statistics of Zi as (A64) σFk2=varFk=varση2+∑i=0,i≠kKZi=var∑i=0,i≠kKZi,

since the terms are independent and equally likely, then (A65) varFk=K(K−1)covZi,Zt+KvarZi,

considering that (A66) covZi,Zt=E[ZiZt]−E[Zi]2

where (A67) E[ZiZt]=PK2ERiRt,

that can be rewritten as (A68) E[ZiZt]=PK2E(Ci+Si)(Ct+St),

by expanding the product, it follows that (A69) E[ZiZt]=PK2E(CiCt+SiSt+CiSt+SiCt),

since ECiSt=ESiCt, then (A70) E(CiCt+SiSt+CiSt+SiCt)=ECiCt+ESiSt+2ESiCt.

For i≠t (A71) ECiCt=E∑l1=1Mcl1i2∑l2=1Mcl2t2=∑l1=1M∑l2=1MEcl1i2cl2t2,

by expanding the terms, it follows that (A72) E[cl1i2cl2t2]=E∑p1=1N∑p2=1N∑q1=1N∑q2=1Nhl1p1hl1p2gq1igq2icosδp1q1cosδp2q2+ℜ{h(d),il1}2+2ℜ{h(d),il1}∑p1=1N∑q1=1Nhl1p1gq1icosδp1q1×∑p3=1N∑p4=1N∑q3=1N∑q4=1Nhl2p3hl2p4gq3tgq4tcosδp3q3cosδp4q4+ℜ{h(d),tl2}2+2ℜ{h(d),tl2}∑p3=1N∑q3=1Nhl2p3gq3tcosδp3q3.

By expanding the terms of E[cl1i2cl2t2], the expected value can be rewritten as (A73). (A73) E[cl1i2cl2t2]=∑p1=1N∑p2=1N∑p3=1N∑p4=1N∑q1=1N∑q2=1N∑q3=1N∑q4=1NEhl1p1hl1p2hl2p3hl2p4×Egq1igq2igq3tgq4tEcosδp1q1cosδp2q2cosδp3q3cosδp4q4+ξℜ{h(d)}∑p1=1N∑p2=1N∑q1=1N∑q2=1NEhl1p1hl1p2Egq1igq2iEcosδp1q1cosδp2q2+ξℜ{h(d)}∑p3=1N∑p4=1N∑q3=1N∑q4=1NEhl2p3hl2p4gq3tgq4tcosδp3q3cosδp4q4+Eℜ{h(d),il1}2ℜ{h(d),tl2}2+2Eℜ{h(d),il1}2ℜ{h(d),tl2}∑p3=1N∑q3=1NEhl2p3Egq3tα1+2Eℜ{h(d),tl2}2ℜ{h(d),il1}∑p1=1N∑q1=1NEhl1p1Egq1iα1+4Eℜ{h(d),il1}ℜ{h(d),tl2}∑p1=1N∑q1=1N∑p3=1N∑q3=1NEhl1p1hl2p3Egq1igq3tEcosδp1q1cosδp3q3

Through the recursive expansion of the expression and analyzing the varying scenarios where the variables might be interdependent or independent, based on their index values, it can be inferred that, for l1≠l2, the expected value E[cl1i2cl2t2] will be given by (A74). For l1=l2, it can be calculated by (A75). (A74) E[cl1i2cl2t2]=b8ξℜ{h(d)}b24+Nb9ξℜ{h(d)}(b24+b25α12+2μh2ξg)+b14N2b17α4+b14b20ξℜh(d)2N2ξℜ{h(d)}(2ξgξhb1+b25α12)(N−1)5b20+b14b18b10+b14b18b10+b13b16b10+b14b18b10+b14b19b10+b14N2b17b5+b13b19b10+b13b17b10+b12b21μg2b5+b13b18b10+b14N2b18b5+(N−1)2b17b10+b12b16b5+b13b27μg4b10+b13b19b10+b12b17b5+b12b17b5+b8b21μg2b4+(N−1)2b17b10+b14b20+b13b18b10+b13b10b18+(N−1)2b16b10+b14N2b18b5+b12b17b1+(N−1)2b17b10+b8b21μg2b5+b12b17b5+b13b19b10+b12b17b5+b8μhχhb23b5+b12b17b5+(N−1)2μh4ξg2b10+b8b27ξg2b5+(N−1)N2b22b4+b8b27ξg2b5+b8b27ξg2b5+(N−1)4Nμhχhμg4α14+b11μhχhb23b1α12+b11μhχhμg4α14+b9b21b26+b11b21b26+b9b21μg2b4+b9b21b26+N(N−1)b22b4+(N−1)4Nb16α14+b11μhχhb15+b11μhχhb15+b9b21μg2b4+b11b21μg2α14+2b9b21b26+(N−1)Nb22b4+b11ϵhμg4α14+2b9ϵhb15+N(N−1)ϵhb23b4+b9ϵhb23b1α12+2N(N−1)ϵhb23b4+Nϵhξg2b2,l1=l2

(A75) E[cl1i2cl2t2]=b8ξℜ{h(d)}b24+Nb9ξℜ{h(d)}b24+(N−1)N2ξℜ{h(d)}(b25α12+2μh2ξg)+N2ξℜ{h(d)}(2ξgξhb1+b25α12)+ξℜh(d)2+Nb14μg4μh4(N2−1)N2b12+N2b2+b11μg4b27b8α13+N2(N−1)b3+N2b4+b11b27μg4N212(N2−1)b3+2b4+b9ξh2μg4N2α12(N−1)2α12+(N−1)α12+b1+b9b17b8b5+2(N−1)b6+N2b4+b9b17b8α14+2b10+b6+b11μh4ξgμg2b6(N2−1)+N2b4+b11ξgμg2μh4(N2−1)b6+N2b4+b9b17b7+b6+b9b17b8b5+2(N−1)b6+N2b4+N(N−1)ξgξh2μg2b7+b6+N(N−1)ξh2μg2ξgb7+b6+b9μh4ξg2b7+b6+N(N−1)ξg2b27b8α14+2b10+b6+N(N−1)b27ξg2b7+b6+Nξg2ξh2b7+b6,∀l1≠l2.

Therefore, ECiCt can be calculated by (A76). (A76) μCiCt=ECiCt=M(M−1)Nb9ξℜ{h(d)}b24+(N−1)N2ξℜ{h(d)}(b25α12+2μh2ξg)+b8ξℜ{h(d)}b24+N2ξℜ{h(d)}(2ξgξhb1+b25α12)+ξℜh(d)2+Nb14μg4μh4(N2−1)N2b12+N2b2+b11μg4b27b8α13+N2(N−1)b3+N2b4+b11b27μg4N212(N2−1)b3+2b4+b9ξh2μg4N2α12(N−1)2α12+(N−1)α12+b1+b9b17b8b5+2(N−1)b6+N2b4+b9b17b8α14+2b10+b6+b11μh4ξgμg2b6(N2−1)+N2b4+b11ξgμg2μh4(N2−1)b6+N2b4+b9b17b7+b6+b9b17b8b5+2(N−1)b6+N2b4+N(N−1)ξgξh2μg2b7+b6+N(N−1)ξh2μg2ξgb7+b6+b9μh4ξg2b7+b6+N(N−1)ξg2b27b8α14+2b10+b6+N(N−1)b27ξg2b7+b6+Nξg2ξh2b7+b6+Mb8ξℜ{h(d)}b24+Nb9ξℜ{h(d)}(b24+b25α12+2μh2ξg)+N2ξℜ{h(d)}(2ξgξhb1+b25α12)+ξℜh(d)2+(N−1)5b20+b14b18b10+b14b18b10+b13b16b10+b14b18b10+b14b19b10+b14N2b17b5+b14N2b17α4+b14b20b13b19b10+b13b17b10+b12b21μg2b5+b13b18b10+b14N2b18b5+(N−1)2b17b10+b12b16b5+b13b27μg4b10+b13b19b10+b12b17b5+b12b17b5+b8b21μg2b4+(N−1)2b17b10+b14b20+b13b18b10+b13b10b18+(N−1)2b16b10+b14N2b18b5+b12b17b1+(N−1)2b17b10+b8b21μg2b5+b12b17b5+b13b19b10+b12b17b5+b8μhχhb23b5+b12b17b5+(N−1)2μh4ξg2b10+b8b27ξg2b5+(N−1)N2b22b4+b8b27ξg2b5+b8b27ξg2b5+(N−1)4Nμhχhμg4α14+b11μhχhb23b1α12+b11μhχhμg4α14+b9b21b26+b11b21b26+b9b21μg2b4+b9b21b26+(N−1)Nb22b4+(N−1)4Nb16α14+b11μhχhb15+b11μhχhb15+b9b21μg2b4+b11b21μg2α14+2b9b21b26+(N−1)Nb22b4+b11ϵhμg4α14+b9ϵhb15+b9ϵhb15+N(N−1)ϵhb23b4+b9ϵhb23b1α12+2N(N−1)ϵhb23b4+Nϵhξg2b2

The expected value ESiSt, for i≠t (A77) ESiSt=E∑l1=1Msl1i2∑l2=1Msl2t2=∑l1=1M∑l2=1MEsl1i2sl2t2,

where the expected value Esl1i2sl2t2 can be calculated as (A78) Esl1i2sl2t2=E∑p1=1N∑p2=1N∑q1=1N∑q2=1Nhl1p1hl1p2gq1igq2isinδp1q1sinδp2q2+ℑ{h(d),il1}2+2ℑ{h(d),il1}∑p1=1N∑q1=1Nhl1p1gq1isinδp1q1×∑p3=1N∑p4=1N∑q3=1N∑q4=1Nhl2p3hl2p4gq3tgq4tsinδp3q3sinδp4q4+ℑ{h(d),tl2}2+2ℑ{h(d),tl2}∑p3=1N∑q3=1Nhl2p3gq3tsinδp3q3,

by expanding this equation and removing the null terms, then Esl1i2sl2t2 can be obtained by (A79). (A79) Esl1i2sl2t2=∑p1=1N∑p2=1N∑p3=1N∑p4=1N∑q1=1N∑q2=1N∑q3=1N∑q4=1NEhl1p1hl1p2hl2p3hl2p4×Egq1igq2iEgq3tgq4tEsinδp1q1sinδp2q2sinδp3q3sinδp4q4+ξℑ{h(d)}∑p1=1N∑p2=1N∑q1=1N∑q2=1NEhl1p1hl1p2Egq1igq2iEsinδp1q1sinδp2q2+ξℑ{h(d)}∑p3=1N∑p4=1N∑q3=1N∑q4=1NEhl2p3hl2p4Egq3tgq4tEsinδp3q3sinδp4q4+Eℑ{h(d),il1}2Eℑ{h(d),tl2}2

by expanding the terms, it is easy to note that many expressions are equal to zero because of the expected value of the sine of a zero mean Von Mises random variable. The fourth-order trigonometric moment of the phase is Esin4δ=1−2b1+b2, since sin4δ=(1−cos2δ)2=1−2cosδcos4δ, therefore (A80) Esl1i2sl2t2=N2ξh2ξg2(1−2b1+b2)+2N2ξℑ{h(d)}ξhξgb29+ξℑ{h(d)}2,∀l1≠l2,

(A81) Esl1i2sl2t2=N2ϵhϵg(1−2b1+b2)+2N2ξℑ{h(d)}ξhξgb29+ξℑ{h(d)}2,∀l1=l2,

(A82) μSiSt=E[SiSt]=M(M−1)N2ξh2ξg2(1−2b1+b2)+2N2ξℑ{h(d)}ξhξgb29+ξℑ{h(d)}2+                MN2ϵhϵg(1−2b1+b2)+2N2ξℑ{h(d)}ξhξgb29.

The expected value ESiCt, considering that i≠t, can be computed as (A83) ESiCt=E∑l1=1Msl1i2∑l2=1Mcl2t2=∑l1=1M∑l2=1MEsl1i2cl2t2,

where Esl1i2cl2t2 can be defined as (A84) Esl1i2cl2t2=E∑p1=1N∑p2=1N∑q1=1N∑q2=1Nhl1p1hl1p2gq1igq2isinδp1q1sinδp2q2+ℑ{h(d),il1}2+2ℑ{h(d),il1}∑p1=1N∑q1=1Nhl1p1gq1isinδp1q1×∑p3=1N∑p4=1N∑q3=1N∑q4=1Nhl2p3hl2p4gq3tgq4tcosδp3q3cosδp4q4+ℜ{h(d),tl2}2+2ℜ{h(d),tl2}∑p3=1N∑q3=1Nhl2p3gq3tcosδp3q3,

by expanding and removing the null terms, then Esl1i2cl2t2 can be calculated by (A85). (A85) Esl1i2cl2t2=∑p1=1N∑p3=1N∑p4=1N∑q1=1N∑q2=1N∑q3=1N∑q4=1NEhl1p1hl1p1hl2p3hl2p4×Egq1igq2igq3tgq4tEcosδp3q3cosδp4q4Esinδp1q1sinδp1q2+ξℜ{h(d)}∑p1=1N∑q1=1N∑q2=1NEhl1p1hl1p1Egq1igq2iEsinδp1q1sinδp1q2+ξℑ{h(d)}∑p3=1N∑q3=1N∑q4=1NEhl2p3hl2p3Egq3tgq4tEcosδp3q3cosδp3q4+ξℜ{h(d)}+(N−1)ξℑ{h(d)}∑p3=1N∑q3=1N∑q4=1Nμh2Egq3tgq4tα12+ξℜ{h(d)}

by expanding the summations and evaluating the expected values recursively, it follows that, for i≠t, (A86) Esl1i2cl2t2=b12b27μg2ξgb28+N2b14b17b29α12+N2b14b27μg2ξgb28+Nb14b27μg2ξgb28+b12b27ξg2b28+(N−1)4b10b18+b12b27ξg2b28+b12b27b23b28+4b8b17b28+N2(N−1)ξg2b27b28+b12b17b28+N2(N−1)ξg2b27b28+b8b23ξh2b28(b8+N2(N−1))+N2(N−1)μg2ξgξh2b28+N2ξh2ξg2b28+(N−1)N2ξℜ{h(d)}ξhμg2b29+N2ξℜ{h(d)}ξh2b29+ξℑ{h(d)}N2((N−1)b25α12+ξhξgb1)+ξℜ{h(d)}+b8ξℑ{h(d)}b24+N2(N−1)ξℑ{h(d)}μh2ξgα12+2ξℜ{h(d)},∀l1≠l2,

and Esl1i2cl1t2 can be obtained by (A87). (A87) Esl1i2cl1t2=(N−1)4b10b18+N2b14b17b29α12+Nb14b27μg2ξgb28+N2b14b27μg2ξgb28+b12b27ξg2b28+b12b27μg2ξgb28+b12b27ξg2b28+b12μh2ξhb23b28+b8μh2ξhμg2ξgb28+b8χhμhξgμg2b28+N2(N−1)μhχhξg2b28+b12μg2χhμhξgb28+2b8μg2ξgχhμhb28+N2(N−1)χhμhξg2b28+b8b23ϵhb28+N2(N−1)b23ϵhb28+N2(N−1)μg2ξgϵhb28+N2Eχhξg2b28+(N−1)N2ξℜ{h(d)}ξhμg2b29+ξℜ{h(d)}N2ξhξgb29+ξℑ{h(d)}N2((N−1)b25α12+ξhξgb1)+ξℜ{h(d)}+N2(N−1)ξℑ{h(d)}μh2ξgα12+b8ξℑ{h(d)}b24+2ξℜ{h(d)},∀i≠t,l1=l2.

Therefore, the term ESiCt is given by (A88). (A88) μSiCt=ESiCt=M(M−1)(N−1)4b10b18+N2b14b17b29α12+Nb14b27μg2ξgb28+2ξℜ{h(d)}+N2b14b27μg2ξgb28+b12b27ξg2b28+b12b27μg2ξgb28+b12b27ξg2b28+b12b27b23b28+4b8b17b28+N2(N−1)ξg2b27b28+b12b17b28+N2(N−1)ξg2b27b28+b8b23ξh2b28(b8+N2(N−1))+N2(N−1)μg2ξgξh2b28+N2ξh2ξg2b28+(N−1)N2ξℜ{h(d)}ξhμg2b29+ξℜ{h(d)}N2ξh2b29+ξℑ{h(d)}N2((N−1)b25α12+ξhξgb1)+ξℜ{h(d)}+b8ξℑ{h(d)}b24+N2(N−1)ξℑ{h(d)}μh2ξgα12+M(N−1)4b10b18+N2b14b17b29α12+Nb14b27μg2ξgb28+N2b14b27μg2ξgb28+b12b27ξg2b28+b12b27b28(μg2ξg+ξg2)+b12μh2ξhb23b28+b8μh2ξhμg2ξgb28+b8χhμhξgμg2b28+N2Eχhξg2b28+N2(N−1)μhχhξg2b28+b12μg2χhμhξgb28+2b8μg2ξgχhμhb28+ξℜ{h(d)}b8ξℑ{h(d)}b24+N2(N−1)χhμhξg2b28+b8b23ϵhb28+N2(N−1)b23ϵhb28+N2(N−1)μg2ξgϵhb28+2ξℜ{h(d)}+(N−1)N2ξℜ{h(d)}ξhμg2b29+ξℜ{h(d)}N2ξhξgb29+ξℑ{h(d)}N2((N−1)b25α12+ξhξgb1)+N2(N−1)ξℑ{h(d)}μh2ξgα12.

Since (A89) E[ZiZt]=PK2μCiCt+μSiSt+2μSiCt,

it follows that (A90) covZi,Zt=PK2μCiCt+μSiSt+2μSiCt−μZk2.

Therefore, (A91) σFk2=K(K−1)PK2μCiCt+μSiSt+2μSiCt−μZk2+KσZk2.

Appendix C. Statistical Parameters of γk

Appendix C.1. Expected Value of γk

The expected value of γk, considering the gamma distribution in (A92) μγk=Eγk=μZkμFk,

since μZk and μFk are already known, can be computed using the derived expressions.

Appendix C.2. Variance of γk

The variance of γk can be computed considering the moments of Fk and Zk as (A93) σγk2=μZkμFk2σZk2μZk2−2(K−1)cov(Zi,Zk)μZkμFk+σFk2μFk2,

since μZk, μFk, σZk2, σFk2 and cov(Zi,Zk) were previously derived, these parameters can be substituted here.

Figure 1 System model with an eavesdropper link.

Figure 2 Probability distribution function via Monte Carlo.

Figure 3 Error probability varying with N.

Figure 4 Error probability for m=2, 16-QAM.

Figure 5 Error probability for different κ values.

Figure 6 Error probability for m=1 (Rayleigh), 16-QAM.

Figure 7 Error probability for m=2, 4-QAM.

Figure 8 Secrecy Outage Probability.

Disclaimer/Publisher’s Note: The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.
==== Refs
References

1. Zhang Z. Dai L. Reconfigurable Intelligent Surfaces for 6G: Nine Fundamental Issues and One Critical Problem Tsinghua Sci. Technol. 2023 28 929 939 10.26599/TST.2023.9010001
2. Almekhlafi M. Arfaoui M.A. Assi C. Ghrayeb A. A Low Complexity Passive Beamforming Design for Reconfigurable Intelligent Surface (RIS) in 6G Networks IEEE Trans. Veh. Technol. 2023 72 6309 6321 10.1109/TVT.2022.3233469
3. Dang S. Amin O. Shihada B. Alouini M.-S. What should 6G be? Nat. Electron. 2020 3 20 29 10.1038/s41928-019-0355-6
4. Pan C. Ren H. Wang K. Kolb J.F. Elkashlan M. Chen M. Di Renzo M. Hao Y. Wang J. Swindlehurst A.L. Reconfigurable intelligent surfaces for 6G systems: Principles, applications, and research directions IEEE Commun. Mag. 2021 59 14 20 10.1109/MCOM.001.2001076
5. Akyildiz I.F. Kak A. Nie S. 6G and beyond: The future of wireless communications systems IEEE Access 2020 8 133995 134030 10.1109/ACCESS.2020.3010896
6. Pereira de Figueiredo F.A. Mendes Lemes D.A. Ferreira Dias C. Fraidenraich G. Massive MIMO channel estimation considering pilot contamination and spatially correlated channels Electron. Lett. 2020 56 410 413 10.1049/el.2019.3899
7. Inserra D. Li G. Dai J. Shi J. Wen G. Li J. Huang Y. Dual-orthogonal polarization amplifying reconfigurable intelligent surface with reflection amplifier based on passive circulator IEEE Trans. Microw. Theory Technol. 2024 1 1 12 10.1109/TMTT.2023.3344783
8. Rana B. Cho S.-S. Hong I.-P. Review paper on hardware of reconfigurable intelligent surfaces IEEE Access 2023 11 29614 29634 10.1109/ACCESS.2023.3261547
9. Chen K. Song W. Li Z. Wang Z. Ma J. Wang X. Sun T. Guo Q. Shi Y. Qin W.-D. Chalcogenide phase-change material advances programmable terahertz metamaterials: A non-volatile perspective for reconfigurable intelligent surfaces Nanophotonics 2024 12 399 412 10.1515/nanoph-2022-0602
10. Li X. Sato H. Fujikake H. Chen Q. Development of Two-dimensional Steerable Reflectarray with Liquid Crystal for Reconfigurable Intelligent Surface Application IEEE Trans. Antennas Propag. 2024 72 2108 2123 10.1109/TAP.2024.3354054
11. Tataria H. Tufvesson F. Edfors O. Real-time implementation aspects of large intelligent surfaces Proceedings of the ICASSP 2020—2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP) Barcelona, Spain 4–8 May 2020 9170 9174 10.1109/ICASSP40776.2020.9054405
12. Wang X. Wang X. Ge J. Liu Z. Ma Y. Li X. Reconfigurable Intelligent Surface-Assisted Secure Communication in Cognitive Radio Systems Energies 2024 17 515 10.3390/en17020515
13. Jull E. Ebbeson G. The reduction of interference from large reflecting surfaces IEEE Trans. Antennas Propag. 1977 25 565 570 10.1109/TAP.1977.1141614
14. Karagiannidis G.K. Sagias N.C. Mathiopoulos P.T. N*Nakagami: A Novel Stochastic Model for Cascaded Fading Channels IEEE Trans. Commun. 2007 55 1453 1458 10.1109/TCOMM.2007.902497
15. Ferreira R.C. Facina M.S.P. de Figueiredo F.A.P. Fraidenraich G. de Lima E.R. Secrecy Analysis and Error Probability of LIS-Aided Communication Systems under Nakagami-m Fading Entropy 2021 23 1284 10.3390/e23101284 34682010
16. Gong S. Lu X. Hoang D.T. Niyato D. Shu L. Kim D.I. Liang Y.-C. Toward Smart Wireless Communications via Intelligent Reflecting Surfaces: A Contemporary Survey IEEE Commun. Surv. Tutor. 2020 22 2283 2314 10.1109/COMST.2020.3004197
17. Wu Q. Zhang S. Zheng B. You C. Zhang R. Intelligent Reflecting Surface-Aided Wireless Communications: A Tutorial IEEE Trans. Commun. 2021 69 3313 3351 10.1109/TCOMM.2021.3051897
18. Vega Sánchez J.D. Ramírez-Espinosa P. López-Martínez F.J. Physical Layer Security of Large Reflecting Surface Aided Communications with Phase Errors IEEE Wirel. Commun. Lett. 2021 10 325 329 10.1109/LWC.2020.3029816
19. Coelho Ferreira R. Facina M.S.P. de Figueiredo F.A.P. Fraidenraich G. de Lima E.R. Large Intelligent Surfaces Communicating through Massive MIMO Rayleigh Fading Channels Sensors 2020 20 6679 10.3390/s20226679 33266451
20. Nadeem Q.-U.-A. Alwazani H. Kammoun A. Chaaban A. Débbah M. Alouini M.-S. Intelligent Reflecting Surface-Assisted Multi-User MISO Communication: Channel Estimation and Beamforming Design IEEE Open J. Commun. Soc. 2020 1 661 680 10.1109/OJCOMS.2020.2992791
21. Basar E. Transmission Through Large Intelligent Surfaces: A New Frontier in Wireless Communications Proceedings of the 2019 European Conference on Networks and Communications (EuCNC) Valencia, Spain 18–21 June 2019 112 117 10.1109/EuCNC.2019.8801961
22. Lin Z. Niu H. An K. Wang Y. Zheng G. Chatzinotas S. Hu Y. Refracting RIS-aided hybrid satellite-terrestrial relay networks: Joint beamforming design and optimization IEEE Trans. Aerosp. Electron. Syst. 2022 58 3717 3724 10.1109/TAES.2022.3155711
23. Lin Z. Niu H. An K. Hu Y. Li D. Wang J. Al-Dhahir N. Pain without gain: Destructive beamforming from a malicious RIS perspective in IoT networks IEEE Internet Things J. 2023 11 7619 7629 10.1109/JIOT.2023.3316830
24. Ma R. Yang W. Guan X. Lu X. Song Y. Chen D. Covert mmWave communications with finite blocklength against spatially random wardens IEEE Internet Things J. 2023 11 3402 3416 10.1109/JIOT.2023.3296414
25. Niu H. Chu Z. Zhou F. Zhu Z. Zhen L. Wong K.-K. Robust design for intelligent reflecting surface-assisted secrecy SWIPT network IEEE Trans. Wirel. Commun. 2021 21 4133 4149 10.1109/TWC.2021.3126833
26. Kendall M.G. The Advanced Theory of Statistics Charles Griffin and Co., Ltd. London, UK 1948 Volume 1
